function BlockData(a,b){this.selMenuHander=a,this.target=b}function BlockCCControlData(a,b,c){this.selCCControlHandler=a,this.target=b,this.controlEvents=c}var PROPERTY_POSITION="position",PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SKEW="skew",PROPERTY_ANCHORPOINT="anchorPoint",PROPERTY_SCALE="scale",PROPERTY_ROTATION="rotation",PROPERTY_TAG="tag",PROPERTY_IGNOREANCHORPOINTFORPOSITION="ignoreAnchorPointForPosition",PROPERTY_VISIBLE="visible",ASSERT_FAIL_UNEXPECTED_PROPERTY=function(a){cc.log("Unexpected property: '"+a+"'!")},ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE=function(a){cc.log("Unexpected property type: '"+a+"'!")};cc.NodeLoader=cc.Class.extend({_customProperties:null,ctor:function(){this._customProperties=new cc._Dictionary},loadCCNode:function(a,b){return this._createCCNode(a,b)},parseProperties:function(a,b,c){for(var d=c.readInt(!1),e=c.readInt(!1),f=d+e,g=0;f>g;g++){var h=g>=d,i=c.readInt(!1),j=c.readCachedString(),k=!1,l=c.readByte();if((l===CCB_PLATFORM_ALL||l===CCB_PLATFORM_IOS||l===CCB_PLATFORM_MAC)&&(k=!0),a instanceof cc.BuilderFile){if(a.getCCBFileNode()&&h){a=a.getCCBFileNode();var m=a.userObject;k=-1!=m.indexOf(j)}}else if(h&&a==c.getAnimationManager().getRootNode()){var n=a.userObject;n||(n=[],a.userObject=n),n.push(j)}switch(i){case CCB_PROPTYPE_POSITION:var o=this.parsePropTypePosition(a,b,c,j);k&&this.onHandlePropTypePosition(a,b,j,o,c);break;case CCB_PROPTYPE_POINT:var p=this.parsePropTypePoint(a,b,c);k&&this.onHandlePropTypePoint(a,b,j,p,c);break;case CCB_PROPTYPE_POINTLOCK:var q=this.parsePropTypePointLock(a,b,c);k&&this.onHandlePropTypePointLock(a,b,j,q,c);break;case CCB_PROPTYPE_SIZE:var r=this.parsePropTypeSize(a,b,c);k&&this.onHandlePropTypeSize(a,b,j,r,c);break;case CCB_PROPTYPE_SCALELOCK:var s=this.parsePropTypeScaleLock(a,b,c,j);k&&this.onHandlePropTypeScaleLock(a,b,j,s,c);break;case CCB_PROPTYPE_FLOATXY:var t=this.parsePropTypeFloatXY(a,b,c);k&&this.onHandlePropTypeFloatXY(a,b,j,t,c);break;case CCB_PROPTYPE_FLOAT:var u=this.parsePropTypeFloat(a,b,c);k&&this.onHandlePropTypeFloat(a,b,j,u,c);break;case CCB_PROPTYPE_DEGREES:var v=this.parsePropTypeDegrees(a,b,c,j);k&&this.onHandlePropTypeDegrees(a,b,j,v,c);break;case CCB_PROPTYPE_FLOATSCALE:var w=this.parsePropTypeFloatScale(a,b,c);k&&this.onHandlePropTypeFloatScale(a,b,j,w,c);break;case CCB_PROPTYPE_INTEGER:var x=this.parsePropTypeInteger(a,b,c);k&&this.onHandlePropTypeInteger(a,b,j,x,c);break;case CCB_PROPTYPE_INTEGERLABELED:var y=this.parsePropTypeIntegerLabeled(a,b,c);k&&this.onHandlePropTypeIntegerLabeled(a,b,j,y,c);break;case CCB_PROPTYPE_FLOATVAR:var z=this.parsePropTypeFloatVar(a,b,c);k&&this.onHandlePropTypeFloatVar(a,b,j,z,c);break;case CCB_PROPTYPE_CHECK:var A=this.parsePropTypeCheck(a,b,c,j);k&&this.onHandlePropTypeCheck(a,b,j,A,c);break;case CCB_PROPTYPE_SPRITEFRAME:var B=this.parsePropTypeSpriteFrame(a,b,c,j);k&&this.onHandlePropTypeSpriteFrame(a,b,j,B,c);break;case CCB_PROPTYPE_ANIMATION:var C=this.parsePropTypeAnimation(a,b,c);k&&this.onHandlePropTypeAnimation(a,b,j,C,c);break;case CCB_PROPTYPE_TEXTURE:var D=this.parsePropTypeTexture(a,b,c);k&&this.onHandlePropTypeTexture(a,b,j,D,c);break;case CCB_PROPTYPE_BYTE:var E=this.parsePropTypeByte(a,b,c,j);k&&this.onHandlePropTypeByte(a,b,j,E,c);break;case CCB_PROPTYPE_COLOR3:var F=this.parsePropTypeColor3(a,b,c,j);k&&this.onHandlePropTypeColor3(a,b,j,F,c);break;case CCB_PROPTYPE_COLOR4VAR:var G=this.parsePropTypeColor4FVar(a,b,c);k&&this.onHandlePropTypeColor4FVar(a,b,j,G,c);break;case CCB_PROPTYPE_FLIP:var H=this.parsePropTypeFlip(a,b,c);k&&this.onHandlePropTypeFlip(a,b,j,H,c);break;case CCB_PROPTYPE_BLENDMODE:var I=this.parsePropTypeBlendFunc(a,b,c);k&&this.onHandlePropTypeBlendFunc(a,b,j,I,c);break;case CCB_PROPTYPE_FNTFILE:var J=c.getCCBRootPath()+this.parsePropTypeFntFile(a,b,c);k&&this.onHandlePropTypeFntFile(a,b,j,J,c);break;case CCB_PROPTYPE_FONTTTF:var K=this.parsePropTypeFontTTF(a,b,c);k&&this.onHandlePropTypeFontTTF(a,b,j,K,c);break;case CCB_PROPTYPE_STRING:var L=this.parsePropTypeString(a,b,c);k&&this.onHandlePropTypeString(a,b,j,L,c);break;case CCB_PROPTYPE_TEXT:var M=this.parsePropTypeText(a,b,c);k&&this.onHandlePropTypeText(a,b,j,M,c);break;case CCB_PROPTYPE_BLOCK:var N=this.parsePropTypeBlock(a,b,c);k&&this.onHandlePropTypeBlock(a,b,j,N,c);break;case CCB_PROPTYPE_BLOCKCCCONTROL:var O=this.parsePropTypeBlockCCControl(a,b,c);k&&null!=O&&this.onHandlePropTypeBlockCCControl(a,b,j,O,c);break;case CCB_PROPTYPE_CCBFILE:var P=this.parsePropTypeCCBFile(a,b,c);k&&this.onHandlePropTypeCCBFile(a,b,j,P,c);break;default:ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE(i)}}},getCustomProperties:function(){return this._customProperties},_createCCNode:function(){return cc.Node.create()},parsePropTypePosition:function(a,b,c,d){var e=c.readFloat(),f=c.readFloat(),g=c.readInt(!1),h=c.getAnimationManager().getContainerSize(b),i=cc._getAbsolutePosition(e,f,g,h,d);if(a.setPosition(cc.getAbsolutePosition(i,g,h,d)),c.getAnimatedProperties().indexOf(d)>-1){var j=[e,f,g];c.getAnimationManager().setBaseValue(j,a,d)}return i},parsePropTypePoint:function(a,b,c){var d=c.readFloat(),e=c.readFloat();return cc.p(d,e)},parsePropTypePointLock:function(a,b,c){var d=c.readFloat(),e=c.readFloat();return cc.p(d,e)},parsePropTypeSize:function(a,b,c){var d=c.readFloat(),e=c.readFloat(),f=c.readInt(!1),g=c.getAnimationManager().getContainerSize(b);switch(f){case CCB_SIZETYPE_ABSOLUTE:break;case CCB_SIZETYPE_RELATIVE_CONTAINER:d=g.width-d,e=g.height-e;break;case CCB_SIZETYPE_PERCENT:d=g.width*d/100,e=g.height*e/100;break;case CCB_SIZETYPE_HORIZONTAL_PERCENT:d=g.width*d/100;break;case CCB_SIZETYPE_VERTICAL_PERCENT:e=g.height*e/100;break;case CCB_SIZETYPE_MULTIPLY_RESOLUTION:var h=cc.BuilderReader.getResolutionScale();d*=h,e*=h;break;default:cc.log("Unknown CCB type.")}return cc.size(d,e)},parsePropTypeScaleLock:function(a,b,c,d){var e=c.readFloat(),f=c.readFloat(),g=c.readInt(!1);return cc.setRelativeScale(a,e,f,g,d),c.getAnimatedProperties().indexOf(d)>-1&&c.getAnimationManager().setBaseValue([e,f,g],a,d),g==CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(e*=cc.BuilderReader.getResolutionScale(),f*=cc.BuilderReader.getResolutionScale()),[e,f]},parsePropTypeFloat:function(a,b,c){return c.readFloat()},parsePropTypeDegrees:function(a,b,c,d){var e=c.readFloat();return c.getAnimatedProperties().indexOf(d)>-1&&c.getAnimationManager().setBaseValue(e,a,d),e},parsePropTypeFloatScale:function(a,b,c){var d=c.readFloat(),e=c.readInt(!1);return e==CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(d*=cc.BuilderReader.getResolutionScale()),d},parsePropTypeInteger:function(a,b,c){return c.readInt(!0)},parsePropTypeIntegerLabeled:function(a,b,c){return c.readInt(!0)},parsePropTypeFloatVar:function(a,b,c){var d=c.readFloat(),e=c.readFloat();return[d,e]},parsePropTypeCheck:function(a,b,c,d){var e=c.readBool();return c.getAnimatedProperties().indexOf(d)>-1&&c.getAnimationManager().setBaseValue(e,a,d),e},parsePropTypeSpriteFrame:function(a,b,c,d){var e,f=c.readCachedString(),g=c.readCachedString();if(null!=g&&0!=g.length){if(0==f.length){g=c.getCCBRootPath()+g;var h=cc.textureCache.addImage(g),i=h.getContentSize(),j=cc.rect(0,0,i.width,i.height);e=cc.SpriteFrame.create(h,j)}else{var k=cc.spriteFrameCache;f=c.getCCBRootPath()+f,-1==c.getLoadedSpriteSheet().indexOf(f)&&(k.addSpriteFrames(f),c.getLoadedSpriteSheet().push(f)),e=k.getSpriteFrame(g)}c.getAnimatedProperties().indexOf(d)>-1&&c.getAnimationManager().setBaseValue(e,a,d)}return e},parsePropTypeAnimation:function(a,b,c){var d=c.getCCBRootPath()+c.readCachedString(),e=c.readCachedString(),f=null;if(e=cc.BuilderReader.lastPathComponent(e),d=cc.BuilderReader.lastPathComponent(d),null!=e&&""!=e){var g=cc.animationCache;g.addAnimations(d),f=g.getAnimation(e)}return f},parsePropTypeTexture:function(a,b,c){var d=c.getCCBRootPath()+c.readCachedString();return""!=d?cc.textureCache.addImage(d):null},parsePropTypeByte:function(a,b,c,d){var e=c.readByte();return c.getAnimatedProperties().indexOf(d)>-1&&c.getAnimationManager().setBaseValue(e,a,d),e},parsePropTypeColor3:function(a,b,c,d){var e=c.readByte(),f=c.readByte(),g=c.readByte(),h={r:e,g:f,b:g};return c.getAnimatedProperties().indexOf(d)>-1&&c.getAnimationManager().setBaseValue(cc.Color3BWapper.create(h),a,d),h},parsePropTypeColor4FVar:function(a,b,c){var d=0|255*c.readFloat(),e=0|255*c.readFloat(),f=0|255*c.readFloat(),g=c.readFloat();g=1>=g?0|255*g:g;var h=0|255*c.readFloat(),i=0|255*c.readFloat(),j=0|255*c.readFloat(),k=c.readFloat();k=1>=k?0|255*k:k;var l=[];return l[0]={r:d,g:e,b:f,a:g},l[1]={r:h,g:i,b:j,a:k},l},parsePropTypeFlip:function(a,b,c){var d=c.readBool(),e=c.readBool();return[d,e]},parsePropTypeBlendFunc:function(a,b,c){var d=c.readInt(!1),e=c.readInt(!1);return new cc.BlendFunc(d,e)},parsePropTypeFntFile:function(a,b,c){return c.readCachedString()},parsePropTypeString:function(a,b,c){return c.readCachedString()},parsePropTypeText:function(a,b,c){return c.readCachedString()},parsePropTypeFontTTF:function(a,b,c){return c.readCachedString()},parsePropTypeBlock:function(a,b,c){var d=c.readCachedString(),e=c.readInt(!1);if(e!==CCB_TARGETTYPE_NONE){var f=null;if(c.isJSControlled())e===CCB_TARGETTYPE_DOCUMENTROOT?(c.addDocumentCallbackNode(a),c.addDocumentCallbackName(d),c.addDocumentCallbackControlEvents(0)):(c.addOwnerCallbackNode(a),c.addOwnerCallbackName(d),c.addOwnerCallbackControlEvents(0));else if(e===CCB_TARGETTYPE_DOCUMENTROOT?f=c.getAnimationManager().getRootNode():e===CCB_TARGETTYPE_OWNER&&(f=c.getOwner()),null!=f)if(d.length>0){var g=0;if(null!=f&&f.onResolveCCBCCMenuItemSelector&&(g=f.onResolveCCBCCMenuItemSelector(f,d)),0==g){var h=c.getCCBSelectorResolver();null!=h&&(g=h.onResolveCCBCCMenuItemSelector(f,d))}if(0!=g)return new BlockData(g,f);cc.log("Skipping selector '"+d+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}return null},parsePropTypeBlockCCControl:function(a,b,c){var d=c.readCachedString(),e=c.readInt(!1),f=c.readInt(!1);if(e!==CCB_TARGETTYPE_NONE)if(c.isJSControlled())e==CCB_TARGETTYPE_DOCUMENTROOT?(c.addDocumentCallbackNode(a),c.addDocumentCallbackName(d),c.addDocumentCallbackControlEvents(f)):(c.addOwnerCallbackNode(a),c.addOwnerCallbackName(d),c.addOwnerCallbackControlEvents(f));else{var g=null;if(e==CCB_TARGETTYPE_DOCUMENTROOT?g=c.getAnimationManager().getRootNode():e==CCB_TARGETTYPE_OWNER&&(g=c.getOwner()),null!=g)if(d.length>0){var h=0;if(null!=g&&g.onResolveCCBCCControlSelector&&(h=g.onResolveCCBCCControlSelector(g,d)),0==h){var i=c.getCCBSelectorResolver();null!=i&&(h=i.onResolveCCBCCControlSelector(g,d))}if(0!=h)return new BlockCCControlData(h,g,f);cc.log("Skipping selector '"+d+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}return null},parsePropTypeCCBFile:function(a,b,c){var d=c.getCCBRootPath()+c.readCachedString(),e=cc.BuilderReader.deletePathExtension(d);d=e+".ccbi";var f=new cc.BuilderReader(c),g=cc.loader.getRes(d);if(!g){var h=cc.loader.getUrl(d);g=cc.loader.loadBinarySync(h),cc.loader.cache[d]=g}f.initWithData(g,c.getOwner()),f.getAnimationManager().setRootContainerSize(b.getContentSize()),f.setAnimationManagers(c.getAnimationManagers()),f.getAnimationManager().setOwner(c.getOwner());var i=f.readFileWithCleanUp(!1);return c.setAnimationManagers(f.getAnimationManagers()),i&&-1!=f.getAnimationManager().getAutoPlaySequenceId()&&f.getAnimationManager().runAnimations(f.getAnimationManager().getAutoPlaySequenceId(),0),i},parsePropTypeFloatXY:function(a,b,c){var d=c.readFloat(),e=c.readFloat();return[d,e]},onHandlePropTypePosition:function(a,b,c,d){c===PROPERTY_POSITION?a.setPosition(d):ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypePoint:function(a,b,c,d){c===PROPERTY_ANCHORPOINT?a.setAnchorPoint(d):ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypePointLock:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeSize:function(a,b,c,d){c===PROPERTY_CONTENTSIZE?a.setContentSize(d):ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeScaleLock:function(a,b,c,d){c===PROPERTY_SCALE?(a.setScaleX(d[0]),a.setScaleY(d[1])):ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeFloatXY:function(a,b,c,d){if(c===PROPERTY_SKEW)a.setSkewX(d[0]),a.setSkewY(d[1]);else{var e=c+"X",f=c+"Y";a[e]&&a[f]||ASSERT_FAIL_UNEXPECTED_PROPERTY(c),a[e](d[0]),a[f](d[1])}},onHandlePropTypeFloat:function(a,b,c,d){this._customProperties.setObject(d,c)},onHandlePropTypeDegrees:function(a,b,c,d){c===PROPERTY_ROTATION?a.setRotation(d):ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeFloatScale:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeInteger:function(a,b,c,d){c===PROPERTY_TAG?a.setTag(d):ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeIntegerLabeled:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeFloatVar:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeCheck:function(a,b,c,d){c===PROPERTY_VISIBLE?a.setVisible(d):c===PROPERTY_IGNOREANCHORPOINTFORPOSITION?a.ignoreAnchorPointForPosition(d):ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeSpriteFrame:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeAnimation:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeTexture:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeByte:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeColor3:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeColor4FVar:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeFlip:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeBlendFunc:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeFntFile:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeString:function(a,b,c,d){this._customProperties.setObject(d,c)},onHandlePropTypeText:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeFontTTF:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeBlock:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeBlockCCControl:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)},onHandlePropTypeCCBFile:function(a,b,c){ASSERT_FAIL_UNEXPECTED_PROPERTY(c)}}),cc.NodeLoader.loader=function(){return new cc.NodeLoader},cc.NodeLoaderListener=cc.Class.extend({onNodeLoaded:function(){}}),cc.BuilderSelectorResolver=cc.Class.extend({onResolveCCBCCMenuItemSelector:function(){},onResolveCCBCCCallFuncSelector:function(){},onResolveCCBCCControlSelector:function(){}}),cc.BuilderScriptOwnerProtocol=cc.Class.extend({createNew:function(){}}),cc.BuilderMemberVariableAssigner=cc.Class.extend({onAssignCCBMemberVariable:function(){return!1},onAssignCCBCustomProperty:function(){return!1}});var PROPERTY_CCBFILE="ccbFile";cc.BuilderFileLoader=cc.NodeLoader.extend({_createCCNode:function(){return cc.BuilderFile.create()},onHandlePropTypeCCBFile:function(a,b,c,d,e){c==PROPERTY_CCBFILE?a.setCCBFileNode(d):cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(this,a,b,c,d,e)}}),cc.BuilderFileLoader.loader=function(){return new cc.BuilderFileLoader};var PROPERTY_ENABLED="enabled",PROPERTY_SELECTED="selected",PROPERTY_CCCONTROL="ccControl";cc.ControlLoader=cc.NodeLoader.extend({_createCCNode:function(){},onHandlePropTypeBlockCCControl:function(a,b,c,d,e){c==PROPERTY_CCCONTROL?a.addTargetWithActionForControlEvents(d.target,d.selCCControlHandler,d.controlEvents):cc.NodeLoader.prototype.onHandlePropTypeBlockCCControl.call(this,a,b,c,d,e)},onHandlePropTypeCheck:function(a,b,c,d,e){c==PROPERTY_ENABLED?a.setEnabled(d):c==PROPERTY_SELECTED?a.setSelected(d):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,a,b,c,d,e)}});var PROPERTY_ZOOMONTOUCHDOWN="zoomOnTouchDown",PROPERTY_TITLE_NORMAL="title|1",PROPERTY_TITLE_HIGHLIGHTED="title|2",PROPERTY_TITLE_DISABLED="title|3",PROPERTY_TITLECOLOR_NORMAL="titleColor|1",PROPERTY_TITLECOLOR_HIGHLIGHTED="titleColor|2",PROPERTY_TITLECOLOR_DISABLED="titleColor|3",PROPERTY_TITLETTF_NORMAL="titleTTF|1",PROPERTY_TITLETTF_HIGHLIGHTED="titleTTF|2",PROPERTY_TITLETTF_DISABLED="titleTTF|3",PROPERTY_TITLETTFSIZE_NORMAL="titleTTFSize|1",PROPERTY_TITLETTFSIZE_HIGHLIGHTED="titleTTFSize|2",PROPERTY_TITLETTFSIZE_DISABLED="titleTTFSize|4",PROPERTY_LABELANCHORPOINT="labelAnchorPoint",PROPERTY_PREFEREDSIZE="preferedSize",PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL="backgroundSpriteFrame|1",PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED="backgroundSpriteFrame|2",PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED="backgroundSpriteFrame|3";cc.ControlButtonLoader=cc.ControlLoader.extend({_createCCNode:function(){return cc.ControlButton.create()},onHandlePropTypeCheck:function(a,b,c,d,e){c==PROPERTY_ZOOMONTOUCHDOWN?a.setZoomOnTouchDown(d):cc.ControlLoader.prototype.onHandlePropTypeCheck.call(this,a,b,c,d,e)},onHandlePropTypeString:function(a,b,c,d,e){c==PROPERTY_TITLE_NORMAL?a.setTitleForState(d,cc.CONTROL_STATE_NORMAL):c==PROPERTY_TITLE_HIGHLIGHTED?a.setTitleForState(d,cc.CONTROL_STATE_HIGHLIGHTED):c==PROPERTY_TITLE_DISABLED?a.setTitleForState(d,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeString.call(this,a,b,c,d,e)},onHandlePropTypeFontTTF:function(a,b,c,d,e){c==PROPERTY_TITLETTF_NORMAL?a.setTitleTTFForState(d,cc.CONTROL_STATE_NORMAL):c==PROPERTY_TITLETTF_HIGHLIGHTED?a.setTitleTTFForState(d,cc.CONTROL_STATE_HIGHLIGHTED):c==PROPERTY_TITLETTF_DISABLED?a.setTitleTTFForState(d,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeFontTTF.call(this,a,b,c,d,e)},onHandlePropTypeFloatScale:function(a,b,c,d,e){c==PROPERTY_TITLETTFSIZE_NORMAL?a.setTitleTTFSizeForState(d,cc.CONTROL_STATE_NORMAL):c==PROPERTY_TITLETTFSIZE_HIGHLIGHTED?a.setTitleTTFSizeForState(d,cc.CONTROL_STATE_HIGHLIGHTED):c==PROPERTY_TITLETTFSIZE_DISABLED?a.setTitleTTFSizeForState(d,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeFloatScale.call(this,a,b,c,d,e)},onHandlePropTypePoint:function(a,b,c,d,e){c==PROPERTY_LABELANCHORPOINT?a.setLabelAnchorPoint(d):cc.ControlLoader.prototype.onHandlePropTypePoint.call(this,a,b,c,d,e)},onHandlePropTypeSize:function(a,b,c,d,e){c==PROPERTY_PREFEREDSIZE?a.setPreferredSize(d):cc.ControlLoader.prototype.onHandlePropTypeSize.call(this,a,b,c,d,e)},onHandlePropTypeSpriteFrame:function(a,b,c,d,e){c==PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL?null!=d&&a.setBackgroundSpriteFrameForState(d,cc.CONTROL_STATE_NORMAL):c==PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED?null!=d&&a.setBackgroundSpriteFrameForState(d,cc.CONTROL_STATE_HIGHLIGHTED):c==PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED?null!=d&&a.setBackgroundSpriteFrameForState(d,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeSpriteFrame.call(this,a,b,c,d,e)},onHandlePropTypeColor3:function(a,b,c,d,e){c==PROPERTY_TITLECOLOR_NORMAL?a.setTitleColorForState(d,cc.CONTROL_STATE_NORMAL):c==PROPERTY_TITLECOLOR_HIGHLIGHTED?a.setTitleColorForState(d,cc.CONTROL_STATE_HIGHLIGHTED):c==PROPERTY_TITLECOLOR_DISABLED?a.setTitleColorForState(d,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeColor3.call(this,a,b,c,d,e)}}),cc.ControlButtonLoader.loader=function(){return new cc.ControlButtonLoader};var PROPERTY_CONTAINER="container",PROPERTY_DIRECTION="direction",PROPERTY_CLIPSTOBOUNDS="clipsToBounds",PROPERTY_BOUNCES="bounces",PROPERTY_SCALE="scale";cc.ScrollViewLoader=cc.NodeLoader.extend({_createCCNode:function(){return cc.ScrollView.create()},onHandlePropTypeSize:function(a,b,c,d,e){c==PROPERTY_CONTENTSIZE?a.setViewSize(d):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,a,b,c,d,e)},onHandlePropTypeCCBFile:function(a,b,c,d,e){c==PROPERTY_CONTAINER?(a.setContainer(d),a.updateInset()):cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(this,a,b,c,d,e)},onHandlePropTypeCheck:function(a,b,c,d,e){c==PROPERTY_CLIPSTOBOUNDS?a.setClippingToBounds(d):c==PROPERTY_BOUNCES?a.setBounceable(d):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,a,b,c,d,e)},onHandlePropTypeFloat:function(a,b,c,d,e){c==PROPERTY_SCALE?a.setScale(d):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,a,b,c,d,e)},onHandlePropTypeIntegerLabeled:function(a,b,c,d,e){c==PROPERTY_DIRECTION?a.setDirection(d):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,a,b,c,d,e)}}),cc.ScrollViewLoader.loader=function(){return new cc.ScrollViewLoader};var PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SPRITEFRAME="spriteFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc",PROPERTY_INSETLEFT="insetLeft",PROPERTY_INSETTOP="insetTop",PROPERTY_INSETRIGHT="insetRight",PROPERTY_INSETBOTTOM="insetBottom";cc.Scale9SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(){var a=cc.Scale9Sprite.create();return a.setAnchorPoint(0,0),a},onHandlePropTypeColor3:function(a,b,c,d,e){c==PROPERTY_COLOR?(255!==d.r||255!==d.g||255!==d.b)&&a.setColor(d):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,a,b,c,d,e)},onHandlePropTypeByte:function(a,b,c,d,e){c==PROPERTY_OPACITY?a.setOpacity(d):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,a,b,c,d,e)},onHandlePropTypeBlendFunc:function(a,b,c,d,e){c==PROPERTY_BLENDFUNC||cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,a,b,c,d,e)},onHandlePropTypeSpriteFrame:function(a,b,c,d,e){c==PROPERTY_SPRITEFRAME?a.setSpriteFrame(d):cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(this,a,b,c,d,e)},onHandlePropTypeSize:function(a,b,c,d,e){c==PROPERTY_CONTENTSIZE||(c==PROPERTY_PREFEREDSIZE?a.setPreferredSize(d):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,a,b,c,d,e))},onHandlePropTypeFloat:function(a,b,c,d,e){c==PROPERTY_INSETLEFT?a.setInsetLeft(d):c==PROPERTY_INSETTOP?a.setInsetTop(d):c==PROPERTY_INSETRIGHT?a.setInsetRight(d):c==PROPERTY_INSETBOTTOM?a.setInsetBottom(d):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,a,b,c,d,e)}}),cc.Scale9SpriteLoader.loader=function(){return new cc.Scale9SpriteLoader};var PROPERTY_FLIP="flip",PROPERTY_DISPLAYFRAME="displayFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc";cc.SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(){return cc.Sprite.create()},onHandlePropTypeColor3:function(a,b,c,d,e){c===PROPERTY_COLOR?(255!==d.r||255!==d.g||255!==d.b)&&a.setColor(d):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,a,b,c,d,e)},onHandlePropTypeByte:function(a,b,c,d,e){c===PROPERTY_OPACITY?a.setOpacity(d):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,a,b,c,d,e)},onHandlePropTypeBlendFunc:function(a,b,c,d,e){c===PROPERTY_BLENDFUNC?a.setBlendFunc(d):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,a,b,c,d,e)},onHandlePropTypeSpriteFrame:function(a,b,c,d,e){c===PROPERTY_DISPLAYFRAME?d?a.setSpriteFrame(d):cc.log("ERROR: SpriteFrame is null"):cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(this,a,b,c,d,e)},onHandlePropTypeFlip:function(a,b,c,d,e){c===PROPERTY_FLIP?(a.setFlippedX(d[0]),a.setFlippedY(d[1])):cc.NodeLoader.prototype.onHandlePropTypeFlip.call(this,a,b,c,d,e)}}),cc.SpriteLoader.loader=function(){return new cc.SpriteLoader};var PROPERTY_TOUCH_ENABLED="touchEnabled",PROPERTY_IS_TOUCH_ENABLED="isTouchEnabled",PROPERTY_ACCELEROMETER_ENABLED="accelerometerEnabled",PROPERTY_IS_ACCELEROMETER_ENABLED="isAccelerometerEnabled",PROPERTY_IS_MOUSE_ENABLED="isMouseEnabled",PROPERTY_MOUSE_ENABLED="mouseEnabled",PROPERTY_KEYBOARD_ENABLED="keyboardEnabled",PROPERTY_IS_KEYBOARD_ENABLED="isKeyboardEnabled";cc.LayerLoader=cc.NodeLoader.extend({_createCCNode:function(){var a=cc.Layer.create();return a.setContentSize(0,0),a},onHandlePropTypeCheck:function(a,b,c,d,e){c===PROPERTY_TOUCH_ENABLED||c===PROPERTY_IS_TOUCH_ENABLED||c===PROPERTY_ACCELEROMETER_ENABLED||c===PROPERTY_IS_ACCELEROMETER_ENABLED||c===PROPERTY_MOUSE_ENABLED||c===PROPERTY_IS_MOUSE_ENABLED||(c===PROPERTY_KEYBOARD_ENABLED||c===PROPERTY_IS_KEYBOARD_ENABLED?a.setKeyboardEnabled&&!cc.sys.isNative?a.setKeyboardEnabled(d):cc.log("The property '"+PROPERTY_IS_KEYBOARD_ENABLED+"' is not supported!"):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,a,b,c,d,e))}}),cc.LayerLoader.loader=function(){return new cc.LayerLoader},cc.LayerColorLoader=cc.LayerLoader.extend({_createCCNode:function(){return cc.LayerColor.create()},onHandlePropTypeColor3:function(a,b,c,d,e){c===PROPERTY_COLOR?a.setColor(d):cc.LayerLoader.prototype.onHandlePropTypeColor3.call(this,a,b,c,d,e)},onHandlePropTypeByte:function(a,b,c,d,e){c===PROPERTY_OPACITY?a.setOpacity(d):cc.LayerLoader.prototype.onHandlePropTypeByte.call(this,a,b,c,d,e)},onHandlePropTypeBlendFunc:function(a,b,c,d,e){c===PROPERTY_BLENDFUNC?a.setBlendFunc(d):cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(this,a,b,c,d,e)}}),cc.LayerColorLoader.loader=function(){return new cc.LayerColorLoader};var PROPERTY_STARTCOLOR="startColor",PROPERTY_ENDCOLOR="endColor",PROPERTY_STARTOPACITY="startOpacity",PROPERTY_ENDOPACITY="endOpacity",PROPERTY_VECTOR="vector";cc.LayerGradientLoader=cc.LayerLoader.extend({_createCCNode:function(){return cc.LayerGradient.create()},onHandlePropTypeColor3:function(a,b,c,d,e){c===PROPERTY_STARTCOLOR?a.setStartColor(d):c==PROPERTY_ENDCOLOR?a.setEndColor(d):cc.LayerLoader.prototype.onHandlePropTypeColor3.call(this,a,b,c,d,e)},onHandlePropTypeByte:function(a,b,c,d,e){c===PROPERTY_STARTOPACITY?a.setStartOpacity(d):c===PROPERTY_ENDOPACITY?a.setEndOpacity(d):cc.LayerLoader.prototype.onHandlePropTypeByte.call(this,a,b,c,d,e)},onHandlePropTypePoint:function(a,b,c,d,e){c===PROPERTY_VECTOR?a.setVector(d):cc.LayerLoader.prototype.onHandlePropTypePoint.call(this,a,b,c,d,e)},onHandlePropTypeBlendFunc:function(a,b,c,d,e){c===PROPERTY_BLENDFUNC?a.setBlendFunc(d):cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(this,a,b,c,d,e)}}),cc.LayerGradientLoader.loader=function(){return new cc.LayerGradientLoader},cc.MenuLoader=cc.LayerLoader.extend({_createCCNode:function(){var a=cc.Menu.create();return a.setContentSize(0,0),a}}),cc.MenuLoader.loader=function(){return new cc.MenuLoader};var PROPERTY_BLOCK="block",PROPERTY_ISENABLED="isEnabled";cc.MenuItemLoader=cc.NodeLoader.extend({_createCCNode:function(){return null},onHandlePropTypeBlock:function(a,b,c,d,e){c===PROPERTY_BLOCK?null!=d&&a.setTarget(d.selMenuHander,d.target):cc.NodeLoader.prototype.onHandlePropTypeBlock.call(this,a,b,c,d,e)},onHandlePropTypeCheck:function(a,b,c,d,e){c===PROPERTY_ISENABLED?a.setEnabled(d):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,a,b,c,d,e)}});var PROPERTY_NORMALDISPLAYFRAME="normalSpriteFrame",PROPERTY_SELECTEDDISPLAYFRAME="selectedSpriteFrame",PROPERTY_DISABLEDDISPLAYFRAME="disabledSpriteFrame";cc.MenuItemImageLoader=cc.MenuItemLoader.extend({_createCCNode:function(){return cc.MenuItemImage.create()},onHandlePropTypeSpriteFrame:function(a,b,c,d,e){c===PROPERTY_NORMALDISPLAYFRAME?null!=d&&a.setNormalSpriteFrame(d):c===PROPERTY_SELECTEDDISPLAYFRAME?null!=d&&a.setSelectedSpriteFrame(d):c===PROPERTY_DISABLEDDISPLAYFRAME?null!=d&&a.setDisabledSpriteFrame(d):cc.MenuItemLoader.prototype.onHandlePropTypeSpriteFrame.call(this,a,b,c,d,e)}}),cc.MenuItemImageLoader.loader=function(){return new cc.MenuItemImageLoader};var PROPERTY_FONTNAME="fontName",PROPERTY_FONTSIZE="fontSize",PROPERTY_HORIZONTALALIGNMENT="horizontalAlignment",PROPERTY_VERTICALALIGNMENT="verticalAlignment",PROPERTY_STRING="string",PROPERTY_DIMENSIONS="dimensions";cc.LabelTTFLoader=cc.NodeLoader.extend({_createCCNode:function(){return cc.LabelTTF.create()},onHandlePropTypeColor3:function(a,b,c,d,e){c===PROPERTY_COLOR?(255!==d.r||255!==d.g||255!==d.b)&&a.setColor(d):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,a,b,c,d,e)},onHandlePropTypeByte:function(a,b,c,d,e){c===PROPERTY_OPACITY?a.setOpacity(d):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,a,b,c,d,e)},onHandlePropTypeBlendFunc:function(a,b,c,d,e){c===PROPERTY_BLENDFUNC?a.setBlendFunc(d):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,a,b,c,d,e)},onHandlePropTypeFontTTF:function(a,b,c,d,e){c===PROPERTY_FONTNAME?a.setFontName(d):cc.NodeLoader.prototype.onHandlePropTypeFontTTF.call(this,a,b,c,d,e)},onHandlePropTypeText:function(a,b,c,d,e){c===PROPERTY_STRING?a.setString(d):cc.NodeLoader.prototype.onHandlePropTypeText.call(this,a,b,c,d,e)},onHandlePropTypeFloatScale:function(a,b,c,d,e){c===PROPERTY_FONTSIZE?a.setFontSize(d):cc.NodeLoader.prototype.onHandlePropTypeFloatScale.call(this,a,b,c,d,e)},onHandlePropTypeIntegerLabeled:function(a,b,c,d,e){c===PROPERTY_HORIZONTALALIGNMENT?a.setHorizontalAlignment(d):c===PROPERTY_VERTICALALIGNMENT?a.setVerticalAlignment(d):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,a,b,c,d,e)},onHandlePropTypeSize:function(a,b,c,d,e){c===PROPERTY_DIMENSIONS?a.setDimensions(d):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,a,b,c,d,e)}}),cc.LabelTTFLoader.loader=function(){return new cc.LabelTTFLoader};var PROPERTY_FNTFILE="fntFile";cc.LabelBMFontLoader=cc.NodeLoader.extend({_createCCNode:function(){return cc.LabelBMFont.create()},onHandlePropTypeColor3:function(a,b,c,d,e){c===PROPERTY_COLOR?(255!==d.r||255!==d.g||255!==d.b)&&a.setColor(d):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,a,b,c,d,e)},onHandlePropTypeByte:function(a,b,c,d,e){c===PROPERTY_OPACITY?a.setOpacity(d):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,a,b,c,d,e)},onHandlePropTypeBlendFunc:function(a,b,c,d,e){c===PROPERTY_BLENDFUNC?a.setBlendFunc(d):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,a,b,c,d,e)},onHandlePropTypeFntFile:function(a,b,c,d,e){c===PROPERTY_FNTFILE?a.setFntFile(d):cc.NodeLoader.prototype.onHandlePropTypeFntFile.call(this,a,b,c,d,e)},onHandlePropTypeText:function(a,b,c,d,e){c===PROPERTY_STRING?a.setString(d):cc.NodeLoader.prototype.onHandlePropTypeText.call(this,a,b,c,d,e)}}),cc.LabelBMFontLoader.loader=function(){return new cc.LabelBMFontLoader};var PROPERTY_EMITERMODE="emitterMode",PROPERTY_POSVAR="posVar",PROPERTY_EMISSIONRATE="emissionRate",PROPERTY_DURATION="duration",PROPERTY_TOTALPARTICLES="totalParticles",PROPERTY_LIFE="life",PROPERTY_STARTSIZE="startSize",PROPERTY_ENDSIZE="endSize",PROPERTY_STARTSPIN="startSpin",PROPERTY_ENDSPIN="endSpin",PROPERTY_ANGLE="angle",PROPERTY_GRAVITY="gravity",PROPERTY_SPEED="speed",PROPERTY_TANGENTIALACCEL="tangentialAccel",PROPERTY_RADIALACCEL="radialAccel",PROPERTY_TEXTURE="texture",PROPERTY_STARTRADIUS="startRadius",PROPERTY_ENDRADIUS="endRadius",PROPERTY_ROTATEPERSECOND="rotatePerSecond";cc.ParticleSystemLoader=cc.NodeLoader.extend({_createCCNode:function(){return cc.ParticleSystem.create()},onHandlePropTypeIntegerLabeled:function(a,b,c,d,e){c===PROPERTY_EMITERMODE?a.setEmitterMode(d):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,a,b,c,d,e)},onHandlePropTypePoint:function(a,b,c,d,e){c===PROPERTY_POSVAR?a.setPosVar(d):c===PROPERTY_GRAVITY?a.setGravity(d):cc.NodeLoader.prototype.onHandlePropTypePoint.call(this,a,b,c,d,e)},onHandlePropTypeFloat:function(a,b,c,d,e){c===PROPERTY_EMISSIONRATE?a.setEmissionRate(d):c===PROPERTY_DURATION?a.setDuration(d):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,a,b,c,d,e)},onHandlePropTypeInteger:function(a,b,c,d,e){c===PROPERTY_TOTALPARTICLES?a.setTotalParticles(d):cc.NodeLoader.prototype.onHandlePropTypeInteger.call(this,a,b,c,d,e)},onHandlePropTypeFloatVar:function(a,b,c,d,e){c===PROPERTY_LIFE?(a.setLife(d[0]),a.setLifeVar(d[1])):c===PROPERTY_STARTSIZE?(a.setStartSize(d[0]),a.setStartSizeVar(d[1])):c===PROPERTY_ENDSIZE?(a.setEndSize(d[0]),a.setEndSizeVar(d[1])):c===PROPERTY_STARTSPIN?(a.setStartSpin(d[0]),a.setStartSpinVar(d[1])):c===PROPERTY_ENDSPIN?(a.setEndSpin(d[0]),a.setEndSpinVar(d[1])):c===PROPERTY_ANGLE?(a.setAngle(d[0]),a.setAngleVar(d[1])):c===PROPERTY_SPEED?(a.setSpeed(d[0]),a.setSpeedVar(d[1])):c===PROPERTY_TANGENTIALACCEL?(a.setTangentialAccel(d[0]),a.setTangentialAccelVar(d[1])):c===PROPERTY_RADIALACCEL?(a.setRadialAccel(d[0]),a.setRadialAccelVar(d[1])):c===PROPERTY_STARTRADIUS?(a.setStartRadius(d[0]),a.setStartRadiusVar(d[1])):c===PROPERTY_ENDRADIUS?(a.setEndRadius(d[0]),a.setEndRadiusVar(d[1])):c===PROPERTY_ROTATEPERSECOND?(a.setRotatePerSecond(d[0]),a.setRotatePerSecondVar(d[1])):cc.NodeLoader.prototype.onHandlePropTypeFloatVar.call(this,a,b,c,d,e)
},onHandlePropTypeColor4FVar:function(a,b,c,d,e){c===PROPERTY_STARTCOLOR?(a.setStartColor(d[0]),a.setStartColorVar(d[1])):c===PROPERTY_ENDCOLOR?(a.setEndColor(d[0]),a.setEndColorVar(d[1])):cc.NodeLoader.prototype.onHandlePropTypeColor4FVar.call(this,a,b,c,d,e)},onHandlePropTypeBlendFunc:function(a,b,c,d,e){c===PROPERTY_BLENDFUNC?a.setBlendFunc(d):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,a,b,c,d,e)},onHandlePropTypeTexture:function(a,b,c,d,e){c===PROPERTY_TEXTURE?a.setTexture(d):cc.NodeLoader.prototype.onHandlePropTypeTexture.call(this,a,b,c,d,e)}}),cc.ParticleSystemLoader.loader=function(){return new cc.ParticleSystemLoader},cc.NodeLoaderLibrary=cc.Class.extend({_ccNodeLoaders:null,ctor:function(){this._ccNodeLoaders={}},registerDefaultCCNodeLoaders:function(){this.registerCCNodeLoader("CCNode",cc.NodeLoader.loader()),this.registerCCNodeLoader("CCLayer",cc.LayerLoader.loader()),this.registerCCNodeLoader("CCLayerColor",cc.LayerColorLoader.loader()),this.registerCCNodeLoader("CCLayerGradient",cc.LayerGradientLoader.loader()),this.registerCCNodeLoader("CCSprite",cc.SpriteLoader.loader()),this.registerCCNodeLoader("CCLabelBMFont",cc.LabelBMFontLoader.loader()),this.registerCCNodeLoader("CCLabelTTF",cc.LabelTTFLoader.loader()),this.registerCCNodeLoader("CCScale9Sprite",cc.Scale9SpriteLoader.loader()),this.registerCCNodeLoader("CCScrollView",cc.ScrollViewLoader.loader()),this.registerCCNodeLoader("CCBFile",cc.BuilderFileLoader.loader()),this.registerCCNodeLoader("CCMenu",cc.MenuLoader.loader()),this.registerCCNodeLoader("CCMenuItemImage",cc.MenuItemImageLoader.loader()),this.registerCCNodeLoader("CCControlButton",cc.ControlButtonLoader.loader()),this.registerCCNodeLoader("CCParticleSystemQuad",cc.ParticleSystemLoader.loader())},registerCCNodeLoader:function(a,b){this._ccNodeLoaders[a]=b},unregisterCCNodeLoader:function(a){this._ccNodeLoaders[a]&&delete this._ccNodeLoaders[a]},getCCNodeLoader:function(a){return this._ccNodeLoaders[a]?this._ccNodeLoaders[a]:null},purge:function(a){if(a)for(var b in this._ccNodeLoaders)delete this._ccNodeLoaders[b];this._ccNodeLoaders={}}}),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null,cc.NodeLoaderLibrary.library=function(){return new cc.NodeLoaderLibrary},cc.NodeLoaderLibrary.sharedCCNodeLoaderLibrary=function(){return null==cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary&&(cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=new cc.NodeLoaderLibrary,cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary.registerDefaultCCNodeLoaders()),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary},cc.NodeLoaderLibrary.purgeSharedCCNodeLoaderLibrary=function(){cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null},cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary=function(){var a=cc.NodeLoaderLibrary.library();return a.registerDefaultCCNodeLoaders(),a};var CCB_VERSION=5,CCB_PROPTYPE_POSITION=0,CCB_PROPTYPE_SIZE=1,CCB_PROPTYPE_POINT=2,CCB_PROPTYPE_POINTLOCK=3,CCB_PROPTYPE_SCALELOCK=4,CCB_PROPTYPE_DEGREES=5,CCB_PROPTYPE_INTEGER=6,CCB_PROPTYPE_FLOAT=7,CCB_PROPTYPE_FLOATVAR=8,CCB_PROPTYPE_CHECK=9,CCB_PROPTYPE_SPRITEFRAME=10,CCB_PROPTYPE_TEXTURE=11,CCB_PROPTYPE_BYTE=12,CCB_PROPTYPE_COLOR3=13,CCB_PROPTYPE_COLOR4VAR=14,CCB_PROPTYPE_FLIP=15,CCB_PROPTYPE_BLENDMODE=16,CCB_PROPTYPE_FNTFILE=17,CCB_PROPTYPE_TEXT=18,CCB_PROPTYPE_FONTTTF=19,CCB_PROPTYPE_INTEGERLABELED=20,CCB_PROPTYPE_BLOCK=21,CCB_PROPTYPE_ANIMATION=22,CCB_PROPTYPE_CCBFILE=23,CCB_PROPTYPE_STRING=24,CCB_PROPTYPE_BLOCKCCCONTROL=25,CCB_PROPTYPE_FLOATSCALE=26,CCB_PROPTYPE_FLOATXY=27,CCB_FLOAT0=0,CCB_FLOAT1=1,CCB_FLOAT_MINUS1=2,CCB_FLOAT05=3,CCB_FLOAT_INTEGER=4,CCB_FLOAT_FULL=5,CCB_PLATFORM_ALL=0,CCB_PLATFORM_IOS=1,CCB_PLATFORM_MAC=2,CCB_TARGETTYPE_NONE=0,CCB_TARGETTYPE_DOCUMENTROOT=1,CCB_TARGETTYPE_OWNER=2,CCB_KEYFRAME_EASING_INSTANT=0,CCB_KEYFRAME_EASING_LINEAR=1,CCB_KEYFRAME_EASING_CUBIC_IN=2,CCB_KEYFRAME_EASING_CUBIC_OUT=3,CCB_KEYFRAME_EASING_CUBIC_INOUT=4,CCB_KEYFRAME_EASING_ELASTIC_IN=5,CCB_KEYFRAME_EASING_ELASTIC_OUT=6,CCB_KEYFRAME_EASING_ELASTIC_INOUT=7,CCB_KEYFRAME_EASING_BOUNCE_IN=8,CCB_KEYFRAME_EASING_BOUNCE_OUT=9,CCB_KEYFRAME_EASING_BOUNCE_INOUT=10,CCB_KEYFRAME_EASING_BACK_IN=11,CCB_KEYFRAME_EASING_BACK_OUT=12,CCB_KEYFRAME_EASING_BACK_INOUT=13,CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT=0,CCB_POSITIONTYPE_RELATIVE_TOP_LEFT=1,CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT=2,CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT=3,CCB_POSITIONTYPE_PERCENT=4,CCB_POSITIONTYPE_MULTIPLY_RESOLUTION=5,CCB_SIZETYPE_ABSOLUTE=0,CCB_SIZETYPE_PERCENT=1,CCB_SIZETYPE_RELATIVE_CONTAINER=2,CCB_SIZETYPE_HORIZONTAL_PERCENT=3,CCB_SIZETYPE_VERTICAL_PERCENT=4,CCB_SIZETYPE_MULTIPLY_RESOLUTION=5,CCB_SCALETYPE_ABSOLUTE=0,CCB_SCALETYPE_MULTIPLY_RESOLUTION=1;cc.BuilderFile=cc.Node.extend({_ccbFileNode:null,getCCBFileNode:function(){return this._ccbFileNode},setCCBFileNode:function(a){this._ccbFileNode=a}}),cc.BuilderFile.create=function(){return new cc.BuilderFile},cc.BuilderReader=cc.Class.extend({_jsControlled:!1,_data:null,_ccbRootPath:"",_bytes:0,_currentByte:0,_currentBit:0,_stringCache:null,_loadedSpriteSheets:null,_owner:null,_animationManager:null,_animationManagers:null,_animatedProps:null,_ccNodeLoaderLibrary:null,_ccNodeLoaderListener:null,_ccbMemberVariableAssigner:null,_ccbSelectorResolver:null,_ownerOutletNames:null,_ownerOutletNodes:null,_nodesWithAnimationManagers:null,_animationManagerForNodes:null,_ownerCallbackNames:null,_ownerCallbackNodes:null,_ownerCallbackEvents:null,_readNodeGraphFromData:!1,ctor:function(a,b,c,d){if(this._stringCache=[],this._loadedSpriteSheets=[],this._currentBit=-1,this._currentByte=-1,0!=arguments.length)if(a instanceof cc.BuilderReader){var e=a;this._loadedSpriteSheets=e._loadedSpriteSheets,this._ccNodeLoaderLibrary=e._ccNodeLoaderLibrary,this._ccbMemberVariableAssigner=e._ccbMemberVariableAssigner,this._ccbSelectorResolver=e._ccbSelectorResolver,this._ccNodeLoaderListener=e._ccNodeLoaderListener,this._ownerCallbackNames=e._ownerCallbackNames,this._ownerCallbackNodes=e._ownerCallbackNodes,this._ownerCallbackEvents=e._ownerCallbackEvents,this._ownerOutletNames=e._ownerOutletNames,this._ownerOutletNodes=e._ownerOutletNodes,this._ccbRootPath=e._ccbRootPath}else this._ccNodeLoaderLibrary=a,this._ccbMemberVariableAssigner=b,this._ccbSelectorResolver=c,this._ccNodeLoaderListener=d},getCCBRootPath:function(){return this._ccbRootPath},setCCBRootPath:function(a){this._ccbRootPath=a},initWithData:function(a,b){return this._animationManager=new cc.BuilderAnimationManager,this._data=a,this._bytes=a.length,this._currentBit=0,this._currentByte=0,this._owner=b,this._animationManager.setRootContainerSize(cc.director.getWinSize()),!0},_loadBinarySync:function(a){var b=this.getXMLHttpRequest(),c="load "+a+" failed!";b.open("GET",a,!1);var d=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){if(b.setRequestHeader("Accept-Charset","x-user-defined"),b.send(null),200!=b.status)return cc.log(c),null;var e=cc._convertResponseBodyToText(b.responseBody);e&&(d=this._stringConvertToArray(e),this._fileDataCache[a]=d)}else{if(b.overrideMimeType&&b.overrideMimeType("text/plain; charset=x-user-defined"),b.send(null),200!=b.status)return cc.log(c),null;d=this._stringConvertToArray(b.responseText),this._fileDataCache[a]=d}return d},readNodeGraphFromFile:function(a,b,c,d){null==c?c=cc.director.getWinSize():c instanceof cc.BuilderAnimationManager&&(d=c,c=cc.director.getWinSize());var e=cc.loader.getRes(a);if(!e){var f=cc.loader.getUrl(a);e=cc.loader.loadBinarySync(f),cc.loader.cache[a]=e}return this.readNodeGraphFromData(e,b,c,d)},readNodeGraphFromData:function(a,b,c){this.initWithData(a,b);var d=this._animationManager;d.setRootContainerSize(c),d.setOwner(b),this._ownerOutletNames=[],this._ownerOutletNodes=[],this._ownerCallbackNames=[],this._ownerCallbackNodes=[],this._ownerCallbackEvents=[],this._animationManagers=new cc._Dictionary;var e=this.readFileWithCleanUp(!0);if(e&&-1!=d.getAutoPlaySequenceId()&&d.runAnimations(d.getAutoPlaySequenceId(),0),this._jsControlled){for(var f=[],g=[],h=this._animationManagers,i=h.allKeys(),j=0;j<i.length;j++)f.push(i[j]),g.push(h.objectForKey(i[j]));this._nodesWithAnimationManagers=f,this._animationManagerForNodes=g}return e},createSceneWithNodeGraphFromFile:function(a,b,c,d){var e=this.readNodeGraphFromFile(a,b,c,d),f=cc.Scene.create();return f.addChild(e),f},getCCBMemberVariableAssigner:function(){return this._ccbMemberVariableAssigner},getCCBSelectorResolver:function(){return this._ccbSelectorResolver},getAnimationManager:function(){return this._animationManager},setAnimationManager:function(a){this._animationManager=a},getAnimatedProperties:function(){return this._animatedProps},getLoadedSpriteSheet:function(){return this._loadedSpriteSheets},getOwner:function(){return this._owner},readInt:function(a){for(var b=0;!this._getBit();)b++;for(var c=0,d=b-1;d>=0;d--)this._getBit()&&(c|=1<<d);c|=1<<b;var e;if(a){var f=c%2;e=f?0|c/2:0|-c/2}else e=c-1;return this._alignBits(),e},readByte:function(){var a=this._data[this._currentByte];return this._currentByte++,a},readBool:function(){return 0!=this.readByte()},readFloat:function(){var a=this.readByte();switch(a){case CCB_FLOAT0:return 0;case CCB_FLOAT1:return 1;case CCB_FLOAT_MINUS1:return-1;case CCB_FLOAT05:return.5;case CCB_FLOAT_INTEGER:return this.readInt(!0);default:var b=this._decodeFloat(23,8);return b}},_decodeFloat:function(a,b){var c=a+b+1,d=c>>3;this._checkSize(c);var e=Math.pow(2,b-1)-1,f=this._readBitsOnly(a+b,1,d),g=this._readBitsOnly(a,b,d),h=0,i=2,j=0;do for(var k=this._readByteOnly(++j,d),l=a%8||8,m=1<<l;m>>=1;)k&m&&(h+=1/i),i*=2;while(a-=l);return this._currentByte+=d,g==(e<<1)+1?h?0/0:f?-1/0:+1/0:(1+-2*f)*(g||h?g?Math.pow(2,g-e)*(1+h):Math.pow(2,-e+1)*h:0)},_readBitsOnly:function(a,b,c){var d=(a+b)%8,e=a%8,f=c-(a>>3)-1,g=c+(-(a+b)>>3),h=f-g,i=this._readByteOnly(f,c)>>e&(1<<(h?8-e:b))-1;for(h&&d&&(i+=(this._readByteOnly(g++,c)&(1<<d)-1)<<(h--<<3)-e);h;)i+=this._shl(this._readByteOnly(g++,c),(h--<<3)-e);return i},_readByteOnly:function(a,b){return this._data[this._currentByte+b-a-1]},_shl:function(a,b){for(++b;--b;a=1073741824==(1073741824&(a%=2147483648))?2*a:2*(a-1073741824)+2147483647+1);return a},_checkSize:function(a){if(!(this._currentByte+Math.ceil(a/8)<this._data.length))throw new Error("Index out of bound")},readCachedString:function(){return this._stringCache[this.readInt(!1)]},isJSControlled:function(){return this._jsControlled},getOwnerCallbackNames:function(){return this._ownerCallbackNames},getOwnerCallbackNodes:function(){return this._ownerCallbackNodes},getOwnerCallbackControlEvents:function(){return this._ownerCallbackEvents},getOwnerOutletNames:function(){return this._ownerOutletNames},getOwnerOutletNodes:function(){return this._ownerOutletNodes},getNodesWithAnimationManagers:function(){return this._nodesWithAnimationManagers},getAnimationManagersForNodes:function(){return this._animationManagerForNodes},getAnimationManagers:function(){return this._animationManagers},setAnimationManagers:function(a){this._animationManagers=a},addOwnerCallbackName:function(a){this._ownerCallbackNames.push(a)},addOwnerCallbackNode:function(a){this._ownerCallbackNodes.push(a)},addOwnerCallbackControlEvents:function(a){this._ownerCallbackEvents.push(a)},addDocumentCallbackName:function(a){this._animationManager.addDocumentCallbackName(a)},addDocumentCallbackNode:function(a){this._animationManager.addDocumentCallbackNode(a)},addDocumentCallbackControlEvents:function(a){this._animationManager.addDocumentCallbackControlEvents(a)},readFileWithCleanUp:function(a){if(!this._readHeader())return null;if(!this._readStringCache())return null;if(!this._readSequences())return null;var b=this._readNodeGraph();return this._animationManagers.setObject(this._animationManager,b),a&&this._cleanUpNodeGraph(b),b},addOwnerOutletName:function(a){this._ownerOutletNames.push(a)},addOwnerOutletNode:function(a){null!=a&&this._ownerOutletNodes.push(a)},_cleanUpNodeGraph:function(a){a.userObject=null;for(var b=a.getChildren(),c=0,d=b.length;d>c;c++)this._cleanUpNodeGraph(b[c])},_readCallbackKeyframesForSeq:function(a){var b=this.readInt(!1);if(!b)return!0;for(var c=new cc.BuilderSequenceProperty,d=this._jsControlled,e=this._animationManager,f=c.getKeyframes(),g=0;b>g;g++){var h=this.readFloat(),i=this.readCachedString(),j=this.readInt(!1),k=[i,j],l=new cc.BuilderKeyframe;l.setTime(h),l.setValue(k),d&&e.getKeyframeCallbacks().push(j+":"+i),f.push(l)}return a.setCallbackChannel(c),!0},_readSoundKeyframesForSeq:function(a){var b=this.readInt(!1);if(!b)return!0;for(var c=new cc.BuilderSequenceProperty,d=c.getKeyframes(),e=0;b>e;e++){var f=this.readFloat(),g=this.readCachedString(),h=this.readFloat(),i=this.readFloat(),j=this.readFloat(),k=[g,h,i,j],l=new cc.BuilderKeyframe;l.setTime(f),l.setValue(k),d.push(l)}return a.setSoundChannel(c),!0},_readSequences:function(){for(var a=this._animationManager.getSequences(),b=this.readInt(!1),c=0;b>c;c++){var d=new cc.BuilderSequence;if(d.setDuration(this.readFloat()),d.setName(this.readCachedString()),d.setSequenceId(this.readInt(!1)),d.setChainedSequenceId(this.readInt(!0)),!this._readCallbackKeyframesForSeq(d))return!1;if(!this._readSoundKeyframesForSeq(d))return!1;a.push(d)}return this._animationManager.setAutoPlaySequenceId(this.readInt(!0)),!0},readKeyframe:function(a){var b=new cc.BuilderKeyframe;b.setTime(this.readFloat());var c=this.readInt(!1),d=0,e=null;if((c===CCB_KEYFRAME_EASING_CUBIC_IN||c===CCB_KEYFRAME_EASING_CUBIC_OUT||c===CCB_KEYFRAME_EASING_CUBIC_INOUT||c===CCB_KEYFRAME_EASING_ELASTIC_IN||c===CCB_KEYFRAME_EASING_ELASTIC_OUT||c===CCB_KEYFRAME_EASING_ELASTIC_INOUT)&&(d=this.readFloat()),b.setEasingType(c),b.setEasingOpt(d),a==CCB_PROPTYPE_CHECK)e=this.readBool();else if(a==CCB_PROPTYPE_BYTE)e=this.readByte();else if(a==CCB_PROPTYPE_COLOR3){var f=cc.color(this.readByte(),this.readByte(),this.readByte());e=cc.Color3BWapper.create(f)}else if(a==CCB_PROPTYPE_FLOATXY)e=[this.readFloat(),this.readFloat()];else if(a==CCB_PROPTYPE_DEGREES)e=this.readFloat();else if(a==CCB_PROPTYPE_SCALELOCK||a==CCB_PROPTYPE_POSITION||a==CCB_PROPTYPE_FLOATXY)e=[this.readFloat(),this.readFloat()];else if(a==CCB_PROPTYPE_SPRITEFRAME){var g=this.readCachedString(),h=this.readCachedString();if(""==g){h=this._ccbRootPath+h;var i=cc.textureCache.addImage(h),j=i.getContentSize(),k=cc.rect(0,0,j.width,j.height);e=cc.SpriteFrame.create(i,k)}else{g=this._ccbRootPath+g;var l=cc.spriteFrameCache;-1==this._loadedSpriteSheets.indexOf(g)&&(l.addSpriteFrames(g),this._loadedSpriteSheets.push(g)),e=l.getSpriteFrame(h)}}return b.setValue(e),b},_readHeader:function(){if(null==this._data)return!1;var a=this._readStringFromBytes(this._currentByte,4,!0);if(this._currentByte+=4,"ccbi"!=a)return!1;var b=this.readInt(!1);return b!=CCB_VERSION?(cc.log("WARNING! Incompatible ccbi file version (file: "+b+" reader: "+CCB_VERSION+")"),!1):(this._jsControlled=this.readBool(),this._animationManager._jsControlled=this._jsControlled,!0)},_readStringFromBytes:function(a,b,c){c=c||!1;var d,e="",f=this._data,g=this._currentByte;if(c)for(d=b-1;d>=0;d--)e+=String.fromCharCode(f[g+d]);else for(d=0;b>d;d++)e+=String.fromCharCode(f[g+d]);return e},_readStringCache:function(){for(var a=this.readInt(!1),b=0;a>b;b++)this._readStringCacheEntry();return!0},_readStringCacheEntry:function(){for(var a=this.readByte(),b=this.readByte(),c=a<<8|b,d="",e=this._data,f=this._currentByte,g=0;c>g;g++){var h=e[f+g].toString("16").toUpperCase();h=h.length>1?h:"0"+h,d+="%"+h}d=decodeURIComponent(d),this._currentByte+=c,this._stringCache.push(d)},_readNodeGraph:function(a){var b,c=this.readCachedString(),d=this._jsControlled,e=this._animationManager;d&&(b=this.readCachedString());var f,g=this.readInt(!1);g!=CCB_TARGETTYPE_NONE&&(f=this.readCachedString());var h=this._ccNodeLoaderLibrary.getCCNodeLoader(c);h||(h=this._ccNodeLoaderLibrary.getCCNodeLoader("CCNode"));var i=h.loadCCNode(a,this);e.getRootNode()||e.setRootNode(i),d&&i==e.getRootNode()&&e.setDocumentControllerName(b);var j=new cc._Dictionary;this._animatedProps=[];var k,l=this._animatedProps,m=this.readInt(!1);for(k=0;m>k;++k){for(var n=this.readInt(!1),o=new cc._Dictionary,p=this.readInt(!1),q=0;p>q;++q){var r=new cc.BuilderSequenceProperty;r.setName(this.readCachedString()),r.setType(this.readInt(!1)),l.push(r.getName());for(var s=this.readInt(!1),t=r.getKeyframes(),u=0;s>u;++u){var v=this.readKeyframe(r.getType());t.push(v)}o.setObject(r,r.getName())}j.setObject(o,n)}j.count()>0&&e.addNode(i,j),h.parseProperties(i,a,this);var w=i instanceof cc.BuilderFile;if(w){var x=i.getCCBFileNode();x.setPosition(i.getPosition()),x.setRotation(i.getRotation()),x.setScaleX(i.getScaleX()),x.setScaleY(i.getScaleY()),x.setTag(i.getTag()),x.setVisible(!0),e.moveAnimationsFromNode(i,x),i.setCCBFileNode(null),i=x}var y=null,z=null;if(g!=CCB_TARGETTYPE_NONE)if(d)g==CCB_TARGETTYPE_DOCUMENTROOT?(e.addDocumentOutletName(f),e.addDocumentOutletNode(i)):(this._ownerOutletNames.push(f),this._ownerOutletNodes.push(i));else if(g===CCB_TARGETTYPE_DOCUMENTROOT?y=e.getRootNode():g===CCB_TARGETTYPE_OWNER&&(y=this._owner),null!=y){var A=!1;null!=y&&y.onAssignCCBMemberVariable&&(A=y.onAssignCCBMemberVariable(y,f,i)),z=this._ccbMemberVariableAssigner,!A&&null!=z&&z.onAssignCCBMemberVariable&&z.onAssignCCBMemberVariable(y,f,i)}if(h.getCustomProperties().length>0){var B=!1;if(!d&&(y=i,null!=y&&null!=y.onAssignCCBCustomProperty)){var C=h.getCustomProperties(),D=C.allKeys();for(k=0;k<D.length;k++){var E=C.objectForKey(D[k]);B=y.onAssignCCBCustomProperty(y,D[k],E),z=this._ccbMemberVariableAssigner,B||null==z||null==z.onAssignCCBCustomProperty||(B=z.onAssignCCBCustomProperty(y,D[k],E))}}}this._animatedProps=null;var F=this.readInt(!1);for(k=0;F>k;k++){var G=this._readNodeGraph(i);i.addChild(G)}return w||(null!=i&&i.onNodeLoaded?i.onNodeLoaded(i,h):null!=this._ccNodeLoaderListener&&this._ccNodeLoaderListener.onNodeLoaded(i,h)),i},_getBit:function(){var a=0!=(this._data[this._currentByte]&1<<this._currentBit);if(this._currentBit++,this._currentBit>=8&&(this._currentBit=0,this._currentByte++,this._currentByte>this._data.length))throw"out of the data bound";return a},_alignBits:function(){this._currentBit&&(this._currentBit=0,this._currentByte++)},_readUTF8:function(){}}),cc.BuilderReader._ccbResolutionScale=1,cc.BuilderReader.setResolutionScale=function(a){cc.BuilderReader._ccbResolutionScale=a},cc.BuilderReader.getResolutionScale=function(){return cc.BuilderReader._ccbResolutionScale},cc.BuilderReader.loadAsScene=function(a,b,c,d){d=d||cc.BuilderReader.getResourcePath();var e=cc.BuilderReader.load(a,b,c,d),f=cc.Scene.create();return f.addChild(e),f},cc.BuilderReader._controllerClassCache={},cc.BuilderReader.registerController=function(a,b){cc.BuilderReader._controllerClassCache[a]=cc.Class.extend(b)},cc.BuilderReader.load=function(a,b,c,d){d=d||cc.BuilderReader.getResourcePath();var e=new cc.BuilderReader(cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary());e.setCCBRootPath(d),(a.length<5||a.toLowerCase().lastIndexOf(".ccbi")!=a.length-5)&&(a+=".ccbi");var f,g,h,i,j,k,l=e.readNodeGraphFromFile(a,b,c);if(b){var m=e.getOwnerCallbackNames(),n=e.getOwnerCallbackNodes(),o=e.getOwnerCallbackControlEvents();for(f=0;f<m.length;f++)g=m[f],h=n[f],i=o[f],h instanceof cc.ControlButton?h.addTargetWithActionForControlEvents(b,b[g],i):h.setCallback(b[g],b);var p=e.getOwnerOutletNames(),q=e.getOwnerOutletNodes();for(f=0;f<p.length;f++)j=p[f],k=q[f],b[j]=k}var r=e.getNodesWithAnimationManagers(),s=e.getAnimationManagersForNodes();if(!r||!s)return l;var t=cc.BuilderReader._controllerClassCache;for(f=0;f<r.length;f++){var u,v=r[f],w=s[f];v.animationManager=w;var x=w.getDocumentControllerName();if(x){var y=t[x];if(!y)throw"Can not find controller : "+x;var z=new y;z.controllerName=x,v.controller=z,z.rootNode=v;var A=w.getDocumentCallbackNames(),B=w.getDocumentCallbackNodes(),C=w.getDocumentCallbackControlEvents();for(u=0;u<A.length;u++)g=A[u],h=B[u],i=C[u],h instanceof cc.ControlButton?h.addTargetWithActionForControlEvents(z,z[g],i):h.setCallback(z[g],z);var D=w.getDocumentOutletNames(),E=w.getDocumentOutletNodes();for(u=0;u<D.length;u++)j=D[u],k=E[u],z[j]=k;z.onDidLoadFromCCB&&"function"==typeof z.onDidLoadFromCCB&&z.onDidLoadFromCCB();var F=w.getKeyframeCallbacks();for(u=0;u<F.length;u++){var G=F[u].split(":"),H=G[0],I=G[1];1==H?w.setCallFunc(cc.CallFunc.create(z[I],z),F[u]):2==H&&b&&w.setCallFunc(cc.CallFunc.create(b[I],b),F[u])}}}return l},cc.BuilderReader._resourcePath="",cc.BuilderReader.setResourcePath=function(a){cc.BuilderReader._resourcePath=a},cc.BuilderReader.getResourcePath=function(){return cc.BuilderReader._resourcePath},cc.BuilderReader.lastPathComponent=function(a){var b=a.lastIndexOf("/");return-1!=b?a.substring(b+1,a.length-b):a},cc.BuilderReader.deletePathExtension=function(a){var b=a.lastIndexOf(".");return-1!=b?a.substring(0,b):a},cc.BuilderReader.toLowerCase=function(a){return a.toLowerCase()},cc.BuilderReader.endsWith=function(a,b){return a.length>=b.length?0==a.lastIndexOf(b):!1},cc.BuilderReader.concat=function(a,b){return a+b},cc.loader.register(["ccbi"],cc._binaryLoader),cc.INT_VALUE=0,cc.FLOAT_VALUE=1,cc.POINTER_VALUE=2,cc.BOOL_VALUE=3,cc.UNSIGNEDCHAR_VALUE=4,cc.Color3BWapper=cc.Class.extend({_color:null,ctor:function(){this._color=cc.color(0,0,0)},getColor:function(){return this._color}}),cc.Color3BWapper.create=function(a){var b=new cc.Color3BWapper;return b&&(b._color.r=a.r,b._color.g=a.g,b._color.b=a.b),b},cc.BuilderValue=cc.Class.extend({_value:null,_type:0,getIntValue:function(){},getFloatValue:function(){},getBoolValue:function(){},getByteValue:function(){},getPointer:function(){},getValue:function(){return this._value}}),cc.BuilderValue.create=function(a){var b=new cc.BuilderValue;return b},cc.BuilderKeyframe=cc.Class.extend({_value:null,_time:0,_easingType:0,_easingOpt:0,getValue:function(){return this._value},setValue:function(a){this._value=a},getTime:function(){return this._time},setTime:function(a){this._time=a},getEasingType:function(){return this._easingType},setEasingType:function(a){this._easingType=a},getEasingOpt:function(){return this._easingOpt},setEasingOpt:function(a){this._easingOpt=a}}),cc.BuilderSequence=cc.Class.extend({_duration:0,_name:"",_sequenceId:0,_chainedSequenceId:0,_callbackChannel:null,_soundChannel:null,ctor:function(){this._name=""},getDuration:function(){return this._duration},setDuration:function(a){this._duration=a},getName:function(){return this._name},setName:function(a){this._name=a},getSequenceId:function(){return this._sequenceId},setSequenceId:function(a){this._sequenceId=a},getChainedSequenceId:function(){return this._chainedSequenceId},setChainedSequenceId:function(a){this._chainedSequenceId=a},getCallbackChannel:function(){return this._callbackChannel},setCallbackChannel:function(a){this._callbackChannel=a},getSoundChannel:function(){return this._soundChannel},setSoundChannel:function(a){this._soundChannel=a}}),cc.BuilderSequenceProperty=cc.Class.extend({_name:null,_type:0,_keyFrames:null,ctor:function(){this.init()},init:function(){this._keyFrames=[],this._name=""},getName:function(){return this._name},setName:function(a){this._name=a},getType:function(){return this._type},setType:function(a){this._type=a},getKeyframes:function(){return this._keyFrames}}),cc.getAbsolutePosition=function(a,b,c){var d=cc.p(0,0);if(b===CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT)d=a;else if(b===CCB_POSITIONTYPE_RELATIVE_TOP_LEFT)d.x=a.x,d.y=c.height-a.y;else if(b===CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT)d.x=c.width-a.x,d.y=c.height-a.y;else if(b===CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT)d.x=c.width-a.x,d.y=a.y;else if(b===CCB_POSITIONTYPE_PERCENT)d.x=c.width*a.x/100,d.y=c.height*a.y/100;else if(b===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var e=cc.BuilderReader.getResolutionScale();d.x=a.x*e,d.y=a.y*e}return d},cc._getAbsolutePosition=function(a,b,c,d){var e=cc.p(0,0);if(c===CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT)e.x=a,e.y=b;else if(c===CCB_POSITIONTYPE_RELATIVE_TOP_LEFT)e.x=a,e.y=d.height-b;else if(c===CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT)e.x=d.width-a,e.y=d.height-b;else if(c===CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT)e.x=d.width-a,e.y=b;else if(c===CCB_POSITIONTYPE_PERCENT)e.x=d.width*a/100,e.y=d.height*b/100;else if(c===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var f=cc.BuilderReader.getResolutionScale();e.x=a*f,e.y=b*f}return e},cc.setRelativeScale=function(a,b,c,d){if(!a)throw"cc.setRelativeScale(): node should be non-null";if(d===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var e=cc.BuilderReader.getResolutionScale();b*=e,c*=e}a.setScaleX(b),a.setScaleY(c)},cc.BuilderAnimationManagerDelegate=cc.Class.extend({completedAnimationSequenceNamed:function(){}}),cc.BuilderAnimationManager=cc.Class.extend({_sequences:null,_nodeSequences:null,_baseValues:null,_autoPlaySequenceId:0,_rootNode:null,_owner:null,_rootContainerSize:null,_delegate:null,_runningSequence:null,_documentOutletNames:null,_documentOutletNodes:null,_documentCallbackNames:null,_documentCallbackNodes:null,_documentCallbackControlEvents:null,_documentControllerName:"",_lastCompletedSequenceName:"",_keyframeCallbacks:null,_keyframeCallFuncs:null,_animationCompleteCallbackFunc:null,_target:null,_jsControlled:!1,ctor:function(){this._rootContainerSize=cc.size(0,0),this.init()},init:function(){return this._sequences=[],this._nodeSequences=new cc._Dictionary,this._baseValues=new cc._Dictionary,this._documentOutletNames=[],this._documentOutletNodes=[],this._documentCallbackNames=[],this._documentCallbackNodes=[],this._documentCallbackControlEvents=[],this._keyframeCallbacks=[],this._keyframeCallFuncs={},!0},getSequences:function(){return this._sequences},setSequences:function(a){this._sequences=a},getAutoPlaySequenceId:function(){return this._autoPlaySequenceId},setAutoPlaySequenceId:function(a){this._autoPlaySequenceId=a},getRootNode:function(){return this._rootNode},setRootNode:function(a){this._rootNode=a},getOwner:function(){return this._owner},setOwner:function(a){this._owner=a},addDocumentCallbackNode:function(a){this._documentCallbackNodes.push(a)},addDocumentCallbackName:function(a){this._documentCallbackNames.push(a)},addDocumentCallbackControlEvents:function(a){this._documentCallbackControlEvents.push(a)},addDocumentOutletNode:function(a){this._documentOutletNodes.push(a)},addDocumentOutletName:function(a){this._documentOutletNames.push(a)},setDocumentControllerName:function(a){this._documentControllerName=a},getDocumentControllerName:function(){return this._documentControllerName},getDocumentCallbackNames:function(){return this._documentCallbackNames},getDocumentCallbackNodes:function(){return this._documentCallbackNodes},getDocumentCallbackControlEvents:function(){return this._documentCallbackControlEvents},getDocumentOutletNames:function(){return this._documentOutletNames},getDocumentOutletNodes:function(){return this._documentOutletNodes},getLastCompletedSequenceName:function(){return this._lastCompletedSequenceName},getKeyframeCallbacks:function(){return this._keyframeCallbacks},getRootContainerSize:function(){return this._rootContainerSize},setRootContainerSize:function(a){this._rootContainerSize=cc.size(a.width,a.height)},getDelegate:function(){return this._delegate},setDelegate:function(a){this._delegate=a},getRunningSequenceName:function(){return this._runningSequence?this._runningSequence.getName():null},getContainerSize:function(a){return a?a.getContentSize():this._rootContainerSize},addNode:function(a,b){this._nodeSequences.setObject(b,a)},setBaseValue:function(a,b,c){var d=this._baseValues.objectForKey(b);d||(d=new cc._Dictionary,this._baseValues.setObject(d,b)),d.setObject(a,c)},moveAnimationsFromNode:function(a,b){var c=this._baseValues,d=c.objectForKey(a);null!=d&&(c.setObject(d,b),c.removeObjectForKey(a));var e=this._nodeSequences,f=e.objectForKey(a);null!=f&&(e.setObject(f,b),e.removeObjectForKey(a))},getActionForCallbackChannel:function(a){for(var b=0,c=[],d=a.getKeyframes(),e=d.length,f=0;e>f;++f){var g=d[f],h=g.getTime()-b;b=g.getTime(),h>0&&c.push(cc.DelayTime.create(h));var i=g.getValue(),j=i[0],k=i[1];if(this._jsControlled){var l=k+":"+j,m=this._keyframeCallFuncs[l];null!=m&&c.push(m)}else{var n;if(k==CCB_TARGETTYPE_DOCUMENTROOT?n=this._rootNode:k==CCB_TARGETTYPE_OWNER&&(n=this._owner),null!=n)if(j.length>0){var o=0,p=n;null!=n.onResolveCCBCCCallFuncSelector&&(o=p.onResolveCCBCCCallFuncSelector(n,j)),0==o?cc.log("Skipping selector '"+j+"' since no CCBSelectorResolver is present."):c.push(cc.CallFunc.create(o,n))}else cc.log("Unexpected empty selector.")}}return c.length<1?null:cc.Sequence.create(c)},getActionForSoundChannel:function(a){for(var b=0,c=[],d=a.getKeyframes(),e=d.length,f=0;e>f;++f){var g=d[f],h=g.getTime()-b;b=g.getTime(),h>0&&c.push(cc.DelayTime.create(h));var i=g.getValue(),j=cc.BuilderReader.getResourcePath()+i[0],k=parseFloat(i[1]),l=parseFloat(i[2]),m=parseFloat(i[3]);c.push(cc.BuilderSoundEffect.create(j,k,l,m))}return c.length<1?null:cc.Sequence.create(c)},runAnimationsForSequenceNamed:function(a){this.runAnimationsForSequenceIdTweenDuration(this._getSequenceId(a),0)},runAnimationsForSequenceNamedTweenDuration:function(a,b){this.runAnimationsForSequenceIdTweenDuration(this._getSequenceId(a),b)},runAnimationsForSequenceIdTweenDuration:function(a,b){if(-1===a)throw"cc.BuilderAnimationManager.runAnimationsForSequenceIdTweenDuration(): Sequence id should not be -1";b=b||0,this._rootNode.stopAllActions();for(var c=this._nodeSequences.allKeys(),d=0,e=c.length;e>d;d++){var f=c[d];f.stopAllActions();var g,h=this._nodeSequences.objectForKey(f),i=h.objectForKey(a),j=[];if(i){var k=i.allKeys();for(g=0;g<k.length;g++){var l=k[g],m=i.objectForKey(l);j.push(l),this._setFirstFrame(f,m,b),this._runAction(f,m,b)}}var n=this._baseValues.objectForKey(f);if(n){var o=n.allKeys();for(g=0;g<o.length;g++){var p=o[g];if(-1==j.indexOf(p)){var q=n.objectForKey(p);null!=q&&this._setAnimatedProperty(p,f,q,b)}}}}var r=this._getSequence(a),s=cc.Sequence.create(cc.DelayTime.create(r.getDuration()+b),cc.CallFunc.create(this._sequenceCompleted,this));this._rootNode.runAction(s);var t;r.getCallbackChannel()&&(t=this.getActionForCallbackChannel(r.getCallbackChannel()),t&&this._rootNode.runAction(t)),r.getSoundChannel()&&(t=this.getActionForSoundChannel(r.getSoundChannel()),t&&this._rootNode.runAction(t)),this._runningSequence=this._getSequence(a)},runAnimations:function(a,b){b=b||0;var c;c="string"==typeof a?this._getSequenceId(a):a,this.runAnimationsForSequenceIdTweenDuration(c,b)},setAnimationCompletedCallback:function(a,b){this._target=a,this._animationCompleteCallbackFunc=b},setCompletedAnimationCallback:function(a,b){this.setAnimationCompletedCallback(a,b)},setCallFunc:function(a,b){this._keyframeCallFuncs[b]=a},debug:function(){},_getBaseValue:function(a,b){var c=this._baseValues.objectForKey(a);return c?c.objectForKey(b):null},_getSequenceId:function(a){for(var b=null,c=this._sequences,d=0,e=c.length;e>d;d++)if(b=c[d],b&&b.getName()===a)return b.getSequenceId();return-1},_getSequence:function(a){for(var b=null,c=this._sequences,d=0,e=c.length;e>d;d++)if(b=c[d],b&&b.getSequenceId()===a)return b;return null},_getAction:function(a,b,c,d){var e,f,g,h,i,j=b.getTime()-(a?a.getTime():0);if("rotation"===c)return cc.BuilderRotateTo.create(j,b.getValue());if("rotationX"===c)return cc.BuilderRotateXTo.create(j,b.getValue());if("rotationY"===c)return cc.BuilderRotateYTo.create(j,b.getValue());if("opacity"===c)return cc.FadeTo.create(j,b.getValue());if("color"===c){var k=b.getValue().getColor();return cc.TintTo.create(j,k.r,k.g,k.b)}if("visible"===c){var l=b.getValue();return l?cc.Sequence.create(cc.DelayTime.create(j),cc.Show.create()):cc.Sequence.create(cc.DelayTime.create(j),cc.Hide.create())}if("displayFrame"===c)return cc.Sequence.create(cc.DelayTime.create(j),cc.BuilderSetSpriteFrame.create(b.getValue()));if("position"===c){e=this._getBaseValue(d,c),f=e[2],g=b.getValue(),h=g[0],i=g[1];var m=this.getContainerSize(d.getParent()),n=cc._getAbsolutePosition(h,i,f,m,c);return cc.MoveTo.create(j,n)
}if("scale"===c){if(e=this._getBaseValue(d,c),f=e[2],g=b.getValue(),h=g[0],i=g[1],f===CCB_SCALETYPE_MULTIPLY_RESOLUTION){var o=cc.BuilderReader.getResolutionScale();h*=o,i*=o}return cc.ScaleTo.create(j,h,i)}return"skew"===c?(g=b.getValue(),h=g[0],i=g[1],cc.SkewTo.create(j,h,i)):(cc.log("BuilderReader: Failed to create animation for property: "+c),null)},_setAnimatedProperty:function(a,b,c,d){if(d>0){var e=new cc.BuilderKeyframe;e.setValue(c),e.setTime(d),e.setEasingType(CCB_KEYFRAME_EASING_LINEAR);var f=this._getAction(null,e,a,b);b.runAction(f)}else{var g,h,i,j;if("position"===a)g=this._getBaseValue(b,a),h=g[2],i=c[0],j=c[1],b.setPosition(cc._getAbsolutePosition(i,j,h,this.getContainerSize(b.getParent()),a));else if("scale"===a)g=this._getBaseValue(b,a),h=g[2],i=c[0],j=c[1],cc.setRelativeScale(b,i,j,h,a);else if("skew"===a)i=c[0],j=c[1],b.setSkewX(i),b.setSkewY(j);else if("rotation"===a)b.setRotation(c);else if("rotationX"==a)b.setRotationSkewX(c);else if("rotationY"==a)b.setRotationSkewY(c);else if("opacity"===a)b.setOpacity(c);else if("displayFrame"===a)b.setSpriteFrame(c);else if("color"===a){var k=c.getColor();(255!==k.r||255!==k.g||255!==k.b)&&b.setColor(k)}else"visible"===a?(c=c||!1,b.setVisible(c)):cc.log("unsupported property name is "+a)}},_setFirstFrame:function(a,b,c){var d=b.getKeyframes();if(0===d.length){var e=this._getBaseValue(a,b.getName());e||cc.log("cc.BuilderAnimationManager._setFirstFrame(): No baseValue found for property"),this._setAnimatedProperty(b.getName(),a,e,c)}else{var f=d[0];this._setAnimatedProperty(b.getName(),a,f.getValue(),c)}},_getEaseAction:function(a,b,c){return b===CCB_KEYFRAME_EASING_LINEAR||b===CCB_KEYFRAME_EASING_INSTANT?a:b===CCB_KEYFRAME_EASING_CUBIC_IN?cc.EaseIn.create(a,c):b===CCB_KEYFRAME_EASING_CUBIC_OUT?cc.EaseOut.create(a,c):b===CCB_KEYFRAME_EASING_CUBIC_INOUT?cc.EaseInOut.create(a,c):b===CCB_KEYFRAME_EASING_BACK_IN?cc.EaseBackIn.create(a):b===CCB_KEYFRAME_EASING_BACK_OUT?cc.EaseBackOut.create(a):b===CCB_KEYFRAME_EASING_BACK_INOUT?cc.EaseBackInOut.create(a):b===CCB_KEYFRAME_EASING_BOUNCE_IN?cc.EaseBounceIn.create(a):b===CCB_KEYFRAME_EASING_BOUNCE_OUT?cc.EaseBounceOut.create(a):b===CCB_KEYFRAME_EASING_BOUNCE_INOUT?cc.EaseBounceInOut.create(a):b===CCB_KEYFRAME_EASING_ELASTIC_IN?cc.EaseElasticIn.create(a,c):b===CCB_KEYFRAME_EASING_ELASTIC_OUT?cc.EaseElasticOut.create(a,c):b===CCB_KEYFRAME_EASING_ELASTIC_INOUT?cc.EaseElasticInOut.create(a,c):(cc.log("BuilderReader: Unkown easing type "+b),a)},_runAction:function(a,b,c){var d=b.getKeyframes(),e=d.length;if(e>1){var f=[],g=d[0],h=g.getTime()+c;h>0&&f.push(cc.DelayTime.create(h));for(var i=0;e-1>i;++i){var j=d[i],k=d[i+1],l=this._getAction(j,k,b.getName(),a);l&&(l=this._getEaseAction(l,j.getEasingType(),j.getEasingOpt()),f.push(l))}var m=cc.Sequence.create(f);a.runAction(m)}},_sequenceCompleted:function(){var a=this._runningSequence,b=a.getName();this._lastCompletedSequenceName!=a.getName()&&(this._lastCompletedSequenceName=a.getName());var c=a.getChainedSequenceId();this._runningSequence=null,-1!=c&&this.runAnimations(c,0),this._delegate&&this._delegate.completedAnimationSequenceNamed(b),this._target&&this._animationCompleteCallbackFunc&&this._animationCompleteCallbackFunc.call(this._target)}}),cc.BuilderSetSpriteFrame=cc.ActionInstant.extend({_spriteFrame:null,initWithSpriteFrame:function(a){return this._spriteFrame=a,!0},update:function(){this.target.setSpriteFrame(this._spriteFrame)}}),cc.BuilderSetSpriteFrame.create=function(a){var b=new cc.BuilderSetSpriteFrame;return b&&b.initWithSpriteFrame(a)?b:null},cc.BuilderRotateTo=cc.ActionInterval.extend({_startAngle:0,_dstAngle:0,_diffAngle:0,initWithDuration:function(a,b){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._dstAngle=b,!0):!1},update:function(a){this.target.setRotation(this._startAngle+this._diffAngle*a)},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a),this._startAngle=this.target.getRotation(),this._diffAngle=this._dstAngle-this._startAngle}}),cc.BuilderRotateTo.create=function(a,b){var c=new cc.BuilderRotateTo;return c&&c.initWithDuration(a,b)?c:null},cc.BuilderRotateXTo=cc.ActionInterval.extend({}),cc.BuilderRotateXTo.create=function(){throw"rotationX has not been implemented in cocos2d-html5"},cc.BuilderRotateYTo=cc.ActionInterval.extend({}),cc.BuilderRotateYTo.create=function(){throw"rotationY has not been implemented in cocos2d-html5"},cc.BuilderSoundEffect=cc.ActionInstant.extend({init:function(a){return this._file=a,!0},update:function(){cc.audioEngine.playEffect(this._file)}}),cc.BuilderSoundEffect.create=function(a){var b=new cc.BuilderSoundEffect;return b&&b.init(a)?b:null};