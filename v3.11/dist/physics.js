!function(){var a={_ignoreBodyRotation:!1,_body:null,_rotation:1,ctor:function(a,b){if(cc.Sprite.prototype.ctor.call(this),void 0===a)cc.PhysicsSprite.prototype.init.call(this);else if(cc.isString(a))if("#"===a[0]){var c=a.substr(1,a.length-1),d=cc.spriteFrameCache.getSpriteFrame(c);this.initWithSpriteFrame(d)}else this.init(a,b);else cc.isObject(a)&&(a instanceof cc.Texture2D?this.initWithTexture(a,b):a instanceof cc.SpriteFrame&&this.initWithSpriteFrame(a));cc.renderer.pushRenderCommand(this._renderCmd)},visit:function(){cc.renderer.pushRenderCommand(this._renderCmd),cc.Sprite.prototype.visit.call(this)},setBody:function(a){this._body=a},getBody:function(){return this._body},getPosition:function(){var a=this._body;return{x:a.p.x,y:a.p.y}},getPositionX:function(){return this._body.p.x},getPositionY:function(){return this._body.p.y},setPosition:function(a,b){void 0===b?(this._body.p.x=a.x,this._body.p.y=a.y):(this._body.p.x=a,this._body.p.y=b)},setPositionX:function(a){this._body.p.x=a},setPositionY:function(a){this._body.p.y=a},_syncPosition:function(){var a=this._position,b=this._body;a.x===b.p.x&&a.y===b.p.y||cc.Sprite.prototype.setPosition.call(this,b.p.x,b.p.y)},getRotation:function(){return this._ignoreBodyRotation?this._rotationX:-cc.radiansToDegrees(this._body.a)},setRotation:function(a){this._ignoreBodyRotation?cc.Sprite.prototype.setRotation.call(this,a):this._body.a=-cc.degreesToRadians(a)},_syncRotation:function(){this._rotationX!==-cc.radiansToDegrees(this._body.a)&&cc.Sprite.prototype.setRotation.call(this,-cc.radiansToDegrees(this._body.a))},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform()},isDirty:function(){return!this._body.isSleeping()},setDirty:function(){},setIgnoreBodyRotation:function(a){this._ignoreBodyRotation=a},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.PhysicsSprite.CanvasRenderCmd(this):new cc.PhysicsSprite.WebGLRenderCmd(this)}};cc.PhysicsSprite=cc.Sprite.extend(a),cc.PhysicsSprite._className="PhysicsSprite";var b=cc.PhysicsSprite.prototype;b.body,cc.defineGetterSetter(b,"body",b.getBody,b.setBody),b.dirty,cc.defineGetterSetter(b,"dirty",b.isDirty,b.setDirty),cc.PhysicsSprite.create=function(a,b){return new cc.PhysicsSprite(a,b)},cc.PhysicsSprite.createWithSpriteFrameName=cc.PhysicsSprite.create,cc.PhysicsSprite.createWithSpriteFrame=cc.PhysicsSprite.create}(),function(){cc.PhysicsSprite.CanvasRenderCmd=function(a){cc.Sprite.CanvasRenderCmd.call(this,a),this._needDraw=!0};var a=cc.PhysicsSprite.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);a.constructor=cc.PhysicsSprite.CanvasRenderCmd,a.rendering=function(a,b,c){var d=this._node;d._syncPosition(),d._ignoreBodyRotation||d._syncRotation(),this.transform(this.getParentRenderCmd()),cc.Sprite.CanvasRenderCmd.prototype.rendering.call(this,a,b,c)},a.getNodeToParentTransform=function(){var a=this._node,b=this._transform,c=a._body,d=a._scaleX,e=a._scaleY,f=this._anchorPointInPoints;b.tx=c.p.x,b.ty=c.p.y;var g=-c.a,h=1,i=0;return g&&!a._ignoreBodyRotation&&(h=Math.cos(g),i=Math.sin(g)),b.a=b.d=h,b.b=-i,b.c=i,1===d&&1===e||(b.a*=d,b.c*=d,b.b*=e,b.d*=e),b.tx+=h*-f.x*d+-i*f.y*e,b.ty-=i*-f.x*d+h*f.y*e,this._ignoreAnchorPointForPosition&&(b.tx+=f.x,b.ty+=f.y),this._transform}}(),cc.__convertVerts=function(a){for(var b=[],c=0;c<a.length/2;c++)b[c]={x:a[2*c],y:a[2*c+1]};return b},cc.ColorForBody=function(a){return a.isRogue()||a.isSleeping()?cc.color(128,128,128,128):a.nodeIdleTime>a.space.sleepTimeThreshold?cc.color(84,84,84,128):cc.color(255,0,0,128)},cc.DrawShape=function(a,b){var c=a.body,d=cc.ColorForBody(c);switch(a.collisionCode){case cp.CircleShape.prototype.collisionCode:this.drawDot(a.tc,Math.max(a.r,1),d),this.drawSegment(a.tc,cp.v.add(a.tc,cp.v.mult(c.rot,a.r)),1,d);break;case cp.SegmentShape.prototype.collisionCode:this.drawSegment(a.ta,a.tb,Math.max(a.r,2),d);break;case cp.PolyShape.prototype.collisionCode:var e=cc.color(d.r,d.g,d.b,cc.lerp(d.a,255,.5));this.drawPoly(cc.__convertVerts(a.tVerts),d,1,e);break;default:cc.log("cc.DrawShape(): Bad assertion in DrawShape()")}},cc.DrawConstraint=function(a,b){var c,d,e=a.a,f=a.b;if(a instanceof cp.PinJoint)c=e.local2World(a.anchr1),d=f.local2World(a.anchr2),this.drawDot(c,3,cc.CONSTRAINT_COLOR),this.drawDot(d,3,cc.CONSTRAINT_COLOR),this.drawSegment(c,d,1,cc.CONSTRAINT_COLOR);else if(a instanceof cp.SlideJoint)c=e.local2World(a.anchr1),d=f.local2World(a.anchr2),this.drawDot(c,3,cc.CONSTRAINT_COLOR),this.drawDot(d,3,cc.CONSTRAINT_COLOR),this.drawSegment(c,d,1,cc.CONSTRAINT_COLOR);else if(a instanceof cp.PivotJoint)c=e.local2World(a.anchr1),d=f.local2World(a.anchr2),this.drawDot(c,3,cc.CONSTRAINT_COLOR),this.drawDot(d,3,cc.CONSTRAINT_COLOR);else if(a instanceof cp.GrooveJoint){c=e.local2World(a.grv_a),d=e.local2World(a.grv_b);var g=f.local2World(a.anchr2);this.drawDot(g,3,cc.CONSTRAINT_COLOR),this.drawSegment(c,d,1,cc.CONSTRAINT_COLOR)}else a instanceof cp.DampedSpring},cc.CONSTRAINT_COLOR=cc.color(0,255,0,128),cc.PhysicsDebugNode=cc.DrawNode.extend({_space:null,_className:"PhysicsDebugNode",ctor:function(a){cc.DrawNode.prototype.ctor.call(this),this._space=a},getSpace:function(){return this._space},setSpace:function(a){this._space=a},draw:function(a){this._space&&(this._space.eachShape(cc.DrawShape.bind(this)),this._space.eachConstraint(cc.DrawConstraint.bind(this)),cc.DrawNode.prototype.draw.call(this),this.clear())},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.PhysicsDebugNode.CanvasRenderCmd(this):new cc.PhysicsDebugNode.WebGLRenderCmd(this)}}),cc.PhysicsDebugNode.create=function(a){return new cc.PhysicsDebugNode(a)},function(){cc.PhysicsDebugNode.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a),this._buffer=a._buffer,this._needDraw=!0};var a=cc.PhysicsDebugNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=cc.PhysicsDebugNode.CanvasRenderCmd,a.rendering=function(a,b,c){var d=this._node;d._space&&(d._space.eachShape(cc.DrawShape.bind(d)),d._space.eachConstraint(cc.DrawConstraint.bind(d)),cc.DrawNode.CanvasRenderCmd.prototype.rendering.call(this,a,b,c),d.clear())},a._drawDot=cc.DrawNode.CanvasRenderCmd.prototype._drawDot,a._drawSegment=cc.DrawNode.CanvasRenderCmd.prototype._drawSegment,a._drawPoly=cc.DrawNode.CanvasRenderCmd.prototype._drawPoly}();