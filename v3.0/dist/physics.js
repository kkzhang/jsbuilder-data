!function(){var a={_ignoreBodyRotation:!1,_body:null,_rotation:1,ctor:function(a,b){if(cc.Sprite.prototype.ctor.call(this),void 0===a)cc.PhysicsSprite.prototype.init.call(this);else if(cc.isString(a))if("#"===a[0]){var c=a.substr(1,a.length-1),d=cc.spriteFrameCache.getSpriteFrame(c);this.initWithSpriteFrame(d)}else this.init(a,b);else cc.isObject(a)&&(a instanceof cc.Texture2D?this.initWithTexture(a,b):a instanceof cc.SpriteFrame&&this.initWithSpriteFrame(a))},setBody:function(a){this._body=a},getBody:function(){return this._body},getPosition:function(){var a=this._body;return{x:a.p.x,y:a.p.y}},getPositionX:function(){return this._body.p.x},getPositionY:function(){return this._body.p.y},setPosition:function(a,b){void 0===b?(this._body.p.x=a.x,this._body.p.y=a.y):(this._body.p.x=a,this._body.p.y=b)},setPositionX:function(a){this._body.p.x=a},setPositionY:function(a){this._body.p.y=a},_syncPosition:function(){var a=this._position,b=this._body;(a.x!=b.p.x||a.y!=b.p.y)&&cc.Sprite.prototype.setPosition.call(this,b.p.x,b.p.y)},getRotation:function(){return this._ignoreBodyRotation?cc.radiansToDegrees(this._rotationRadiansX):-cc.radiansToDegrees(this._body.a)},setRotation:function(a){this._ignoreBodyRotation?cc.Sprite.prototype.setRotation.call(this,a):this._body.a=-cc.degreesToRadians(a)},_syncRotation:function(){this._rotationRadiansX!=-this._body.a&&cc.Sprite.prototype.setRotation.call(this,-cc.radiansToDegrees(this._body.a))},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(){if(cc._renderType===cc._RENDER_TYPE_CANVAS)return this._nodeToParentTransformForCanvas();var a=this._body,b=this._anchorPointInPoints,c=this._scaleX,d=this._scaleY,e=a.p.x,f=a.p.y;this._ignoreAnchorPointForPosition&&(e+=b.x,f+=b.y);var g=a.a,h=Math.cos(g),i=Math.sin(g);return cc._rectEqualToZero(b)||(e+=h*-b.x*c+-i*-b.y*d,f+=i*-b.x*c+h*-b.y*d),this._transform=cc.affineTransformMake(h*c,i*c,-i*d,h*d,e,f),this._transform},_nodeToParentTransformForCanvas:function(){if(this.dirty){var a=this._transform,b=this._body,c=this._scaleX,d=this._scaleY,e=this._anchorPointInPoints;a.tx=b.p.x,a.ty=b.p.y;var f=-b.a,g=1,h=0;f&&(g=Math.cos(f),h=Math.sin(f)),a.a=a.d=g,a.b=-h,a.c=h,(1!==c||1!==d)&&(a.a*=c,a.c*=c,a.b*=d,a.d*=d),a.tx+=g*-e.x*c+-h*e.y*d,a.ty-=h*-e.x*c+g*e.y*d,this._ignoreAnchorPointForPosition&&(a.tx+=e.x,a.ty+=e.y),this._transformDirty=!1}return this._transform},isDirty:function(){return!this._body.isSleeping()},setDirty:function(){},setIgnoreBodyRotation:function(a){this._ignoreBodyRotation=a}};cc.PhysicsSprite=cc.Sprite.extend(a),cc.PhysicsSprite._className="PhysicsSprite";var b=cc.PhysicsSprite.prototype;b.body,cc.defineGetterSetter(b,"body",b.getBody,b.setBody),b.dirty,cc.defineGetterSetter(b,"dirty",b.isDirty,b.setDirty),cc.PhysicsSprite.create=function(a,b){return new cc.PhysicsSprite(a,b)},cc.PhysicsSprite.createWithSpriteFrameName=cc.PhysicsSprite.create,cc.PhysicsSprite.createWithSpriteFrame=cc.PhysicsSprite.create}(),cc.__convertVerts=function(a){for(var b=[],c=0;c<a.length/2;c++)b[c]={x:a[2*c],y:a[2*c+1]};return b},cc.ColorForBody=function(a){return a.isRogue()||a.isSleeping()?cc.color(128,128,128,128):a.nodeIdleTime>a.space.sleepTimeThreshold?cc.color(84,84,84,128):cc.color(255,0,0,128)},cc.DrawShape=function(a){var b=a.body,c=cc.ColorForBody(b);switch(a.collisionCode){case cp.CircleShape.prototype.collisionCode:this.drawDot(a.tc,Math.max(a.r,1),c),this.drawSegment(a.tc,cp.v.add(a.tc,cp.v.mult(b.rot,a.r)),1,c);break;case cp.SegmentShape.prototype.collisionCode:this.drawSegment(a.ta,a.tb,Math.max(a.r,2),c);break;case cp.PolyShape.prototype.collisionCode:var d=cc.color(c.r,c.g,c.b,cc.lerp(c.a,255,.5));this.drawPoly(cc.__convertVerts(a.tVerts),c,1,d);break;default:cc.log("cc.DrawShape(): Bad assertion in DrawShape()")}},cc.DrawConstraint=function(a){var b,c,d=a.a,e=a.b;if(a instanceof cp.PinJoint)b=d.local2World(a.anchr1),c=e.local2World(a.anchr2),this.drawDot(b,3,cc.CONSTRAINT_COLOR),this.drawDot(c,3,cc.CONSTRAINT_COLOR),this.drawSegment(b,c,1,cc.CONSTRAINT_COLOR);else if(a instanceof cp.SlideJoint)b=d.local2World(a.anchr1),c=e.local2World(a.anchr2),this.drawDot(b,3,cc.CONSTRAINT_COLOR),this.drawDot(c,3,cc.CONSTRAINT_COLOR),this.drawSegment(b,c,1,cc.CONSTRAINT_COLOR);else if(a instanceof cp.PivotJoint)b=d.local2World(a.anchr1),c=e.local2World(a.anchr2),this.drawDot(b,3,cc.CONSTRAINT_COLOR),this.drawDot(c,3,cc.CONSTRAINT_COLOR);else if(a instanceof cp.GrooveJoint){b=d.local2World(a.grv_a),c=d.local2World(a.grv_b);var f=e.local2World(a.anchr2);this.drawDot(f,3,cc.CONSTRAINT_COLOR),this.drawSegment(b,c,1,cc.CONSTRAINT_COLOR)}else a instanceof cp.DampedSpring},cc.CONSTRAINT_COLOR=cc.color(0,255,0,128),cc.PhysicsDebugNode=cc.DrawNode.extend({_space:null,_className:"PhysicsDebugNode",ctor:function(a){cc.DrawNode.prototype.ctor.call(this),this._space=a},getSpace:function(){return this._space},setSpace:function(a){this._space=a},draw:function(){this._space&&(this._space.eachShape(cc.DrawShape.bind(this)),this._space.eachConstraint(cc.DrawConstraint.bind(this)),cc.DrawNode.prototype.draw.call(this),this.clear())}}),cc.PhysicsDebugNode.create=function(a){return new cc.PhysicsDebugNode(a)};