cc.Component=cc.Class.extend({_owner:null,_name:"",_enabled:!0,ctor:function(){this._owner=null,this._name="",this._enabled=!0},init:function(){return!0},onEnter:function(){},onExit:function(){},update:function(){},serialize:function(){},isEnabled:function(){return this._enabled},setEnabled:function(a){this._enabled=a},getName:function(){return this._name},setName:function(a){this._name=a},setOwner:function(a){this._owner=a},getOwner:function(){return this._owner}}),cc.Component.create=function(){return new cc.Component},cc.ComponentContainer=cc.Class.extend({_components:null,_owner:null,ctor:function(a){this._components=null,this._owner=a},getComponent:function(a){if(!a)throw"cc.ComponentContainer.getComponent(): name should be non-null";return a=a.trim(),this._components[a]},add:function(a){if(!a)throw"cc.ComponentContainer.add(): component should be non-null";if(a.getOwner())return cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1;null==this._components&&(this._components={},this._owner.scheduleUpdate());var b=this._components[a.getName()];return b?(cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1):(a.setOwner(this._owner),this._components[a.getName()]=a,a.onEnter(),!0)},remove:function(a){if(!a)throw"cc.ComponentContainer.remove(): name should be non-null";return this._components?a instanceof cc.Component?this._removeByComponent(a):(a=a.trim(),this._removeByComponent(this._components[a])):!1},_removeByComponent:function(a){return a?(a.onExit(),a.setOwner(null),delete this._components[a.getName()],!0):!1},removeAll:function(){if(this._components){var a=this._components;for(var b in a){var c=a[b];c.onExit(),c.setOwner(null),delete a[b]}this._owner.unscheduleUpdate(),this._components=null}},_alloc:function(){this._components={}},visit:function(a){if(this._components){var b=this._components;for(var c in b)b[c].update(a)}},isEmpty:function(){return this._components?0==this._components.length:!0}});var ccs=ccs||{};ccs.Class=ccs.Class||cc.Class,ccs.Class.extend=ccs.Class.extend||cc.Class.extend,ccs.Node=ccs.Node||cc.Node,ccs.Node.extend=ccs.Node.extend||cc.Node.extend,ccs.Sprite=ccs.Sprite||cc.Sprite,ccs.Sprite.extend=ccs.Sprite.extend||cc.Sprite.extend,ccs.Component=ccs.Component||cc.Component,ccs.Component.extend=ccs.Component.extend||cc.Component.extend,ccs.cocostudioVersion="v1.3.0.0",ccs.VERSION_COMBINED=.3,ccs.VERSION_CHANGE_ROTATION_RANGE=1,ccs.VERSION_COLOR_READING=1.1,ccs.MAX_VERTEXZ_VALUE=5e6,ccs.ARMATURE_MAX_CHILD=50,ccs.ARMATURE_MAX_ZORDER=100,ccs.ARMATURE_MAX_COUNT=ccs.MAX_VERTEXZ_VALUE/ccs.ARMATURE_MAX_CHILD/ccs.ARMATURE_MAX_ZORDER,ccs.AUTO_ADD_SPRITE_FRAME_NAME_PREFIX=!1,ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT=!1,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX=!1,ccs.armatureVersion=function(){return"v1.1.0.0"},ccs.CONST_VERSION="version",ccs.CONST_VERSION_2_0=2,ccs.CONST_VERSION_COMBINED=.3,ccs.CONST_ARMATURES="armatures",ccs.CONST_ARMATURE="armature",ccs.CONST_BONE="b",ccs.CONST_DISPLAY="d",ccs.CONST_ANIMATIONS="animations",ccs.CONST_ANIMATION="animation",ccs.CONST_MOVEMENT="mov",ccs.CONST_FRAME="f",ccs.CONST_TEXTURE_ATLAS="TextureAtlas",ccs.CONST_SUB_TEXTURE="SubTexture",ccs.CONST_SKELETON="skeleton",ccs.CONST_A_NAME="name",ccs.CONST_A_DURATION="dr",ccs.CONST_A_FRAME_INDEX="fi",ccs.CONST_A_DURATION_TO="to",ccs.CONST_A_DURATION_TWEEN="drTW",ccs.CONST_A_LOOP="lp",ccs.CONST_A_MOVEMENT_SCALE="sc",ccs.CONST_A_MOVEMENT_DELAY="dl",ccs.CONST_A_DISPLAY_INDEX="dI",ccs.CONST_A_PLIST="plist",ccs.CONST_A_PARENT="parent",ccs.CONST_A_SKEW_X="kX",ccs.CONST_A_SKEW_Y="kY",ccs.CONST_A_SCALE_X="cX",ccs.CONST_A_SCALE_Y="cY",ccs.CONST_A_Z="z",ccs.CONST_A_EVENT="evt",ccs.CONST_A_SOUND="sd",ccs.CONST_A_SOUND_EFFECT="sdE",ccs.CONST_A_TWEEN_EASING="twE",ccs.CONST_A_EASING_PARAM="twEP",ccs.CONST_A_TWEEN_ROTATE="twR",ccs.CONST_A_IS_ARMATURE="isArmature",ccs.CONST_A_DISPLAY_TYPE="displayType",ccs.CONST_A_MOVEMENT="mov",ccs.CONST_A_X="x",ccs.CONST_A_Y="y",ccs.CONST_A_COCOS2DX_X="cocos2d_x",ccs.CONST_A_COCOS2DX_Y="cocos2d_y",ccs.CONST_A_WIDTH="width",ccs.CONST_A_HEIGHT="height",ccs.CONST_A_PIVOT_X="pX",ccs.CONST_A_PIVOT_Y="pY",ccs.CONST_A_COCOS2D_PIVOT_X="cocos2d_pX",ccs.CONST_A_COCOS2D_PIVOT_Y="cocos2d_pY",ccs.CONST_A_BLEND_TYPE="bd",ccs.CONST_A_BLEND_SRC="bd_src",ccs.CONST_A_BLEND_DST="bd_dst",ccs.CONST_A_ALPHA="a",ccs.CONST_A_RED="r",ccs.CONST_A_GREEN="g",ccs.CONST_A_BLUE="b",ccs.CONST_A_ALPHA_OFFSET="aM",ccs.CONST_A_RED_OFFSET="rM",ccs.CONST_A_GREEN_OFFSET="gM",ccs.CONST_A_BLUE_OFFSET="bM",ccs.CONST_A_COLOR_TRANSFORM="colorTransform",ccs.CONST_A_TWEEN_FRAME="tweenFrame",ccs.CONST_CONTOUR="con",ccs.CONST_CONTOUR_VERTEX="con_vt",ccs.CONST_FL_NAN="NaN",ccs.CONST_FRAME_DATA="frame_data",ccs.CONST_MOVEMENT_BONE_DATA="mov_bone_data",ccs.CONST_MOVEMENT_DATA="mov_data",ccs.CONST_ANIMATION_DATA="animation_data",ccs.CONST_DISPLAY_DATA="display_data",ccs.CONST_SKIN_DATA="skin_data",ccs.CONST_BONE_DATA="bone_data",ccs.CONST_ARMATURE_DATA="armature_data",ccs.CONST_CONTOUR_DATA="contour_data",ccs.CONST_TEXTURE_DATA="texture_data",ccs.CONST_VERTEX_POINT="vertex",ccs.CONST_COLOR_INFO="color",ccs.CONST_CONFIG_FILE_PATH="config_file_path",ccs.CONST_CONTENT_SCALE="content_scale",ccs.DataInfo=function(){this.asyncStruct=null,this.configFileQueue=[],this.contentScale=1,this.filename="",this.baseFilePath="",this.flashToolVersion=0,this.cocoStudioVersion=0},ccs.dataReaderHelper={ConfigType:{DragonBone_XML:0,CocoStudio_JSON:1,CocoStudio_Binary:2},_configFileList:[],_flashToolVersion:ccs.CONST_VERSION_2_0,_positionReadScale:1,_asyncRefCount:0,_asyncRefTotalCount:0,_dataQueue:null,setPositionReadScale:function(a){this._positionReadScale=a},getPositionReadScale:function(){return this._positionReadScale},addDataFromFile:function(a){if(-1==this._configFileList.indexOf(a)){this._configFileList.push(a);var b=this._initBaseFilePath(a),c=cc.path.extname(a).toLowerCase(),d=new ccs.DataInfo;d.filename=a,d.basefilePath=b,".xml"==c?ccs.dataReaderHelper.addDataFromXML(a,d):".json"==c||".exportjson"==c?ccs.dataReaderHelper.addDataFromJson(a,d):".csb"==c&&ccs.dataReaderHelper.addDataFromBinaryCache(a,d)}},addDataFromFileAsync:function(a,b,c,d,e){if(-1!=this._configFileList.indexOf(c))return void(e&&d&&(0==this._asyncRefTotalCount&&0==this._asyncRefCount?this._asyncCallBack(d,e,1):this._asyncCallBack(d,e,(this._asyncRefTotalCount-this._asyncRefCount)/this._asyncRefTotalCount)));this._asyncRefTotalCount++,this._asyncRefCount++;var f=this,g=function(){f.addDataFromFile(c),f._asyncRefCount--,f._asyncCallBack(d,e,(f._asyncRefTotalCount-f._asyncRefCount)/f._asyncRefTotalCount)};cc.director.getScheduler().scheduleCallbackForTarget(this,g,.1,!1)},removeConfigFile:function(a){for(var b=this._configFileList,c=b.length,d=b[c],e=0;c>e;e++)b[e]==a&&(d=e);d!=b[c]&&cc.arrayRemoveObject(b,a)},addDataFromCache:function(a,b){if(!a)return void cc.log("XML error  or  XML is empty.");b.flashToolVersion=parseFloat(a.getAttribute(ccs.CONST_VERSION));var c,d=a.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ARMATURES+" >  "+ccs.CONST_ARMATURE),e=ccs.armatureDataManager;for(c=0;c<d.length;c++){var f=this.decodeArmature(d[c],b);e.addArmatureData(f.name,f,b.filename)}var g=a.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ANIMATIONS+" >  "+ccs.CONST_ANIMATION);for(c=0;c<g.length;c++){var h=this.decodeAnimation(g[c],b);e.addAnimationData(h.name,h,b.filename)}var i=a.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_TEXTURE_ATLAS+" >  "+ccs.CONST_SUB_TEXTURE);for(c=0;c<i.length;c++){var j=this.decodeTexture(i[c],b);e.addTextureData(j.name,j,b.filename)}},decodeArmature:function(a,b){var c=new ccs.ArmatureData;c.init(),c.name=a.getAttribute(ccs.CONST_A_NAME);for(var d=a.querySelectorAll(ccs.CONST_ARMATURE+" > "+ccs.CONST_BONE),e=0;e<d.length;e++){var f=d[e],g=f.getAttribute(ccs.CONST_A_PARENT),h=null;if(g)for(var i=0;i<d.length&&(h=d[i],g!=d[i].getAttribute(ccs.CONST_A_NAME));i++);var j=this.decodeBone(f,h,b);c.addBoneData(j)}return c},decodeArmatureFromJSON:function(a,b){var c=new ccs.ArmatureData;c.init();var d=a[ccs.CONST_A_NAME];d&&(c.name=d),b.cocoStudioVersion=c.dataVersion=a[ccs.CONST_VERSION]||.1;for(var e=a[ccs.CONST_BONE_DATA],f=0;f<e.length;f++){var g=this.decodeBoneFromJson(e[f],b);c.addBoneData(g)}return c},decodeBone:function(a,b,c){var d=new ccs.BoneData;d.init(),d.name=a.getAttribute(ccs.CONST_A_NAME),d.parentName=a.getAttribute(ccs.CONST_A_PARENT)||"",d.zOrder=parseInt(a.getAttribute(ccs.CONST_A_Z))||0;for(var e=a.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_DISPLAY),f=0;f<e.length;f++){var g=e[f],h=this.decodeBoneDisplay(g,c);d.addDisplayData(h)}return d},decodeBoneFromJson:function(a,b){var c=new ccs.BoneData;c.init(),this.decodeNodeFromJson(c,a,b),c.name=a[ccs.CONST_A_NAME]||"",c.parentName=a[ccs.CONST_A_PARENT]||"";for(var d=a[ccs.CONST_DISPLAY_DATA]||[],e=0;e<d.length;e++){var f=this.decodeBoneDisplayFromJson(d[e],b);c.addDisplayData(f)}return c},decodeBoneDisplay:function(a){var b=parseFloat(a.getAttribute(ccs.CONST_A_IS_ARMATURE))||0,c=null;1==b?(c=new ccs.ArmatureDisplayData,c.displayType=ccs.DISPLAY_TYPE_ARMATURE):(c=new ccs.SpriteDisplayData,c.displayType=ccs.DISPLAY_TYPE_SPRITE);var d=a.getAttribute(ccs.CONST_A_NAME)||"";return d&&(c.displayName=d),c},decodeBoneDisplayFromJson:function(a,b){var c=a[ccs.CONST_A_DISPLAY_TYPE]||ccs.DISPLAY_TYPE_SPRITE,d=null;switch(c){case ccs.DISPLAY_TYPE_SPRITE:d=new ccs.SpriteDisplayData;var e=a[ccs.CONST_A_NAME];null!=e&&(d.displayName=e);var f=a[ccs.CONST_SKIN_DATA]||[],g=f[0];if(g){var h=d.skinData;h.x=g[ccs.CONST_A_X]*this._positionReadScale,h.y=g[ccs.CONST_A_Y]*this._positionReadScale,h.scaleX=null==g[ccs.CONST_A_SCALE_X]?1:g[ccs.CONST_A_SCALE_X],h.scaleY=null==g[ccs.CONST_A_SCALE_Y]?1:g[ccs.CONST_A_SCALE_Y],h.skewX=null==g[ccs.CONST_A_SKEW_X]?1:g[ccs.CONST_A_SKEW_X],h.skewY=null==g[ccs.CONST_A_SKEW_Y]?1:g[ccs.CONST_A_SKEW_Y],h.x*=b.contentScale,h.y*=b.contentScale}break;case ccs.DISPLAY_TYPE_ARMATURE:d=new ccs.ArmatureDisplayData;var e=a[ccs.CONST_A_NAME];null!=e&&(d.displayName=a[ccs.CONST_A_NAME]);break;case ccs.DISPLAY_TYPE_PARTICLE:d=new ccs.ParticleDisplayData;var i=a[ccs.CONST_A_PLIST];null!=i&&(d.displayName=b.asyncStruct?b.asyncStruct.basefilePath+i:b.basefilePath+i);break;default:d=new ccs.SpriteDisplayData}return d.displayType=c,d},decodeAnimation:function(a,b){var c=new ccs.AnimationData,d=a.getAttribute(ccs.CONST_A_NAME),e=ccs.armatureDataManager.getArmatureData(d);c.name=d;for(var f=a.querySelectorAll(ccs.CONST_ANIMATION+" > "+ccs.CONST_MOVEMENT),g=null,h=0;h<f.length;h++){g=f[h];var i=this.decodeMovement(g,e,b);c.addMovement(i)}return c},decodeAnimationFromJson:function(a,b){var c=new ccs.AnimationData,d=a[ccs.CONST_A_NAME];d&&(c.name=a[ccs.CONST_A_NAME]);for(var e=a[ccs.CONST_MOVEMENT_DATA]||[],f=0;f<e.length;f++){var g=this.decodeMovementFromJson(e[f],b);c.addMovement(g)}return c},decodeMovement:function(a,b,c){var d=new ccs.MovementData;d.name=a.getAttribute(ccs.CONST_A_NAME);var e,f,g,h,i=0;e=a.getAttribute(ccs.CONST_A_DURATION),d.duration=null==e?0:parseFloat(e),f=a.getAttribute(ccs.CONST_A_DURATION_TO),d.durationTo=null==f?0:parseFloat(f),g=a.getAttribute(ccs.CONST_A_DURATION_TWEEN),d.durationTween=null==g?0:parseFloat(g),h=a.getAttribute(ccs.CONST_A_LOOP),d.loop=h?Boolean(parseFloat(h)):!0;var j=a.getAttribute(ccs.CONST_A_TWEEN_EASING);j&&(j!=ccs.CONST_FL_NAN?(i=null==j?0:parseFloat(j),d.tweenEasing=2==i?ccs.TweenType.sineEaseInOut:i):d.tweenEasing=ccs.TweenType.linear);for(var k=a.querySelectorAll(ccs.CONST_MOVEMENT+" > "+ccs.CONST_BONE),l=null,m=0;m<k.length;m++){l=k[m];var n=l.getAttribute(ccs.CONST_A_NAME);if(!d.getMovementBoneData(n)){var o=b.getBoneData(n),p=o.parentName,q=null;if(""!=p)for(var r=0;r<k.length&&(q=k[r],p!=q.getAttribute(ccs.CONST_A_NAME));r++);var s=this.decodeMovementBone(l,q,o,c);d.addMovementBoneData(s)}}return d},decodeMovementFromJson:function(a,b){var c=new ccs.MovementData;c.loop=null==a[ccs.CONST_A_LOOP]?!1:a[ccs.CONST_A_LOOP],c.durationTween=a[ccs.CONST_A_DURATION_TWEEN]||0,c.durationTo=a[ccs.CONST_A_DURATION_TO]||0,c.duration=a[ccs.CONST_A_DURATION]||0,c.scale=null==a[ccs.CONST_A_DURATION]?1:null==a[ccs.CONST_A_MOVEMENT_SCALE]?1:a[ccs.CONST_A_MOVEMENT_SCALE],c.tweenEasing=null==a[ccs.CONST_A_TWEEN_EASING]?ccs.TweenType.linear:a[ccs.CONST_A_TWEEN_EASING];var d=a[ccs.CONST_A_NAME];d&&(c.name=d);for(var e=a[ccs.CONST_MOVEMENT_BONE_DATA]||[],f=0;f<e.length;f++){var g=this.decodeMovementBoneFromJson(e[f],b);c.addMovementBoneData(g)}return c},decodeMovementBone:function(a,b,c,d){var e=new ccs.MovementBoneData;e.init();var f,g;a&&(f=parseFloat(a.getAttribute(ccs.CONST_A_MOVEMENT_SCALE))||0,e.scale=f,g=parseFloat(a.getAttribute(ccs.CONST_A_MOVEMENT_DELAY))||0,g>0&&(g-=1),e.delay=g);var h=0,i=0,j=0,k=null,l=[];if(null!=b){for(var m=b.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),n=0;n<m.length;n++)l.push(m[n]);h=l.length}e.name=a.getAttribute(ccs.CONST_A_NAME);for(var o=a.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),p=0,q=0,r=0;r<o.length;r++){var s=o[r];if(b)for(;h>p&&(k?i>q||q>=i+j:!0);)k=l[p],i+=j,j=parseFloat(k.getAttribute(ccs.CONST_A_DURATION)),p++;var t=this.decodeFrame(s,k,c,d);e.addFrameData(t),t.frameID=q,q+=t.duration,e.duration=q}for(var u=e.frameList,v=Math.PI,n=u.length-1;n>=0;n--)if(n>0){var w=u[n].skewX-u[n-1].skewX,x=u[n].skewY-u[n-1].skewY;(-v>w||w>v)&&(u[n-1].skewX=0>w?u[n-1].skewX-2*v:u[n-1].skewX+2*v),(-v>x||x>v)&&(u[n-1].skewY=0>x?u[n-1].skewY-2*v:u[n-1].skewY+2*v)}var y=new ccs.FrameData;return y.copy(e.frameList[e.frameList.length-1]),y.frameID=e.duration,e.addFrameData(y),e},decodeMovementBoneFromJson:function(a,b){var c=new ccs.MovementBoneData;c.init(),c.delay=a[ccs.CONST_A_MOVEMENT_DELAY]||0;var d=a[ccs.CONST_A_NAME];d&&(c.name=d);for(var e=a[ccs.CONST_FRAME_DATA]||[],f=e.length,g=0;f>g;g++){var h=a[ccs.CONST_FRAME_DATA][g],i=this.decodeFrameFromJson(h,b);c.addFrameData(i),b.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&(i.frameID=c.duration,c.duration+=i.duration)}if(b.cocoStudioVersion<ccs.VERSION_CHANGE_ROTATION_RANGE)for(var j=c.frameList,k=Math.PI,g=j.length-1;g>=0;g--)if(g>0){var l=j[g].skewX-j[g-1].skewX,m=j[g].skewY-j[g-1].skewY;(-k>l||l>k)&&(j[g-1].skewX=0>l?j[g-1].skewX-2*k:j[g-1].skewX+2*k),(-k>m||m>k)&&(j[g-1].skewY=0>m?j[g-1].skewY-2*k:j[g-1].skewY+2*k)}if(b.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&c.frameList.length>0){var i=new ccs.FrameData;i.copy(c.frameList[c.frameList.length-1]),c.addFrameData(i),i.frameID=c.duration}return c},decodeFrame:function(a,b,c,d){var e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=new ccs.FrameData;q.strMovement=a.getAttribute(ccs.CONST_A_MOVEMENT)||"",q.movement=q.strMovement,q.strEvent=a.getAttribute(ccs.CONST_A_EVENT)||"",q.event=q.strEvent,q.strSound=a.getAttribute(ccs.CONST_A_SOUND)||"",q.sound=q.strSound,q.strSoundEffect=a.getAttribute(ccs.CONST_A_SOUND_EFFECT)||"",q.soundEffect=q.strSoundEffect;var r=a.getAttribute(ccs.CONST_A_TWEEN_FRAME);if(q.isTween=!(void 0!=r&&"false"==r),d.flashToolVersion>=ccs.CONST_VERSION_2_0?(e=a.getAttribute(ccs.CONST_A_COCOS2DX_X),e&&(q.x=parseFloat(e),q.x*=this._positionReadScale),f=a.getAttribute(ccs.CONST_A_COCOS2DX_Y),f&&(q.y=-parseFloat(f),q.y*=this._positionReadScale)):(e=a.getAttribute(ccs.CONST_A_X),e&&(q.x=parseFloat(e),q.x*=this._positionReadScale),f=a.getAttribute(ccs.CONST_A_Y),f&&(q.y=-parseFloat(f),q.y*=this._positionReadScale)),g=a.getAttribute(ccs.CONST_A_SCALE_X),null!=g&&(q.scaleX=parseFloat(g)),h=a.getAttribute(ccs.CONST_A_SCALE_Y),null!=h&&(q.scaleY=parseFloat(h)),i=a.getAttribute(ccs.CONST_A_SKEW_X),null!=i&&(q.skewX=cc.degreesToRadians(parseFloat(i))),j=a.getAttribute(ccs.CONST_A_SKEW_Y),null!=j&&(q.skewY=cc.degreesToRadians(-parseFloat(j))),l=a.getAttribute(ccs.CONST_A_DURATION),null!=l&&(q.duration=parseFloat(l)),m=a.getAttribute(ccs.CONST_A_DISPLAY_INDEX),null!=m&&(q.displayIndex=parseFloat(m)),n=a.getAttribute(ccs.CONST_A_Z),null!=n&&(q.zOrder=parseInt(n)),k=a.getAttribute(ccs.CONST_A_TWEEN_ROTATE),null!=k&&(q.tweenRotate=parseFloat(k)),p=a.getAttribute(ccs.CONST_A_BLEND_TYPE),null!=p){var s=q.blendFunc;switch(p){case ccs.BLEND_TYPE_NORMAL:s.src=cc.BLEND_SRC,s.dst=cc.BLEND_DST;break;case ccs.BLEND_TYPE_ADD:s.src=cc.SRC_ALPHA,s.dst=cc.ONE;break;case ccs.BLEND_TYPE_MULTIPLY:s.src=cc.DST_COLOR,s.dst=cc.ONE_MINUS_SRC_ALPHA;break;case ccs.BLEND_TYPE_SCREEN:s.src=cc.ONE,s.dst=cc.ONE_MINUS_DST_COLOR;break;default:q.blendFunc.src=cc.BLEND_SRC,q.blendFunc.dst=cc.BLEND_DST}}var t=a.querySelectorAll(ccs.CONST_FRAME+" > "+ccs.CONST_A_COLOR_TRANSFORM);if(t&&t.length>0){t=t[0];var u,v,w,x,y,z,A,B;u=parseFloat(t.getAttribute(ccs.CONST_A_ALPHA))||0,v=parseFloat(t.getAttribute(ccs.CONST_A_RED))||0,w=parseFloat(t.getAttribute(ccs.CONST_A_GREEN))||0,x=parseFloat(t.getAttribute(ccs.CONST_A_BLUE))||0,y=parseFloat(t.getAttribute(ccs.CONST_A_ALPHA_OFFSET))||0,z=parseFloat(t.getAttribute(ccs.CONST_A_RED_OFFSET))||0,A=parseFloat(t.getAttribute(ccs.CONST_A_GREEN_OFFSET))||0,B=parseFloat(t.getAttribute(ccs.CONST_A_BLUE_OFFSET))||0,q.a=2.55*y+u,q.r=2.55*z+v,q.g=2.55*A+w,q.b=2.55*B+x,q.isUseColorInfo=!0}var C=a.getAttribute(ccs.CONST_A_TWEEN_EASING);if(null!=C&&(C!=ccs.CONST_FL_NAN?(o=a.getAttribute(ccs.CONST_A_TWEEN_EASING),o&&(q.tweenEasing=2==o?ccs.TweenType.sineEaseInOut:o)):q.tweenEasing=ccs.TweenType.linear),b){var D=new ccs.BaseData;d.flashToolVersion>=ccs.CONST_VERSION_2_0?(D.x=parseFloat(b.getAttribute(ccs.CONST_A_COCOS2DX_X)),D.y=parseFloat(b.getAttribute(ccs.CONST_A_COCOS2DX_Y))):(D.x=parseFloat(b.getAttribute(ccs.CONST_A_X)),D.y=parseFloat(b.getAttribute(ccs.CONST_A_Y))),D.skewX=parseFloat(b.getAttribute(ccs.CONST_A_SKEW_X)),D.skewY=parseFloat(b.getAttribute(ccs.CONST_A_SKEW_Y)),D.y=-D.y,D.skewX=cc.degreesToRadians(D.skewX),D.skewY=cc.degreesToRadians(-D.skewY),ccs.TransformHelp.transformFromParent(q,D)}return q},decodeFrameFromJson:function(a,b){var c=new ccs.FrameData;this.decodeNodeFromJson(c,a,b),c.tweenEasing=a[ccs.CONST_A_TWEEN_EASING]||ccs.TweenType.linear,c.displayIndex=a[ccs.CONST_A_DISPLAY_INDEX];var d=null==a[ccs.CONST_A_BLEND_SRC]?cc.BLEND_SRC:a[ccs.CONST_A_BLEND_SRC],e=null==a[ccs.CONST_A_BLEND_DST]?cc.BLEND_DST:a[ccs.CONST_A_BLEND_DST];c.blendFunc.src=d,c.blendFunc.dst=e,c.isTween=null==a[ccs.CONST_A_TWEEN_FRAME]?!0:a[ccs.CONST_A_TWEEN_FRAME];var f=a[ccs.CONST_A_EVENT];null!=f&&(c.strEvent=f,c.event=f),b.cocoStudioVersion<ccs.CONST_VERSION_COMBINED?c.duration=null==a[ccs.CONST_A_DURATION]?1:a[ccs.CONST_A_DURATION]:c.frameID=a[ccs.CONST_A_FRAME_INDEX];for(var g=a[ccs.CONST_A_EASING_PARAM]||[],h=0;h<g.length;h++)c.easingParams[h]=g[h];return c},decodeTexture:function(a,b){var c=new ccs.TextureData;c.init(),a.getAttribute(ccs.CONST_A_NAME)&&(c.name=a.getAttribute(ccs.CONST_A_NAME));var d,e;b.flashToolVersion>=ccs.CONST_VERSION_2_0?(d=parseFloat(a.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_X))||0,e=parseFloat(a.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_Y))||0):(d=parseFloat(a.getAttribute(ccs.CONST_A_PIVOT_X))||0,e=parseFloat(a.getAttribute(ccs.CONST_A_PIVOT_Y))||0);var f=parseFloat(a.getAttribute(ccs.CONST_A_WIDTH))||0,g=parseFloat(a.getAttribute(ccs.CONST_A_HEIGHT))||0,h=d/f,i=(g-e)/g;c.pivotX=h,c.pivotY=i;for(var j=a.querySelectorAll(ccs.CONST_SUB_TEXTURE+" > "+ccs.CONST_CONTOUR),k=0;k<j.length;k++)c.addContourData(this.decodeContour(j[k],b));return c},decodeTextureFromJson:function(a){var b=new ccs.TextureData;b.init();var c=a[ccs.CONST_A_NAME];null!=c&&(b.name=c),b.width=a[ccs.CONST_A_WIDTH]||0,b.height=a[ccs.CONST_A_HEIGHT]||0,b.pivotX=a[ccs.CONST_A_PIVOT_X]||0,b.pivotY=a[ccs.CONST_A_PIVOT_Y]||0;for(var d=a[ccs.CONST_CONTOUR_DATA]||[],e=0;e<d.length;e++)b.contourDataList.push(this.decodeContourFromJson(d[e]));return b},decodeContour:function(a){var b=new ccs.ContourData;b.init();for(var c,d=a.querySelectorAll(ccs.CONST_CONTOUR+" > "+ccs.CONST_CONTOUR_VERTEX),e=0;e<d.length;e++){c=d[e];var f=cc.p(0,0);f.x=parseFloat(c.getAttribute(ccs.CONST_A_X))||0,f.y=parseFloat(c.getAttribute(ccs.CONST_A_Y))||0,f.y=-f.y,b.vertexList.push(f)}return b},decodeContourFromJson:function(a){var b=new ccs.ContourData;b.init();for(var c=a[ccs.CONST_VERTEX_POINT]||[],d=c.length,e=0;d>e;e++){var f=c[e],g=cc.p(0,0);g.x=f[ccs.CONST_A_X]||0,g.y=f[ccs.CONST_A_Y]||0,b.vertexList.push(g)}return b},addDataFromJsonCache:function(a,b){b.contentScale=null==a[ccs.CONST_CONTENT_SCALE]?1:a[ccs.CONST_CONTENT_SCALE];var c,d,e=a[ccs.CONST_ARMATURE_DATA]||[];for(c=0;c<e.length;c++)d=this.decodeArmatureFromJSON(e[c],b),ccs.armatureDataManager.addArmatureData(d.name,d,b.filename);var f,g=a[ccs.CONST_ANIMATION_DATA]||[];for(c=0;c<g.length;c++)f=this.decodeAnimationFromJson(g[c],b),ccs.armatureDataManager.addAnimationData(f.name,f,b.filename);var h,i=a[ccs.CONST_TEXTURE_DATA]||[];for(c=0;c<i.length;c++)h=this.decodeTextureFromJson(i[c],b),ccs.armatureDataManager.addTextureData(h.name,h,b.filename);var j=null==b.asyncStruct?ccs.armatureDataManager.isAutoLoadSpriteFile():b.asyncStruct.autoLoadSpriteFile;if(j){var k,l,m,n,o=a[ccs.CONST_CONFIG_FILE_PATH]||[];for(c=0;c<o.length;c++)k=o[c],l=k.lastIndexOf("."),k=k.substring(0,l),m=b.basefilePath+k+".plist",n=b.basefilePath+k+".png",ccs.armatureDataManager.addSpriteFrameFromFile(m,n,b.filename)}d=null,f=null},decodeNodeFromJson:function(a,b,c){a.x=b[ccs.CONST_A_X]*this._positionReadScale,a.y=b[ccs.CONST_A_Y]*this._positionReadScale,a.x*=c.contentScale,a.y*=c.contentScale,a.zOrder=b[ccs.CONST_A_Z],a.skewX=b[ccs.CONST_A_SKEW_X]||0,a.skewY=b[ccs.CONST_A_SKEW_Y]||0,a.scaleX=null==b[ccs.CONST_A_SCALE_X]?1:b[ccs.CONST_A_SCALE_X],a.scaleY=null==b[ccs.CONST_A_SCALE_Y]?1:b[ccs.CONST_A_SCALE_Y];var d;c.cocoStudioVersion<ccs.VERSION_COLOR_READING?(d=b[0],d&&(a.a=null==d[ccs.CONST_A_ALPHA]?255:d[ccs.CONST_A_ALPHA],a.r=null==d[ccs.CONST_A_RED]?255:d[ccs.CONST_A_RED],a.g=null==d[ccs.CONST_A_GREEN]?255:d[ccs.CONST_A_GREEN],a.b=null==d[ccs.CONST_A_BLUE]?255:d[ccs.CONST_A_BLUE],a.isUseColorInfo=!0)):(d=b[ccs.CONST_COLOR_INFO]||null,d&&(a.a=null==d[ccs.CONST_A_ALPHA]?255:d[ccs.CONST_A_ALPHA],a.r=null==d[ccs.CONST_A_RED]?255:d[ccs.CONST_A_RED],a.g=null==d[ccs.CONST_A_GREEN]?255:d[ccs.CONST_A_GREEN],a.b=null==d[ccs.CONST_A_BLUE]?255:d[ccs.CONST_A_BLUE],a.isUseColorInfo=!0))},clear:function(){this._configFileList=[],this._asyncRefCount=0,this._asyncRefTotalCount=0},_asyncCallBack:function(a,b,c){a&&cc.isFunction(a)&&a.call(b,c),b&&a&&"string"==typeof a&&b[a](c)},_initBaseFilePath:function(a){var b=a,c=b.lastIndexOf("/");return b=c>-1?b.substr(0,c+1):""},addDataFromXML:function(a,b){var c=cc.loader.getRes(a);if(!c)throw"Please load the resource first : "+a;var d=cc.saxParser.parse(c),e=d.documentElement;e&&this.addDataFromCache(e,b)},addDataFromJson:function(a,b){var c=cc.loader.getRes(a);this.addDataFromJsonCache(c,b)}},ccs.spriteFrameCacheHelper={_textureAtlasDic:{},_imagePaths:[],addSpriteFrameFromFile:function(a,b){cc.spriteFrameCache.addSpriteFrames(a,b)},getTextureAtlasWithTexture:function(a){return null},clear:function(){this._textureAtlasDic={},this._imagePaths=[]}},ccs.TransformHelp=ccs.TransformHelp||ccs.Class.extend({}),ccs.TransformHelp.helpMatrix1=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpMatrix2=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpPoint1=cc.p(0,0),ccs.TransformHelp.helpPoint2=cc.p(0,0),ccs.TransformHelp.helpParentNode={},ccs.TransformHelp.transformFromParent=function(a,b){this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(b,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.transformToParent=function(a,b){this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(b,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.transformFromParentWithoutScale=function(a,b){for(var c in b)this.helpParentNode[c]=b[c];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.transformToParentWithoutScale=function(a,b){for(var c in b)this.helpParentNode[c]=b[c];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.nodeToMatrix=function(a,b){if(a.skewX==-a.skewY){var c=Math.sin(a.skewX),d=Math.cos(a.skewX);b.a=a.scaleX*d,b.b=a.scaleX*-c,b.c=a.scaleY*c,b.d=a.scaleY*d}else b.a=a.scaleX*Math.cos(a.skewY),b.b=a.scaleX*Math.sin(a.skewY),b.c=a.scaleY*Math.sin(a.skewX),b.d=a.scaleY*Math.cos(a.skewX);b.tx=a.x,b.ty=a.y},ccs.TransformHelp.matrixToNode=function(a,b){this.helpPoint1.x=0,this.helpPoint1.y=1,this.helpPoint1=cc.pointApplyAffineTransform(this.helpPoint1,a),this.helpPoint1.x-=a.tx,this.helpPoint1.y-=a.ty,this.helpPoint2.x=1,this.helpPoint2.y=0,this.helpPoint2=cc.pointApplyAffineTransform(this.helpPoint2,a),this.helpPoint2.x-=a.tx,this.helpPoint2.y-=a.ty,b.skewX=-(Math.atan2(this.helpPoint1.y,this.helpPoint1.x)-1.5707964),b.skewY=Math.atan2(this.helpPoint2.y,this.helpPoint2.x),b.scaleX=Math.sqrt(a.a*a.a+a.b*a.b),b.scaleY=Math.sqrt(a.c*a.c+a.d*a.d),b.x=a.tx,b.y=a.ty},ccs.TransformHelp.nodeConcat=function(a,b){a.x+=b.x,a.y+=b.y,a.skewX+=b.skewX,a.skewY+=b.skewY,a.scaleX+=b.scaleX,a.scaleY+=b.scaleY},ccs.TransformHelp.nodeSub=function(a,b){a.x-=b.x,a.y-=b.y,a.skewX-=b.skewX,a.skewY-=b.skewY,a.scaleX-=b.scaleX,a.scaleY-=b.scaleY},ccs.TweenType={customEasing:-1,linear:0,sineEaseIn:1,sineEaseOut:2,sineEaseInOut:3,quadEaseIn:4,quadEaseOut:5,quadEaseInOut:6,cubicEaseIn:7,cubicEaseOut:8,cubicEaseInOut:9,quartEaseIn:10,quartEaseOut:11,quartEaseInOut:12,quintEaseIn:13,quintEaseOut:14,quintEaseInOut:15,expoEaseIn:16,expoEaseOut:17,expoEaseInOut:18,circEaseIn:19,eircEaseOut:20,circEaseInOut:21,elasticEaseIn:22,elasticEaseOut:23,elasticEaseInOut:24,backEaseIn:25,backEaseOut:26,backEaseInOut:27,bounceEaseIn:28,bounceEaseOut:29,bounceEaseInOut:30,tweenEasingMax:1e4},ccs.TweenFunction=ccs.TweenFunction||ccs.Class.extend({}),ccs.DOUBLE_PI=ccs.M_PI_X_2=2*Math.PI,ccs.HALF_PI=ccs.M_PI_2=Math.PI/2,ccs.M_PI=Math.PI,ccs.TweenFunction.tweenTo=function(a,b,c){var d=0;switch(b){case ccs.TweenType.customEasing:d=this.customEase(a,c);break;case ccs.TweenType.linear:d=this.linear(a);break;case ccs.TweenType.sineEaseIn:d=this.sineEaseIn(a);break;case ccs.TweenType.sineEaseOut:d=this.sineEaseOut(a);break;case ccs.TweenType.sineEaseInOut:d=this.sineEaseInOut(a);break;case ccs.TweenType.quadEaseIn:d=this.quadEaseIn(a);break;case ccs.TweenType.quadEaseOut:d=this.quadEaseOut(a);break;case ccs.TweenType.quadEaseInOut:d=this.quadEaseInOut(a);break;case ccs.TweenType.cubicEaseIn:d=this.cubicEaseIn(a);break;case ccs.TweenType.cubicEaseOut:d=this.cubicEaseOut(a);break;case ccs.TweenType.cubicEaseInOut:d=this.cubicEaseInOut(a);break;case ccs.TweenType.quartEaseIn:d=this.quartEaseIn(a);break;case ccs.TweenType.quartEaseOut:d=this.quartEaseOut(a);break;case ccs.TweenType.quartEaseInOut:d=this.quartEaseInOut(a);break;case ccs.TweenType.quintEaseIn:d=this.quintEaseIn(a);break;case ccs.TweenType.quintEaseOut:d=this.quintEaseOut(a);break;case ccs.TweenType.quintEaseInOut:d=this.quintEaseInOut(a);break;case ccs.TweenType.expoEaseIn:d=this.expoEaseIn(a);break;case ccs.TweenType.expoEaseOut:d=this.expoEaseOut(a);break;case ccs.TweenType.expoEaseInOut:d=this.expoEaseInOut(a);break;case ccs.TweenType.circEaseIn:d=this.circEaseIn(a);break;case ccs.TweenType.eircEaseOut:d=this.circEaseOut(a);break;case ccs.TweenType.circEaseInOut:d=this.circEaseInOut(a);break;case ccs.TweenType.elasticEaseIn:var e=.3;null!=c&&c.length>0&&(e=c[0]),d=this.elasticEaseIn(a,e);break;case ccs.TweenType.elasticEaseOut:var e=.3;null!=c&&c.length>0&&(e=c[0]),d=this.elasticEaseOut(a,e);break;case ccs.TweenType.elasticEaseInOut:var e=.3;null!=c&&c.length>0&&(e=c[0]),d=this.elasticEaseInOut(a,e);break;case ccs.TweenType.backEaseIn:d=this.backEaseIn(a);break;case ccs.TweenType.backEaseOut:d=this.backEaseOut(a);break;case ccs.TweenType.backEaseInOut:d=this.backEaseInOut(a);break;case ccs.TweenType.bounceEaseIn:d=this.bounceEaseIn(a);break;case ccs.TweenType.bounceEaseOut:d=this.bounceEaseOut(a);break;case ccs.TweenType.bounceEaseInOut:d=this.bounceEaseInOut(a);break;default:d=this.sineEaseInOut(a)}return d},ccs.TweenFunction.linear=function(a){return a},ccs.TweenFunction.sineEaseIn=function(a){return-1*Math.cos(a*ccs.HALF_PI)+1},ccs.TweenFunction.sineEaseOut=function(a){return Math.sin(a*ccs.HALF_PI)},ccs.TweenFunction.sineEaseInOut=function(a){return-.5*(Math.cos(ccs.M_PI*a)-1)},ccs.TweenFunction.quadEaseIn=function(a){return a*a},ccs.TweenFunction.quadEaseOut=function(a){return-1*a*(a-2)},ccs.TweenFunction.quadEaseInOut=function(a){return a=2*a,1>a?.5*a*a:(--a,-.5*(a*(a-2)-1))},ccs.TweenFunction.cubicEaseIn=function(a){return a*a*a},ccs.TweenFunction.cubicEaseOut=function(a){return a-=1,a*a*a+1},ccs.TweenFunction.cubicEaseInOut=function(a){return a=2*a,1>a?.5*a*a*a:(a-=2,.5*(a*a*a+2))},ccs.TweenFunction.quartEaseIn=function(a){return a*a*a*a},ccs.TweenFunction.quartEaseOut=function(a){return a-=1,-(a*a*a*a-1)},ccs.TweenFunction.quartEaseInOut=function(a){return a=2*a,1>a?.5*a*a*a*a:(a-=2,-.5*(a*a*a*a-2))},ccs.TweenFunction.quintEaseIn=function(a){return a*a*a*a*a},ccs.TweenFunction.quintEaseOut=function(a){return a-=1,a*a*a*a*a+1},ccs.TweenFunction.quintEaseInOut=function(a){return a=2*a,1>a?.5*a*a*a*a*a:(a-=2,.5*(a*a*a*a*a+2))},ccs.TweenFunction.expoEaseIn=function(a){return 0==a?0:Math.pow(2,10*(a-1))-.001},ccs.TweenFunction.expoEaseOut=function(a){return 1==a?1:-Math.pow(2,-10*a)+1},ccs.TweenFunction.expoEaseInOut=function(a){return a/=.5,a=1>a?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*(a-1))+2)},ccs.TweenFunction.circEaseIn=function(a){return-1*(Math.sqrt(1-a*a)-1)},ccs.TweenFunction.circEaseOut=function(a){return a-=1,Math.sqrt(1-a*a)},ccs.TweenFunction.circEaseInOut=function(a){return a=2*a,1>a?-.5*(Math.sqrt(1-a*a)-1):(a-=2,.5*(Math.sqrt(1-a*a)+1))},ccs.TweenFunction.elasticEaseIn=function(a,b){var c=.3;b.length>0&&(c=b[0]);var d=0;if(0==a||1==a)d=a;else{var e=c/4;a-=1,d=-Math.pow(2,10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c)}return d},ccs.TweenFunction.elasticEaseOut=function(a,b){var c=.3;b.length>0&&(c=b[0]);var d=0;if(0==a||1==a)d=a;else{var e=c/4;d=Math.pow(2,-10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c)+1}return d},ccs.TweenFunction.elasticEaseInOut=function(a,b){var c=.3;b.length>0&&(c=b[0]);var d=0;if(0==a||1==a)d=a;else{a=2*a,c||(c=.3*1.5);var e=c/4;a-=1,d=0>a?-.5*Math.pow(2,10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c):Math.pow(2,-10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c)*.5+1}return d},ccs.TweenFunction.backEaseIn=function(a){var b=1.70158;return a*a*((b+1)*a-b)},ccs.TweenFunction.backEaseOut=function(a){var b=1.70158;return a-=1,a*a*((b+1)*a+b)+1},ccs.TweenFunction.backEaseInOut=function(a){var b=2.5949095;return a=2*a,1>a?a*a*((b+1)*a-b)/2:(a-=2,a*a*((b+1)*a+b)/2+1)},ccs.bounceTime=function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?(a-=1.5/2.75,7.5625*a*a+.75):2.5/2.75>a?(a-=2.25/2.75,7.5625*a*a+.9375):(a-=2.625/2.75,7.5625*a*a+.984375)},ccs.TweenFunction.bounceEaseIn=function(a){return 1-ccs.bounceTime(1-a)},ccs.TweenFunction.bounceEaseOut=function(a){return ccs.bounceTime(a)},ccs.TweenFunction.bounceEaseInOut=function(a){var b=0;return.5>a?(a=2*a,b=.5*(1-ccs.bounceTime(1-a))):b=.5*ccs.bounceTime(2*a-1)+.5,b},ccs.TweenFunction.customEase=function(a,b){if(b.length>0){var c=1-a;return b[1]*c*c*c+3*b[3]*a*c*c+3*b[5]*a*a*c+b[7]*a*a*a}return a},ccs.TweenFunction.easeIn=function(a,b){return Math.pow(a,b)},ccs.TweenFunction.easeOut=function(a,b){return Math.pow(a,1/b)},ccs.TweenFunction.easeInOut=function(a,b){return a*=2,1>a?.5*Math.pow(a,b):1-.5*Math.pow(2-a,b)
},ccs.TweenFunction.quadraticIn=function(a){return Math.pow(a,2)},ccs.TweenFunction.quadraticOut=function(a){return-a*(a-2)},ccs.TweenFunction.bezieratFunction=function(a,b,c,d,e){return Math.pow(1-e,3)*a+3*e*Math.pow(1-e,2)*b+3*Math.pow(e,2)*(1-e)*c+Math.pow(e,3)*d};var ENABLE_PHYSICS_DETECT=!1;ccs.fmodf=function(a,b){for(;a>b;)a-=b;return a};var CC_SAFE_RELEASE=function(a){a&&a.release&&a.release()};ccs.isSpriteContainPoint=function(a,b,c){var d=a.convertToNodeSpace(b);c&&(c.x=d.x,c.y=d.y);var e=a.getContentSize();return cc.rectContainsPoint(cc.rect(0,0,e.width,e.height),d)},ccs.SPRITE_CONTAIN_POINT=ccs.isSpriteContainPoint,ccs.SPRITE_CONTAIN_POINT_WITH_RETURN=ccs.isSpriteContainPoint,ccs.extBezierTo=function(a,b,c,d,e){var f=cc.p(0,0);return d&&!e&&(f.x=Math.pow(1-a,2)*b.x+2*a*(1-a)*c.x+Math.pow(a,2)*d.x,f.y=Math.pow(1-a,2)*b.y+2*a*(1-a)*c.y+Math.pow(a,2)*d.y),e&&(f.x=b.x*Math.pow(1-a,3)+3*a*c.x*Math.pow(1-a,2)+3*d.x*Math.pow(a,2)*(1-a)+e.x*Math.pow(a,3),f.y=b.y*Math.pow(1-a,3)+3*a*c.y*Math.pow(1-a,2)+3*d.y*Math.pow(a,2)*(1-a)+e.y*Math.pow(a,3)),f},ccs.extCircleTo=function(a,b,c,d,e){var f=cc.p(0,0);return f.x=b.x+c*Math.cos(d+e*a),f.y=b.y+c*Math.sin(d+e*a),f},ccs.RelativeData=function(){this.plistFiles=[],this.armatures=[],this.animations=[],this.textures=[]},ccs.armatureDataManager={_animationDatas:{},_armatureDatas:{},_textureDatas:{},_autoLoadSpriteFile:!1,_relativeDatas:{},s_sharedArmatureDataManager:null,removeArmatureFileInfo:function(a){var b=this.getRelativeData(a);if(b){var c,d;for(c=0;c<b.armatures.length;c++)d=b.armatures[c],this.removeArmatureData(d);for(c=0;c<b.animations.length;c++)d=b.animations[c],this.removeAnimationData(d);for(c=0;c<b.textures.length;c++)d=b.textures[c],this.removeTextureData(d);for(c=0;c<b.plistFiles.length;c++)d=b.plistFiles[c],cc.spriteFrameCache.removeSpriteFramesFromFile(d);delete this._relativeDatas[a],ccs.dataReaderHelper.removeConfigFile(a)}},addArmatureData:function(a,b,c){var d=this.getRelativeData(c);d&&d.armatures.push(a),this._armatureDatas[a]=b},getArmatureData:function(a){var b=null;return this._armatureDatas&&(b=this._armatureDatas[a]),b},removeArmatureData:function(a){this._armatureDatas[a]&&delete this._armatureDatas[a]},addAnimationData:function(a,b,c){var d=this.getRelativeData(c);d&&d.animations.push(a),this._animationDatas[a]=b},getAnimationData:function(a){var b=null;return this._animationDatas[a]&&(b=this._animationDatas[a]),b},removeAnimationData:function(a){this._animationDatas[a]&&delete this._animationDatas[a]},addTextureData:function(a,b,c){var d=this.getRelativeData(c);d&&d.textures.push(a),this._textureDatas[a]=b},getTextureData:function(a){var b=null;return this._textureDatas&&(b=this._textureDatas[a]),b},removeTextureData:function(a){this._textureDatas[a]&&delete this._textureDatas[a]},addArmatureFileInfo:function(){var a,b,c;switch(arguments.length){case 1:c=arguments[0],this.addRelativeData(c),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFile(c);break;case 3:a=arguments[0],b=arguments[1],c=arguments[2],this.addRelativeData(c),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFile(c),this.addSpriteFrameFromFile(b,a)}},addArmatureFileInfoAsync:function(){var a,b,c,d,e;switch(arguments.length){case 3:c=arguments[0],d=arguments[2],e=arguments[1],this.addRelativeData(c),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFileAsync("","",c,e,d);break;case 5:a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[4],e=arguments[3],this.addRelativeData(c),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFileAsync(a,b,c,e,d),this.addSpriteFrameFromFile(b,a)}},addSpriteFrameFromFile:function(a,b,c){var d=this.getRelativeData(c);d&&d.plistFiles.push(a),ccs.spriteFrameCacheHelper.addSpriteFrameFromFile(a,b)},isAutoLoadSpriteFile:function(){return this._autoLoadSpriteFile},getArmatureDatas:function(){return this._armatureDatas},getAnimationDatas:function(){return this._animationDatas},getTextureDatas:function(){return this._textureDatas},addRelativeData:function(a){this._relativeDatas[a]||(this._relativeDatas[a]=new ccs.RelativeData)},getRelativeData:function(a){return this._relativeDatas[a]},clear:function(){this._animationDatas={},this._armatureDatas={},this._textureDatas={},ccs.spriteFrameCacheHelper.clear(),ccs.dataReaderHelper.clear()}},ccs.BLEND_TYPE_NORMAL=0,ccs.BLEND_TYPE_LAYER=1,ccs.BLEND_TYPE_DARKEN=2,ccs.BLEND_TYPE_MULTIPLY=3,ccs.BLEND_TYPE_LIGHTEN=4,ccs.BLEND_TYPE_SCREEN=5,ccs.BLEND_TYPE_OVERLAY=6,ccs.BLEND_TYPE_HIGHLIGHT=7,ccs.BLEND_TYPE_ADD=8,ccs.BLEND_TYPE_SUBTRACT=9,ccs.BLEND_TYPE_DIFFERENCE=10,ccs.BLEND_TYPE_INVERT=11,ccs.BLEND_TYPE_ALPHA=12,ccs.BLEND_TYPE_ERASE=13,ccs.DISPLAY_TYPE_SPRITE=0,ccs.DISPLAY_TYPE_ARMATURE=1,ccs.DISPLAY_TYPE_PARTICLE=2,ccs.DISPLAY_TYPE_MAX=3,ccs.BaseData=ccs.Class.extend({x:0,y:0,zOrder:0,skewX:0,skewY:0,scaleX:1,scaleY:1,tweenRotate:0,isUseColorInfo:!1,r:255,g:255,b:255,a:255,ctor:function(){this.x=0,this.y=0,this.zOrder=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1,this.tweenRotate=0,this.isUseColorInfo=!1,this.r=255,this.g=255,this.b=255,this.a=255},copy:function(a){this.x=a.x,this.y=a.y,this.zOrder=a.zOrder,this.scaleX=a.scaleX,this.scaleY=a.scaleY,this.skewX=a.skewX,this.skewY=a.skewY,this.tweenRotate=a.tweenRotate,this.isUseColorInfo=a.isUseColorInfo,this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a},setColor:function(a){this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a},getColor:function(){return cc.color(this.r,this.g,this.b,this.a)},subtract:function(a,b,c){this.x=b.x-a.x,this.y=b.y-a.y,this.scaleX=b.scaleX-a.scaleX,this.scaleY=b.scaleY-a.scaleY,this.skewX=b.skewX-a.skewX,this.skewY=b.skewY-a.skewY,this.isUseColorInfo||a.isUseColorInfo||b.isUseColorInfo?(this.a=b.a-a.a,this.r=b.r-a.r,this.g=b.g-a.g,this.b=b.b-a.b,this.isUseColorInfo=!0):(this.a=this.r=this.g=this.b=0,this.isUseColorInfo=!1),c&&(this.skewX>ccs.M_PI&&(this.skewX-=ccs.DOUBLE_PI),this.skewX<-ccs.M_PI&&(this.skewX+=ccs.DOUBLE_PI),this.skewY>ccs.M_PI&&(this.skewY-=ccs.DOUBLE_PI),this.skewY<-ccs.M_PI&&(this.skewY+=ccs.DOUBLE_PI)),b.tweenRotate&&(this.skewX+=b.tweenRotate*ccs.PI*2,this.skewY-=b.tweenRotate*ccs.PI*2)}}),ccs.DisplayData=ccs.Class.extend({displayType:ccs.DISPLAY_TYPE_MAX,displayName:"",ctor:function(){this.displayType=ccs.DISPLAY_TYPE_MAX},changeDisplayToTexture:function(a){var b=a,c=b.lastIndexOf(".");return-1!=c&&(b=b.substring(0,c)),b},copy:function(a){this.displayName=a.displayName,this.displayType=a.displayType}}),ccs.SpriteDisplayData=ccs.DisplayData.extend({skinData:null,ctor:function(){this.skinData=new ccs.BaseData,this.displayType=ccs.DISPLAY_TYPE_SPRITE},copy:function(a){ccs.DisplayData.prototype.copy.call(this,a),this.skinData=a.skinData}}),ccs.ArmatureDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayName="",this.displayType=ccs.DISPLAY_TYPE_ARMATURE}}),ccs.ParticleDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayType=ccs.DISPLAY_TYPE_PARTICLE}}),ccs.BoneData=ccs.BaseData.extend({displayDataList:null,name:"",parentName:"",boneDataTransform:null,ctor:function(){this.displayDataList=[],this.name="",this.parentName="",this.boneDataTransform=null},init:function(){return this.displayDataList.length=0,!0},addDisplayData:function(a){this.displayDataList.push(a)},getDisplayData:function(a){return this.displayDataList[a]}}),ccs.ArmatureData=ccs.Class.extend({boneDataDic:null,name:"",dataVersion:.1,ctor:function(){this.boneDataDic={},this.name="",this.dataVersion=.1},init:function(){return!0},addBoneData:function(a){this.boneDataDic[a.name]=a},getBoneDataDic:function(){return this.boneDataDic},getBoneData:function(a){return this.boneDataDic[a]}}),ccs.FrameData=ccs.BaseData.extend({duration:0,tweenEasing:0,easingParamNumber:0,easingParams:null,displayIndex:-1,movement:"",event:"",sound:"",soundEffect:"",blendFunc:null,frameID:0,isTween:!0,ctor:function(){ccs.BaseData.prototype.ctor.call(this),this.duration=1,this.tweenEasing=ccs.TweenType.linear,this.easingParamNumber=0,this.easingParams=[],this.displayIndex=0,this.movement="",this.event="",this.sound="",this.soundEffect="",this.blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.frameID=0,this.isTween=!0},copy:function(a){if(ccs.BaseData.prototype.copy.call(this,a),this.duration=a.duration,this.displayIndex=a.displayIndex,this.tweenEasing=a.tweenEasing,this.easingParamNumber=a.easingParamNumber,0!=this.easingParamNumber){this.easingParams.length=0;for(var b=0;b<this.easingParamNumber;b++)this.easingParams[b]=a.easingParams[b]}this.blendFunc=a.blendFunc,this.isTween=a.isTween}}),ccs.MovementBoneData=ccs.Class.extend({delay:0,scale:1,duration:0,frameList:null,name:"",ctor:function(){this.delay=0,this.scale=1,this.duration=0,this.frameList=[],this.name=""},init:function(){return!0},addFrameData:function(a){this.frameList.push(a)},getFrameData:function(a){return this.frameList[a]}}),ccs.MovementData=function(){this.name="",this.duration=0,this.scale=1,this.durationTo=0,this.durationTween=0,this.loop=!0,this.tweenEasing=ccs.TweenType.linear,this.movBoneDataDic={}},ccs.MovementData.prototype.addMovementBoneData=function(a){this.movBoneDataDic[a.name]=a},ccs.MovementData.prototype.getMovementBoneData=function(a){return this.movBoneDataDic[a]},ccs.AnimationData=function(){this.movementDataDic={},this.movementNames=[],this.name=""},ccs.AnimationData.prototype.addMovement=function(a){this.movementDataDic[a.name]=a,this.movementNames.push(a.name)},ccs.AnimationData.prototype.getMovement=function(a){return this.movementDataDic[a]},ccs.AnimationData.prototype.getMovementCount=function(){return Object.keys(this.movementDataDic).length},ccs.ContourVertex2=function(a,b){this.x=a||0,this.y=b||0},ccs.ContourData=function(){this.vertexList=[]},ccs.ContourData.prototype.init=function(){return this.vertexList.length=0,!0},ccs.ContourData.prototype.addVertex=function(a){this.vertexList.push(a)},ccs.TextureData=function(){this.height=0,this.width=0,this.pivotX=.5,this.pivotY=.5,this.name="",this.contourDataList=[]},ccs.TextureData.prototype.init=function(){this.contourDataList.length=0},ccs.TextureData.prototype.addContourData=function(a){this.contourDataList.push(a)},ccs.TextureData.prototype.getContourData=function(a){return this.contourDataList[a]},ccs.DecorativeDisplay=ccs.Class.extend({_display:null,_colliderDetector:null,_displayData:null,ctor:function(){this._display=null,this._colliderDetector=null,this._displayData=null},init:function(){return!0},setDisplay:function(a){a._parent&&(a._parent.removeChild(a),delete a._parent),this._display=a},getDisplay:function(){return this._display},setColliderDetector:function(a){this._colliderDetector=a},getColliderDetector:function(){return this._colliderDetector},setDisplayData:function(a){this._displayData=a},getDisplayData:function(){return this._displayData},release:function(){this._display=null,this._displayData=null,this._colliderDetector=null}}),ccs.DecorativeDisplay.create=function(){var a=new ccs.DecorativeDisplay;return a&&a.init()?a:null},ccs.displayFactory={addDisplay:function(a,b,c){switch(c.displayType){case ccs.DISPLAY_TYPE_SPRITE:this.addSpriteDisplay(a,b,c);break;case ccs.DISPLAY_TYPE_PARTICLE:this.addParticleDisplay(a,b,c);break;case ccs.DISPLAY_TYPE_ARMATURE:this.addArmatureDisplay(a,b,c)}},createDisplay:function(a,b){switch(b.getDisplayData().displayType){case ccs.DISPLAY_TYPE_SPRITE:this.createSpriteDisplay(a,b);break;case ccs.DISPLAY_TYPE_PARTICLE:this.createParticleDisplay(a,b);break;case ccs.DISPLAY_TYPE_ARMATURE:this.createArmatureDisplay(a,b)}},_helpTransform:{a:1,b:0,c:0,d:1,tx:0,ty:0},updateDisplay:function(a,b,c){var d=a.getDisplayRenderNode();if(d){switch(a.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:c&&d.updateArmatureTransform();break;case ccs.DISPLAY_TYPE_PARTICLE:this.updateParticleDisplay(a,d,b);break;case ccs.DISPLAY_TYPE_ARMATURE:this.updateArmatureDisplay(a,d,b);break;default:var e=a.getNodeToArmatureTransform();d.setAdditionalTransform(e)}if((ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&c){var f=a.getDisplayManager().getCurrentDecorativeDisplay(),g=f.getColliderDetector();if(g){var h=f.getDisplay(),i=h.nodeToParentTransform(),j=this._helpTransform;j.a=i.a,j.b=i.b,j.c=i.c,j.d=i.d,j.tx=i.tx,j.ty=i.ty;var k=cc.pointApplyAffineTransform(h.getAnchorPointInPoints(),j);j.tx=k.x,j.ty=k.y;var l=cc.affineTransformConcat(j,a.getArmature().nodeToParentTransform());g.updateTransform(l)}}}},addSpriteDisplay:function(a,b,c){var d=new ccs.SpriteDisplayData;d.copy(c),b.setDisplayData(d),this.createSpriteDisplay(a,b)},createSpriteDisplay:function(a,b){var c=null,d=b.getDisplayData(),e=d.displayName,f=e.lastIndexOf(".");if(-1!=f&&(e=e.substring(0,f)),c=""==e?ccs.Skin.create():ccs.Skin.createWithSpriteFrameName(e+".png"),b.setDisplay(c),null!=c){c.setBone(a),this.initSpriteDisplay(a,b,d.displayName,c);var g=a.getArmature();g&&c.setSkinData(g.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?d.skinData:a.boneData)}},initSpriteDisplay:function(a,b,c,d){var e=c,f=e.lastIndexOf(".");-1!=f&&(e=e.substring(0,f));var g=ccs.armatureDataManager.getTextureData(e);if(g&&d.setAnchorPoint(cc.p(g.pivotX,g.pivotY)),(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&g&&g.contourDataList.length>0){var h=ccs.ColliderDetector.create(a);h.addContourDataList(g.contourDataList),b.setColliderDetector(h)}},addArmatureDisplay:function(a,b,c){var d=new ccs.ArmatureDisplayData;d.copy(c),b.setDisplayData(d),this.createArmatureDisplay(a,b)},createArmatureDisplay:function(a,b){var c=b.getDisplayData(),d=ccs.Armature.create(c.displayName,a);b.setDisplay(d)},updateArmatureDisplay:function(a,b,c){b&&(b.sortAllChildren(),b.update(c))},addParticleDisplay:function(a,b,c){var d=new ccs.ParticleDisplayData;d.copy(c),b.setDisplayData(d),this.createParticleDisplay(a,b)},createParticleDisplay:function(a,b){var c=b.getDisplayData(),d=cc.ParticleSystem.create(c.displayName);d.removeFromParent(),d.cleanup();var e=a.getArmature();e&&d.setParent(a.getArmature()),b.setDisplay(d)},updateParticleDisplay:function(a,b,c){var d=new ccs.BaseData;ccs.TransformHelp.matrixToNode(a.nodeToArmatureTransform(),d),b.setPosition(d.x,d.y),b.setScaleX(d.scaleX),b.setScaleY(d.scaleY),b.update(c)}},ccs.DisplayManager=ccs.Class.extend({_decoDisplayList:null,_currentDecoDisplay:null,_displayRenderNode:null,_displayIndex:null,_forceChangeDisplay:!1,_bone:null,_visible:!0,_displayType:null,ctor:function(){this._decoDisplayList=[],this._currentDecoDisplay=null,this._displayRenderNode=null,this._displayIndex=null,this._forceChangeDisplay=!1,this._bone=null,this._visible=!0,this._displayType=ccs.DISPLAY_TYPE_MAX},init:function(a){return this._bone=a,this.initDisplayList(a.getBoneData()),!0},addDisplay:function(a,b){var c,d=this._decoDisplayList;if(b>=0&&b<d.length?c=d[b]:(c=ccs.DecorativeDisplay.create(),d.push(c)),a instanceof ccs.DisplayData)return cc.displayFactory.addDisplay(this._bone,c,a),void(b==this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(b,!1)));var e=null;if(a instanceof ccs.Skin){a.setBone(this._bone),e=new ccs.SpriteDisplayData,ccs.displayFactory.initSpriteDisplay(this._bone,c,a.getDisplayName(),a);var f=c.getDisplayData();if(f instanceof ccs.SpriteDisplayData)a.setSkinData(f.skinData),e.skinData=f.skinData;else{for(var g=!1,h=d.length-2;h>=0;h--){var i=d[h],j=i.getDisplayData();if(j instanceof ccs.SpriteDisplayData){g=!0,a.setSkinData(j.skinData),e.skinData=j.skinData;break}}g||a.setSkinData(new ccs.BaseData)}}else if(a instanceof cc.ParticleSystem){e=new ccs.ParticleDisplayData,a.removeFromParent(),a.cleanup();var k=this._bone.getArmature();k&&a.setParent(k)}else a instanceof ccs.Armature?(e=new ccs.ArmatureDisplayData,e.displayName=a.getName(),a.setParentBone(this._bone)):e=new ccs.DisplayData;c.setDisplay(a),c.setDisplayData(e),b==this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(b,!1))},_addDisplayOther:function(a,b){var c=null;if(b instanceof ccs.Skin){var d=b;d.setBone(this._bone),c=new ccs.SpriteDisplayData,c.displayName=d.getDisplayName(),ccs.displayFactory.initSpriteDisplay(this._bone,a,d.getDisplayName(),d);var e=a.getDisplayData();if(e instanceof ccs.SpriteDisplayData)d.setSkinData(e.skinData);else{for(var f=!1,g=this._decoDisplayList.length-2;g>=0;g--){var h=this._decoDisplayList[g],i=h.getDisplayData();if(i){f=!0,d.setSkinData(i.skinData),c.skinData=i.skinData;break}}f||d.setSkinData(new ccs.BaseData),d.setSkinData(new ccs.BaseData)}}else b instanceof cc.ParticleSystem?(c=new ccs.ParticleDisplayData,c.displayName=b._plistFile):b instanceof ccs.Armature?(c=new ccs.ArmatureDisplayData,c.displayName=b.getName(),b.setParentBone(this._bone)):c=new ccs.DisplayData;a.setDisplay(b),a.setDisplayData(c)},removeDisplay:function(a){this._decoDisplayList.splice(a,1),a===this._displayIndex&&(this.setCurrentDecorativeDisplay(null),this._displayIndex=-1)},getDecorativeDisplayList:function(){return this._decoDisplayList},changeDisplayWithIndex:function(a,b){return a>=this._decoDisplayList.length?void cc.log("the index value is out of range"):(this._forceChangeDisplay=b,this._displayIndex!=a?(this._displayIndex=a,0>a?void(this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this.setCurrentDecorativeDisplay(null))):void this.setCurrentDecorativeDisplay(this._decoDisplayList[a])):void 0)},changeDisplayWithName:function(a,b){for(var c=this._decoDisplayList,d=0;d<c.length;d++)if(c[d].getDisplayData().displayName==a){this.changeDisplayWithIndex(d,b);break}},setCurrentDecorativeDisplay:function(a){var b=this._currentDecoDisplay;(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&b&&b.getColliderDetector()&&b.getColliderDetector().setActive(!1),this._currentDecoDisplay=a,b=this._currentDecoDisplay,(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&b&&b.getColliderDetector()&&b.getColliderDetector().setActive(!0);var c=b?b.getDisplay():null,d=this._displayRenderNode,e=this._bone;d&&(d instanceof ccs.Armature&&e.setChildArmature(null),d.removeFromParent(!0)),this._displayRenderNode=c,c?(c instanceof ccs.Armature?(this._bone.setChildArmature(c),c.setParentBone(this._bone)):c instanceof cc.ParticleSystem&&(c instanceof ccs.Armature?(e.setChildArmature(c),c.setParentBone(e)):c instanceof cc.ParticleSystem&&c.resetSystem()),c.setColor(e.getDisplayedColor()),c.setOpacity(e.getDisplayedOpacity()),this._displayRenderNode.setVisible(this._visible),this._displayType=this._currentDecoDisplay.getDisplayData().displayType):this._displayType=ccs.DISPLAY_TYPE_MAX,cc.renderer.childrenOrderDirty=!0},getDisplayRenderNode:function(){return this._displayRenderNode},getDisplayRenderNodeType:function(){return this._displayType},getCurrentDisplayIndex:function(){return this._displayIndex},getCurrentDecorativeDisplay:function(){return this._currentDecoDisplay},getDecorativeDisplayByIndex:function(a){return this._decoDisplayList[a]},initDisplayList:function(a){if(this._decoDisplayList.length=0,a)for(var b=a.displayDataList,c=this._decoDisplayList,d=this._bone,e=0;e<b.length;e++){var f=b[e],g=ccs.DecorativeDisplay.create();g.setDisplayData(f),ccs.displayFactory.createDisplay(d,g),c.push(g)}},containPoint:function(a,b){if(!this._visible||this._displayIndex<0)return!1;if(void 0!==b&&(a=cc.p(a,b)),this._currentDecoDisplay.getDisplayData().displayType==ccs.DISPLAY_TYPE_SPRITE){var c=this._currentDecoDisplay.getDisplay();return c=c.getChildByTag(0),ccs.SPRITE_CONTAIN_POINT_WITH_RETURN(c,a)}return!1},setVisible:function(a){this._displayRenderNode&&(this._visible=a,this._displayRenderNode.setVisible(a))},isVisible:function(){return this._visible},getContentSize:function(){return this._displayRenderNode?this._displayRenderNode.getContentSize():cc.size(0,0)},getBoundingBox:function(){return this._displayRenderNode?this._displayRenderNode.getBoundingBox():cc.rect(0,0,0,0)},getAnchorPoint:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPoint():cc.p(0,0)},getAnchorPointInPoints:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPointInPoints():cc.p(0,0)},getForceChangeDisplay:function(){return this._forceChangeDisplay},release:function(){this._decoDisplayList=null,this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this._displayRenderNode=null)}}),ccs.DisplayManager.create=function(a){var b=new ccs.DisplayManager;return b&&b.init(a)?b:null},ccs.Skin=ccs.Sprite.extend({_skinData:null,bone:null,_skinTransform:null,_displayName:"",_armature:null,_className:"Skin",ctor:function(){cc.Sprite.prototype.ctor.call(this),this._skinData=null,this.bone=null,this._displayName="",this._skinTransform=cc.affineTransformIdentity(),this._armature=null},initWithSpriteFrameName:function(a){if(""==a)return!1;var b=cc.spriteFrameCache.getSpriteFrame(a),c=!0;return b?this.initWithSpriteFrame(b):(cc.log("Can't find CCSpriteFrame with %s. Please check your .plist file",a),c=!1),this._displayName=a,c},initWithFile:function(a){var b=cc.Sprite.prototype.initWithFile.call(this,a);return this._displayName=a,b},setSkinData:function(a){this._skinData=a,this.setScaleX(a.scaleX),this.setScaleY(a.scaleY),this.setRotationX(cc.radiansToDegrees(a.skewX)),this.setRotationY(cc.radiansToDegrees(-a.skewY)),this.setPosition(a.x,a.y);var b=this.getNodeToParentTransform?this.getNodeToParentTransform():this.nodeToParentTransform(),c=this._skinTransform;c.a=b.a,c.b=b.b,c.c=b.c,c.d=b.d,c.tx=b.tx,c.ty=b.ty,this.updateArmatureTransform()},getSkinData:function(){return this._skinData},updateArmatureTransform:function(){this._transform=cc.affineTransformConcat(this._skinTransform,this.bone.getNodeToArmatureTransform())},_updateTransformForWebGL:function(){var a=this._quad;if(this._visible){var b=this.getNodeToParentTransform?this.getNodeToParentTransform():this.nodeToParentTransform(),c=this._rect,d=this._offsetPosition.x,e=this._offsetPosition.y,f=d+c.width,g=e+c.height,h=b.tx,i=b.ty,j=b.a,k=b.b,l=b.d,m=-b.c,n=d*j-e*m+h,o=d*k+e*l+i,p=f*j-e*m+h,q=f*k+e*l+i,r=f*j-g*m+h,s=f*k+g*l+i,t=d*j-g*m+h,u=d*k+g*l+i,v=this._vertexZ;cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(n=0|n,o=0|o,p=0|p,q=0|q,r=0|r,s=0|s,t=0|t,u=0|u),this.SET_VERTEX3F(a.bl.vertices,n,o,v),this.SET_VERTEX3F(a.br.vertices,p,q,v),this.SET_VERTEX3F(a.tl.vertices,t,u,v),this.SET_VERTEX3F(a.tr.vertices,r,s,v)}else a.br.vertices=a.tl.vertices=a.tr.vertices=a.bl.vertices={x:0,y:0,z:0};this._textureAtlas&&this._textureAtlas.updateQuad(a,this._textureAtlas.getTotalQuads()),this._quadDirty=!0},SET_VERTEX3F:function(a,b,c,d){a.x=b,a.y=c,a.z=d},RENDER_IN_SUBPIXEL:function(a){return cc.SPRITEBATCHNODE_RENDER_SUBPIXEL?a:Math.ceil(a)},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._transform,this.bone.getArmature().getNodeToWorldTransform())},getNodeToWorldTransformAR:function(){var a=this._transform;return this._anchorPointInPoints=cc.pointApplyAffineTransform(this._anchorPointInPoints,a),a.tx=this._anchorPointInPoints.x,a.ty=this._anchorPointInPoints.y,cc.affineTransformConcat(a,this.bone.getArmature().nodeToWorldTransform())},setBone:function(a){this.bone=a;var b=this.bone.getArmature();b&&(this._armature=b)},getBone:function(){return this.bone},getDisplayName:function(){return this._displayName}}),cc._renderType==cc._RENDER_TYPE_WEBGL&&(ccs.Skin.prototype.updateTransform=ccs.Skin.prototype._updateTransformForWebGL);var _p=ccs.Skin.prototype;_p.skinData,cc.defineGetterSetter(_p,"skinData",_p.getSkinData,_p.setSkinData),_p.displayName,cc.defineGetterSetter(_p,"displayName",_p.getDisplayName),_p=null,ccs.Skin.create=function(a,b){var c=arguments.length,d=new ccs.Skin;if(0===c||null==a||""==a){if(d.init())return d}else if("#"==a[0]){if(d&&d.initWithSpriteFrameName(a))return d}else if(d&&d.initWithFile(a,b))return d;return null},ccs.Skin.createWithSpriteFrameName=function(a){var b=new ccs.Skin;return b&&b.initWithSpriteFrameName(a)?b:null},ccs.ANIMATION_TYPE_SINGLE_FRAME=-4,ccs.ANIMATION_TYPE_NO_LOOP=-3,ccs.ANIMATION_TYPE_TO_LOOP_FRONT=-2,ccs.ANIMATION_TYPE_TO_LOOP_BACK=-1,ccs.ANIMATION_TYPE_LOOP_FRONT=0,ccs.ANIMATION_TYPE_LOOP_BACK=1,ccs.ANIMATION_TYPE_MAX=2,ccs.ProcessBase=ccs.Class.extend({_processScale:1,_isComplete:!0,_isPause:!0,_isPlaying:!1,_currentPercent:0,_rawDuration:0,_loopType:0,_tweenEasing:0,animationInternal:null,_currentFrame:0,_durationTween:0,_nextFrameIndex:0,_curFrameIndex:null,_isLoopBack:!1,ctor:function(){this._processScale=1,this._isComplete=!0,this._isPause=!0,this._isPlaying=!1,this._currentFrame=0,this._currentPercent=0,this._durationTween=0,this._rawDuration=0,this._loopType=ccs.ANIMATION_TYPE_LOOP_BACK,this._tweenEasing=ccs.TweenType.linear,this.animationInternal=1/60,this._curFrameIndex=0,this._durationTween=0,this._isLoopBack=!1},pause:function(){this._isPause=!0,this._isPlaying=!1},resume:function(){this._isPause=!1,this._isPlaying=!0},stop:function(){this._isComplete=!0,this._isPlaying=!1},play:function(a,b,c,d){this._isComplete=!1,this._isPause=!1,this._isPlaying=!0,this._currentFrame=0,this._nextFrameIndex=a,this._tweenEasing=d},update:function(a){if(!this._isComplete&&!this._isPause&&!(this._rawDuration<=0||a>1)){var b=void 0===this._nextFrameIndex?0:this._nextFrameIndex,c=this._currentFrame;0>=b?(this._currentPercent=1,c=0):(c+=this._processScale*(a/this.animationInternal),this._currentPercent=c/b,c=ccs.fmodf(c,b)),this._currentFrame=c,this.updateHandler()}},gotoFrame:function(a){var b=this._loopType;b==ccs.ANIMATION_TYPE_NO_LOOP?b=ccs.ANIMATION_TYPE_MAX:b==ccs.ANIMATION_TYPE_TO_LOOP_FRONT&&(b=ccs.ANIMATION_TYPE_LOOP_FRONT),this._loopType=b,this._curFrameIndex=a,this._nextFrameIndex=this._durationTween},getCurrentFrameIndex:function(){return this._curFrameIndex=(this._rawDuration-1)*this._currentPercent,this._curFrameIndex},updateHandler:function(){},isPause:function(){return this._isPause},isComplete:function(){return this._isComplete},getCurrentPercent:function(){return this._currentPercent},getRawDuration:function(){return this._rawDuration},getLoop:function(){return this._loopType},getTweenEasing:function(){return this._tweenEasing},getAnimationInternal:function(){return this.animationInternal},setAnimationInternal:function(a){this.animationInternal=a},getProcessScale:function(){return this._processScale},setProcessScale:function(a){this._processScale=a},isPlaying:function(){return this._isPlaying}});var _p=ccs.ProcessBase.prototype;_p.currentFrameIndex,cc.defineGetterSetter(_p,"currentFrameIndex",_p.getCurrentFrameIndex),_p.paused,cc.defineGetterSetter(_p,"paused",_p.isPause),_p.completed,cc.defineGetterSetter(_p,"completed",_p.isComplete),_p.currentPercent,cc.defineGetterSetter(_p,"currentPercent",_p.getCurrentPercent),_p.rawDuration,cc.defineGetterSetter(_p,"rawDuration",_p.getRawDuration),_p.loop,cc.defineGetterSetter(_p,"loop",_p.getLoop),_p.tweenEasing,cc.defineGetterSetter(_p,"tweenEasing",_p.getTweenEasing),_p.playing,cc.defineGetterSetter(_p,"playing",_p.isPlaying),_p=null,ccs.MovementEventType={start:0,complete:1,loopComplete:2},ccs.AnimationEvent=ccs.Class.extend({_arguments:null,_callFunc:null,_selectorTarget:null,ctor:function(a,b,c){this._data=c,this._callFunc=a,this._selectorTarget=b},call:function(){this._callFunc&&this._callFunc.apply(this._selectorTarget,this._arguments)},setArguments:function(a){this._arguments=a}}),ccs.MovementEvent=function(){this.armature=null,this.movementType=ccs.MovementEventType.start,this.movementID=""},ccs.FrameEvent=function(){this.bone=null,this.frameEventName="",this.originFrameIndex=0,this.currentFrameIndex=0},ccs.ArmatureAnimation=ccs.ProcessBase.extend({_animationData:null,_movementData:null,_armature:null,_movementID:"",_toIndex:0,_tweenList:null,_speedScale:1,_ignoreFrameEvent:!1,_frameEventQueue:null,_movementEventQueue:null,_movementList:null,_onMovementList:!1,_movementListLoop:!1,_movementIndex:0,_movementListDurationTo:-1,_movementEventCallFunc:null,_frameEventCallFunc:null,_movementEventTarget:null,_frameEventTarget:null,_movementEventListener:null,_frameEventListener:null,ctor:function(){ccs.ProcessBase.prototype.ctor.call(this),this._tweenList=[],this._movementList=[],this._frameEventQueue=[],this._movementEventQueue=[]},init:function(a){return this._armature=a,this._tweenList.length=0,!0},pause:function(){for(var a=this._tweenList,b=0;b<a.length;b++)a[b].pause();ccs.ProcessBase.prototype.pause.call(this)},resume:function(){for(var a=this._tweenList,b=0;b<a.length;b++)a[b].resume();ccs.ProcessBase.prototype.resume.call(this)},stop:function(){for(var a=this._tweenList,b=0;b<a.length;b++)a[b].stop();a.length=0,ccs.ProcessBase.prototype.stop.call(this)},setAnimationScale:function(a){this.setSpeedScale(a)},getAnimationScale:function(){return this.getSpeedScale()},setSpeedScale:function(a){if(a!=this._speedScale){this._speedScale=a,this._processScale=this._movementData?this._speedScale*this._movementData.scale:this._speedScale;var b=this._armature.getBoneDic();for(var c in b){var d=b[c];d.getTween().setProcessScale(this._processScale),d.getChildArmature()&&d.getChildArmature().getAnimation().setSpeedScale(this._processScale)}}},getSpeedScale:function(){return this._speedScale},play:function(a,b,c){cc.assert(this._animationData,"this.animationData can not be null"),this._movementData=this._animationData.getMovement(a),cc.assert(this._movementData,"this._movementData can not be null"),b=void 0===b?-1:b,c=void 0===c?-1:c,this._rawDuration=this._movementData.duration,this._movementID=a,this._processScale=this._speedScale*this._movementData.scale,b=-1==b?this._movementData.durationTo:b;var d=0==this._movementData.durationTween?this._rawDuration:this._movementData.durationTween,e=this._movementData.tweenEasing;c=0>c?this._movementData.loop:c,this._onMovementList=!1,ccs.ProcessBase.prototype.play.call(this,b,d,c,e),0==this._rawDuration?this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME:(this._loopType=c?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._durationTween=d);var f;this._tweenList=[];var g=this._armature.getBoneDic();for(var h in g){var i=g[h];f=this._movementData.movBoneDataDic[i.getName()];var j=i.getTween();f&&f.frameList.length>0?(this._tweenList.push(j),f.duration=this._movementData.duration,j.play(f,b,d,c,e),j.setProcessScale(this._processScale),i.getChildArmature()&&i.getChildArmature().getAnimation().setSpeedScale(this._processScale)):i.isIgnoreMovementBoneData()||(i.getDisplayManager().changeDisplayWithIndex(-1,!1),j.stop())}this._armature.update(0)},playByIndex:function(a,b,c,d){cc.log("playByIndex is deprecated. Use playWithIndex instead."),this.playWithIndex(a,b,d)},playWithIndex:function(a,b,c){var d=this._animationData.movementNames;cc.assert(a>-1&&a<d.length);var e=d[a];this.play(e,b,c)},playWithNames:function(a,b,c){b=void 0===b?-1:b,c=void 0===c?!0:c,this._movementListLoop=c,this._movementListDurationTo=b,this._onMovementList=!0,this._movementIndex=0,a instanceof Array?this._movementList=a:this._movementList.length=0,this.updateMovementList()},playWithIndexes:function(a,b,c){b=void 0===b?-1:b,c=void 0===c?!0:c,this._movementList.length=0,this._movementListLoop=c,this._movementListDurationTo=b,this._onMovementList=!0,this._movementIndex=0;for(var d=this._animationData.movementNames,e=0;e<a.length;e++){var f=d[a[e]];this._movementList.push(f)}this.updateMovementList()},gotoAndPlay:function(a){if(!this._movementData||0>a||a>=this._movementData.duration)return void cc.log("Please ensure you have played a movement, and the frameIndex is in the range.");var b=this._ignoreFrameEvent;this._ignoreFrameEvent=!0,this._isPlaying=!0,this._isComplete=this._isPause=!1,ccs.ProcessBase.prototype.gotoFrame.call(this,a),this._currentPercent=this._curFrameIndex/(this._movementData.duration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent;for(var c=this._tweenList,d=0;d<c.length;d++)c[d].gotoAndPlay(a);this._armature.update(0),this._ignoreFrameEvent=b},gotoAndPause:function(a){this.gotoAndPlay(a),this.pause()},getMovementCount:function(){return this._animationData.getMovementCount()
},update:function(a){ccs.ProcessBase.prototype.update.call(this,a);for(var b=this._tweenList,c=0;c<b.length;c++)b[c].update(a);for(var d,e=this._frameEventQueue;e.length>0;)d=e.shift(),this._ignoreFrameEvent=!0,this._frameEventCallFunc&&this._frameEventCallFunc.call(this._frameEventTarget,d.bone,d.frameEventName,d.originFrameIndex,d.currentFrameIndex),this._frameEventListener&&this._frameEventListener(d.bone,d.frameEventName,d.originFrameIndex,d.currentFrameIndex),this._ignoreFrameEvent=!1;for(var f=this._movementEventQueue;f.length>0;)d=f.shift(),this._movementEventCallFunc&&this._movementEventCallFunc.call(this._movementEventTarget,d.armature,d.movementType,d.movementID),this._movementEventListener&&this._movementEventListener(d.armature,d.movementType,d.movementID)},updateHandler:function(){var a=this._currentPercent;if(a>=1){switch(this._loopType){case ccs.ANIMATION_TYPE_NO_LOOP:if(this._loopType=ccs.ANIMATION_TYPE_MAX,this._currentFrame=(a-1)*this._nextFrameIndex,a=this._currentFrame/this._durationTween,1>a){this._nextFrameIndex=this._durationTween,this.movementEvent(this._armature,ccs.MovementEventType.start,this._movementID);break}break;case ccs.ANIMATION_TYPE_MAX:case ccs.ANIMATION_TYPE_SINGLE_FRAME:a=1,this._isComplete=!0,this._isPlaying=!1,this.movementEvent(this._armature,ccs.MovementEventType.complete,this._movementID),this.updateMovementList();break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:this._loopType=ccs.ANIMATION_TYPE_LOOP_FRONT,a=ccs.fmodf(a,1),this._currentFrame=0==this._nextFrameIndex?0:ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._nextFrameIndex=this._durationTween>0?this._durationTween:1,this.movementEvent(this,ccs.MovementEventType.start,this._movementID);break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._toIndex=0,this.movementEvent(this._armature,ccs.MovementEventType.loopComplete,this._movementID)}this._currentPercent=a}},getCurrentMovementID:function(){return this._isComplete?"":this._movementID},setMovementEventCallFunc:function(a,b){1==arguments.length?this._frameEventListener=b:2==arguments.length&&(this._movementEventTarget=b,this._movementEventCallFunc=a)},setFrameEventCallFunc:function(a,b){1==arguments.length?this._frameEventListener=b:2==arguments.length&&(this._frameEventTarget=b,this._frameEventCallFunc=a)},setUserObject:function(a){this._userObject=a},frameEvent:function(a,b,c,d){if(this._frameEventTarget&&this._frameEventCallFunc||this._frameEventListener){var e=new ccs.FrameEvent;e.bone=a,e.frameEventName=b,e.originFrameIndex=c,e.currentFrameIndex=d,this._frameEventQueue.push(e)}},movementEvent:function(a,b,c){if(this._movementEventTarget&&this._movementEventCallFunc||this._movementEventListener){var d=new ccs.MovementEvent;d.armature=a,d.movementType=b,d.movementID=c,this._movementEventQueue.push(d)}},updateMovementList:function(){if(this._onMovementList){var a,b=this._movementList;this._movementListLoop?(a=b[this._movementIndex],this.play(a,a.durationTo,0),this._movementIndex++,this._movementIndex>=b.length&&(this._movementIndex=0)):this._movementIndex<b.length?(a=b[this._movementIndex],this.play(a,a.durationTo,0),this._movementIndex++):this._onMovementList=!1,this._onMovementList=!0}},setAnimationData:function(a){this._animationData!=a&&(this._animationData=a)},getAnimationData:function(){return this._animationData},getUserObject:function(){return this._userObject},isIgnoreFrameEvent:function(){return this._ignoreFrameEvent}});var _p=ccs.ArmatureAnimation.prototype;_p.speedScale,cc.defineGetterSetter(_p,"speedScale",_p.getSpeedScale,_p.setSpeedScale),_p.animationScale,cc.defineGetterSetter(_p,"animationScale",_p.getAnimationScale,_p.setAnimationScale),_p=null,ccs.ArmatureAnimation.create=function(a){var b=new ccs.ArmatureAnimation;return b&&b.init(a)?b:null},ccs.Tween=ccs.ProcessBase.extend({_tweenData:null,_to:null,_from:null,_between:null,_movementBoneData:null,_bone:null,_frameTweenEasing:0,_betweenDuration:0,_totalDuration:0,_toIndex:0,_fromIndex:0,_animation:null,_passLastFrame:!1,ctor:function(){ccs.ProcessBase.prototype.ctor.call(this),this._frameTweenEasing=ccs.TweenType.linear},init:function(a){return this._from=new ccs.FrameData,this._between=new ccs.FrameData,this._bone=a,this._tweenData=this._bone.getTweenData(),this._tweenData.displayIndex=-1,this._animation=null!=this._bone.getArmature()?this._bone.getArmature().getAnimation():null,!0},play:function(a,b,c,d,e){ccs.ProcessBase.prototype.play.call(this,b,c,d,e),this._loopType=d?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;var f=a!=this._movementBoneData;this.setMovementBoneData(a),this._rawDuration=this._movementBoneData.duration;var g=this._movementBoneData.getFrameData(0);this._tweenData.displayIndex=g.displayIndex,this._bone.getArmature().getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeSub(this._tweenData,this._bone.getBoneData()),this._tweenData.scaleX+=1,this._tweenData.scaleY+=1),0==this._rawDuration?(this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME,0==b?this.setBetween(g,g):this.setBetween(this._tweenData,g),this._frameTweenEasing=ccs.TweenType.linear):this._movementBoneData.frameList.length>1&&(this._durationTween=c*this._movementBoneData.scale,d&&0!=this._movementBoneData.delay?this.setBetween(this._tweenData,this.tweenNodeTo(this.updateFrameData(1-this._movementBoneData.delay),this._between)):f&&0!=b?this.setBetween(this._tweenData,g):this.setBetween(g,g)),this.tweenNodeTo(0)},gotoAndPlay:function(a){ccs.ProcessBase.prototype.gotoFrame.call(this,a),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0,this._isPlaying=!0,this._isComplete=this._isPause=!1,this._currentPercent=this._curFrameIndex/(this._rawDuration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent},gotoAndPause:function(a){this.gotoAndPlay(a),this.pause()},updateHandler:function(){var a=this._currentPercent||1,b=this._loopType;if(a>=1)switch(b){case ccs.ANIMATION_TYPE_SINGLE_FRAME:a=1,this._isComplete=!0,this._isPlaying=!1;break;case ccs.ANIMATION_TYPE_NO_LOOP:if(b=ccs.ANIMATION_TYPE_MAX,a=this._durationTween<=0?1:(a-1)*this._nextFrameIndex/this._durationTween,a>=1){a=1,this._isComplete=!0,this._isPlaying=!1;break}this._nextFrameIndex=this._durationTween,this._currentFrame=a*this._nextFrameIndex,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:b=ccs.ANIMATION_TYPE_LOOP_FRONT,this._nextFrameIndex=this._durationTween>0?this._durationTween:1,0!=this._movementBoneData.delay?(this._currentFrame=(1-this._movementBoneData.delay)*this._nextFrameIndex,a=this._currentFrame/this._nextFrameIndex):(a=0,this._currentFrame=0),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_MAX:a=1,this._isComplete=!0,this._isPlaying=!1;break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex)}1>a&&b<ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(a=Math.sin(a*cc.PI/2)),this._currentPercent=a,this._loopType=b,b>ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(a=this.updateFrameData(a)),this._frameTweenEasing!=ccs.TweenType.tweenEasingMax&&this.tweenNodeTo(a)},setBetween:function(a,b,c){void 0===c&&(c=!0);do{if(a.displayIndex<0&&b.displayIndex>=0){this._from.copy(b),this._between.subtract(b,b,c);break}if(b.displayIndex<0&&a.displayIndex>=0){this._from.copy(a),this._between.subtract(b,b,c);break}this._from.copy(a),this._between.subtract(a,b,c)}while(0);a.isTween||(this._tweenData.copy(a),this._tweenData.isTween=!0),this.arriveKeyFrame(a)},arriveKeyFrame:function(a){if(a){var b=this._bone,c=b.getDisplayManager(),d=a.displayIndex;c.getForceChangeDisplay()||c.changeDisplayWithIndex(d,!1),this._tweenData.zOrder=a.zOrder,b.updateZOrder(),this._bone.setBlendFunc(a.blendFunc);var e=b.getChildArmature();e&&""!=a.movement&&e.getAnimation().play(a.movement)}},tweenNodeTo:function(a,b){b||(b=this._tweenData);var c=this._from,d=this._between;return c.isTween||(a=0),b.x=c.x+a*d.x,b.y=c.y+a*d.y,b.scaleX=c.scaleX+a*d.scaleX,b.scaleY=c.scaleY+a*d.scaleY,b.skewX=c.skewX+a*d.skewX,b.skewY=c.skewY+a*d.skewY,this._bone.setTransformDirty(!0),b&&d.isUseColorInfo&&this.tweenColorTo(a,b),b},tweenColorTo:function(a,b){var c=this._from,d=this._between;b.a=c.a+a*d.a,b.r=c.r+a*d.r,b.g=c.g+a*d.g,b.b=c.b+a*d.b,this._bone.updateColor()},updateFrameData:function(a){a>1&&0!=this._movementBoneData.delay&&(a=ccs.fmodf(a,1));var b,c,d=(this._rawDuration-1)*a,e=this._totalDuration,f=this._betweenDuration,g=this._toIndex;if(e>d||d>=e+f){var h=this._movementBoneData.frameList,i=h.length;if(d<h[0].frameID)return b=c=h[0],this.setBetween(b,c),this._currentPercent;if(d>=h[i-1].frameID){if(this._passLastFrame)return b=c=h[i-1],this.setBetween(b,c),this._currentPercent;this._passLastFrame=!0}else this._passLastFrame=!1;do if(this._fromIndex=g,b=h[this._fromIndex],e=b.frameID,g=this._fromIndex+1,g>=i&&(g=0),c=h[g],b.strEvent&&!this._animation.isIgnoreFrameEvent()&&this._animation.frameEvent(this._bone,b.strEvent,b.frameID,d),d==b.frameID||this._passLastFrame&&this._fromIndex==i-1)break;while(d<b.frameID||d>=c.frameID);f=c.frameID-b.frameID,this._frameTweenEasing=b.tweenEasing,this.setBetween(b,c,!1),this._totalDuration=e,this._betweenDuration=f,this._toIndex=g}a=0==f?0:(d-this._totalDuration)/this._betweenDuration;var j=this._frameTweenEasing!=ccs.TweenType.linear?this._frameTweenEasing:this._tweenEasing;return j==ccs.TweenType.tweenEasingMax||j==ccs.TweenType.linear||this._passLastFrame||(a=ccs.TweenFunction.tweenTo(a,j,this._from.easingParams)),a},setAnimation:function(a){this._animation=a},getAnimation:function(){return this._animation},setMovementBoneData:function(a){this._movementBoneData=a}});var _p=ccs.Tween.prototype;_p.animation,cc.defineGetterSetter(_p,"animation",_p.getAnimation,_p.setAnimation),_p=null,ccs.Tween.create=function(a){var b=new ccs.Tween;return b&&b.init(a)?b:null},ccs.PT_RATIO=32,ccs.ColliderFilter=ccs.Class.extend({_collisionType:0,_group:0,_categoryBits:0,_groupIndex:0,_maskBits:0,ctor:function(a,b){this._collisionType=a||0,this._group=b||0},updateShape:function(a){if(a instanceof cp.Shape)a.collision_type=this._collisionType,a.group=this._group;else if(a instanceof Box2D.b2FilterData){var b=new Box2D.b2FilterData;b.categoryBits=this._categoryBits,b.groupIndex=this._groupIndex,b.maskBits=this._maskBits,a.SetFilterData(b)}}}),ccs.ColliderBody=ccs.Class.extend({shape:null,coutourData:null,colliderFilter:null,_calculatedVertexList:null,ctor:function(a){this.shape=null,this.coutourData=a,this.colliderFilter=new ccs.ColliderFilter,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX&&(this._calculatedVertexList=[])},getContourData:function(){return this.coutourData},setColliderFilter:function(a){this.colliderFilter=a},getCalculatedVertexList:function(){return this._calculatedVertexList},setB2Fixture:function(a){this._fixture=a},getB2Fixture:function(){return this._fixture},setShape:function(a){this.shape=a},getShape:function(){return this.shape},setContourData:function(a){this.coutourData=a},getColliderFilter:function(){return this.colliderFilter}}),ccs.ColliderDetector=ccs.Class.extend({_colliderBodyList:null,_bone:null,_body:null,_active:!1,_filter:null,helpPoint:cc.p(0,0),ctor:function(){this._colliderBodyList=[],this._bone=null,this._body=null,this._active=!1,this._filter=null},init:function(a){return this._colliderBodyList.length=0,a&&(this._bone=a),this._filter=new ccs.ColliderFilter,!0},addContourData:function(a){var b=new ccs.ColliderBody(a);if(this._colliderBodyList.push(b),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)for(var c=b.getCalculatedVertexList(),d=a.vertexList,e=0;e<d.length;e++){var f=new ccs.ContourVertex2(0,0);c.push(f)}},addContourDataList:function(a){for(var b=0;b<a.length;b++)this.addContourData(a[b])},removeContourData:function(a){var b,c=[],d=this._colliderBodyList;for(b=0;b<d.length;b++){var e=d[b];e&&e.getContourData()==a&&c.push(e)}for(b=0;b<c.length;b++)cc.arrayRemoveObject(d,c[b])},removeAll:function(){this._colliderBodyList.length=0},setActive:function(a){if(this._active!=a){this._active=a;var b,c=this._body;if(c){var d=null;if(this._active)for(var e=0;e<this._colliderBodyList.length;e++)d=this._colliderBodyList[e],b=d.getShape(),c.space.addShape(b);else for(var e=0;e<this._colliderBodyList.length;e++)d=this._colliderBodyList[e],b=d.getShape(),c.space.removeShape(b)}}},getActive:function(){return this._active},getColliderBodyList:function(){return this._colliderBodyList},setColliderFilter:function(a){this._filter=a;for(var b=this._colliderBodyList,c=0;c<b.length;c++){var d=b[c];d.setColliderFilter(a),d.getShape()&&d.getColliderFilter().updateShape(d.getShape())}},getColliderFilter:function(){return this._filter},updateTransform:function(a){if(this._active)for(var b=null,c=this._body,d=this.helpPoint,e=0;e<this._colliderBodyList.length;e++){b=this._colliderBodyList[e];var f=b.getContourData(),g=null;c&&(g=b.getShape());for(var h=f.vertexList,i=b.getCalculatedVertexList(),j=0;j<h.length;j++){if(d.x=h[j].x,d.y=h[j].y,d=cc.pointApplyAffineTransform(d,a),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX){var k=cc.p(0,0);k.x=d.x,k.y=d.y,i[j]=k}g&&(g.verts[2*j]=d.x,g.verts[2*j+1]=d.y)}if(g)for(var j=0;j<h.length;j++){var l=g.verts[(j+1)%g.verts.length],m=cp.v.normalize(cp.v.perp(cp.v.sub(l,g.verts[j])));g.planes&&(g.planes[j].n=m,g.planes[j].d=cp.v.dot(m,g.verts[j]))}}},setBody:function(a){this._body=a;for(var b,c=this._colliderBodyList,d=0;d<c.length;d++){b=c[d];for(var e=b.getContourData(),f=[],g=e.vertexList,h=0;h<g.length;h++){var i=g[h];f.push(i.x),f.push(i.y)}var j=new cp.PolyShape(this._body,f,cp.vzero);j.sensor=!0,j.data=this._bone,this._active&&this._body.space.addShape(j),b.setShape(j),b.getColliderFilter().updateShape(j)}},getBody:function(){return this._body}});var _p=ccs.ColliderDetector.prototype;_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p.active,cc.defineGetterSetter(_p,"active",_p.getActive,_p.setActive),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p=null,ccs.ColliderDetector.create=function(a){var b=new ccs.ColliderDetector;return b&&b.init(a)?b:null},ccs.Armature=ccs.Node.extend({animation:null,armatureData:null,batchNode:null,_textureAtlas:null,_parentBone:null,_boneDic:null,_topBoneList:null,_armatureIndexDic:null,_offsetPoint:null,version:0,_armatureTransformDirty:!0,_body:null,_blendFunc:null,_className:"Armature",_realAnchorPointInPoints:null,ctor:function(a,b){cc.Node.prototype.ctor.call(this),this._name="",this._topBoneList=[],this._armatureIndexDic={},this._offsetPoint=cc.p(0,0),this._armatureTransformDirty=!0,this._realAnchorPointInPoints=cc.p(0,0),a&&ccs.Armature.prototype.init.call(this,a,b)},_initRendererCmd:function(){cc._renderType===cc._RENDER_TYPE_CANVAS?(this._rendererStartCmd=new cc.CustomRenderCmdCanvas(this,this._startRendererCmdForCanvas),this._rendererEndCmd=new cc.CustomRenderCmdCanvas(this,this._endRendererCmdForCanvas)):this._rendererCmd=new cc.ArmatureRenderCmdWebGL(this)},init:function(a,b){cc.Node.prototype.init.call(this),b&&(this._parentBone=b),this.removeAllChildren(),this.animation=new ccs.ArmatureAnimation,this.animation.init(this),this._boneDic={},this._topBoneList.length=0,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._name=a||"";var c,d=ccs.armatureDataManager;if(""!=a){c=d.getAnimationData(a),cc.assert(c,"AnimationData not exist!"),this.animation.setAnimationData(c);var e=d.getArmatureData(a);cc.assert(e,"ArmatureData not exist!"),this.armatureData=e;var f=e.getBoneDataDic();for(var g in f){var h=this.createBone(String(g));do{var i=c.getMovement(c.movementNames[0]);if(!i)break;var j=i.getMovementBoneData(h.getName());if(!j||j.frameList.length<=0)break;var k=j.getFrameData(0);if(!k)break;h.getTweenData().copy(k),h.changeDisplayWithIndex(k.displayIndex,!1)}while(0)}this.update(0),this.updateOffsetPoint()}else this._name="new_armature",this.armatureData=ccs.ArmatureData.create(),this.armatureData.name=this._name,c=ccs.AnimationData.create(),c.name=this._name,d.addArmatureData(this._name,this.armatureData),d.addAnimationData(this._name,c),this.animation.setAnimationData(c);return cc._renderType===cc._RENDER_TYPE_WEBGL&&this.setShaderProgram(cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),!0},createBone:function(a){var b=this.getBone(a);if(b)return b;var c=this.armatureData.getBoneData(a),d=c.parentName,e=null;return d?(this.createBone(d),e=ccs.Bone.create(a),this.addBone(e,d)):(e=ccs.Bone.create(a),this.addBone(e,"")),e.setBoneData(c),e.getDisplayManager().changeDisplayWithIndex(-1,!1),e},addBone:function(a,b){cc.assert(a,"Argument must be non-nil");var c=this._boneDic;if(a.getName()&&cc.assert(!c[a.getName()],"bone already added. It can't be added again"),b){var d=c[b];d?d.addChildBone(a):this._topBoneList.push(a)}else this._topBoneList.push(a);a.setArmature(this),c[a.getName()]=a,this.addChild(a)},removeBone:function(a,b){cc.assert(a,"bone must be added to the bone dictionary!"),a.setArmature(null),a.removeFromParent(b),cc.arrayRemoveObject(this._topBoneList,a),delete this._boneDic[a.getName()],this.removeChild(a,!0)},getBone:function(a){return this._boneDic[a]},changeBoneParent:function(a,b){cc.assert(a,"bone must be added to the bone dictionary!");var c=a.getParentBone();if(c&&(cc.arrayRemoveObject(c.getChildren(),a),a.setParentBone(null)),b){var d=this._boneDic[b];d?(d.addChildBone(a),cc.arrayRemoveObject(this._topBoneList,a)):this._topBoneList.push(a)}},getBoneDic:function(){return this._boneDic},updateOffsetPoint:function(){var a=this.getBoundingBox();this.setContentSize(a);var b=this._offsetPoint;b.x=-a.x,b.y=-a.y,0!=a.width&&0!=a.height&&this.setAnchorPoint(b.x/a.width,b.y/a.height)},setAnchorPoint:function(a,b){var c,d;void 0!==b?(c=a,d=b):(c=a.x,d=a.y);var e=this._anchorPoint;if(c!=e.x||d!=e.y){var f=this._contentSize;e.x=c,e.y=d,this._anchorPointInPoints.x=f.width*e.x-this._offsetPoint.x,this._anchorPointInPoints.y=f.height*e.y-this._offsetPoint.y,this._realAnchorPointInPoints.x=f.width*e.x,this._realAnchorPointInPoints.y=f.height*e.y,this.setNodeDirty()}},_setAnchorX:function(a){this._anchorPoint.x!==a&&(this._anchorPoint.x=a,this._anchorPointInPoints.x=this._contentSize.width*a-this._offsetPoint.x,this._realAnchorPointInPoints.x=this._contentSize.width*a,this.setNodeDirty())},_setAnchorY:function(a){this._anchorPoint.y!==a&&(this._anchorPoint.y=a,this._anchorPointInPoints.y=this._contentSize.height*a-this._offsetPoint.y,this._realAnchorPointInPoints.y=this._contentSize.height*a,this.setNodeDirty())},getAnchorPointInPoints:function(){return this._realAnchorPointInPoints},setAnimation:function(a){this.animation=a},getAnimation:function(){return this.animation},getArmatureTransformDirty:function(){return this._armatureTransformDirty},update:function(a){this.animation.update(a);for(var b=this._topBoneList,c=0;c<b.length;c++)b[c].update(a);this._armatureTransformDirty=!1},draw:function(a){null==this._parentBone&&null==this._batchNode;for(var b=this._children,c=cc.BlendFunc.ALPHA_PREMULTIPLIED,d=cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,e=0,f=b.length;f>e;e++){var g=b[e];if(g&&g.getDisplayRenderNode){var h=g.getDisplayRenderNode();if(null==h)continue;switch(cc._renderType===cc._RENDER_TYPE_WEBGL&&h.setShaderProgram(this._shaderProgram),g.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:if(h instanceof ccs.Skin)if(cc._renderType===cc._RENDER_TYPE_WEBGL){h.updateTransform();var i=g.getBlendFunc();h.setBlendFunc(i.src!=c.src||i.dst!=c.dst?g.getBlendFunc():this._blendFunc.src!=c.src||this._blendFunc.dst!=c.dst||h.getTexture().hasPremultipliedAlpha()?this._blendFunc:d),h.draw(a)}else h.visit(a);break;case ccs.DISPLAY_TYPE_ARMATURE:h.draw(a);break;default:h.visit(a)}}else g instanceof cc.Node&&(cc._renderType===cc._RENDER_TYPE_WEBGL&&g.setShaderProgram(this._shaderProgram),g.visit(a))}},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){cc.Node.prototype.onExit.call(this),this.unscheduleUpdate()},visit:null,_visitForCanvas:function(a){var b=a||cc._renderContext;this._visible&&(b.save(),this.transform(b),this.sortAllChildren(),this._rendererStartCmd&&cc.renderer.pushRenderCommand(this._rendererStartCmd),this.draw(a),this._rendererEndCmd&&cc.renderer.pushRenderCommand(this._rendererEndCmd),this._cacheDirty=!1,b.restore())},_startRendererCmdForCanvas:function(a,b,c){var d=a||cc._renderContext;d.save(),this.transform(d);var e=this._transformWorld;a.transform(e.a,e.b,e.c,e.d,e.tx*b,-e.ty*c);for(var f=this._children,g=0,h=f.length;h>g;g++){var i=f[g];if(i&&i.getDisplayRenderNode){var j=i.getDisplayRenderNode();if(null==j)continue;j._transformForRenderer()}}},_endRendererCmdForCanvas:function(a){var b=a||cc._renderContext;this._cacheDirty=!1,b.restore()},_visitForWebGL:function(){if(this._visible){var a=(cc._renderContext,cc.current_stack);a.stack.push(a.top),cc.kmMat4Assign(this._stackMatrix,a.top),a.top=this._stackMatrix,this.transform(),this.sortAllChildren(),cc.renderer.pushRenderCommand(this._rendererCmd),a.top=a.stack.pop()}},getBoundingBox:function(){for(var a,b,c,d=0,e=!0,f=cc.rect(0,0,0,0),g=this._children,h=g.length,i=0;h>i;i++){var j=g[i];if(j){var k=j.getDisplayManager().getBoundingBox();if(0==k.x&&0==k.y&&0==k.width&&0==k.height)continue;e?(a=k.x,b=k.y,c=k.x+k.width,d=k.y+k.height,e=!1):(a=k.x<f.x?k.x:f.x,b=k.y<f.y?k.y:f.y,c=k.x+k.width>f.x+f.width?k.x+k.width:f.x+f.width,d=k.y+k.height>f.y+f.height?k.y+k.height:f.y+f.height),f.x=a,f.y=b,f.width=c-a,f.height=d-b}}return cc.rectApplyAffineTransform(f,this.getNodeToParentTransform())},getBoneAtPoint:function(a,b){for(var c=this._children,d=c.length-1;d>=0;d--){var e=c[d];if(e instanceof ccs.Bone&&e.getDisplayManager().containPoint(a,b))return e}return null},setParentBone:function(a){this._parentBone=a;var b=this._boneDic;for(var c in b)b[c].setArmature(this)},getParentBone:function(){return this._parentBone},drawContour:function(){cc._drawingUtil.setDrawColor(255,255,255,255),cc._drawingUtil.setLineWidth(1);var a=this._boneDic;for(var b in a){var c=a[b],d=c.getColliderDetector();if(d)for(var e=d.getColliderBodyList(),f=0;f<e.length;f++){var g=e[f],h=g.getCalculatedVertexList();cc._drawingUtil.drawPoly(h,h.length,!0)}}},setBody:function(a){if(this._body!=a){this._body=a,this._body.data=this;for(var b,c,d=this._children,e=0;e<d.length;e++)if(b=d[e],b instanceof ccs.Bone)for(var f=b.getDisplayManager().getDecorativeDisplayList(),g=0;g<f.length;g++){c=f[g];var h=c.getColliderDetector();h&&h.setBody(this._body)}}},getShapeList:function(){return this._body?this._body.shapeList:null},getBody:function(){return this._body},setBlendFunc:function(a){this._blendFunc=a},getBlendFunc:function(){return this._blendFunc},setColliderFilter:function(a){var b=this._boneDic;for(var c in b)b[c].setColliderFilter(a)},getArmatureData:function(){return this.armatureData},setArmatureData:function(a){this.armatureData=a},getBatchNode:function(){return this.batchNode},setBatchNode:function(a){this.batchNode=a},getVersion:function(){return this.version},setVersion:function(a){this.version=a},_transformForRenderer:function(){ccs.Node.prototype._transformForRenderer.call(this);for(var a=this._children,b=0,c=a.length;c>b;b++){var d=a[b];if(d&&d.getDisplayRenderNode){var e=d.getDisplayRenderNode();if(null==e)continue;e._transformForRenderer()}}}}),ccs.Armature.prototype.visit=cc._renderType==cc._RENDER_TYPE_WEBGL?ccs.Armature.prototype._visitForWebGL:ccs.Armature.prototype._visitForCanvas;var _p=ccs.Armature.prototype;_p.parentBone,cc.defineGetterSetter(_p,"parentBone",_p.getParentBone,_p.setParentBone),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",null,_p.setColliderFilter),_p=null,ccs.Armature.create=function(a,b){var c=new ccs.Armature;return c.init(a,b)?c:null},ccs.Bone=ccs.Node.extend({_boneData:null,_armature:null,_childArmature:null,_displayManager:null,ignoreMovementBoneData:!1,_tween:null,_tweenData:null,_parentBone:null,_boneTransformDirty:!1,_worldTransform:null,_blendFunc:null,blendDirty:!1,_worldInfo:null,_armatureParentBone:null,_dataVersion:0,_className:"Bone",ctor:function(){cc.Node.prototype.ctor.call(this),this._tweenData=null,this._parentBone=null,this._armature=null,this._childArmature=null,this._boneData=null,this._tween=null,this._displayManager=null,this.ignoreMovementBoneData=!1,this._worldTransform=cc.affineTransformMake(1,0,0,1,0,0),this._boneTransformDirty=!0,this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.blendDirty=!1,this._worldInfo=null,this._armatureParentBone=null,this._dataVersion=0},init:function(a){return a&&(this._name=a),this._tweenData=new ccs.FrameData,this._tween=new ccs.Tween,this._tween.init(this),this._displayManager=new ccs.DisplayManager,this._displayManager.init(this),this._worldInfo=new ccs.BaseData,this._boneData=new ccs.BaseData,!0},setBoneData:function(a){cc.assert(a,"_boneData must not be null"),this._boneData!=a&&(this._boneData=a),this.setName(this._boneData.name),this._localZOrder=this._boneData.zOrder,this._displayManager.initDisplayList(a)},getBoneData:function(){return this._boneData},setArmature:function(a){this._armature=a,a?(this._tween.setAnimation(this._armature.getAnimation()),this._dataVersion=this._armature.getArmatureData().dataVersion,this._armatureParentBone=this._armature.getParentBone()):this._armatureParentBone=null},getArmature:function(){return this._armature},update:function(a){if(this._parentBone&&(this._boneTransformDirty=this._boneTransformDirty||this._parentBone.isTransformDirty()),this._armatureParentBone&&!this._boneTransformDirty&&(this._boneTransformDirty=this._armatureParentBone.isTransformDirty()),this._boneTransformDirty){var b=this._tweenData;this._dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeConcat(b,this._boneData),b.scaleX-=1,b.scaleY-=1);var c=this._worldInfo;c.copy(b),c.x=b.x+this._position.x,c.y=b.y+this._position.y,c.scaleX=b.scaleX*this._scaleX,c.scaleY=b.scaleY*this._scaleY,c.skewX=b.skewX+this._skewX+this._rotationX,c.skewY=b.skewY+this._skewY-this._rotationY,this._parentBone?this._applyParentTransform(this._parentBone):this._armatureParentBone&&this._applyParentTransform(this._armatureParentBone),ccs.TransformHelp.nodeToMatrix(c,this._worldTransform),this._armatureParentBone&&(this._worldTransform=cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToParentTransform()))}ccs.displayFactory.updateDisplay(this,a,this._boneTransformDirty||this._armature.getArmatureTransformDirty());for(var d=0;d<this._children.length;d++){var e=this._children[d];e.update(a)}this._boneTransformDirty=!1},_applyParentTransform:function(a){var b=this._worldInfo,c=a._worldTransform,d=a._worldInfo,e=b.x,f=b.y;b.x=e*c.a+f*c.c+d.x,b.y=e*c.b+f*c.d+d.y,b.scaleX=b.scaleX*d.scaleX,b.scaleY=b.scaleY*d.scaleY,b.skewX=b.skewX+d.skewX,b.skewY=b.skewY+d.skewY},setBlendFunc:function(a,b){var c,d,e=this._blendFunc;void 0===b?(c=a.src,d=a.dst):(c=a,d=b),(e.src!=c||e.dst!=d)&&(e.src=c,e.dst=d,this.blendDirty=!0)},updateDisplayedColor:function(a){this._realColor=cc.color(255,255,255),cc.Node.prototype.updateDisplayedColor.call(this,a),this.updateColor()},updateDisplayedOpacity:function(a){this._realOpacity=255,cc.Node.prototype.updateDisplayedOpacity.call(this,a),this.updateColor()},updateColor:function(){var a=this._displayManager.getDisplayRenderNode();null!=a&&(a.setColor(cc.color(this._displayedColor.r*this._tweenData.r/255,this._displayedColor.g*this._tweenData.g/255,this._displayedColor.b*this._tweenData.b/255)),a.setOpacity(this._displayedOpacity*this._tweenData.a/255))},updateZOrder:function(){if(this._armature.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED){var a=this._tweenData.zOrder+this._boneData.zOrder;this.setLocalZOrder(a)}else this.setLocalZOrder(this._tweenData.zOrder)},addChildBone:function(a){cc.assert(a,"Argument must be non-nil"),cc.assert(!a.parentBone,"child already added. It can't be added again"),this._children.indexOf(a)<0&&(this._children.push(a),a.setParentBone(this))},removeChildBone:function(a,b){if(this._children.length>0&&-1!=this._children.getIndex(a)){if(b)for(var c=a._children,d=0;d<c.length;d++){var e=c[d];a.removeChildBone(e,b)}a.setParentBone(null),a.getDisplayManager().setCurrentDecorativeDisplay(null),cc.arrayRemoveObject(this._children,a)}},removeFromParent:function(a){this._parentBone&&this._parentBone.removeChildBone(this,a)},setParentBone:function(a){this._parentBone=a},getParentBone:function(){return this._parentBone},setChildArmature:function(a){this._childArmature!=a&&(null==a&&this._childArmature&&this._childArmature.setParentBone(null),this._childArmature=a)},getChildArmature:function(){return this._childArmature},getTween:function(){return this._tween},setLocalZOrder:function(a){this._localZOrder!=a&&cc.Node.prototype.setLocalZOrder.call(this,a)},getNodeToArmatureTransform:function(){return this._worldTransform},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToWorldTransform())},getDisplayRenderNode:function(){return this._displayManager.getDisplayRenderNode()},getDisplayRenderNodeType:function(){return this._displayManager.getDisplayRenderNodeType()},addDisplay:function(a,b){return b=b||0,this._displayManager.addDisplay(a,b)},removeDisplay:function(a){this._displayManager.removeDisplay(a)},changeDisplayByIndex:function(a,b){cc.log("changeDisplayByIndex is deprecated. Use changeDisplayWithIndex instead."),this.changeDisplayWithIndex(a,b)},changeDisplayByName:function(a,b){cc.log("changeDisplayByName is deprecated. Use changeDisplayWithName instead."),this.changeDisplayWithName(a,b)},changeDisplayWithIndex:function(a,b){this._displayManager.changeDisplayWithIndex(a,b)},changeDisplayWithName:function(a,b){this._displayManager.changeDisplayWithName(a,b)},getColliderDetector:function(){var a=this._displayManager.getCurrentDecorativeDisplay();if(a){var b=a.getColliderDetector();if(b)return b}return null},setColliderFilter:function(a){for(var b=this._displayManager.getDecorativeDisplayList(),c=0;c<b.length;c++){var d=b[c],e=d.getColliderDetector();e&&e.setColliderFilter(a)}},getColliderFilter:function(){var a=this.displayManager.getCurrentDecorativeDisplay();if(a){var b=a.getColliderDetector();if(b)return b.getColliderFilter()}return null},setTransformDirty:function(a){this._boneTransformDirty=a},isTransformDirty:function(){return this._boneTransformDirty},getDisplayManager:function(){return this._displayManager},setIgnoreMovementBoneData:function(a){this._ignoreMovementBoneData=a},isIgnoreMovementBoneData:function(){return this._ignoreMovementBoneData},getBlendFunc:function(){return this._blendFunc},setBlendDirty:function(a){this._blendDirty=a},isBlendDirty:function(){return this._blendDirty},getTweenData:function(){return this._tweenData},getWorldInfo:function(){return this._worldInfo},getChildrenBone:function(){return this._children},nodeToArmatureTransform:function(){return this.getNodeToArmatureTransform()},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getColliderBodyList:function(){var a=this.getColliderDetector();return a?a.getColliderBodyList():null},getIgnoreMovementBoneData:function(){return this.isIgnoreMovementBoneData()}});var _p=ccs.Bone.prototype;_p.boneData,cc.defineGetterSetter(_p,"boneData",_p.getBoneData,_p.setBoneData),_p.armature,cc.defineGetterSetter(_p,"armature",_p.getArmature,_p.setArmature),_p.childArmature,cc.defineGetterSetter(_p,"childArmature",_p.getChildArmature,_p.setChildArmature),_p.childrenBone,cc.defineGetterSetter(_p,"childrenBone",_p.getChildrenBone),_p.tween,cc.defineGetterSetter(_p,"tween",_p.getTween),_p.tweenData,cc.defineGetterSetter(_p,"tweenData",_p.getTweenData),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p=null,ccs.Bone.create=function(a){var b=new ccs.Bone;
return b&&b.init(a)?b:null},ccs.FRAME_TYPE_MOVE=0,ccs.FRAME_TYPE_SCALE=1,ccs.FRAME_TYPE_ROTATE=2,ccs.FRAME_TYPE_TINT=3,ccs.FRAME_TYPE_FADE=4,ccs.FRAME_TYPE_MAX=5,ccs.FrameEaseType={Custom:-1,Linear:0,Sine_EaseIn:1,Sine_EaseOut:2,Sine_EaseInOut:3,Quad_EaseIn:4,Quad_EaseOut:5,Quad_EaseInOut:6,Cubic_EaseIn:7,Cubic_EaseOut:8,Cubic_EaseInOut:9,Quart_EaseIn:10,Quart_EaseOut:11,Quart_EaseInOut:12,Quint_EaseIn:13,Quint_EaseOut:14,Quint_EaseInOut:15,Expo_EaseIn:16,Expo_EaseOut:17,Expo_EaseInOut:18,Circ_EaseIn:19,Circ_EaseOut:20,Circ_EaseInOut:21,Elastic_EaesIn:22,Elastic_EaesOut:23,Elastic_EaesInOut:24,Back_EaseIn:25,Back_EaseOut:26,Back_EaseInOut:27,Bounce_EaseIn:28,Bounce_EaseOut:29,Bounce_EaseInOut:30},ccs.ActionFrame=ccs.Class.extend({frameType:0,easingType:0,frameIndex:0,_Parameter:null,time:0,ctor:function(){this.frameType=0,this.easingType=ccs.FrameEaseType.Linear,this.frameIndex=0,this.time=0},getAction:function(){return cc.log("Need a definition of <getAction> for ActionFrame"),null},_getEasingAction:function(a){if(null===a)return console.error("Action cannot be null!"),null;var b;switch(this.easingType){case ccs.FrameEaseType.Custom:break;case ccs.FrameEaseType.Linear:b=a;break;case ccs.FrameEaseType.Sine_EaseIn:b=a.easing(cc.easeSineIn());break;case ccs.FrameEaseType.Sine_EaseOut:b=a.easing(cc.easeSineOut());break;case ccs.FrameEaseType.Sine_EaseInOut:b=a.easing(cc.easeSineInOut());break;case ccs.FrameEaseType.Quad_EaseIn:b=a.easing(cc.easeQuadraticActionIn());break;case ccs.FrameEaseType.Quad_EaseOut:b=a.easing(cc.easeQuadraticActionOut());break;case ccs.FrameEaseType.Quad_EaseInOut:b=a.easing(cc.easeQuadraticActionInOut());break;case ccs.FrameEaseType.Cubic_EaseIn:b=a.easing(cc.easeCubicActionIn());break;case ccs.FrameEaseType.Cubic_EaseOut:b=a.easing(cc.easeCubicActionOut());break;case ccs.FrameEaseType.Cubic_EaseInOut:b=a.easing(cc.easeCubicActionInOut());break;case ccs.FrameEaseType.Quart_EaseIn:b=a.easing(cc.easeQuarticActionIn());break;case ccs.FrameEaseType.Quart_EaseOut:b=a.easing(cc.easeQuarticActionOut());break;case ccs.FrameEaseType.Quart_EaseInOut:b=a.easing(cc.easeQuarticActionInOut());break;case ccs.FrameEaseType.Quint_EaseIn:b=a.easing(cc.easeQuinticActionIn());break;case ccs.FrameEaseType.Quint_EaseOut:b=a.easing(cc.easeQuinticActionOut());break;case ccs.FrameEaseType.Quint_EaseInOut:b=a.easing(cc.easeQuinticActionInOut());break;case ccs.FrameEaseType.Expo_EaseIn:b=a.easing(cc.easeExponentialIn());break;case ccs.FrameEaseType.Expo_EaseOut:b=a.easing(cc.easeExponentialOut());break;case ccs.FrameEaseType.Expo_EaseInOut:b=a.easing(cc.easeExponentialInOut());break;case ccs.FrameEaseType.Circ_EaseIn:b=a.easing(cc.easeCircleActionIn());break;case ccs.FrameEaseType.Circ_EaseOut:b=a.easing(cc.easeCircleActionOut());break;case ccs.FrameEaseType.Circ_EaseInOut:b=a.easing(cc.easeCircleActionInOut());break;case ccs.FrameEaseType.Elastic_EaesIn:b=a.easing(cc.easeElasticIn());break;case ccs.FrameEaseType.Elastic_EaesOut:b=a.easing(cc.easeElasticOut());break;case ccs.FrameEaseType.Elastic_EaesInOut:b=a.easing(cc.easeElasticInOut());break;case ccs.FrameEaseType.Back_EaseIn:b=a.easing(cc.easeBackIn());break;case ccs.FrameEaseType.Back_EaseOut:b=a.easing(cc.easeBackOut());break;case ccs.FrameEaseType.Back_EaseInOut:b=a.easing(cc.easeBackInOut());break;case ccs.FrameEaseType.Bounce_EaseIn:b=a.easing(cc.easeBounceIn());break;case ccs.FrameEaseType.Bounce_EaseOut:b=a.easing(cc.easeBounceOut());break;case ccs.FrameEaseType.Bounce_EaseInOut:b=a.easing(cc.easeBounceInOut())}return b},setEasingParameter:function(a){this._Parameter=[];for(var b=0;b<a.length;b++)this._Parameter.push(a[b])},setEasingType:function(a){this.easingType=a}}),ccs.ActionMoveFrame=ccs.ActionFrame.extend({_position:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._position=cc.p(0,0),this.frameType=ccs.FRAME_TYPE_MOVE},setPosition:function(a,b){void 0===b?(this._position.x=a.x,this._position.y=a.y):(this._position.x=a,this._position.y=b)},getPosition:function(){return this._position},getAction:function(a){return this._getEasingAction(cc.moveTo(a,this._position))}}),ccs.ActionScaleFrame=ccs.ActionFrame.extend({_scaleX:1,_scaleY:1,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1,this.frameType=ccs.FRAME_TYPE_SCALE},setScaleX:function(a){this._scaleX=a},getScaleX:function(){return this._scaleX},setScaleY:function(a){this._scaleY=a},getScaleY:function(){return this._scaleY},getAction:function(a){return this._getEasingAction(cc.scaleTo(a,this._scaleX,this._scaleY))}}),ccs.ActionRotationFrame=ccs.ActionFrame.extend({_rotation:0,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._rotation=0,this.frameType=ccs.FRAME_TYPE_ROTATE},setRotation:function(a){this._rotation=a},getRotation:function(){return this._rotation},getAction:function(a,b){if(void 0===b)return this._getEasingAction(cc.rotateTo(a,this._rotation));if(b instanceof cc.ActionRotationFrame){var c=this._rotation-b._rotation;return this._getEasingAction(cc.rotateBy(a,c))}return this.getAction(a)}}),ccs.ActionFadeFrame=ccs.ActionFrame.extend({_opacity:255,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._opacity=255,this.frameType=ccs.FRAME_TYPE_FADE},setOpacity:function(a){this._opacity=a},getOpacity:function(){return this._opacity},getAction:function(a){return this._getEasingAction(cc.fadeTo(a,this._opacity))}}),ccs.ActionTintFrame=ccs.ActionFrame.extend({_color:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._color=cc.color(255,255,255,255),this.frameType=ccs.FRAME_TYPE_TINT},setColor:function(a){var b=this._color;b.r=a.r,b.g=a.g,b.b=a.b},getColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,a.a)},getAction:function(a){return this._getEasingAction(cc.tintTo(a,this._color.r,this._color.g,this._color.b))}}),ccs.actionManager={_actionDic:{},initWithDictionary:function(a,b,c){for(var d=a,e=d.lastIndexOf("/"),f=d.substr(e+1,d.length),g=b.actionlist,h=[],i=0;i<g.length;i++){var j=new ccs.ActionObject,k=g[i];j.initWithDictionary(k,c),h.push(j)}this._actionDic[f]=h},getActionByName:function(a,b){var c=this._actionDic[a];if(!c)return null;for(var d=0;d<c.length;d++){var e=c[d];if(b==e.getName())return e}return null},playActionByName:function(a,b,c){var d=this.getActionByName(a,b);d&&d.play(c)},releaseActions:function(){this._actionDic={}},clear:function(){this._actionDic={}}},ccs.ActionNode=ccs.Class.extend({_currentFrameIndex:0,_destFrameIndex:0,_unitTime:0,_actionTag:0,_object:null,_actionSpawn:null,_action:null,_frameArray:null,_frameArrayNum:0,ctor:function(){this._currentFrameIndex=0,this._destFrameIndex=0,this._unitTime=.1,this._actionTag=0,this._object=null,this._actionSpawn=null,this._action=null,this._frameArray=[],this._frameArrayNum=ccs.FRAME_TYPE_MAX;for(var a=0;a<this._frameArrayNum;a++)this._frameArray.push([])},initWithDictionary:function(a,b){this.setActionTag(a.ActionTag);for(var c=a.actionframelist,d=0;d<c.length;d++){var e=c[d],f=e.frameid,g=e.tweenType;null==g&&(g=0);for(var h=e.tweenParameter,i=[],j=0;h>j;j++){var k=e.tweenParameter[j];i.push(k)}var l,m;if(void 0!==e.positionx){var n=e.positionx,o=e.positiony;l=new ccs.ActionMoveFrame,l.frameIndex=f,l.setEasingType(g),l.setEasingParameter(i),l.setPosition(n,o),m=this._frameArray[ccs.FRAME_TYPE_MOVE],m.push(l)}if(void 0!==e.scalex){var p=e.scalex,q=e.scaley;l=new ccs.ActionScaleFrame,l.frameIndex=f,l.setEasingType(g),l.setEasingParameter(i),l.setScaleX(p),l.setScaleY(q),m=this._frameArray[ccs.FRAME_TYPE_SCALE],m.push(l)}if(void 0!==e.rotation){var r=e.rotation;l=new ccs.ActionRotationFrame,l.frameIndex=f,l.setEasingType(g),l.setEasingParameter(i),l.setRotation(r),m=this._frameArray[ccs.FRAME_TYPE_ROTATE],m.push(l)}if(void 0!==e.opacity){var s=e.opacity;l=new ccs.ActionFadeFrame,l.frameIndex=f,l.setEasingType(g),l.setEasingParameter(i),l.setOpacity(s),m=this._frameArray[ccs.FRAME_TYPE_FADE],m.push(l)}if(void 0!==e.colorr){var t=e.colorr,u=e.colorg,v=e.colorb;l=new ccs.ActionTintFrame,l.frameIndex=f,l.setEasingType(g),l.setEasingParameter(i),l.setColor(cc.color(t,u,v)),m=this._frameArray[ccs.FRAME_TYPE_TINT],m.push(l)}e=null}this._initActionNodeFromRoot(b)},_initActionNodeFromRoot:function(a){if(a instanceof ccui.Widget){var b=ccui.helper.seekActionWidgetByActionTag(a,this.getActionTag());b&&this.setObject(b)}},setUnitTime:function(a){this._unitTime=a,this._refreshActionProperty()},getUnitTime:function(){return this._unitTime},setActionTag:function(a){this._actionTag=a},getActionTag:function(){return this._actionTag},setObject:function(a){this._object=a},getObject:function(){return this._object},getActionNode:function(){return this._object instanceof cc.Node?this._object:null},insertFrame:function(a,b){if(null!=b){var c=b.frameType,d=this._frameArray[c];d.splice(a,0,b)}},addFrame:function(a){if(a){var b=a.frameType,c=this._frameArray[b];c.push(a)}},deleteFrame:function(a){if(null!=a){var b=a.frameType,c=this._frameArray[b];cc.arrayRemoveObject(c,a)}},clearAllFrame:function(){for(var a=0;a<this._frameArrayNum;a++)this._frameArray[a].length=0},_refreshActionProperty:function(){if(null==this._object)return null;for(var a=[],b=0;b<this._frameArrayNum;b++){var c=this._frameArray[b];if(!(c.length<=0)){for(var d=[],e=0;e<c.length;e++){var f=c[e];if(0!=e){var g=c[e-1],h=(f.frameIndex-g.frameIndex)*this.getUnitTime(),i=f.getAction(h);i&&d.push(i)}}if(d){var j=cc.sequence(d);null!=j&&a.push(j)}}}return this._action=null,this._actionSpawn=cc.spawn(a),this._actionSpawn},playAction:function(a){null!=this._object&&null!=this._actionSpawn&&(this._action=a?cc.sequence(this._actionSpawn,a):cc.sequence(this._actionSpawn),this._runAction())},_runAction:function(){var a=this.getActionNode();null!=a&&null!=this._action&&a.runAction(this._action)},stopAction:function(){var a=this.getActionNode();null!=a&&null!=this._action&&(this._action.isDone()||a.stopAction(this._action))},getFirstFrameIndex:function(){for(var a=99999,b=!1,c=this._frameArray,d=0,e=this._frameArrayNum;e>d;d++){var f=c[d];if(!(f.length<=0)){b=!0;var g=f[0].frameIndex;a=a>g?g:a}}return b||(a=0),a},getLastFrameIndex:function(){for(var a=-1,b=!1,c=this._frameArray,d=0,e=this._frameArrayNum;e>d;d++){var f=c[d];if(!(f.length<=0)){b=!0;var g=f[f.length-1],h=g.frameIndex;a=h>a?h:a}}return b||(a=0),a},updateActionToTimeLine:function(a){for(var b=!1,c=this.getUnitTime(),d=0;d<this._frameArrayNum;d++){var e=this._frameArray[d];if(null!=e)for(var f=0;f<e.length;f++){var g=e[f];if(g.frameIndex*c==a){this._easingToFrame(1,1,g),b=!0;break}if(g.frameIndex*c>a){if(0==f)this._easingToFrame(1,1,g),b=!1;else{var h=e[f-1],i=(g.frameIndex-h.frameIndex)*c,j=a-h.frameIndex*c;this._easingToFrame(i,1,h),this._easingToFrame(i,j/i,g),b=!0}break}}}return b},_easingToFrame:function(a,b,c){var d=c.getAction(a),e=this.getActionNode();null!=d&&null!=e&&(d.startWithTarget(e),d.update(b))},isActionDoneOnce:function(){return null==this._action?!0:this._action.isDone()}}),ccs.ActionObject=ccs.Class.extend({_actionNodeList:null,_name:"",_loop:!1,_pause:!1,_playing:!1,_unitTime:0,_currentTime:0,_scheduler:null,_callback:null,_fTotalTime:0,ctor:function(){this._actionNodeList=[],this._name="",this._loop=!1,this._pause=!1,this._playing=!1,this._unitTime=.1,this._currentTime=0,this._fTotalTime=0,this._scheduler=cc.director.getScheduler()},setName:function(a){this._name=a},getName:function(){return this._name},setLoop:function(a){this._loop=a},getLoop:function(){return this._loop},setUnitTime:function(a){this._unitTime=a;for(var b=this._actionNodeList.length,c=0;b>c;c++){var d=this._actionNodeList[c];d.setUnitTime(this._unitTime)}},getUnitTime:function(){return this._unitTime},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(a){this._currentTime=a},getTotalTime:function(){return this._fTotalTime},isPlaying:function(){return this._playing},initWithDictionary:function(a,b){this.setName(a.name),this.setLoop(a.loop),this.setUnitTime(a.unittime);for(var c=a.actionnodelist,d=0,e=0;e<c.length;e++){var f=new ccs.ActionNode,g=c[e];f.initWithDictionary(g,b),f.setUnitTime(this.getUnitTime()),this._actionNodeList.push(f);var h=f.getLastFrameIndex()-f.getFirstFrameIndex();h>d&&(d=h)}this._fTotalTime=d*this._unitTime},addActionNode:function(a){a&&(this._actionNodeList.push(a),a.setUnitTime(this._unitTime))},removeActionNode:function(a){null!=a&&cc.arrayRemoveObject(this._actionNodeList,a)},play:function(a){this.stop(),this.updateToFrameByTime(0);for(var b=this._actionNodeList,c=b.length,d=0;c>d;d++)b[d].playAction(a);this._loop&&this._scheduler.scheduleCallbackForTarget(this,this.simulationActionUpdate,0,cc.REPEAT_FOREVER,0,!1),void 0!==a&&(this._callback=a)},pause:function(){this._pause=!0},stop:function(){for(var a=this._actionNodeList,b=0;b<a.length;b++)a[b].stopAction();this._scheduler.unscheduleCallbackForTarget(this,this.simulationActionUpdate),this._pause=!1},updateToFrameByTime:function(a){this._currentTime=a;for(var b=0;b<this._actionNodeList.length;b++){var c=this._actionNodeList[b];c.updateActionToTimeLine(a)}},simulationActionUpdate:function(){for(var a=!0,b=this._actionNodeList,c=0,d=b.length;d>c;c++)if(!b[c].isActionDoneOnce()){a=!1;break}a&&(null!=this._callback&&this._callback.execute(),this._loop?this.play():this._scheduler.unschedule(this.simulationActionUpdate,this))}}),ccs.ComAttribute=ccs.Component.extend({_jsonDict:null,_filePath:"",ctor:function(){cc.Component.prototype.ctor.call(this),this._jsonDict={},this._filePath="",this._name="CCComAttribute"},init:function(){return this._jsonDict={},!0},setInt:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setDouble:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setFloat:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setBool:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setString:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setObject:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},getInt:function(a){var b=this._jsonDict[a];return parseInt(b||0)},getDouble:function(a){var b=this._jsonDict[a];return parseFloat(b||0)},getFloat:function(a){var b=this._jsonDict[a];return parseFloat(b||0)},getBool:function(a){var b=this._jsonDict[a];return Boolean(b||!1)},getString:function(a){var b=this._jsonDict[a];return b||""},getObject:function(a){return this._jsonDict[a]},parse:function(a){this._jsonDict=cc.loader.getRes(a)}}),ccs.ComAttribute.create=function(){var a=new ccs.ComAttribute;return a&&a.init()?a:null},ccs.ComAudio=ccs.Component.extend({_filePath:"",_loop:!1,ctor:function(){cc.Component.prototype.ctor.call(this),this._name="Audio"},init:function(){return!0},onExit:function(){this.stopBackgroundMusic(!0),this.stopAllEffects()},end:function(){cc.audioEngine.end()},preloadBackgroundMusic:function(a){cc.loader.load(a)},playBackgroundMusic:function(a,b){a?cc.audioEngine.playMusic(a,b):cc.audioEngine.playMusic(this._filePath,this._loop)},stopBackgroundMusic:function(a){cc.audioEngine.stopMusic(a)},pauseBackgroundMusic:function(){cc.audioEngine.pauseMusic()},resumeBackgroundMusic:function(){cc.audioEngine.resumeMusic()},rewindBackgroundMusic:function(){cc.audioEngine.rewindMusic()},willPlayBackgroundMusic:function(){return cc.audioEngine.willPlayMusic()},isBackgroundMusicPlaying:function(){return cc.audioEngine.isMusicPlaying()},getBackgroundMusicVolume:function(){return cc.audioEngine.getMusicVolume()},setBackgroundMusicVolume:function(a){cc.audioEngine.setMusicVolume(a)},getEffectsVolume:function(){return cc.audioEngine.getEffectsVolume()},setEffectsVolume:function(a){cc.audioEngine.setEffectsVolume(a)},playEffect:function(a,b){return a?cc.audioEngine.playEffect(a,b):cc.audioEngine.playEffect(this._filePath,this._loop)},pauseEffect:function(a){cc.audioEngine.pauseEffect(a)},pauseAllEffects:function(){cc.audioEngine.pauseAllEffects()},resumeEffect:function(a){cc.audioEngine.resumeEffect(a)},resumeAllEffects:function(){cc.audioEngine.resumeAllEffects()},stopEffect:function(a){cc.audioEngine.stopEffect(a)},stopAllEffects:function(){cc.audioEngine.stopAllEffects()},preloadEffect:function(a){cc.loader.getRes(a),this.setFile(a),this.setLoop(!1)},unloadEffect:function(a){cc.audioEngine.unloadEffect(a)},setFile:function(a){this._filePath=a},setLoop:function(a){this._loop=a},getFile:function(){return this._filePath},isLoop:function(){return this._loop}}),ccs.ComAudio.create=function(){var a=new ccs.ComAudio;return a&&a.init()?a:null},ccs.ComController=ccs.Component.extend({ctor:function(){cc.Component.prototype.ctor.call(this),this._name="ComController"},onEnter:function(){null!=this._owner&&this._owner.scheduleUpdate()},isEnabled:function(){return this._enabled},setEnabled:function(a){this._enabled=a}}),ccs.ComController.create=function(){var a=new ccs.ComController;return a&&a.init()?a:null},ccs.ComRender=ccs.Component.extend({_render:null,ctor:function(a,b){cc.Component.prototype.ctor.call(this),this._render=a,this._name=b,this.isRenderer=!0},onEnter:function(){this._owner&&this._owner.addChild(this._render)},onExit:function(){this._owner&&(this._owner.removeChild(this._render,!0),this._render=null)},getNode:function(){return this._render},setNode:function(a){this._render=a}}),ccs.ComRender.create=function(a,b){var c=new ccs.ComRender(a,b);return c&&c.init()?c:null},ccs.objectFactory={_typeMap:{},createObject:function(a){var b=null,c=this._typeMap[a];return c&&(b=cc.isFunction(c._fun)?new c._fun:c._fun),b},registerType:function(a){this._typeMap[a._className]=a},createGUI:function(a){var b=null;"Panel"===a?a="Layout":"TextArea"===a?a="Label":"TextButton"===a&&(a="Button");var c=this._typeMap[a];return c&&c._fun&&(b=c._fun),b},removeAll:function(){this._typeMap={}}},ccs.TInfo=ccs.Class.extend({_className:"",_fun:null,ctor:function(a,b){b?(this._className=a,this._fun=b):(this._className=a._className,this._fun=a._fun),ccs.objectFactory.registerType(this)}}),ccs.sendEvent=function(a){var b=ccs.triggerManager.get(a);if(null!=b)for(var c=0;c<b.length;c++){var d=b[c];null!=d&&d.detect()&&d.done()}},ccs.registerTriggerClass=function(a,b){new ccs.TInfo(a,b)},ccs.triggerManager={_eventTriggers:{},_triggerObjs:{},_movementDispatches:[],parse:function(a){for(var b=0;b<a.length;++b){var c=a[b],d=ccs.TriggerObj.create();d.serialize(c);for(var e=d.getEvents(),f=0;f<e.length;f++){var g=e[f];this.add(g,d)}this._triggerObjs[d.getId()]=d}},get:function(a){return this._eventTriggers[a]},getTriggerObj:function(a){return this._triggerObjs[a]},add:function(a,b){var c=this._eventTriggers[a];c||(c=[]),-1==c.indexOf(b)&&(c.push(b),this._eventTriggers[a]=c)},removeAll:function(){for(var a in this._eventTriggers)for(var b=this._eventTriggers[a],c=0;c<b.length;c++){var d=b[c];d.removeAll()}this._eventTriggers={}},remove:function(a,b){if(b)return this._removeObj(a,b);var c=!1;do{var d=this._eventTriggers[a];if(!d)break;for(var e=0;e<d.length;e++){var f=d[e];f&&f.removeAll()}delete this._eventTriggers[a],c=!0}while(0);return c},_removeObj:function(a,b){var c=!1;do{var d=this._eventTriggers[a];if(!d)break;for(var e=0;e<d.length;e++){var f=d[e];if(f&&f==b){f.removeAll(),d.splice(e,1);break}}c=!0}while(0);return c},removeTriggerObj:function(a){var b=this.getTriggerObj(a);if(!b)return!1;for(var c=b.getEvents(),d=0;d<c.length;d++){var e=c[d];this.remove(e,b)}return!0},isEmpty:function(){return!this._eventTriggers||this._eventTriggers.length<=0},addArmatureMovementCallBack:function(a,b,c){if(null!=a&&null!=c&&null!=b){for(var d,e=!1,f=0;f<this._movementDispatches.length;f++)d=this._movementDispatches[f],d&&d[0]==a&&(d.addAnimationEventCallBack(b,c),e=!0);if(!e){var g=new ccs.ArmatureMovementDispatcher;a.getAnimation().setMovementEventCallFunc(g.animationEvent,g),g.addAnimationEventCallBack(b,c),this._movementDispatches.push([a,g])}}},removeArmatureMovementCallBack:function(a,b,c){if(null!=a&&null!=b&&null!=c)for(var d,e=0;e<this._movementDispatches.length;e++)d=this._movementDispatches[e],d&&d[0]==a&&d.removeAnimationEventCallBack(c,b)},removeArmatureAllMovementCallBack:function(a){if(null!=a)for(var b,c=0;c<this._movementDispatches.length;c++)if(b=this._movementDispatches[c],b&&b[0]==a){this._movementDispatches.splice(c,1);break}},removeAllArmatureMovementCallBack:function(){this._movementDispatches.length=0},version:function(){return"1.2.0.0"}},ccs.ArmatureMovementDispatcher=ccs.Class.extend({_mapEventAnimation:null,ctor:function(){this._mapEventAnimation=[]},animationEvent:function(a,b,c){for(var d,e,f,g=0;g<this._mapEventAnimation.length;g++)d=this._mapEventAnimation[g],e=d[0],f=d[1],f&&f.call(e,a,b,c)},addAnimationEventCallBack:function(a,b){this._mapEventAnimation.push([b,a])},removeAnimationEventCallBack:function(a,b){for(var c,d=0;d<this._mapEventAnimation.length;d++)c=this._mapEventAnimation[d],c[0]==b&&this._mapEventAnimation.splice(d,1)}}),ccs.BaseTriggerCondition=ccs.Class.extend({ctor:function(){},init:function(){return!0},detect:function(){return!0},serialize:function(){},removeAll:function(){}}),ccs.BaseTriggerAction=ccs.Class.extend({ctor:function(){},init:function(){return!0},done:function(){},serialize:function(){},removeAll:function(){}}),ccs.TriggerObj=ccs.Class.extend({_cons:null,_acts:null,_id:0,_enable:!0,_vInt:null,ctor:function(){this._id=0,this._enable=!0},init:function(){return this._cons=[],this._acts=[],this._vInt=[],!0},detect:function(){if(!this._enable||0==this._cons.length)return!0;for(var a=!0,b=null,c=0;c<this._cons.length;c++)b=this._cons[c],b&&b.detect&&(a=a&&b.detect());return a},done:function(){if(this._enable&&0!=this._acts.length)for(var a,b=0;b<this._acts.length;b++)a=this._acts[b],a&&a.done&&a.done()},removeAll:function(){for(var a=null,b=0;b<this._cons.length;b++)a=this._cons[b],a&&a.removeAll();this._cons=[];for(var b=0;b<this._acts.length;b++)a=this._acts[b],a&&a.removeAll();this._acts=[]},serialize:function(a){this._id=a.id||0;for(var b=a.conditions||[],c=0;c<b.length;c++){var d=b[c],e=d.classname,f=ccs.objectFactory.createObject(e);f?(f.serialize(d),f.init(),this._cons.push(f)):cc.log("class named classname("+e+") can not implement!")}for(var g=a.actions||[],c=0;c<g.length;c++){var d=g[c],e=d.classname,h=ccs.objectFactory.createObject(e);h?(h.serialize(d),h.init(),this._acts.push(h)):cc.log("class named classname("+e+") can not implement!")}for(var i=a.events||[],c=0;c<i.length;c++){var d=i[c],j=d.id;0>j||this._vInt.push(j)}},getId:function(){return this._id},setEnable:function(a){this._enable=a},getEvents:function(){return this._vInt}}),ccs.TriggerObj.create=function(){var a=new ccs.TriggerObj;return a.init()?a:null},ccs.ButtonReader={getInstance:function(){return ccs.ButtonReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=ccs.uiReader.getFilePath(),d=a,e=b.scale9Enable;d.setScale9Enabled(e);var f=b.normalData,g=f.resourceType;switch(g){case 0:var h=c,i=f.path,j=i&&""!==i?h+i:null;d.loadTextureNormal(j);break;case 1:var i=f.path;d.loadTextureNormal(i,1)}var k=b.pressedData,l=k.resourceType;switch(l){case 0:var m=c,n=k.path,o=n&&""!==n?m+n:null;d.loadTexturePressed(o);break;case 1:var n=k.path;d.loadTexturePressed(n,1)}var p=b.disabledData,q=p.resourceType;switch(q){case 0:var r=c,s=p.path,t=s&&""!==s?r+s:null;d.loadTextureDisabled(t);break;case 1:var s=p.path;d.loadTextureDisabled(s,1)}if(e){var u=b.capInsetsX,v=b.capInsetsY,w=b.capInsetsWidth,x=b.capInsetsHeight;d.setCapInsets(cc.rect(u,v,w,x));var y=b.scale9Width,z=b.scale9Height;null!=y&&null!=z&&d.setSize(cc.size(y,z))}var A=b.text;null!=A&&d.setTitleText(A);var B=b.textColorR,C=b.textColorG,D=b.textColorB,E=B?b.textColorR:255,F=C?b.textColorG:255,G=D?b.textColorB:255;d.setTitleColor(cc.color(E,F,G));var H=b.fontSize;null!=H&&d.setTitleFontSize(b.fontSize);var I=b.fontName;I&&d.setTitleFontName(b.fontName),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.CheckBoxReader={getInstance:function(){return ccs.CheckBoxReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=a,d=b.backGroundBoxData,e=d.resourceType,f=ccs.WidgetReader._getResourcePath(d,"path",e);c.loadTextureBackGround(f,e);var g=b.backGroundBoxSelectedData,h=g.resourceType,i=ccs.WidgetReader._getResourcePath(g,"path",h);i||(h=e,i=f),c.loadTextureBackGroundSelected(i,h);var j=b.frontCrossData,k=j.resourceType,l=ccs.WidgetReader._getResourcePath(j,"path",k);c.loadTextureFrontCross(l,k);var m=b.backGroundBoxDisabledData,n=m.resourceType,o=ccs.WidgetReader._getResourcePath(m,"path",n);o||(n=k,o=l),c.loadTextureBackGroundDisabled(o,n);var p=b.frontCrossDisabledData,q=p.resourceType,r=ccs.WidgetReader._getResourcePath(p,"path",q);c.loadTextureFrontCrossDisabled(r,q),b.selectedState&&c.setSelectedState(b.selectedState),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.ImageViewReader={getInstance:function(){return ccs.ImageViewReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=ccs.uiReader.getFilePath(),d=a,e=b.fileNameData,f=e.resourceType;switch(f){case 0:var g=c,h=e.path,i=null;h&&""!==h&&(i=g+h,d.loadTexture(i));break;case 1:var h=e.path;d.loadTexture(h,1)}var j=b.scale9Enable,k=!1;if(j&&(k=b.scale9Enable),d.setScale9Enabled(k),k){var l=b.scale9Width,m=b.scale9Height;if(l&&m){var n=b.scale9Width,o=b.scale9Height;d.setSize(cc.size(n,o))}var p=b.capInsetsX,q=b.capInsetsY,r=b.capInsetsWidth,s=b.capInsetsHeight;d.setCapInsets(cc.rect(p,q,r,s))}ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.LabelAtlasReader={getInstance:function(){return ccs.LabelAtlasReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=ccs.uiReader.getFilePath(),d=a,e=b.stringValue,f=b.charMapFileData,g=b.itemWidth,h=b.itemHeight,i=b.startCharMap;if(null!=e&&f&&null!=g&&null!=h&&null!=i){var j=b.charMapFileData,k=j.resourceType;switch(k){case 0:var l=c,m=j.path,n=l+m;d.setProperty(e,n,g,h,i);break;case 1:cc.log("Wrong res type of LabelAtlas!")}}ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.LabelBMFontReader={getInstance:function(){return ccs.LabelBMFontReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=ccs.uiReader.getFilePath(),d=a,e=b.fileNameData,f=e.resourceType;switch(f){case 0:var g=c,h=e.path,i=g+h;d.setFntFile(i);break;case 1:cc.log("Wrong res type of LabelAtlas!")}var j=b.text;d.setString(j),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.LabelReader={getInstance:function(){return ccs.LabelReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=a,d=b.touchScaleEnable;c.setTouchScaleChangeEnabled(d);var e=b.text;c.setString(e);var f=b.fontSize;null!=f&&c.setFontSize(b.fontSize);var g=b.fontName;null!=g&&c.setFontName(b.fontName);var h=b.areaWidth,i=b.areaHeight;if(null!=h&&null!=i){var j=cc.size(b.areaWidth,b.areaHeight);c.setTextAreaSize(j)}var k=b.hAlignment;null!=k&&c.setTextHorizontalAlignment(b.hAlignment);var l=b.vAlignment;null!=l&&c.setTextVerticalAlignment(b.vAlignment),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.LayoutReader={getInstance:function(){return ccs.LayoutReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=ccs.uiReader.getFilePath(),d=a,e=0,f=0,g=b.adaptScreen;if(g){var h=cc.director.getWinSize();e=h.width,f=h.height}else e=b.width,f=b.height;d.setSize(cc.size(e,f)),d.setClippingEnabled(b.clipAble);var i=b.backGroundScale9Enable;d.setBackGroundImageScale9Enabled(i);var j=b.bgColorR,k=b.bgColorG,l=b.bgColorB,m=b.bgStartColorR,n=b.bgStartColorG,o=b.bgStartColorB,p=b.bgEndColorR,q=b.bgEndColorG,r=b.bgEndColorB,s=b.vectorX,t=b.vectorY;d.setBackGroundColorVector(cc.p(s,t));var u=b.bgColorOpacity,v=b.colorType;d.setBackGroundColorType(v),d.setBackGroundColor(cc.color(m,n,o),cc.color(p,q,r)),d.setBackGroundColor(cc.color(j,k,l)),d.setBackGroundColorOpacity(u);var w=b.backGroundImageData;if(w){var x=w.resourceType;switch(x){case 0:var y=c,z=w.path,A=z&&""!==z?y+z:null;d.setBackGroundImage(A);break;case 1:var z=w.path;d.setBackGroundImage(z,1)}}if(i){var B=b.capInsetsX,C=b.capInsetsY,D=b.capInsetsWidth,E=b.capInsetsHeight;d.setBackGroundImageCapInsets(cc.rect(B,C,D,E))}d.setLayoutType(b.layoutType),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.ScrollViewReader={getInstance:function(){return ccs.ScrollViewReader},setPropsFromJsonDictionary:function(a,b){ccs.LayoutReader.setPropsFromJsonDictionary.call(this,a,b);var c=a,d=b.innerWidth||200,e=b.innerHeight||200;c.setInnerContainerSize(cc.size(d,e));var f=b.direction||1;c.setDirection(f),c.setBounceEnabled(b.bounceEnable),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.ListViewReader={getInstance:function(){return ccs.ListViewReader},setPropsFromJsonDictionary:function(a,b){ccs.ScrollViewReader.setPropsFromJsonDictionary.call(this,a,b);var c=a,d=b.direction;c.setDirection(d);var e=b.gravity;c.setGravity(e);var f=b.itemMargin;c.setItemsMargin(f)}},ccs.LoadingBarReader={getInstance:function(){return ccs.LoadingBarReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=ccs.uiReader.getFilePath(),d=a,e=b.textureData,f=e.resourceType;switch(f){case 0:var g=c,h=e.path,i=null;h&&""!==h&&(i=g+h,d.loadTexture(i));break;case 1:var h=e.path;d.loadTexture(h,1)}var j=b.scale9Enable;if(d.setScale9Enabled(j),j){var k=b.capInsetsX,l=b.capInsetsY,m=b.capInsetsWidth,n=b.capInsetsHeight;d.setCapInsets(cc.rect(k,l,m,n));var o=b.width,p=b.height;d.setSize(cc.size(o,p))}d.setDirection(b.direction),d.setPercent(b.percent),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.PageViewReader={getInstance:function(){return ccs.PageViewReader},setPropsFromJsonDictionary:function(a,b){ccs.LayoutReader.setPropsFromJsonDictionary.call(this,a,b)}},ccs.SliderReader={getInstance:function(){return ccs.SliderReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=ccs.uiReader.getFilePath(),d=a,e=c,f=b.scale9Enable;d.setScale9Enabled(f);var g,h=b.barFileName,i=b.length,j=b.barFileNameData,k=j.resourceType,l=j.path;if(null!=h){if(f){switch(k){case 0:g=l?e+l:null,d.loadBarTexture(g);break;case 1:d.loadBarTexture(l,1)}d.setSize(cc.size(i,d.getContentSize().height))}}else switch(k){case 0:g=l?e+l:null,d.loadBarTexture(g);break;case 1:d.loadBarTexture(l,1)}var m=b.ballNormalData,n=m.resourceType,o=m.path;switch(n){case 0:var p=o?e+o:null;d.loadSlidBallTextureNormal(p);break;case 1:d.loadSlidBallTextureNormal(o,1)}var q=b.ballPressedData,r=q.resourceType,s=q.path;switch(null===s&&(r=n,s=o),r){case 0:var t=s?e+s:null;d.loadSlidBallTexturePressed(t);break;case 1:d.loadSlidBallTexturePressed(s,1)}var u=b.ballDisabledData,v=u.resourceType,w=u.path;switch(v){case 0:var x=w?e+w:null;d.loadSlidBallTextureDisabled(x);break;case 1:d.loadSlidBallTextureDisabled(w,1)}var y=b.progressBarData,z=y.resourceType,A=y.path;switch(z){case 0:var B=A?e+A:null;d.loadProgressBarTexture(B);break;case 1:d.loadProgressBarTexture(A,1)}ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.TextFieldReader={getInstance:function(){return ccs.TextFieldReader},setPropsFromJsonDictionary:function(a,b){ccs.WidgetReader.setPropsFromJsonDictionary.call(this,a,b);var c=a,d=b.placeHolder;d&&c.setPlaceHolder(d),c.setString(b.text);var e=b.fontSize1;e&&c.setFontSize(e);var f=b.fontName;f&&c.setFontName(f);var g=b.touchSizeWidth,h=b.touchSizeHeight;g&&h&&c.setTouchSize(g,h);var i=(b.width,b.height,b.maxLengthEnable);if(c.setMaxLengthEnabled(i),i){var j=b.maxLength;
c.setMaxLength(j)}var k=b.passwordEnable;c.setPasswordEnabled(k),k&&c.setPasswordStyleText(b.passwordStyleText);var l=b.areaWidth,m=b.areaHeight;if(l&&m){var n=cc.size(l,m);c.setTextAreaSize(n)}var o=b.hAlignment;o&&c.setTextHorizontalAlignment(o);var p=b.vAlignment;p&&c.setTextVerticalAlignment(p),ccs.WidgetReader.setColorPropsFromJsonDictionary.call(this,a,b)}},ccs.WidgetReaderProtocol=ccs.Class.extend({setPropsFromJsonDictionary:function(){}}),ccs.WidgetReader={getInstance:function(){return ccs.WidgetReader},setPropsFromJsonDictionary:function(a,b){var c=b.ignoreSize;null!=c&&a.ignoreContentAdaptWithSize(c),a.setSizeType(b.sizeType),a.setPositionType(b.positionType),a.setSizePercent(cc.p(b.sizePercentX,b.sizePercentY)),a.setPositionPercent(cc.p(b.positionPercentX,b.positionPercentY));var d=0,e=0,f=b.adaptScreen;if(f){var g=cc.director.getWinSize();d=g.width,e=g.height}else d=b.width,e=b.height;a.setContentSize(d,e),a.setTag(b.tag),a.setActionTag(b.actiontag),a.setTouchEnabled(b.touchAble);var h=b.name,i=h?h:"default";a.setName(i);var j=b.x,k=b.y;a.setPosition(j,k);var l=b.scaleX||1;a.setScaleX(l);var m=b.scaleY||1;a.setScaleY(m);var n=b.rotation||0;a.setRotation(n);var o=b.visible||!1;null!=o&&a.setVisible(o),a.setLocalZOrder(b.ZOrder);var p=b.layoutParameter;if(null!=p){var q=b.layoutParameter,r=q.type,s=null;switch(r){case 0:break;case 1:s=new ccui.LinearLayoutParameter;var t=q.gravity;s.setGravity(t);break;case 2:s=new ccui.RelativeLayoutParameter;var u=s,v=q.relativeName;u.setRelativeName(v);var w=q.relativeToName;u.setRelativeToWidgetName(w);var x=q.align;u.setAlign(x)}if(null!=s){var y=q.marginLeft||0,z=q.marginTop||0,A=q.marginRight||0,B=q.marginDown||0;s.setMargin(y,z,A,B),a.setLayoutParameter(s)}}},setColorPropsFromJsonDictionary:function(a,b){var c=b.opacity;null!=c&&a.setOpacity(c);var d=b.colorR,e=b.colorG,f=b.colorB;a.setColor(cc.color(null==d?255:d,null==e?255:e,null==f?255:f)),ccs.WidgetReader._setAnchorPointForWidget(a,b),a.setFlippedX(b.flipX),a.setFlippedY(b.flipY)},_setAnchorPointForWidget:function(a,b){var c,d=b.anchorPointX;c=null!=d?b.anchorPointX:a.getAnchorPoint().x;var e,f=b.anchorPointY;e=null!=f?b.anchorPointY:a.getAnchorPoint().y,(null!=d||null!=f)&&a.setAnchorPoint(cc.p(c,e))},_getResourcePath:function(a,b,c){var d,e=a[b];return null!=e&&(0==c?d=ccs.uiReader.getFilePath()+e:1==c?d=e:cc.assert(0,"invalid TextureResType!!!")),d}},function(){var a=ccs.objectFactory;a.registerType({_className:"ButtonReader",_fun:ccs.ButtonReader}),a.registerType({_className:"CheckBoxReader",_fun:ccs.CheckBoxReader}),a.registerType({_className:"SliderReader",_fun:ccs.SliderReader}),a.registerType({_className:"ImageViewReader",_fun:ccs.ImageViewReader}),a.registerType({_className:"LoadingBarReader",_fun:ccs.LoadingBarReader}),a.registerType({_className:"TextAtlasReader",_fun:ccs.LabelAtlasReader}),a.registerType({_className:"TextReader",_fun:ccs.LabelReader}),a.registerType({_className:"TextBMFontReader",_fun:ccs.LabelBMFontReader}),a.registerType({_className:"TextFieldReader",_fun:ccs.TextFieldReader}),a.registerType({_className:"LayoutReader",_fun:ccs.LayoutReader}),a.registerType({_className:"PageViewReader",_fun:ccs.PageViewReader}),a.registerType({_className:"ScrollViewReader",_fun:ccs.ScrollViewReader}),a.registerType({_className:"ListViewReader",_fun:ccs.ListViewReader}),a.registerType({_className:"WidgetReader",_fun:ccs.WidgetReader}),a.registerType({_className:"Button",_fun:ccui.Button}),a.registerType({_className:"CheckBox",_fun:ccui.CheckBox}),a.registerType({_className:"ImageView",_fun:ccui.ImageView}),a.registerType({_className:"Text",_fun:ccui.Text}),a.registerType({_className:"TextAtlas",_fun:ccui.TextAtlas}),a.registerType({_className:"TextBMFont",_fun:ccui.TextBMFont}),a.registerType({_className:"LoadingBar",_fun:ccui.LoadingBar}),a.registerType({_className:"Slider",_fun:ccui.Slider}),a.registerType({_className:"TextField",_fun:ccui.TextField}),a.registerType({_className:"Layout",_fun:ccui.Layout}),a.registerType({_className:"ListView",_fun:ccui.ListView}),a.registerType({_className:"PageView",_fun:ccui.PageView}),a.registerType({_className:"ScrollView",_fun:ccui.ScrollView})}(),ccs.uiReader={_filePath:"",_olderVersion:!1,_fileDesignSizes:{},_mapObject:{},_mapParseSelector:{},getVersionInteger:function(a){if(!a)return 0;var b=a,c=b.length;if(7>c)return 0;var d=b.indexOf("."),e=b.substr(0,d);b=b.substr(d+1,c-1),d=b.indexOf(".");var f=b.substr(0,d);b=b.substr(d+1,c-1),d=b.indexOf(".");var g=b.substr(0,d);b=b.substr(d+1,c-1),d=b.indexOf(".");var h=-1==d?b:b.substr(0,d),i=parseInt(e),j=parseInt(f),k=parseInt(g),l=parseInt(h);return 1e3*i+100*j+10*k+l},storeFileDesignSize:function(a,b){this._fileDesignSizes[a]=b},getFileDesignSize:function(a){return this._fileDesignSizes[a]},widgetFromJsonFile:function(a){var b=cc.loader.getRes(a);if(!b)throw"Please load the resource first : "+a;var c=cc.path.dirname(a);this._filePath=""==c?c:c+"/";var d,e,f=b.version,g=this.getVersionInteger(f);return f?250>g?(d=new ccs.WidgetPropertiesReader0250,e=d.createWidget(b,this._filePath,a)):(d=new ccs.WidgetPropertiesReader0300,e=d.createWidget(b,this._filePath,a)):(d=new ccs.WidgetPropertiesReader0250,e=d.createWidget(b,this._filePath,a)),(!f||250>g)&&(this._olderVersion=!0),b=null,e},clear:function(){this._filePath="",this._olderVersion=!1,this._fileDesignSizes={}},registerTypeAndCallBack:function(a,b,c,d){var e=ccs.objectFactory,f=new ccs.TInfo(a,b);e.registerType(f),c&&(this._mapObject[a]=c),d&&(this._mapParseSelector[a]=d)},getFilePath:function(){return this._filePath},setFilePath:function(a){this._filePath=a},getParseObjectMap:function(){return this._mapObject},getParseCallBackMap:function(){return this._mapParseSelector}},ccs.WidgetPropertiesReader=ccs.Class.extend({_filePath:"",createWidget:function(){},widgetFromJsonDictionary:function(){},_createGUI:function(a){var b=this._getGUIClassName(a);return ccs.objectFactory.createObject(b)},_getGUIClassName:function(a){var b=a;return"Panel"==a?b="Layout":"TextArea"==a?b="Text":"TextButton"==a?b="Button":"Label"==a?b="Text":"LabelAtlas"==a?b="TextAtlas":"LabelBMFont"==a&&(b="TextBMFont"),b},_getWidgetReaderClassName:function(a){var b=a;return"Panel"==b?b="Layout":"TextArea"==b?b="Text":"TextButton"==b?b="Button":"Label"==b?b="Text":"LabelAtlas"==b?b="TextAtlas":"LabelBMFont"==b&&(b="TextBMFont"),b+="Reader"},_getWidgetReaderClassNameFromWidget:function(a){var b="";return a instanceof ccui.Button?b="ButtonReader":a instanceof ccui.CheckBox?b="CheckBoxReader":a instanceof ccui.ImageView?b="ImageViewReader":a instanceof ccui.TextAtlas?b="TextAtlasReader":a instanceof ccui.TextBMFont?b="TextBMFontReader":a instanceof ccui.Text?b="TextReader":a instanceof ccui.LoadingBar?b="LoadingBarReader":a instanceof ccui.Slider?b="SliderReader":a instanceof ccui.TextField?b="TextFieldReader":a instanceof ccui.ListView?b="ListViewReader":a instanceof ccui.PageView?b="PageViewReader":a instanceof ccui.ScrollView?b="ScrollViewReader":a instanceof ccui.Layout?b="LayoutReader":a instanceof ccui.Widget&&(b="WidgetReader"),b},_createWidgetReaderProtocol:function(a){return ccs.objectFactory.createObject(a)}}),ccs.WidgetPropertiesReader0250=ccs.WidgetPropertiesReader.extend({createWidget:function(a,b,c){this._filePath=""==b?b:cc.path.join(b,"/");for(var d=a.textures,e=0;e<d.length;e++){var f=d[e],g=b;g+=f,cc.spriteFrameCache.addSpriteFrames(g)}var h=a.designWidth,i=a.designHeight;if(0>=h||0>=i){cc.log("Read design size error!");var j=cc.director.getWinSize();ccs.uiReader.storeFileDesignSize(c,j)}else ccs.uiReader.storeFileDesignSize(c,cc.size(h,i));var k=a.widgetTree,l=this.widgetFromJsonDictionary(k),m=l.getContentSize();0==m.width&&0==m.height&&l.setSize(cc.size(h,i));var n=a.animation;return ccs.actionManager.initWithDictionary(c,n,l),k=null,n=null,l},widgetFromJsonDictionary:function(a){var b=null,c=a.classname,d=a.options;"Button"==c?(b=ccui.Button.create(),this.setPropsForButtonFromJsonDictionary(b,d)):"CheckBox"==c?(b=ccui.CheckBox.create(),this.setPropsForCheckBoxFromJsonDictionary(b,d)):"Label"==c?(b=ccui.Text.create(),this.setPropsForLabelFromJsonDictionary(b,d)):"LabelAtlas"==c?(b=ccui.TextAtlas.create(),this.setPropsForLabelAtlasFromJsonDictionary(b,d)):"LoadingBar"==c?(b=ccui.LoadingBar.create(),this.setPropsForLoadingBarFromJsonDictionary(b,d)):"ScrollView"==c?(b=ccui.ScrollView.create(),this.setPropsForScrollViewFromJsonDictionary(b,d)):"TextArea"==c?(b=ccui.Text.create(),this.setPropsForLabelFromJsonDictionary(b,d)):"TextButton"==c?(b=ccui.Button.create(),this.setPropsForButtonFromJsonDictionary(b,d)):"TextField"==c?(b=ccui.TextField.create(),this.setPropsForTextFieldFromJsonDictionary(b,d)):"ImageView"==c?(b=ccui.ImageView.create(),this.setPropsForImageViewFromJsonDictionary(b,d)):"Panel"==c?(b=ccui.Layout.create(),this.setPropsForLayoutFromJsonDictionary(b,d)):"Slider"==c?(b=ccui.Slider.create(),this.setPropsForSliderFromJsonDictionary(b,d)):"LabelBMFont"==c?(b=ccui.TextBMFont.create(),this.setPropsForLabelBMFontFromJsonDictionary(b,d)):"DragPanel"==c&&(b=ccui.ScrollView.create(),this.setPropsForScrollViewFromJsonDictionary(b,d));for(var e=a.children,f=0;f<e.length;f++){var g=e[f],h=this.widgetFromJsonDictionary(g);h&&b.addChild(h),g=null}return d=null,b},setPropsForWidgetFromJsonDictionary:function(a,b){void 0!==b.ignoreSize&&a.ignoreContentAdaptWithSize(b.ignoreSize);var c=b.width,d=b.height;a.setSize(cc.size(c,d)),a.setTag(b.tag),a.setActionTag(b.actiontag),a.setTouchEnabled(b.touchAble);var e=b.name,f=e?e:"default";a.setName(f);var g=b.x,h=b.y;a.setPosition(cc.p(g,h)),void 0!==b.scaleX&&a.setScaleX(b.scaleX),void 0!==b.scaleY&&a.setScaleY(b.scaleY),void 0!==b.rotation&&a.setRotation(b.rotation),void 0!==b.visible&&a.setVisible(b.visible);var i=b.ZOrder;a.setLocalZOrder(i)},setPropsForAllWidgetFromJsonDictionary:function(){},setPropsForAllCustomWidgetFromJsonDictionary:function(){},setColorPropsForWidgetFromJsonDictionary:function(a,b){void 0!==b.opacity&&a.setOpacity(b.opacity);var c=void 0!==b.colorR?b.colorR:255,d=void 0!==b.colorG?b.colorG:255,e=void 0!==b.colorB?b.colorB:255;a.setColor(cc.color(c,d,e));var f=void 0!==b.anchorPointX?b.anchorPointX:a.getWidgetType()==ccui.Widget.TYPE_WIDGET?.5:0,g=void 0!==b.anchorPointY?b.anchorPointY:a.getWidgetType()==ccui.Widget.TYPE_WIDGET?.5:0;a.setAnchorPoint(f,g);var h=b.flipX,i=b.flipY;a.setFlippedX(h),a.setFlippedY(i)},setPropsForButtonFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.scale9Enable;c.setScale9Enabled(d);var e=b.normal,f=b.pressed,g=b.disabled,h=e?this._filePath+e:null,i=f?this._filePath+f:null,j=g?this._filePath+g:null,k=b.useMergedTexture;if(d){{b.capInsetsX,b.capInsetsY,b.capInsetsWidth,b.capInsetsHeight}if(k?c.loadTextures(e,f,g,ccui.Widget.PLIST_TEXTURE):c.loadTextures(h,i,j),void 0!==b.scale9Width&&void 0!==b.scale9Height){var l=b.scale9Width,m=b.scale9Height;c.setSize(cc.size(l,m))}}else k?c.loadTextures(e,f,g,ccui.Widget.PLIST_TEXTURE):c.loadTextures(h,i,j);if(void 0!==b.text){var n=b.text||"";n&&c.setTitleText(n)}void 0!==b.fontSize&&c.setTitleFontSize(b.fontSize),void 0!==b.fontName&&c.setTitleFontName(b.fontName);var o=void 0!==b.textColorR?b.textColorR:255,p=void 0!==b.textColorG?b.textColorG:255,q=void 0!==b.textColorB?b.textColorB:255,r=cc.color(o,p,q);c.setTitleColor(r),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForCheckBoxFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.backGroundBox,e=b.backGroundBoxSelected,f=b.frontCross,g=b.backGroundBoxDisabled,h=b.frontCrossDisabled,i=this._filePath,j=d?i+d:null,k=e?i+e:null,l=f?i+f:null,m=g?i+g:null,n=h?i+h:null,o=b.useMergedTexture;o?c.loadTextures(d,e,f,g,h,ccui.Widget.PLIST_TEXTURE):c.loadTextures(j,k,l,m,n),c.setSelectedState(b.selectedState||!1),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForImageViewFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.fileName,e=b.scale9Enable||!1;c.setScale9Enabled(e);var f=this._filePath,g=null;d&&(g=f+d);var h=b.useMergedTexture;if(e){if(h?c.loadTexture(d,ccui.Widget.PLIST_TEXTURE):c.loadTexture(g),void 0!==b.scale9Width&&void 0!==b.scale9Height){var i=b.scale9Width,j=b.scale9Height;c.setSize(cc.size(i,j))}var k=b.capInsetsX,l=b.capInsetsY,m=b.capInsetsWidth,n=b.capInsetsHeight;c.setCapInsets(cc.rect(k,l,m,n))}else h?c.loadTexture(d,ccui.Widget.PLIST_TEXTURE):c.loadTexture(g);this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLabelFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.touchScaleEnable;c.setTouchScaleChangeEnabled(d);var e=b.text;if(c.setString(e),void 0!==b.fontSize&&c.setFontSize(b.fontSize),void 0!==b.fontName&&c.setFontName(b.fontName),void 0!==b.areaWidth&&void 0!==b.areaHeight){var f=cc.size(b.areaWidth,b.areaHeight);c.setTextAreaSize(f)}b.hAlignment&&c.setTextHorizontalAlignment(b.hAlignment),b.vAlignment&&c.setTextVerticalAlignment(b.vAlignment),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLabelAtlasFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.charMapFileData,e=b.stringValue,f=b.itemWidth,g=b.itemHeight,h=b.startCharMap,i=void 0!==e,j=void 0!==d,k=void 0!==f,l=void 0!==g,m=void 0!==h;if(i&&j&&k&&l&&m&&d){var n=this._filePath+d;c.setProperty(e,n,f,g,h)}this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLayoutFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a;c instanceof ccui.ScrollView||c instanceof ccui.ListView||c.setClippingEnabled(b.clipAble);var d=a,e=b.backGroundScale9Enable;d.setBackGroundImageScale9Enabled(e);var f=b.bgColorR,g=b.bgColorG,h=b.bgColorB,i=b.bgStartColorR,j=b.bgStartColorG,k=b.bgStartColorB,l=b.bgEndColorR,m=b.bgEndColorG,n=b.bgEndColorB,o=b.vectorX,p=b.vectorY;d.setBackGroundColorVector(cc.p(o,p));var q=b.bgColorOpacity,r=b.colorType;d.setBackGroundColorType(r),d.setBackGroundColor(cc.color(i,j,k),cc.color(l,m,n)),d.setBackGroundColor(cc.color(f,g,h)),d.setBackGroundColorOpacity(q);var s=b.backGroundImage,t=s?this._filePath+s:null,u=b.useMergedTexture;if(u?d.setBackGroundImage(s,ccui.Widget.PLIST_TEXTURE):d.setBackGroundImage(t),e){var v=b.capInsetsX,w=b.capInsetsY,x=b.capInsetsWidth,y=b.capInsetsHeight;d.setBackGroundImageCapInsets(cc.rect(v,w,x,y))}this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForScrollViewFromJsonDictionary:function(a,b){this.setPropsForLayoutFromJsonDictionary(a,b);var c=a,d=b.innerWidth,e=b.innerHeight;c.setInnerContainerSize(cc.size(d,e));var f=b.direction;c.setDirection(f),c.setBounceEnabled(b.bounceEnable),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForContainerWidgetFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a;(c instanceof ccui.ScrollView||c instanceof ccui.ListView)&&c.setClippingEnabled(b.clipAble),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForSliderFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.barTextureScale9Enable||!1;c.setScale9Enabled(d);var e=b.length,f=b.useMergedTexture,g=void 0!==b.barFileName;if(g)if(d){var h=b.barFileName,i=h?this._filePath+h:null;f?c.loadBarTexture(h,ccui.Widget.PLIST_TEXTURE):c.loadBarTexture(i),c.setSize(cc.size(e,c.getContentSize().height))}else{var h=b.barFileName,i=h?this._filePath+h:null;f?c.loadBarTexture(h,ccui.Widget.PLIST_TEXTURE):c.loadBarTexture(i)}var j=b.ballNormal,k=b.ballPressed,l=b.ballDisabled,m=j?this._filePath+j:null,n=k?this._filePath+k:null,o=l?this._filePath+l:null;f?c.loadSlidBallTextures(j,k,l,ccui.Widget.PLIST_TEXTURE):c.loadSlidBallTextures(m,n,o),c.setPercent(b.percent);var h=b.progressBarFileName,i=h?this._filePath+h:null;f?c.loadProgressBarTexture(h,ccui.Widget.PLIST_TEXTURE):c.loadProgressBarTexture(i),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForTextAreaFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a;c.setString(b.text),void 0!==b.fontSize&&c.setFontSize(b.fontSize);var d=b.colorR,e=b.colorG,f=b.colorB;if(c.setColor(cc.color(null==d?255:d,null==e?255:e,null==f?255:f)),c.setFontName(b.fontName),void 0!==b.areaWidth&&void 0!==b.areaHeight){var g=cc.size(b.areaWidth,b.areaHeight);c.setTextAreaSize(g)}b.hAlignment&&c.setTextHorizontalAlignment(b.hAlignment),b.vAlignment&&c.setTextVerticalAlignment(b.vAlignment),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForTextButtonFromJsonDictionary:function(a,b){this.setPropsForButtonFromJsonDictionary(a,b);var c=a;c.setTitleText(b.text||"");var d=void 0!==b.textColorR?b.textColorR:255,e=void 0!==b.textColorG?b.textColorG:255,f=void 0!==b.textColorB?b.textColorB:255;c.setTitleColor(cc.color(d,e,f)),void 0!==b.fontSize&&c.setTitleFontSize(b.fontSize),void 0!==b.fontName&&c.setTitleFontName(b.fontName),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForTextFieldFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a;void 0!==b.placeHolder&&c.setPlaceHolder(b.placeHolder),c.setString(b.text),void 0!==b.fontSize&&c.setFontSize(b.fontSize),void 0!==b.fontName&&c.setFontName(b.fontName),void 0!==b.touchSizeWidth&&void 0!==b.touchSizeHeight&&c.setTouchSize(cc.size(b.touchSizeWidth,b.touchSizeHeight));var d=(b.width,b.height,b.maxLengthEnable);if(c.setMaxLengthEnabled(d),d){var e=b.maxLength;c.setMaxLength(e)}var f=b.passwordEnable;c.setPasswordEnabled(f),f&&c.setPasswordStyleText(b.passwordStyleText),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLoadingBarFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.useMergedTexture,e=b.texture,f=e?this._filePath+e:null;d?c.loadTexture(e,ccui.Widget.PLIST_TEXTURE):c.loadTexture(f),c.setDirection(b.direction),c.setPercent(b.percent),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForListViewFromJsonDictionary:function(a,b){this.setPropsForLayoutFromJsonDictionary(a,b)},setPropsForPageViewFromJsonDictionary:function(a,b){this.setPropsForLayoutFromJsonDictionary(a,b)},setPropsForLabelBMFontFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.fileName,e=this._filePath+d;c.setFntFile(e);var f=b.text;c.setString(f),this.setColorPropsForWidgetFromJsonDictionary(a,b)}}),ccs.WidgetPropertiesReader0300=ccs.WidgetPropertiesReader.extend({createWidget:function(a,b,c){this._filePath=""==b?b:cc.path.join(b,"/");for(var d=a.textures,e=0;e<d.length;e++){var f=d[e],g=b;g+=f,cc.spriteFrameCache.addSpriteFrames(g)}var h=a.designWidth,i=a.designHeight;if(0>=h||0>=i){cc.log("Read design size error!");var j=cc.director.getWinSize();ccs.uiReader.storeFileDesignSize(c,j)}else ccs.uiReader.storeFileDesignSize(c,cc.size(h,i));var k=a.widgetTree,l=this.widgetFromJsonDictionary(k),m=l.getContentSize();0==m.width&&0==m.height&&l.setSize(cc.size(h,i));var n=a.animation;return ccs.actionManager.initWithDictionary(c,n,l),k=null,n=null,l},setPropsForAllWidgetFromJsonDictionary:function(a,b,c){a&&a.setPropsFromJsonDictionary&&a.setPropsFromJsonDictionary(b,c)},setPropsForAllCustomWidgetFromJsonDictionary:function(a,b,c){var d=ccs.uiReader,e=d.getParseObjectMap(),f=e[a],g=d.getParseCallBackMap(),h=g[a];f&&h&&h.call(f,a,b,c)},widgetFromJsonDictionary:function(a){var b=a.classname,c=a.options,d=this._createGUI(b),e=this._getWidgetReaderClassName(b),f=this._createWidgetReaderProtocol(e);if(f)this.setPropsForAllWidgetFromJsonDictionary(f,d,c);else if(e=this._getWidgetReaderClassNameFromWidget(d),f=ccs.objectFactory.createObject(e),f&&d){this.setPropsForAllWidgetFromJsonDictionary(f,d,c);var g=c.customProperty,h=JSON.parse(g);this.setPropsForAllCustomWidgetFromJsonDictionary(b,d,h)}else cc.log("Widget or WidgetReader doesn't exists!!!  Please check your json file.");for(var i=a.children,j=0;j<i.length;j++){var k=this.widgetFromJsonDictionary(i[j]);if(k)if(d instanceof ccui.PageView)d.addPage(k);else if(d instanceof ccui.ListView)d.pushBackCustomItem(k);else{if(!(d instanceof ccui.Layout)){if(k.getPositionType()==ccui.Widget.POSITION_PERCENT){var l=k.getPositionPercent(),m=d.getAnchorPoint();k.setPositionPercent(cc.p(l.x+m.x,l.y+m.y))}var n=d.getAnchorPointInPoints();k.setPosition(cc.p(k.getPositionX()+n.x,k.getPositionY()+n.y))}d.addChild(k)}}return d},setPropsForWidgetFromJsonDictionary:function(a,b){var c=b.name,d=c?c:"default";a.setName(d),void 0!==b.ignoreSize&&a.ignoreContentAdaptWithSize(b.ignoreSize),a.setSizeType(b.sizeType),a.setPositionType(b.positionType),a.setSizePercent(cc.p(b.sizePercentX,b.sizePercentY)),a.setPositionPercent(cc.p(b.positionPercentX,b.positionPercentY));var e=b.width,f=b.height;a.setSize(cc.size(e,f)),a.setTag(b.tag),a.setActionTag(b.actiontag),a.setTouchEnabled(b.touchAble);var g=b.x,h=b.y;a.setPosition(cc.p(g,h)),void 0!==b.scaleX&&a.setScaleX(b.scaleX),void 0!==b.scaleY&&a.setScaleY(b.scaleY),void 0!==b.rotation&&a.setRotation(b.rotation),void 0!==b.visible&&a.setVisible(b.visible),a.setLocalZOrder(b.ZOrder);var i=b.layoutParameter;if(i){var j,k=i.type;switch(k){case 0:break;case 1:j=ccui.LinearLayoutParameter.create();var l=i.gravity;j.setGravity(l);break;case 2:j=ccui.RelativeLayoutParameter.create();var m=i.relativeName;j.setRelativeName(m);var n=i.relativeToName;j.setRelativeToWidgetName(n),j.setAlign(i.align)}var o=i.marginLeft,p=i.marginTop,q=i.marginRight,r=i.marginDown;j.setMargin(new ccui.Margin(o,p,q,r)),a.setLayoutParameter(j)}},setColorPropsForWidgetFromJsonDictionary:function(a,b){void 0!==b.opacity&&a.setOpacity(b.opacity);var c=void 0!==b.colorR?b.colorR:255,d=void 0!==b.colorG?b.colorG:255,e=void 0!==b.colorB?b.colorB:255;a.setColor(cc.color(c,d,e));var f=void 0!==b.anchorPointX?b.anchorPointX:a.getWidgetType()==ccui.Widget.TYPE_WIDGET?.5:0,g=void 0!==b.anchorPointY?b.anchorPointY:a.getWidgetType()==ccui.Widget.TYPE_WIDGET?.5:0;a.setAnchorPoint(f,g);var h=b.flipX,i=b.flipY;a.setFlippedX(h),a.setFlippedY(i)},setPropsForButtonFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.scale9Enable;c.setScale9Enabled(d);var e=b.normalData,f=e.resourceType;switch(f){case 0:var g=e.path,h=g?this._filePath+g:null;c.loadTextureNormal(h);break;case 1:var g=e.path;c.loadTextureNormal(g,ccui.Widget.PLIST_TEXTURE)}e=null;var i=b.pressedData,j=i.resourceType;switch(j){case 0:var k=i.path,l=k?this._filePath+k:null;c.loadTexturePressed(l);break;case 1:var k=i.path;c.loadTexturePressed(k,ccui.Widget.PLIST_TEXTURE)}i=null;var m=b.disabledData,n=m.resourceType;switch(n){case 0:var o=m.path,p=o?this._filePath+o:null;c.loadTextureDisabled(p);break;case 1:var o=m.path;c.loadTextureDisabled(o,ccui.Widget.PLIST_TEXTURE)}if(m=null,d){var q=b.capInsetsX,r=b.capInsetsY,s=b.capInsetsWidth,t=b.capInsetsHeight;if(c.setCapInsets(cc.rect(q,r,s,t)),void 0!==b.scale9Width&&void 0!==b.scale9Height){var u=b.scale9Width,v=b.scale9Height;c.setSize(cc.size(u,v))}}if(void 0!==b.text){var w=b.text||"";w&&c.setTitleText(w)}void 0!==b.fontSize&&c.setTitleFontSize(b.fontSize),void 0!==b.fontName&&c.setTitleFontName(b.fontName);var x=void 0!==b.textColorR?b.textColorR:255,y=void 0!==b.textColorG?b.textColorG:255,z=void 0!==b.textColorB?b.textColorB:255,A=cc.color(x,y,z);c.setTitleColor(A),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForCheckBoxFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.backGroundBoxData,e=d.resourceType;switch(e){case 0:var f=d.path,g=f?this._filePath+f:null;c.loadTextureBackGround(g);break;case 1:var f=d.path;c.loadTextureBackGround(f,ccui.Widget.PLIST_TEXTURE)}d=null;var h=b.backGroundBoxSelectedData,i=h.resourceType;switch(i){case 0:var j=h.path,k=j?this._filePath+j:null;c.loadTextureBackGroundSelected(k);break;case 1:var j=h.path;c.loadTextureBackGroundSelected(j,ccui.Widget.PLIST_TEXTURE)}h=null;var l=b.frontCrossData,m=l.resourceType;switch(m){case 0:var n=l.path,o=n?this._filePath+n:null;c.loadTextureFrontCross(o);break;case 1:var n=l.path;c.loadTextureFrontCross(n,ccui.Widget.PLIST_TEXTURE)}l=null;var p=b.backGroundBoxDisabledData,q=p.resourceType;switch(q){case 0:var r=p.path,s=r?this._filePath+r:null;c.loadTextureBackGroundDisabled(s);break;case 1:var r=p.path;c.loadTextureBackGroundDisabled(r,ccui.Widget.PLIST_TEXTURE)}p=null;var t=b.frontCrossDisabledData,u=t.resourceType;switch(u){case 0:var v=b.path,w=v?this._filePath+v:null;c.loadTextureFrontCrossDisabled(w);break;case 1:var v=b.path;c.loadTextureFrontCrossDisabled(v,ccui.Widget.PLIST_TEXTURE)}t=null;var x=b.selectedState||!1;a.setSelectedState(x),c.setSelectedState(b,"selectedState"),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForImageViewFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.fileNameData,e=d.resourceType;switch(e){case 0:var f=this._filePath,g=d.path,h=null;g&&(h=f+g,c.loadTexture(h));break;case 1:var g=d.path;c.loadTexture(g,ccui.Widget.PLIST_TEXTURE)}d=null;var i=b.scale9Enable||!1;if(c.setScale9Enabled(i),i){if(void 0!==b.scale9Width&&void 0!==b.scale9Height){var j=b.scale9Width,k=b.scale9Height;c.setSize(cc.size(j,k))}var l=b.capInsetsX,m=b.capInsetsY,n=b.capInsetsWidth,o=b.capInsetsHeight;c.setCapInsets(cc.rect(l,m,n,o))}this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLabelFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.touchScaleEnable;c.setTouchScaleChangeEnabled(d);var e=b.text;if(c.setString(e),void 0!==b.fontSize&&c.setFontSize(b.fontSize),void 0!==b.fontName&&c.setFontName(b.fontName),void 0!==b.areaWidth&&void 0!==b.areaHeight){var f=cc.size(b.areaWidth,b.areaHeight);c.setTextAreaSize(f)}b.hAlignment&&c.setTextHorizontalAlignment(b.hAlignment),b.vAlignment&&c.setTextVerticalAlignment(b.vAlignment),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLabelAtlasFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=void 0!==b.stringValue,e=void 0!==b.charMapFile,f=void 0!==b.itemWidth,g=void 0!==b.itemHeight,h=void 0!==b.startCharMap;if(d&&e&&f&&g&&h){var i=b.charMapFileData,j=i.resourceType;switch(j){case 0:var k=i.path,l=this._filePath+k;c.setProperty(b.stringValue,l,b.itemWidth,b.itemHeight,b.startCharMap);break;case 1:cc.log("Wrong res type of LabelAtlas!")}i=null}this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLayoutFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a;c instanceof ccui.ScrollView||c instanceof ccui.ListView||c.setClippingEnabled(b.clipAble);var d=b.backGroundScale9Enable;c.setBackGroundImageScale9Enabled(d);var e=b.bgColorR,f=b.bgColorG,g=b.bgColorB,h=b.bgStartColorR,i=b.bgStartColorG,j=b.bgStartColorB,k=b.bgEndColorR,l=b.bgEndColorG,m=b.bgEndColorB,n=b.vectorX,o=b.vectorY;c.setBackGroundColorVector(cc.p(n,o));var p=b.bgColorOpacity,q=b.colorType;c.setBackGroundColorType(q),c.setBackGroundColor(cc.color(h,i,j),cc.color(k,l,m)),c.setBackGroundColor(cc.color(e,f,g)),c.setBackGroundColorOpacity(p);var r=b.backGroundImageData||{},s=r.resourceType;switch(s){case 0:var t=r.path,u=t?this._filePath+t:null;c.setBackGroundImage(u);break;case 1:var t=r.path;c.setBackGroundImage(t,ccui.Widget.PLIST_TEXTURE)}if(r=null,d){var v=b.capInsetsX,w=b.capInsetsY,x=b.capInsetsWidth,y=b.capInsetsHeight;c.setBackGroundImageCapInsets(cc.rect(v,w,x,y))}c.setLayoutType(b.layoutType),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForScrollViewFromJsonDictionary:function(a,b){this.setPropsForLayoutFromJsonDictionary(a,b);var c=a,d=b.innerWidth,e=b.innerHeight;c.setInnerContainerSize(cc.size(d,e));var f=b.direction;c.setDirection(f),c.setBounceEnabled(b.bounceEnable),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForSliderFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.barTextureScale9Enable||!1;c.setScale9Enabled(d);var e=b.length,f=void 0!==b.barFileName;if(f)if(d){var g=b.barFileNameData,h=g.resourceType;switch(h){case 0:var i=g.path,j=i?this._filePath+i:null;c.loadBarTexture(j);break;case 1:var i=g.path;c.loadBarTexture(i,ccui.Widget.PLIST_TEXTURE)}c.setSize(cc.size(e,c.getContentSize().height)),g=null}else{var g=b.barFileNameData,h=g.resourceType;switch(h){case 0:var i=g.path,j=i?this._filePath+i:null;c.loadBarTexture(j);break;case 1:var i=g.path;c.loadBarTexture(i,ccui.Widget.PLIST_TEXTURE)}g=null}var k=b.ballNormalData,l=k.resourceType;switch(l){case 0:var m=k.path,n=m?this._filePath+m:null;c.loadSlidBallTextureNormal(n);break;case 1:var m=k.path;c.loadSlidBallTextureNormal(m,ccui.Widget.PLIST_TEXTURE)}k=null;var o=b.ballPressedData,p=o.resourceType;switch(p){case 0:var q=o.path,r=q?this._filePath+q:null;c.loadSlidBallTexturePressed(r);break;case 1:var q=o.path;c.loadSlidBallTexturePressed(q,ccui.Widget.PLIST_TEXTURE)}o=null;var s=b.ballDisabledData,t=s.resourceType;switch(t){case 0:var u=s.path,v=u?this._filePath+u:null;c.loadSlidBallTextureDisabled(v);break;case 1:var u=s.path;c.loadSlidBallTextureDisabled(u,ccui.Widget.PLIST_TEXTURE)}s=null;var w=b.progressBarData,x=w.resourceType;switch(x){case 0:var i=w.path,j=i?this._filePath+i:null;c.loadProgressBarTexture(j);break;case 1:var i=w.path;c.loadProgressBarTexture(i,ccui.Widget.PLIST_TEXTURE)}this.setColorPropsForWidgetFromJsonDictionary(a,b),c.setPercent(b.percent)},setPropsForTextAreaFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a;c.setString(b.text),void 0!==b.fontSize&&c.setFontSize(b.fontSize);var d=b.colorR,e=b.colorG,f=b.colorB;if(c.setColor(cc.color(null==d?255:d,null==e?255:e,null==f?255:f)),c.setFontName(b.fontName),void 0!==b.areaWidth&&void 0!==b.areaHeight){var g=cc.size(b.areaWidth,b.areaHeight);c.setTextAreaSize(g)}b.hAlignment&&c.setTextHorizontalAlignment(b.hAlignment),b.vAlignment&&c.setTextVerticalAlignment(b.vAlignment),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForTextButtonFromJsonDictionary:function(a,b){this.setPropsForButtonFromJsonDictionary(a,b);var c=a;c.setTitleText(b.text||"");var d=void 0!==b.textColorR?b.textColorR:255,e=void 0!==b.textColorG?b.textColorG:255,f=void 0!==b.textColorB?b.textColorB:255;c.setTitleColor(cc.color(d,e,f)),void 0!==b.fontSize&&c.setTitleFontSize(b.fontSize),void 0!==b.fontName&&c.setTitleFontName(b.fontName),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForTextFieldFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a;void 0!==b.placeHolder&&c.setPlaceHolder(b.placeHolder),c.setString(b.text),void 0!==b.fontSize&&c.setFontSize(b.fontSize),void 0!==b.fontName&&c.setFontName(b.fontName),void 0!==b.touchSizeWidth&&void 0!==b.touchSizeHeight&&c.setTouchSize(cc.size(b.touchSizeWidth,b.touchSizeHeight));var d=(b.width,b.height,b.maxLengthEnable);if(c.setMaxLengthEnabled(d),d){var e=b.maxLength;c.setMaxLength(e)}var f=b.passwordEnable;c.setPasswordEnabled(f),f&&c.setPasswordStyleText(b.passwordStyleText),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForLoadingBarFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.textureData,e=d.resourceType;switch(e){case 0:var f=this._filePath,g=d.path,h=null;g&&(h=f+g,c.loadTexture(h));break;case 1:var g=d.path;c.loadTexture(g,ccui.Widget.PLIST_TEXTURE)}d=null;var i=b.scale9Enable;if(c.setScale9Enabled(i),i){var j=b.capInsetsX,k=b.capInsetsY,l=b.capInsetsWidth,m=b.capInsetsHeight;c.setCapInsets(cc.rect(j,k,l,m));var n=b.width,o=b.height;c.setSize(cc.size(n,o))}c.setDirection(b.direction),c.setPercent(b.percent),this.setColorPropsForWidgetFromJsonDictionary(a,b)},setPropsForListViewFromJsonDictionary:function(a,b){this.setPropsForLayoutFromJsonDictionary(a,b);var c=b.innerWidth||0,d=b.innerHeight||0;a.setInnerContainerSize(cc.size(c,d)),a.setDirection(b.direction||0),a.setGravity(b.gravity||0),a.setItemsMargin(b.itemMargin||0)},setPropsForPageViewFromJsonDictionary:function(a,b){this.setPropsForLayoutFromJsonDictionary(a,b)
},setPropsForLabelBMFontFromJsonDictionary:function(a,b){this.setPropsForWidgetFromJsonDictionary(a,b);var c=a,d=b.fileNameData,e=d.resourceType;switch(e){case 0:var f=d.path,g=this._filePath+f;c.setFntFile(g);break;case 1:cc.log("Wrong res type of LabelAtlas!")}d=null;var h=b.text;c.setString(h),this.setColorPropsForWidgetFromJsonDictionary(a,b)}}),ccs.sceneReader={_baseBath:"",_listener:null,_selector:null,_node:null,createNodeWithSceneFile:function(a){this._node=null;do{this._baseBath=cc.path.dirname(a);var b=cc.loader.getRes(a);if(!b)throw"Please load the resource first : "+a;this._node=this.createObject(b,null),ccs.triggerManager.parse(b.Triggers||[])}while(0);return this._node},createObject:function(a,b){var c=a.classname;if("CCNode"==c){var d=null;b?(d=cc.Node.create(),b.addChild(d)):d=cc.Node.create(),this.setPropertyFromJsonDict(d,a);for(var e=a.components,f=0;f<e.length;f++){var g=e[f];if(!g)break;c=g.classname;var h=g.name,i=g.fileData,j="",k="",l=0;null!=i&&(l=void 0!==i.resourceType?i.resourceType:-1,j=cc.path.join(this._baseBath,i.path),k=i.plistFile);var m=cc.path.extname(j);if("CCSprite"==c){var n=null;if(0==l){if(".png"!=m)continue;n=cc.Sprite.create(j)}else{if(1!=l)continue;if(".plist"!=m)continue;k=cc.path.join(this._baseBath,k);var o=cc.path.changeExtname(k,".png");cc.spriteFrameCache.addSpriteFrames(k,o),n=cc.Sprite.create("#"+i.path)}var p=ccs.ComRender.create(n,"CCSprite");null!=h&&p.setName(h),d.addComponent(p),this._callSelector(n,g)}else if("CCTMXTiledMap"==c){var q=null;if(0!=l)continue;if(".tmx"!=m)continue;q=cc.TMXTiledMap.create(j);var p=ccs.ComRender.create(q,"CCTMXTiledMap");null!=h&&p.setName(h),d.addComponent(p),this._callSelector(q,g)}else if("CCParticleSystemQuad"==c){if(".plist"!=m)continue;var r=null;if(0!=l){cc.log("unknown resourcetype on CCParticleSystemQuad!");continue}r=cc.ParticleSystem.create(j),r.setPosition(0,0);var p=ccs.ComRender.create(r,"CCParticleSystemQuad");null!=h&&p.setName(h),d.addComponent(p),this._callSelector(r,g)}else if("CCArmature"==c){if(0!=l)continue;var s=cc.loader.getRes(j);s||cc.log("Please load the resource [%s] first!",j);var t=s.armature_data,u=t[0],v=u.name;ccs.armatureDataManager.addArmatureFileInfo(j);var w=ccs.Armature.create(v),p=ccs.ComRender.create(w,"CCArmature");null!=h&&p.setName(h),d.addComponent(p);var x=g.selectedactionname;x&&w.getAnimation()&&w.getAnimation().play(x),s=null,u=null,this._callSelector(w,g)}else if("CCComAudio"==c){var y=null;if(0!=l)continue;y=ccs.ComAudio.create(),y.preloadEffect(j),h&&y.setName(h),d.addComponent(y),this._callSelector(y,g)}else if("CCComAttribute"==c){var z=null;if(0!=l){cc.log("unknown resourcetype on CCComAttribute!");continue}z=ccs.ComAttribute.create(),""!=j&&z.parse(j),h&&z.setName(h),d.addComponent(z),this._callSelector(z,g)}else if("CCBackgroundAudio"==c){if(!m)continue;if(0!=l)continue;var y=ccs.ComAudio.create();y.preloadBackgroundMusic(j),y.setFile(j);var A=Boolean(g.loop||0);y.setLoop(A),h&&y.setName(h),d.addComponent(y),y.playBackgroundMusic(j,A),this._callSelector(y,g)}else if("GUIComponent"==c){var B=ccs.uiReader.widgetFromJsonFile(j),p=ccs.ComRender.create(B,"GUIComponent");null!=h&&p.setName(h),d.addComponent(p),this._callSelector(y,g)}g=null}for(var C=a.gameobjects,f=0;f<C.length;f++){var g=C[f];if(!g)break;this.createObject(g,d),g=null}return d}return null},_nodeByTag:function(a,b){if(null==a)return null;for(var c=null,d=a.getChildren(),e=0;e<d.length;e++){var f=d[e];if(f&&f.getTag()==b){c=f;break}if(c=this._nodeByTag(f,b))break}return c},getNodeByTag:function(a){return null==this._node?null:this._node.getTag()==a?this._node:this._nodeByTag(this._node,a)},setPropertyFromJsonDict:function(a,b){var c=cc.isUndefined(b.x)?0:b.x,d=cc.isUndefined(b.y)?0:b.y;a.setPosition(c,d);var e=Boolean(cc.isUndefined(b.visible)?1:b.visible);a.setVisible(e);var f=cc.isUndefined(b.objecttag)?-1:b.objecttag;a.setTag(f);var g=cc.isUndefined(b.zorder)?0:b.zorder;a.setLocalZOrder(g);var h=cc.isUndefined(b.scalex)?1:b.scalex,i=cc.isUndefined(b.scaley)?1:b.scaley;a.setScaleX(h),a.setScaleY(i);var j=cc.isUndefined(b.rotation)?0:b.rotation;a.setRotation(j)},setTarget:function(a,b){this._listener=b,this._selector=a},_callSelector:function(a,b){this._selector&&this._selector.call(this._listener,a,b)},version:function(){return"1.2.0.0"},clear:function(){ccs.triggerManager.removeAll(),cc.audioEngine.end()}},function(a){a.ActionTimelineData=a.Class.extend({_actionTag:0,ctor:function(a){this._init(a)},_init:function(a){return this._actionTag=a,!0},setActionTag:function(a){this._actionTag=a},getActionTag:function(){return this._actionTag}}),a.ActionTimelineData.create=function(b){var c=new a.ActionTimelineData;return c._init(b),c},a.ActionTimeline=cc.Action.extend({_timelineMap:null,_timelineList:null,_duration:0,_time:null,_timeSpeed:1,_frameInternal:1/60,_playing:!1,_currentFrame:0,_startFrame:0,_endFrame:0,_loop:null,_frameEventListener:null,ctor:function(){cc.Action.prototype.ctor.call(this),this._timelineMap={},this._timelineList=[],this.init()},_gotoFrame:function(a){for(var b=this._timelineList.length,c=0;b>c;c++)this._timelineList[c]._gotoFrame(a)},_stepToFrame:function(a){for(var b=this._timelineList.length,c=0;b>c;c++)this._timelineList[c]._stepToFrame(a)},_emitFrameEvent:function(a){this._frameEventListener&&this._frameEventListener(a)},init:function(){return!0},gotoFrameAndPlay:function(a,b,c,d){var e,f=0,g=arguments.length,h=[];for(f;g>f;f++)"boolean"==typeof arguments[f]?e=arguments[f]:h.push(arguments[f]);a=h[0],b=h[1]||this._duration,c=h[2]||a,d=e||!0,this._startFrame=a,this._endFrame=b,this._currentFrame=c,this._loop=d,this._time=this._currentFrame*this._frameInternal,this.resume(),this._gotoFrame(this._currentFrame)},gotoFrameAndPause:function(a){this._startFrame=this._currentFrame=a,this._time=this._currentFrame*this._frameInternal,this.pause(),this._gotoFrame(this._currentFrame)},pause:function(){this._playing=!1},resume:function(){this._playing=!0},isPlaying:function(){return this._playing},setTimeSpeed:function(a){this._timeSpeed=a},getTimeSpeed:function(){return this._timeSpeed},setDuration:function(a){this._duration=a},getDuration:function(){return this._duration},getStartFrame:function(){return this._startFrame},getEndFrame:function(){return this._endFrame},setCurrentFrame:function(a){a>=this._startFrame&&a>=this._endFrame?(this._currentFrame=a,this._time=this._currentFrame*this._frameInternal):cc.log("frame index is not between start frame and end frame")},getCurrentFrame:function(){return this._currentFrame},addTimeline:function(a){var b=a.getActionTag();this._timelineMap[b]||(this._timelineMap[b]=[]),this._timelineMap[b].some(function(b){return b===a?!0:void 0})||(this._timelineList.push(a),this._timelineMap[b].push(a),a.setActionTimeline(this))},removeTimeline:function(a){var b=a.getActionTag();this._timelineMap[b]&&this._timelineMap[b].some(function(b){return b===a?!0:void 0})&&(cc.arrayRemoveObject(this._timelineMap[b],a),cc.arrayRemoveObject(this._timelineList,a),a.setActionTimeline(null))},getTimelines:function(){return this._timelineList},setFrameEventCallFunc:function(a){this._frameEventListener=a},clearFrameEventCallFunc:function(){this._frameEventListener=null},clone:function(){var b=new a.ActionTimeline;b.setDuration(this._duration),b.setTimeSpeed(this._timeSpeed);for(var c in this._timelineMap){var d=this._timelineMap[c];for(var e in d){var f=d[e],g=f.clone();b.addTimeline(g)}}return b},reverse:function(){return null},step:function(a){this._playing&&0!=this._timelineMap.length&&0!=this._duration&&(this._time+=a*this._timeSpeed,this._currentFrame=this._time/this._frameInternal,this._stepToFrame(this._currentFrame),this._time>this._endFrame*this._frameInternal&&(this._playing=this._loop,this._playing?this.gotoFrameAndPlay(this._startFrame,this._endFrame,this._loop):this._time=this._endFrame*this._frameInternal))},_foreachNodeDescendant:function(a,b){b(a);for(var c=a.getChildren(),d=0;d<c.length;d++){var e=c[d];this._foreachNodeDescendant(e,b)}},startWithTarget:function(a){cc.Action.prototype.startWithTarget.call(this,a);var b=this,c=function(a){var c=a.getUserObject();if(c){var d=c.getActionTag();if(b._timelineMap[d])for(var e=b._timelineMap[d],f=0;f<e.length;f++){var g=e[f];g.setNode(a)}}};this._foreachNodeDescendant(a,c)},isDone:function(){return!1}}),a.ActionTimeline.create=function(){return new a.ActionTimeline}}(ccs),function(a){var b={FrameType_VisibleFrame:"VisibleFrame",FrameType_PositionFrame:"PositionFrame",FrameType_ScaleFrame:"ScaleFrame",FrameType_RotationFrame:"RotationFrame",FrameType_SkewFrame:"SkewFrame",FrameType_RotationSkewFrame:"RotationSkewFrame",FrameType_AnchorFrame:"AnchorFrame",FrameType_InnerActionFrame:"InnerActionFrame",FrameType_ColorFrame:"ColorFrame",FrameType_TextureFrame:"TextureFrame",FrameType_EventFrame:"EventFrame",FrameType_ZOrderFrame:"ZOrderFrame",ACTION:"action",DURATION:"duration",TIMELINES:"timelines",FRAME_TYPE:"frameType",FRAMES:"frames",FRAME_INDEX:"frameIndex",TWEEN:"tween",TIME_SPEED:"speed",ACTION_TAG:"actionTag",INNER_ACTION:"innerActionType",START_FRAME:"startFrame",X:"x",Y:"y",ROTATION:"rotation",ALPHA:"alpha",RED:"red",GREEN:"green",BLUE:"blue",Value:"value"};a.ActionTimelineCache={_FrameCreateFunc:null,_Pair:null,_funcs:null,_animationActions:null,init:function(){this._animationActions={},this._funcs={},this._funcs.VisibleFrame=this._loadVisibleFrame,this._funcs.PositionFrame=this._loadPositionFrame,this._funcs.ScaleFrame=this._loadScaleFrame,this._funcs.RotationFrame=this._loadRotationFrame,this._funcs.SkewFrame=this._loadSkewFrame,this._funcs.RotationSkewFrame=this._loadRotationSkewFrame,this._funcs.AnchorFrame=this._loadAnchorPointFrame,this._funcs.InnerActionFrame=this._loadInnerActionFrame,this._funcs.ColorFrame=this._loadColorFrame,this._funcs.TextureFrame=this._loadTextureFrame,this._funcs.EventFrame=this._loadEventFrame,this._funcs.ZOrderFrame=this._loadZOrderFrame},removeAction:function(a){this._animationActions[a]&&delete this._animationActions[a]},createAction:function(a){var b=this._animationActions[a];return null==b&&(b=this.loadAnimationActionWithFile(a)),b.clone()},loadAnimationActionWithFile:function(a){var b=cc.loader.getRes(a);return this.loadAnimationActionWithContent(a,b)},loadAnimationActionWithContent:function(c,d){var e=this._animationActions[c];if(e)return e;var f=d[b.ACTION];e=new a.ActionTimeline,e.setDuration(f[b.DURATION]),e.setTimeSpeed(f[b.TIME_SPEED]||1);for(var g=f[b.TIMELINES].length,h=0;g>h;h++){var i=f[b.TIMELINES][h],j=this._loadTimeline(i);j&&e.addTimeline(j)}return this._animationActions[c]=e,e},_loadTimeline:function(c){var d=null,e=c[b.FRAME_TYPE];if(null==e)return null;if(e&&this._funcs[e]){d=new a.Timeline;var f=c[b.ACTION_TAG];d.setActionTag(f);for(var g=this._funcs[e],h=c[b.FRAMES].length,i=0;h>i;i++){var j=c[b.FRAMES][i],k=null;if(null!=g){k=g(j);var l=j[b.FRAME_INDEX];k.setFrameIndex(l);var m=j[b.TWEEN]||!1;k.setTween(m)}d.addFrame(k)}}return d},_loadVisibleFrame:function(c){var d=new a.VisibleFrame,e=c[b.Value];return d.setVisible(e),d},_loadPositionFrame:function(c){var d=new a.PositionFrame,e=c[b.X],f=c[b.Y];return d.setPosition(cc.p(e,f)),d},_loadScaleFrame:function(c){var d=new a.ScaleFrame,e=c[b.X],f=c[b.Y];return d.setScaleX(e),d.setScaleY(f),d},_loadSkewFrame:function(c){var d=new a.SkewFrame,e=c[b.X],f=c[b.Y];return d.setSkewX(e),d.setSkewY(f),d},_loadRotationSkewFrame:function(c){var d=new a.RotationSkewFrame,e=c[b.X],f=c[b.Y];return d.setSkewX(e),d.setSkewY(f),d},_loadRotationFrame:function(c){var d=new a.RotationFrame,e=c[b.ROTATION];return d.setRotation(e),d},_loadAnchorPointFrame:function(c){var d=new a.AnchorPointFrame,e=c[b.X],f=c[b.Y];return d.setAnchorPoint(Point(e,f)),d},_loadInnerActionFrame:function(c){var d=new a.InnerActionFrame,e=c[b.INNER_ACTION],f=c[b.START_FRAME];return d.setInnerActionType(e),d.setStartFrameIndex(f),d},_loadColorFrame:function(c){var d=new a.ColorFrame,e=c[b.ALPHA],f=c[b.RED],g=c[b.GREEN],h=c[b.BLUE];return d.setAlpha(e),d.setColor(cc.color(f,g,h)),d},_loadTextureFrame:function(c){var d=new a.TextureFrame,e=c[b.Value];if(null!=e){var f=e,g=cc.spriteFrameCache.getSpriteFrame(f);if(null==g){var h=a.NodeReader.getJsonPath();f=h+e}d.setTextureName(f)}return d},_loadEventFrame:function(c){var d=new a.EventFrame,e=c[b.Value];return null!=e&&d.setEvent(e),d},_loadZOrderFrame:function(c){var d=new a.ZOrderFrame,e=c[b.Value];return d.setZOrder(e),d}},a.ActionTimelineCache.init(),a.ActionTimelineCache._sharedActionCache=null}(ccs),ccs.Frame=ccs.Class.extend({_frameIndex:null,_tween:null,_timeline:null,_node:null,ctor:function(){this._frameIndex=0,this._tween=!0,this._timeline=null,this._node=null},_emitEvent:function(){this._timeline&&this._timeline.getActionTimeline()._emitFrameEvent(this)},_cloneProperty:function(a){this._frameIndex=a.getFrameIndex(),this._tween=a.isTween()},setFrameIndex:function(a){this._frameIndex=a},getFrameIndex:function(){return this._frameIndex},setTimeline:function(a){this._timeline=a},getTimeline:function(){return this._timeline},setNode:function(a){this._node=a},getNode:function(){return this._node},setTween:function(a){this._tween=a},isTween:function(){return this._tween},onEnter:function(){},apply:function(){},clone:function(){}}),ccs.VisibleFrame=ccs.Frame.extend({_visible:!0,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._visible=!0},onEnter:function(){this._node.setVisible(this._visible)},clone:function(){var a=new ccs.VisibleFrame;return a.setVisible(this._visible),a._cloneProperty(this),a},setVisible:function(a){this._visible=a},isVisible:function(){return this._visible}}),ccs.VisibleFrame.create=function(){return new ccs.VisibleFrame},ccs.TextureFrame=ccs.Frame.extend({_sprite:null,_textureName:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._textureName=""},setNode:function(a){ccs.Frame.prototype.setNode.call(this,a),this._sprite=a},onEnter:function(){if(this._sprite){var a=cc.spriteFrameCache.getSpriteFrame(this._textureName);null!=a?this._sprite.setSpriteFrame(a):this._sprite.setTexture(this._textureName)}},clone:function(){var a=new ccs.TextureFrame;return a.setTextureName(this._textureName),a._cloneProperty(this),a},setTextureName:function(a){this._textureName=a},getTextureName:function(){return this._textureName}}),ccs.TextureFrame.create=function(){return new ccs.TextureFrame},ccs.RotationFrame=ccs.Frame.extend({_rotation:null,_betwennRotation:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._rotation=0},onEnter:function(a){this._node.setRotation(this._rotation),this._tween&&(this._betwennRotation=a._rotation-this._rotation)},apply:function(a){if(this._tween&&0!=this._betwennRotation){var b=this._rotation+a*this._betwennRotation;this._node.setRotation(b)}},clone:function(){var a=new ccs.RotationFrame;return a.setRotation(this._rotation),a._cloneProperty(this),a},setRotation:function(a){this._rotation=a},getRotation:function(){return this._rotation}}),ccs.RotationFrame.create=function(){return new ccs.RotationFrame},ccs.SkewFrame=ccs.Frame.extend({_skewX:null,_skewY:null,_betweenSkewX:null,_betweenSkewY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._skewX=0,this._skewY=0},onEnter:function(a){this._node.setSkewX(this._skewX),this._node.setSkewY(this._skewY),this._tween&&(this._betweenSkewX=a._skewX-this._skewX,this._betweenSkewY=a._skewY-this._skewY)},apply:function(a){if(this._tween&&(0!=this._betweenSkewX||0!=this._betweenSkewY)){var b=this._skewX+a*this._betweenSkewX,c=this._skewY+a*this._betweenSkewY;this._node.setSkewX(b),this._node.setSkewY(c)}},clone:function(){var a=new ccs.SkewFrame;return a.setSkewX(this._skewX),a.setSkewY(this._skewY),a._cloneProperty(this),a},setSkewX:function(a){this._skewX=a},getSkewX:function(){return this._skewX},setSkewY:function(a){this._skewY=a},getSkewY:function(){return this._skewY}}),ccs.SkewFrame.create=function(){return new ccs.SkewFrame},ccs.RotationSkewFrame=ccs.SkewFrame.extend({onEnter:function(a){this._node.setRotationX(this._skewX),this._node.setRotationY(this._skewY),this._tween&&(this._betweenSkewX=a._skewX-this._skewX,this._betweenSkewY=a._skewY-this._skewY)},apply:function(a){if(this._tween&&(0!=this._betweenSkewX||0!=this._betweenSkewY)){var b=this._skewX+a*this._betweenSkewX,c=this._skewY+a*this._betweenSkewY;this._node.setRotationX(b),this._node.setRotationY(c)}},clone:function(){var a=new ccs.RotationSkewFrame;return a.setSkewX(this._skewX),a.setSkewY(this._skewY),a._cloneProperty(this),a}}),ccs.RotationSkewFrame.create=function(){return new ccs.RotationSkewFrame},ccs.PositionFrame=ccs.Frame.extend({_position:null,_betweenX:null,_betweenY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._position=cc.p(0,0)},onEnter:function(a){this._node.setPosition(this._position),this._tween&&(this._betweenX=a._position.x-this._position.x,this._betweenY=a._position.y-this._position.y)},apply:function(a){if(this._tween&&(0!=this._betweenX||0!=this._betweenY)){var b=cc.p(0,0);b.x=this._position.x+this._betweenX*a,b.y=this._position.y+this._betweenY*a,this._node.setPosition(b)}},clone:function(){var a=new ccs.PositionFrame;return a.setPosition(this._position),a._cloneProperty(this),a},setPosition:function(a){this._position=a},getPosition:function(){return this._position},setX:function(a){this._position.x=a},getX:function(){return this._position.x},setY:function(a){this._position.y=a},getY:function(){return this._position.y}}),ccs.PositionFrame.create=function(){return new ccs.PositionFrame},ccs.ScaleFrame=ccs.Frame.extend({_scaleX:null,_scaleY:null,_betweenScaleX:null,_betweenScaleY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1},onEnter:function(a){this._node.setScaleX(this._scaleX),this._node.setScaleY(this._scaleY),this._tween&&(this._betweenScaleX=a._scaleX-this._scaleX,this._betweenScaleY=a._scaleY-this._scaleY)},apply:function(a){if(this._tween&&(0!=this._betweenScaleX||0!=this._betweenScaleY)){var b=this._scaleX+this._betweenScaleX*a,c=this._scaleY+this._betweenScaleY*a;this._node.setScaleX(b),this._node.setScaleY(c)}},clone:function(){var a=new ccs.ScaleFrame;return a.setScaleX(this._scaleX),a.setScaleY(this._scaleY),a._cloneProperty(this),a},setScale:function(a){this._scaleX=a,this._scaleY=a},setScaleX:function(a){this._scaleX=a},getScaleX:function(){return this._scaleX},setScaleY:function(a){this._scaleY=a},getScaleY:function(){return this._scaleY}}),ccs.ScaleFrame.create=function(){return new ccs.ScaleFrame},ccs.AnchorPointFrame=ccs.Frame.extend({_anchorPoint:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._anchorPoint=cc.p(0,0)},onEnter:function(){this._node.setAnchorPoint(this._anchorPoint)},clone:function(){var a=new ccs.AnchorPointFrame;return a.setAnchorPoint(this._anchorPoint),a._cloneProperty(this),a},setAnchorPoint:function(a){this._anchorPoint=a},getAnchorPoint:function(){return this._anchorPoint}}),ccs.AnchorPointFrame.create=function(){return new ccs.AnchorPointFrame},ccs.InnerActionType={LoopAction:0,NoLoopAction:1,SingleFrame:2},ccs.InnerActionFrame=ccs.Frame.extend({_innerActionType:null,_startFrameIndex:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._innerActionType=ccs.InnerActionType.LoopAction,this._startFrameIndex=0},onEnter:function(){},clone:function(){var a=new ccs.InnerActionFrame;return a.setInnerActionType(this._innerActionType),a.setStartFrameIndex(this._startFrameIndex),a._cloneProperty(this),a},setInnerActionType:function(a){this._innerActionType=a},getInnerActionType:function(){return this._innerActionType},setStartFrameIndex:function(a){this._startFrameIndex=a},getStartFrameIndex:function(){return this._startFrameIndex}}),ccs.InnerActionFrame.create=function(){return new ccs.InnerActionFrame},ccs.ColorFrame=ccs.Frame.extend({_alpha:null,_color:null,_betweenAlpha:null,_betweenRed:null,_betweenGreen:null,_betweenBlue:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._alpha=255,this.color=cc.color(255,255,255)},onEnter:function(a){if(this._node.setOpacity(this._alpha),this._node.setColor(this._color),this._tween){this._betweenAlpha=a._alpha-this._alpha;var b=a._color;this._betweenRed=b.r-this._color.r,this._betweenGreen=b.g-this._color.g,this._betweenBlue=b.b-this._color.b}},apply:function(a){if(this._tween&&(0!=this._betweenAlpha||0!=this._betweenRed||0!=this._betweenGreen||0!=this._betweenBlue)){var b=this._alpha+this._betweenAlpha*a,c=cc.color(255,255,255);c.r=this._color.r+this._betweenRed*a,c.g=this._color.g+this._betweenGreen*a,c.b=this._color.b+this._betweenBlue*a,this._node.setOpacity(b),this._node.setColor(c)}},clone:function(){var a=new ccs.ColorFrame;return a.setAlpha(this._alpha),a.setColor(this._color),a._cloneProperty(this),a},setAlpha:function(a){this._alpha=a},getAlpha:function(){return this._alpha},setColor:function(a){this._color=a},getColor:function(){return this._color}}),ccs.ColorFrame.create=function(){return new ccs.ColorFrame},ccs.EventFrame=ccs.Frame.extend({_event:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._event=""},onEnter:function(){this._emitEvent()},clone:function(){var a=new ccs.EventFrame;return a.setEvent(this._event),a._cloneProperty(this),a},setEvent:function(a){this._event=a},getEvent:function(){return this._event}}),ccs.EventFrame.create=function(){return new ccs.EventFrame},ccs.ZOrderFrame=ccs.Frame.extend({_zorder:null,onEnter:function(){this._node&&this._node.setLocalZOrder(this._zorder)},clone:function(){var a=new ccs.ZOrderFrame;return a.setZOrder(this._zorder),a._cloneProperty(this),a},setZOrder:function(a){this._zorder=a},getZOrder:function(){return this._zorder}}),ccs.ZOrderFrame.create=function(){return new ccs.ZOrderFrame},function(a){var b={ClassName_Node:"Node",ClassName_SubGraph:"SubGraph",ClassName_Sprite:"Sprite",ClassName_Particle:"Particle",ClassName_Panel:"Panel",ClassName_Button:"Button",ClassName_CheckBox:"CheckBox",ClassName_ImageView:"ImageView",ClassName_TextAtlas:"TextAtlas",ClassName_LabelAtlas:"LabelAtlas",ClassName_LabelBMFont:"LabelBMFont",ClassName_TextBMFont:"TextBMFont",ClassName_Text:"Text",ClassName_LoadingBar:"LoadingBar",ClassName_TextField:"TextField",ClassName_Slider:"Slider",ClassName_Layout:"Layout",ClassName_ScrollView:"ScrollView",ClassName_ListView:"ListView",ClassName_PageView:"PageView",ClassName_Widget:"Widget",ClassName_Label:"Label",NODE:"nodeTree",CHILDREN:"children",CLASSNAME:"classname",FILE_PATH:"fileName",PLIST_FILE:"plistFile",TAG:"tag",ACTION_TAG:"actionTag",OPTIONS:"options",WIDTH:"width",HEIGHT:"height",X:"x",Y:"y",SCALE_X:"scaleX",SCALE_Y:"scaleY",SKEW_X:"skewX",SKEW_Y:"skewY",ROTATION:"rotation",ROTATION_SKEW_X:"rotationSkewX",ROTATION_SKEW_Y:"rotationSkewY",ANCHOR_X:"anchorPointX",ANCHOR_Y:"anchorPointY",ALPHA:"opacity",RED:"colorR",GREEN:"colorG",BLUE:"colorB",ZORDER:"ZOrder",PARTICLE_NUM:"particleNum",FLIPX:"flipX",FLIPY:"flipY",VISIBLE:"visible",TEXTURES:"textures",TEXTURES_PNG:"texturesPng"};a.NodeReader={_funcs:null,_recordJsonPath:!0,_jsonPath:"",_sharedNodeReader:null,init:function(){this._funcs={},this._funcs[b.ClassName_Node]=a.NodeReader._loadSimpleNode.bind(this),this._funcs[b.ClassName_SubGraph]=a.NodeReader._loadSubGraph.bind(this),this._funcs[b.ClassName_Sprite]=a.NodeReader._loadSprite.bind(this),this._funcs[b.ClassName_Particle]=a.NodeReader._loadParticle.bind(this),this._funcs[b.ClassName_LabelAtlas]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_LabelBMFont]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_Panel]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_Button]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_CheckBox]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_ImageView]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_TextAtlas]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_TextBMFont]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_Text]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_LoadingBar]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_TextField]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_Slider]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_Layout]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_ScrollView]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_ListView]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_PageView]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_Widget]=a.NodeReader._loadWidget.bind(this),this._funcs[b.ClassName_Label]=a.NodeReader._loadWidget.bind(this)},createNode:function(b){if(this._recordJsonPath){var c=b.substr(0,b.lastIndexOf("/")+1);a.uiReader.setFilePath(c),this._jsonPath=c}else a.uiReader.setFilePath(""),this._jsonPath="";return this.loadNodeWithFile(b)},loadNodeWithFile:function(b){var c=cc.loader.getRes(b),d=this.loadNodeWithContent(c);return a.ActionTimelineCache.loadAnimationActionWithContent(b,c),d},loadNodeWithContent:function(a){for(var c=a[b.TEXTURES].length,d=0;c>d;d++){var e=a[b.TEXTURES][d],f=a[b.TEXTURES_PNG][d];e=this._jsonPath+e,f=this._jsonPath+f,cc.spriteFrameCache.addSpriteFrames(e,f)}var g=a[b.NODE];return this._loadNode(g)},setRecordJsonPath:function(a){this._recordJsonPath=a},isRecordJsonPath:function(){return this._recordJsonPath},setJsonPath:function(a){this._jsonPath=a},getJsonPath:function(){return this._jsonPath},_loadNode:function(a){var c=null,d=a[b.CLASSNAME],e=this._funcs[d];if(null!=e){var f=a[b.OPTIONS];c=e(f)}if(c)for(var g=a[b.CHILDREN]&&a[b.CHILDREN].length?a[b.CHILDREN].length:0,h=0;g>h;h++){var i=a[b.CHILDREN][h],j=this._loadNode(i);if(j){var k=j;k&&c instanceof ccui.Widget&&!(c instanceof ccui.Layout)&&(k.getPositionType()==ccui.Widget.POSITION_PERCENT&&k.setPositionPercent(cc.p(k.getPositionPercent().x+c.getAnchorPoint().x,k.getPositionPercent().y+c.getAnchorPoint().y)),k.setPosition(cc.p(k.getPositionX()+c.getAnchorPointInPoints().x,k.getPositionY()+c.getAnchorPointInPoints().y))),c.addChild(j)}}else cc.log("Not supported NodeType: %s",d.c_str());return c},_initNode:function(c,d){var e=d[b.WIDTH],f=d[b.HEIGHT],g=d[b.X],h=d[b.Y],i=d[b.SCALE_X]||1,j=d[b.SCALE_Y]||1,k=d[b.ROTATION],l=d[b.ROTATION_SKEW_X],m=d[b.ROTATION_SKEW_Y],n=d[b.SKEW_X],o=d[b.SKEW_Y],p=d[b.ANCHOR_X]||.5,q=d[b.ANCHOR_Y]||.5,r=d[b.ALPHA]||255,s=d[b.RED]||255,t=d[b.GREEN]||255,u=d[b.BLUE]||255,v=d[b.ZORDER],w=d[b.TAG],x=d[b.ACTION_TAG],y=d[b.VISIBLE];g&&h&&(0!=g||0!=h)&&c.setPosition(g,h),1!=i&&c.setScaleX(i),1!=j&&c.setScaleY(j),k&&0!=k&&c.setRotation(k),l&&c.setRotationSkewX(l),m&&c.setRotationSkewY(m),n&&c.setSkewX(n),o&&c.setSkewY(o),(.5!=p||.5!=q)&&c.setAnchorPoint(cc.p(p,q)),e&&f&&(0!=e||0!=f)&&c.setContentSize(cc.size(e,f)),v&&c.setLocalZOrder(v),void 0!==y&&1!=y&&c.setVisible(y),255!=r&&c.setOpacity(r),(255!=s||255!=t||255!=u)&&c.setColor(cc.color(s,t,u)),null!=w&&c.setTag(w),x&&c.setUserObject(new a.ActionTimelineData(x))},_loadSimpleNode:function(a){var b=new cc.Node;return this._initNode(b,a),b},_loadSubGraph:function(a){var c=a[b.FILE_PATH],d=null;return d=c&&""!=c?this.createNode(c):new cc.Node,d.retain(),this._initNode(d,a),d},_loadSprite:function(a){var c=a[b.FILE_PATH],d=null;if(null!=c){var e=c,f=cc.spriteFrameCache.getSpriteFrame(e);f?d=cc.Sprite.createWithSpriteFrame(f):(e=this._jsonPath+e,d=new cc.Sprite(e)),d||(d=new cc.Sprite,cc.log("filePath is empty. Create a sprite with no texture"))}else d=new cc.Sprite;d.retain(),this._initNode(d,a);var g=a[b.FLIPX],h=a[b.FLIPY];return 0!=g&&d.setFlippedX(g),0!=h&&d.setFlippedY(h),d},_loadParticle:function(c){var d=c[b.PLIST_FILE],e=c[b.PARTICLE_NUM],f=new a.ParticleSystemQuad(d);return f.setTotalParticles(e),f.retain(),this._initNode(f,c),f},_loadWidget:function(c){var d=c[b.CLASSNAME];if(null==d)return null;var e=d;"Panel"==e?e="Layout":"TextArea"==e?e="Text":"TextButton"==e?e="Button":"Label"==e?e="Text":"LabelAtlas"==e?e="TextAtlas":"LabelBMFont"==e&&(e="TextBMFont");var f=e;f.append("Reader");var g=a.objectFactory.createObject(e),h=a.objectFactory.createObject(f),i=new a.WidgetPropertiesReader0300;i.setPropsForAllWidgetFromJsonDictionary(h,g,c);var j=c[b.ACTION_TAG];return g.setUserObject(new a.ActionTimelineData(j)),this._initNode(g,c),g}},a.NodeReader.init()}(ccs),ccs.Timeline=ccs.Class.extend({_frames:null,_currentKeyFrame:null,_currentKeyFrameIndex:null,_fromIndex:null,_toIndex:null,_betweenDuration:null,_actionTag:null,_ActionTimeline:null,_node:null,ctor:function(){this._frames=[],this._currentKeyFrame=null,this._currentKeyFrameIndex=0,this._fromIndex=0,this._toIndex=0,this._betweenDuration=0,this._actionTag=0,this._ActionTimeline=null,this._node=null},_gotoFrame:function(a){0!=this._frames.length&&(this._binarySearchKeyFrame(a),this._apply(a))},_stepToFrame:function(a){0!=this._frames.length&&(this._updateCurrentKeyFrame(a),this._apply(a))},getFrames:function(){return this._frames},addFrame:function(a){this._frames.push(a),a.setTimeline(this)},insertFrame:function(a,b){this._frames.splice(b,0,a),a.setTimeline(this)},removeFrame:function(a){cc.arrayRemoveObject(this._frames,a),a.setTimeline(null)},setActionTag:function(a){this._actionTag=a},getActionTag:function(){return this._actionTag},setNode:function(a){for(var b=0;b<this._frames.length;b++){var c=this._frames[b];c.setNode(a)}},getNode:function(){return this._node},setActionTimeline:function(a){this._ActionTimeline=a},getActionTimeline:function(){return this._ActionTimeline},clone:function(){var a=new ccs.Timeline;a._actionTag=this._actionTag;for(var b=0;b<this._frames.length;b++){var c=this._frames[b],d=c.clone();a.addFrame(d)}return a},_apply:function(a){if(this._currentKeyFrame){var b=0==this._betweenDuration?0:(a-this._currentKeyFrameIndex)/this._betweenDuration;this._currentKeyFrame.apply(b)}},_binarySearchKeyFrame:function(a){var b=null,c=null,d=this._frames.length,e=!1;do{if(a<=this._frames[0].getFrameIndex()){this._currentKeyFrameIndex>=this._frames[0].getFrameIndex()&&(e=!0),b=c=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(a>=this._frames[d-1].getFrameIndex()){b=c=this._frames[d-1],this._currentKeyFrameIndex=this._frames[d-1].getFrameIndex(),this._betweenDuration=0;break}for(var f=-1,g=0,h=d-1,i=0;h>=g;){if(i=Math.ceil((g+h)/2),a>=this._frames[i].getFrameIndex()&&a<this._frames[i+1].getFrameIndex()){f=i;break}this._frames[i].getFrameIndex()>a?h=i-1:g=i+1}b=this._frames[f],c=this._frames[f+1],0==f&&this._currentKeyFrameIndex<b.getFrameIndex()&&(e=!0),this._currentKeyFrameIndex=b.getFrameIndex(),this._betweenDuration=c.getFrameIndex()-b.getFrameIndex()}while(0);(e||this._currentKeyFrame!=b)&&(this._currentKeyFrame=b,this._currentKeyFrame.onEnter(c))},_updateCurrentKeyFrame:function(a){if(a<this._currentKeyFrameIndex||a>=this._currentKeyFrameIndex+this._betweenDuration){var b=null,c=null;do{var d=this._frames.length;if(a<this._frames[0].getFrameIndex()){b=c=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(a>=this._frames[d-1].getFrameIndex()){b=c=this._frames[d-1],this._currentKeyFrameIndex=this._frames[d-1].getFrameIndex(),this._betweenDuration=0;break}do if(this._fromIndex=this._toIndex,b=this._frames[this._fromIndex],this._currentKeyFrameIndex=b.getFrameIndex(),this._toIndex=this._fromIndex+1,this._toIndex>=d&&(this._toIndex=0),c=this._frames[this._toIndex],a==b.getFrameIndex())break;while(a<b.getFrameIndex()||a>=c.getFrameIndex());this._betweenDuration=c.getFrameIndex()-b.getFrameIndex()}while(0);this._currentKeyFrame=b,this._currentKeyFrame.onEnter(c)}}}),ccs.Timeline.create=function(){return new ccs.Timeline};