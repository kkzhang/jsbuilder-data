cc.PointObject=cc.Class.extend({_ratio:null,_offset:null,_child:null,ctor:function(a,b){this.initWithCCPoint(a,b)},getRatio:function(){return this._ratio},setRatio:function(a){this._ratio=a},getOffset:function(){return this._offset},setOffset:function(a){this._offset=a},getChild:function(){return this._child},setChild:function(a){this._child=a},initWithCCPoint:function(a,b){return this._ratio=a,this._offset=b,this._child=null,!0}}),cc.PointObject.create=function(a,b){return new cc.PointObject(a,b)},cc.ParallaxNode=cc.Node.extend({parallaxArray:null,_lastPosition:null,_className:"ParallaxNode",getParallaxArray:function(){return this.parallaxArray},setParallaxArray:function(a){this.parallaxArray=a},ctor:function(){cc.Node.prototype.ctor.call(this),this.parallaxArray=[],this._lastPosition=cc.p(-100,-100)},addChild:function(a,b,c,d){if(3===arguments.length)return void cc.log("ParallaxNode: use addChild(child, z, ratio, offset) instead");if(!a)throw"cc.ParallaxNode.addChild(): child should be non-null";var e=new cc.PointObject(c,d);e.setChild(a),this.parallaxArray.push(e),a.setPosition(this._position.x*c.x+d.x,this._position.y*c.y+d.y),cc.Node.prototype.addChild.call(this,a,b,a.tag)},removeChild:function(a,b){for(var c=this.parallaxArray,d=0;d<c.length;d++){var e=c[d];if(e.getChild()==a){c.splice(d,1);break}}cc.Node.prototype.removeChild.call(this,a,b)},removeAllChildren:function(a){this.parallaxArray.length=0,cc.Node.prototype.removeAllChildren.call(this,a)},visit:function(){var a=this._absolutePosition();if(!cc.pointEqualToPoint(a,this._lastPosition)){for(var b=this.parallaxArray,c=0,d=b.length;d>c;c++){var e=b[c],f=e.getChild();f.setPosition(-a.x+a.x*e.getRatio().x+e.getOffset().x,-a.y+a.y*e.getRatio().y+e.getOffset().y)}this._lastPosition=a}cc.Node.prototype.visit.call(this)},_absolutePosition:function(){for(var a=this._position,b=this;null!=b.parent;)b=b.parent,a=cc.pAdd(a,b.getPosition());return a},_transformForRenderer:function(){var a=this._absolutePosition();if(!cc.pointEqualToPoint(a,this._lastPosition)){for(var b=this.parallaxArray,c=0,d=b.length;d>c;c++){var e=b[c],f=e.getChild();f.setPosition(-a.x+a.x*e.getRatio().x+e.getOffset().x,-a.y+a.y*e.getRatio().y+e.getOffset().y)}this._lastPosition=a}cc.Node.prototype._transformForRenderer.call(this)}}),cc.ParallaxNode.create=function(){return new cc.ParallaxNode};