cc.CONTROL_EVENT_TOTAL_NUMBER=9,cc.CONTROL_EVENT_TOUCH_DOWN=1,cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE=2,cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE=4,cc.CONTROL_EVENT_TOUCH_DRAG_ENTER=8,cc.CONTROL_EVENT_TOUCH_DRAG_EXIT=16,cc.CONTROL_EVENT_TOUCH_UP_INSIDE=32,cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE=64,cc.CONTROL_EVENT_TOUCH_CANCEL=128,cc.CONTROL_EVENT_VALUECHANGED=256,cc.CONTROL_STATE_NORMAL=1,cc.CONTROL_STATE_HIGHLIGHTED=2,cc.CONTROL_STATE_DISABLED=4,cc.CONTROL_STATE_SELECTED=8,cc.CONTROL_STATE_INITIAL=8,cc.Control=cc.Layer.extend({_isOpacityModifyRGB:!1,_hasVisibleParents:!1,_touchListener:null,_className:"Control",isOpacityModifyRGB:function(){return this._isOpacityModifyRGB},setOpacityModifyRGB:function(a){this._isOpacityModifyRGB=a;for(var b=this.getChildren(),c=0,d=b.length;d>c;c++){var e=b[c];e&&e.setOpacityModifyRGB(a)}},_state:cc.CONTROL_STATE_NORMAL,getState:function(){return this._state},_enabled:!1,_selected:!1,_highlighted:!1,_dispatchTable:null,setEnabled:function(a){this._enabled=a,this._state=a?cc.CONTROL_STATE_NORMAL:cc.CONTROL_STATE_DISABLED,this.needsLayout()},isEnabled:function(){return this._enabled},setSelected:function(a){this._selected=a,this.needsLayout()},isSelected:function(){return this._selected},setHighlighted:function(a){this._highlighted=a,this.needsLayout()},isHighlighted:function(){return this._highlighted},hasVisibleParents:function(){for(var a=this.getParent(),b=a;null!=b;b=b.getParent())if(!b.isVisible())return!1;return!0},ctor:function(){cc.Layer.prototype.ctor.call(this),this._dispatchTable={},this._color=cc.color.WHITE},init:function(){if(cc.Layer.prototype.init.call(this)){this._state=cc.CONTROL_STATE_NORMAL,this._enabled=!0,this._selected=!1,this._highlighted=!1;var a=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE});return this.onTouchBegan&&(a.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(a.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(a.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(a.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=a,!0}return!1},onEnter:function(){var a=this._touchListener;a._isRegistered()||cc.eventManager.addListener(a,this),cc.Node.prototype.onEnter.call(this)},sendActionsForControlEvents:function(a){for(var b=0,c=cc.CONTROL_EVENT_TOTAL_NUMBER;c>b;b++)if(a&1<<b)for(var d=this._dispatchListforControlEvent(1<<b),e=0,f=d.length;f>e;e++)d[e].invoke(this)},addTargetWithActionForControlEvents:function(a,b,c){for(var d=0,e=cc.CONTROL_EVENT_TOTAL_NUMBER;e>d;d++)c&1<<d&&this._addTargetWithActionForControlEvent(a,b,1<<d)},removeTargetWithActionForControlEvents:function(a,b,c){for(var d=0,e=cc.CONTROL_EVENT_TOTAL_NUMBER;e>d;d++)c&1<<d&&this._removeTargetWithActionForControlEvent(a,b,1<<d)},getTouchLocation:function(a){var b=a.getLocation();return this.convertToNodeSpace(b)},isTouchInside:function(a){var b=a.getLocation();return b=this.getParent().convertToNodeSpace(b),cc.rectContainsPoint(this.getBoundingBox(),b)},_invocationWithTargetAndActionForControlEvent:function(){return null},_dispatchListforControlEvent:function(a){return a=a.toString(),this._dispatchTable[a]||(this._dispatchTable[a]=[]),this._dispatchTable[a]},_addTargetWithActionForControlEvent:function(a,b,c){var d=new cc.Invocation(a,b,c),e=this._dispatchListforControlEvent(c);e.push(d)},_removeTargetWithActionForControlEvent:function(a,b,c){var d=this._dispatchListforControlEvent(c);if(a||b)for(var e=0;e<d.length;){var f=d[e],g=!0;a&&(g=a==f.getTarget()),b&&(g=g&&b==f.getAction()),g?cc.arrayRemoveObject(d,f):e++}else d.length=0},needsLayout:function(){}});var _p=cc.Control.prototype;_p.state,cc.defineGetterSetter(_p,"state",_p.getState),_p.enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),_p.selected,cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),_p.highlighted,cc.defineGetterSetter(_p,"highlighted",_p.isHighlighted,_p.setHighlighted),_p=null,cc.Control.create=function(){var a=new cc.Control;return a&&a.init()?a:null},cc.CONTROL_ZOOM_ACTION_TAG=3435855873,cc.ControlButton=cc.Control.extend({_doesAdjustBackgroundImage:!1,zoomOnTouchDown:!1,_preferredSize:null,_labelAnchorPoint:null,_currentTitle:null,_currentTitleColor:null,_titleLabel:null,_backgroundSprite:null,_opacity:0,_isPushed:!1,_titleDispatchTable:null,_titleColorDispatchTable:null,_titleLabelDispatchTable:null,_backgroundSpriteDispatchTable:null,_parentInited:!1,_marginV:0,_marginH:0,_className:"ControlButton",ctor:function(a,b,c){cc.Control.prototype.ctor.call(this),this._preferredSize=cc.size(0,0),this._labelAnchorPoint=cc.p(0,0),this._currentTitle="",this._currentTitleColor=cc.color.WHITE,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},void 0!=c?this.initWithTitleAndFontNameAndFontSize(a,b,c):void 0!=b?this.initWithLabelAndBackgroundSprite(a,b):void 0!=a?this.initWithBackgroundSprite(a):this.init()},init:function(){return this.initWithLabelAndBackgroundSprite(cc.LabelTTF.create("","Arial",12),cc.Scale9Sprite.create())},needsLayout:function(){if(this._parentInited){this._titleLabel&&this._titleLabel.setVisible(!1),this._backgroundSprite&&this._backgroundSprite.setVisible(!1),this.setLabelAnchorPoint(this._labelAnchorPoint);var a=this._state;this._currentTitle=this.getTitleForState(a),this._currentTitleColor=this.getTitleColorForState(a),this._titleLabel=this.getTitleLabelForState(a);var b=this._titleLabel;b&&b.setString&&b.setString(this._currentTitle),b&&b.setColor(this._currentTitleColor);var c=this.getContentSize();b&&b.setPosition(c.width/2,c.height/2),this._backgroundSprite=this.getBackgroundSpriteForState(a);var d=this._backgroundSprite;d&&d.setPosition(c.width/2,c.height/2);var e=cc.size(0,0);if(b){var f=b.getBoundingBox();e.width=f.width,e.height=f.height}if(this._doesAdjustBackgroundImage)d&&d.setContentSize(e.width+2*this._marginH,e.height+2*this._marginV);else if(d){var g=d.getPreferredSize();g=cc.size(g.width,g.height),g.width<=0&&(g.width=e.width),g.height<=0&&(g.height=e.height),d.setContentSize(g)}var h=b?b.getBoundingBox():cc.rect(0,0,0,0),i=d?d.getBoundingBox():cc.rect(0,0,0,0),j=cc.rectUnion(h,i);this.setContentSize(j.width,j.height),c=this.getContentSize(),b&&(b.setPosition(c.width/2,c.height/2),b.setVisible(!0)),d&&(d.setPosition(c.width/2,c.height/2),d.setVisible(!0))}},initWithLabelAndBackgroundSprite:function(a,b){if(!a)throw"cc.ControlButton.initWithLabelAndBackgroundSprite(): label should be non-null";if(!b)throw"cc.ControlButton.initWithLabelAndBackgroundSprite(): backgroundSprite should be non-null";if(cc.Control.prototype.init.call(this,!0)){this._parentInited=!0,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},this._isPushed=!1,this.zoomOnTouchDown=!0,this._currentTitle=null,this.setAdjustBackgroundImage(!0),this.setPreferredSize(cc.size(0,0)),this.zoomOnTouchDown=!0,this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this._titleLabel=a,this._backgroundSprite=b,this.setOpacity(255),this.setOpacityModifyRGB(!0);var c=a.getString();return this.setTitleForState(c,cc.CONTROL_STATE_NORMAL),this.setTitleColorForState(a.getColor(),cc.CONTROL_STATE_NORMAL),this.setTitleLabelForState(a,cc.CONTROL_STATE_NORMAL),this.setBackgroundSpriteForState(b,cc.CONTROL_STATE_NORMAL),this._state=cc.CONTROL_STATE_NORMAL,this._marginH=24,this._marginV=12,this._labelAnchorPoint=cc.p(.5,.5),this.setPreferredSize(cc.size(0,0)),this.needsLayout(),!0}return!1},initWithTitleAndFontNameAndFontSize:function(a,b,c){var d=cc.LabelTTF.create(a,b,c);return this.initWithLabelAndBackgroundSprite(d,cc.Scale9Sprite.create())},initWithBackgroundSprite:function(a){var b=cc.LabelTTF.create("","Arial",30);return this.initWithLabelAndBackgroundSprite(b,a)},doesAdjustBackgroundImage:function(){return this._doesAdjustBackgroundImage},setAdjustBackgroundImage:function(a){this._doesAdjustBackgroundImage=a,this.needsLayout()},getZoomOnTouchDown:function(){return this.zoomOnTouchDown},setZoomOnTouchDown:function(a){return this.zoomOnTouchDown=a},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(a){if(0===a.width&&0===a.height)this._doesAdjustBackgroundImage=!0;else{this._doesAdjustBackgroundImage=!1;var b=this._backgroundSpriteDispatchTable;for(var c in b)b[c].setPreferredSize(a)}this._preferredSize=a,this.needsLayout()},getLabelAnchorPoint:function(){return this._labelAnchorPoint},setLabelAnchorPoint:function(a){this._labelAnchorPoint=a,this._titleLabel&&this._titleLabel.setAnchorPoint(a)},_getCurrentTitle:function(){return this._currentTitle},_getCurrentTitleColor:function(){return this._currentTitleColor},getOpacity:function(){return this._opacity},setOpacity:function(a){cc.Control.prototype.setOpacity.call(this,a);var b=this._backgroundSpriteDispatchTable;for(var c in b)b[c].setOpacity(a)},setColor:function(a){cc.Control.prototype.setColor.call(this,a);var b=this._backgroundSpriteDispatchTable;for(var c in b)b[c].setColor(a)},getColor:function(){var a=this._realColor;return cc.color(a.r,a.g,a.b,a.a)},isPushed:function(){return this._isPushed},_getVerticalMargin:function(){return this._marginV},_getHorizontalOrigin:function(){return this._marginH},setMargins:function(a,b){this._marginV=b,this._marginH=a,this.needsLayout()},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a),this.needsLayout()},setSelected:function(a){cc.Control.prototype.setSelected.call(this,a),this.needsLayout()},setHighlighted:function(a){this._state=a?cc.CONTROL_STATE_HIGHLIGHTED:cc.CONTROL_STATE_NORMAL,cc.Control.prototype.setHighlighted.call(this,a);var b=this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG);if(b&&this.stopAction(b),this.needsLayout(),this.zoomOnTouchDown){var c=this.isHighlighted()&&this.isEnabled()&&!this.isSelected()?1.1:1,d=cc.ScaleTo.create(.05,c);d.setTag(cc.CONTROL_ZOOM_ACTION_TAG),this.runAction(d)}},onTouchBegan:function(a){return this.isTouchInside(a)&&this.isEnabled()&&this.isVisible()&&this.hasVisibleParents()?(this._isPushed=!0,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),!0):!1},onTouchMoved:function(a){if(!this._enabled||!this._isPushed||this._selected)return void(this._highlighted&&this.setHighlighted(!1));var b=this.isTouchInside(a);b&&!this._highlighted?(this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER)):b&&this._highlighted?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE):!b&&this._highlighted?(this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT)):b||this._highlighted||this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE)},onTouchEnded:function(a){this._isPushed=!1,this.setHighlighted(!1),this.sendActionsForControlEvents(this.isTouchInside(a)?cc.CONTROL_EVENT_TOUCH_UP_INSIDE:cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE)},onTouchCancelled:function(){this._isPushed=!1,this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL)},getTitleForState:function(a){var b=this._titleDispatchTable;return b?b[a]?b[a]:b[cc.CONTROL_STATE_NORMAL]:""},setTitleForState:function(a,b){this._titleDispatchTable[b]=a||"",this.getState()==b&&this.needsLayout()},getTitleColorForState:function(a){var b=this._titleColorDispatchTable[a];return b?b:(b=this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL],b?b:cc.color.WHITE)},setTitleColorForState:function(a,b){this._titleColorDispatchTable[b]=a,this.getState()==b&&this.needsLayout()},getTitleLabelForState:function(a){var b=this._titleLabelDispatchTable;return b[a]?b[a]:b[cc.CONTROL_STATE_NORMAL]},setTitleLabelForState:function(a,b){var c=this._titleLabelDispatchTable;if(c[b]){var d=c[b];d&&this.removeChild(d,!0)}c[b]=a,a.setVisible(!1),a.setAnchorPoint(.5,.5),this.addChild(a,1),this.getState()==b&&this.needsLayout()},setTitleTTFForState:function(a,b){var c=this.getTitleForState(b);c||(c=""),this.setTitleLabelForState(cc.LabelTTF.create(c,a,12),b)},getTitleTTFForState:function(a){var b=this.getTitleLabelForState(a);return null!=b&&b instanceof cc.LabelTTF?b.getFontName():""},setTitleTTFSizeForState:function(a,b){var c=this.getTitleLabelForState(b);null!=c&&c instanceof cc.LabelTTF&&c.setFontSize(a)},getTitleTTFSizeForState:function(a){var b=this.getTitleLabelForState(a);return null!=b&&b instanceof cc.LabelTTF?b.getFontSize():0},setTitleBMFontForState:function(a,b){var c=this.getTitleForState(b);c||(c=""),this.setTitleLabelForState(cc.LabelBMFont.create(c,a),b)},getTitleBMFontForState:function(a){var b=this.getTitleLabelForState(a);return null!=b&&b instanceof cc.LabelBMFont?b.getFntFile():""},getBackgroundSpriteForState:function(a){var b=this._backgroundSpriteDispatchTable;return b[a]?b[a]:b[cc.CONTROL_STATE_NORMAL]},setBackgroundSpriteForState:function(a,b){var c=this._backgroundSpriteDispatchTable;if(c[b]){var d=c[b];d&&this.removeChild(d,!0)}c[b]=a,a.setVisible(!1),a.setAnchorPoint(.5,.5),this.addChild(a);var e=this._preferredSize;(0!==e.width||0!==e.height)&&a.setPreferredSize(e),this._state===b&&this.needsLayout()},setBackgroundSpriteFrameForState:function(a,b){var c=cc.Scale9Sprite.createWithSpriteFrame(a);this.setBackgroundSpriteForState(c,b)}});var _p=cc.ControlButton.prototype;_p.adjustBackground,cc.defineGetterSetter(_p,"adjustBackground",_p.getAdjustBackgroundImage,_p.setAdjustBackgroundImage),_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.labelAnchor,cc.defineGetterSetter(_p,"labelAnchor",_p.getLabelAnchorPoint,_p.setLabelAnchorPoint),_p=null,cc.ControlButton.create=function(a,b,c){return new cc.ControlButton(a,b,c)},cc.RGBA=function(a,b,c,d){this.r=a,this.g=b,this.b=c,this.a=d},cc.HSV=function(a,b,c){this.h=a,this.s=b,this.v=c},cc.ControlUtils={},cc.ControlUtils.addSpriteToTargetWithPosAndAnchor=function(a,b,c,d){var e=cc.Sprite.create("#"+a);return e?(e.setPosition(c),e.setAnchorPoint(d),b.addChild(e),e):null},cc.ControlUtils.HSVfromRGB=function(a){var b,c,d,e=new cc.HSV;return b=a.r<a.g?a.r:a.g,b=b<a.b?b:a.b,c=a.r>a.g?a.r:a.g,c=c>a.b?c:a.b,e.v=c,d=c-b,c>0?(e.s=d/c,e.h=a.r>=c?(a.g-a.b)/d:a.g>=c?2+(a.b-a.r)/d:4+(a.r-a.g)/d,e.h*=60,e.h<0&&(e.h+=360),e):(e.s=0,e.h=-1,e)},cc.ControlUtils.RGBfromHSV=function(a){var b,c,d,e,f,g,h=new cc.RGBA;if(h.a=1,a.s<=0)return a.h?(h.r=0,h.g=0,h.b=0,h):(h.r=a.v,h.g=a.v,h.b=a.v,h);switch(b=a.h,b>=360&&(b=0),b/=60,g=0|b,f=b-g,c=a.v*(1-a.s),d=a.v*(1-a.s*f),e=a.v*(1-a.s*(1-f)),g){case 0:h.r=a.v,h.g=e,h.b=c;break;case 1:h.r=d,h.g=a.v,h.b=c;break;case 2:h.r=c,h.g=a.v,h.b=e;break;case 3:h.r=c,h.g=d,h.b=a.v;break;case 4:h.r=e,h.g=c,h.b=a.v;break;default:h.r=a.v,h.g=c,h.b=d}return h},cc.ControlUtils.CCRectUnion=function(a,b){return cc.rectUnion(a,b)},cc.Invocation=cc.Class.extend({_action:null,_target:null,_controlEvent:null,ctor:function(a,b,c){this._target=a,this._action=b,this._controlEvent=c},getAction:function(){return this._action},getTarget:function(){return this._target},getControlEvent:function(){return this._controlEvent},invoke:function(a){this._target&&this._action&&(cc.isString(this._action)?this._target[this._action](a,this._controlEvent):this._action.call(this._target,a,this._controlEvent))}}),cc.Scale9Sprite=cc.Node.extend({_spriteRect:null,_capInsetsInternal:null,_positionsAreDirty:!1,_scale9Image:null,_topLeft:null,_top:null,_topRight:null,_left:null,_centre:null,_right:null,_bottomLeft:null,_bottom:null,_bottomRight:null,_cacheSprite:null,_cacheCanvas:null,_cacheContext:null,_cacheTexture:null,_scale9Dirty:!0,_opacityModifyRGB:!1,_originalSize:null,_preferredSize:null,_opacity:0,_color:null,_capInsets:null,_insetLeft:0,_insetTop:0,_insetRight:0,_insetBottom:0,_spritesGenerated:!1,_spriteFrameRotated:!1,_textureLoaded:!1,_loadedEventListeners:null,_className:"Scale9Sprite",textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,b){this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){this._textureLoaded=!0;for(var a=this._loadedEventListeners,b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0},_updateCapInset:function(){var a,b=this._insetLeft,c=this._insetTop,d=this._insetRight,e=this._spriteRect,f=this._insetBottom;a=0===b&&0===c&&0===d&&0===f?cc.rect(0,0,0,0):this._spriteFrameRotated?cc.rect(f,b,e.width-d-b,e.height-c-f):cc.rect(b,c,e.width-b-d,e.height-c-f),this.setCapInsets(a)},_updatePositions:function(){if(this._topLeft&&this._topRight&&this._bottomRight&&this._bottomLeft&&this._centre){var a=this._contentSize,b=this._topLeft,c=this._topRight,d=this._bottomRight,e=this._bottomLeft,f=this._centre,g=this._centre.getContentSize(),h=b.getContentSize(),i=e.getContentSize(),j=a.width-h.width-c.getContentSize().width,k=a.height-h.height-d.getContentSize().height,l=j/g.width,m=k/g.height,n=g.width*l,o=g.height*m,p=i.width,q=i.height;if(cc._renderType==cc._RENDER_TYPE_WEBGL){var r=Math.round(n);n!=r&&(n=r,l=n/g.width);var s=Math.round(o);o!=s&&(o=s,m=o/g.height)}f.setScaleX(l),f.setScaleY(m);var t=this._left,u=this._right,v=this._top,w=this._bottom,x=cc.p(0,0);e.setAnchorPoint(x),d.setAnchorPoint(x),b.setAnchorPoint(x),c.setAnchorPoint(x),t.setAnchorPoint(x),u.setAnchorPoint(x),v.setAnchorPoint(x),w.setAnchorPoint(x),f.setAnchorPoint(x),e.setPosition(0,0),d.setPosition(p+n,0),b.setPosition(0,q+o),c.setPosition(p+n,q+o),t.setPosition(0,q),t.setScaleY(m),u.setPosition(p+n,q),u.setScaleY(m),w.setPosition(p,0),w.setScaleX(l),v.setPosition(p,q+o),v.setScaleX(l),f.setPosition(p,q)}},_cacheScale9Sprite:function(){if(this._scale9Image){var a=this._contentSize,b=this._cacheCanvas,c=!1;(b.width!=a.width||b.height!=a.height)&&(b.width=a.width,b.height=a.height,this._cacheContext.translate(0,a.height),c=!0),cc.renderer._isCacheToCanvasOn=!0,this._scale9Image.visit(),this._cacheContext.clearRect(0,0,a.width,-a.height),cc.renderer._renderingToCacheCanvas(this._cacheContext),c&&this._cacheSprite.setTextureRect(cc.rect(0,0,a.width,a.height)),this._cacheSprite.getParent()||this.addChild(this._cacheSprite,-1)}},ctor:function(a,b,c){if(cc.Node.prototype.ctor.call(this),this._spriteRect=cc.rect(0,0,0,0),this._capInsetsInternal=cc.rect(0,0,0,0),this._originalSize=cc.size(0,0),this._preferredSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),this._loadedEventListeners=[],cc._renderType===cc._RENDER_TYPE_CANVAS){var d=this._cacheCanvas=cc.newElement("canvas");d.width=1,d.height=1,this._cacheContext=d.getContext("2d");var e=this._cacheTexture=new cc.Texture2D;e.initWithElement(d),e.handleLoadedTexture(),this._cacheSprite=new cc.Sprite(e),this._cacheSprite.setAnchorPoint(0,0),this.addChild(this._cacheSprite)}if(void 0!=a)if(a instanceof cc.SpriteFrame)this.initWithSpriteFrame(a,b);else{var f=cc.spriteFrameCache.getSpriteFrame(a);null!=f?this.initWithSpriteFrame(f,b):this.initWithFile(a,b,c)}else this.init()},getOriginalSize:function(){return cc.size(this._originalSize)},getPreferredSize:function(){return cc.size(this._preferredSize)},_getPreferredWidth:function(){return this._preferredSize.width},_getPreferredHeight:function(){return this._preferredSize.height},setPreferredSize:function(a){this._positionsAreDirty&&(this._updatePositions(),this._positionsAreDirty=!1,this._scale9Dirty=!0),this.setContentSize(a),this._preferredSize=a},_setPreferredWidth:function(a){this._setWidth(a),this._preferredSize.width=a},_setPreferredHeight:function(a){this._setHeight(a),this._preferredSize.height=a},setOpacity:function(a){if(this._scale9Image){cc.Node.prototype.setOpacity.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.setOpacity(a)}this._scale9Dirty=!0}},updateDisplayedOpacity:function(a){if(this._scale9Image){cc.Node.prototype.updateDisplayedOpacity.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.updateDisplayedOpacity(a)}this._scale9Dirty=!0}},setColor:function(a){if(this._scale9Image){cc.Node.prototype.setColor.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.setColor(a)}this._scale9Dirty=!0}},updateDisplayedColor:function(a){if(this._scale9Image){cc.Node.prototype.updateDisplayedColor.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&(cc._renderType===cc._RENDER_TYPE_CANVAS?(cc.Node.prototype.updateDisplayedColor.call(d,a),(255!==a.r||255!==a.g||255!==a.b)&&(d._changeTextureColor(),d._setNodeDirtyForCache())):d.updateDisplayedColor(a))}this._scale9Dirty=!0}},getCapInsets:function(){return cc.rect(this._capInsets)},setCapInsets:function(a){if(this._scale9Image){var b=this._contentSize,c=b.width,d=b.height;this.updateWithBatchNode(this._scale9Image,this._spriteRect,this._spriteFrameRotated,a),this.setContentSize(c,d)}},getInsetLeft:function(){return this._insetLeft},setInsetLeft:function(a){this._insetLeft=a,this._updateCapInset()},getInsetTop:function(){return this._insetTop},setInsetTop:function(a){this._insetTop=a,this._updateCapInset()},getInsetRight:function(){return this._insetRight},setInsetRight:function(a){this._insetRight=a,this._updateCapInset()},getInsetBottom:function(){return this._insetBottom},setInsetBottom:function(a){this._insetBottom=a,this._updateCapInset()},setContentSize:function(a,b){cc.Node.prototype.setContentSize.call(this,a,b),this._positionsAreDirty=!0},_setWidth:function(a){cc.Node.prototype._setWidth.call(this,a),this._positionsAreDirty=!0},_setHeight:function(a){cc.Node.prototype._setHeight.call(this,a),this._positionsAreDirty=!0},visit:function(a){this._visible&&(this._positionsAreDirty&&(this._updatePositions(),this._positionsAreDirty=!1,this._scale9Dirty=!0),cc._renderType===cc._RENDER_TYPE_CANVAS?(this._scale9Dirty=!1,this._cacheScale9Sprite(),cc.Node.prototype.visit.call(this,a)):cc.Node.prototype.visit.call(this,a))},_transformForRenderer:function(){cc._renderType===cc._RENDER_TYPE_CANVAS&&(this._cacheScale9Sprite(),this.transform()),cc.Node.prototype._transformForRenderer.call(this)},init:function(){return this.initWithBatchNode(null,cc.rect(0,0,0,0),!1,cc.rect(0,0,0,0))},initWithBatchNode:function(a,b,c,d){return void 0===d&&(d=c,c=!1),a&&this.updateWithBatchNode(a,b,c,d),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint(.5,.5),this._positionsAreDirty=!0,!0},initWithFile:function(a,b,c){if(a instanceof cc.Rect?(a=arguments[1],c=arguments[0],b=cc.rect(0,0,0,0)):(b=b||cc.rect(0,0,0,0),c=c||cc.rect(0,0,0,0)),!a)throw"cc.Scale9Sprite.initWithFile(): file should be non-null";var d=cc.textureCache.getTextureForKey(a);d||(d=cc.textureCache.addImage(a));var e=d.isLoaded();return this._textureLoaded=e,e||d.addLoadedEventListener(function(a){var b=this._preferredSize;b=cc.size(b.width,b.height);var c=a.getContentSize();this.updateWithBatchNode(this._scale9Image,cc.rect(0,0,c.width,c.height),!1,this._capInsets),this.setPreferredSize(b),this._positionsAreDirty=!0,this._callLoadedEventCallbacks()},this),this.initWithBatchNode(cc.SpriteBatchNode.create(a,9),b,!1,c)},initWithSpriteFrame:function(a,b){if(!a||!a.getTexture())throw"cc.Scale9Sprite.initWithSpriteFrame(): spriteFrame should be non-null and its texture should be non-null";b=b||cc.rect(0,0,0,0);var c=a.textureLoaded();this._textureLoaded=c,c||a.addLoadedEventListener(function(a){var b=this._preferredSize;b=cc.size(b.width,b.height),this.updateWithBatchNode(this._scale9Image,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),this._capInsets),this.setPreferredSize(b),this._positionsAreDirty=!0,this._callLoadedEventCallbacks()},this);var d=cc.SpriteBatchNode.create(a.getTexture(),9);return this.initWithBatchNode(d,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),b)},initWithSpriteFrameName:function(a,b){if(!a)throw"cc.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null";b=b||cc.rect(0,0,0,0);var c=cc.spriteFrameCache.getSpriteFrame(a);return null==c?(cc.log("cc.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),!1):this.initWithSpriteFrame(c,b)},resizableSpriteWithCapInsets:function(a){var b=new cc.Scale9Sprite;return b&&b.initWithBatchNode(this._scale9Image,this._spriteRect,!1,a)?b:null},setOpacityModifyRGB:function(a){if(this._scale9Image){this._opacityModifyRGB=a;var b=this._scale9Image.getChildren();if(b)for(var c=0,d=b.length;d>c;c++)b[c].setOpacityModifyRGB(a)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},updateWithBatchNode:function(a,b,c,d){var e=this.getOpacity(),f=this.getColor(),g=cc.rect(b.x,b.y,b.width,b.height);if(this.removeAllChildren(!0),this._scale9Image!=a&&(this._scale9Image=a),!this._scale9Image)return!1;var h=a.getTexture(),i=h.isLoaded();if(this._textureLoaded=i,!i)return h.addLoadedEventListener(function(){this._positionsAreDirty=!0,this._callLoadedEventCallbacks()},this),!0;var j=this._scale9Image;j.removeAllChildren(!0);var k=this._capInsets;k.x=d.x,k.y=d.y,k.width=d.width,k.height=d.height,this._spriteFrameRotated=c;var l=j.getTexture();if(cc._rectEqualToZero(g)){var m=l.getContentSize();g=cc.rect(0,0,m.width,m.height)}this._spriteRect=g;var n=this._spriteRect;n.x=g.x,n.y=g.y,n.width=g.width,n.height=g.height,this._originalSize.width=g.width,this._originalSize.height=g.height;var o=this._preferredSize;0===o.width&&0===o.height&&(o.width=g.width,o.height=g.height);var p=this._capInsetsInternal;d&&(p.x=d.x,p.y=d.y,p.width=d.width,p.height=d.height);var q=g.width,r=g.height;cc._rectEqualToZero(p)&&(p.x=q/3,p.y=r/3,p.width=q/3,p.height=r/3);var s=p.x,t=p.width,u=q-(s+t),v=p.y,w=p.height,x=r-(v+w),y=0,z=0,A=cc.rect(y+.5|0,z+.5|0,s+.5|0,v+.5|0);y+=s;var B=cc.rect(y+.5|0,z+.5|0,t+.5|0,v+.5|0);y+=t;var C=cc.rect(y+.5|0,z+.5|0,u+.5|0,v+.5|0);y=0,z=0,z+=v;var D=cc.rect(y+.5|0,z+.5|0,s+.5|0,w+.5|0);y+=s;var E=cc.rect(y+.5|0,z+.5|0,t+.5|0,w+.5|0);y+=t;var F=cc.rect(y+.5|0,z+.5|0,u+.5|0,w+.5|0);y=0,z=0,z+=v,z+=w;var G=cc.rect(y+.5|0,z+.5|0,s+.5|0,x+.5|0);y+=s;var H=cc.rect(y+.5|0,z+.5|0,t+.5|0,x+.5|0);y+=t;var I=cc.rect(y+.5|0,z+.5|0,u+.5|0,x+.5|0),J=cc.affineTransformMakeIdentity();if(c){var K=E,L=I,M=G,N=C,O=A,P=F,Q=D,R=H,S=B;J=cc.affineTransformTranslate(J,g.height+g.x,g.y),J=cc.affineTransformRotate(J,1.57079633),E=cc.rectApplyAffineTransform(E,J),I=cc.rectApplyAffineTransform(I,J),G=cc.rectApplyAffineTransform(G,J),C=cc.rectApplyAffineTransform(C,J),A=cc.rectApplyAffineTransform(A,J),F=cc.rectApplyAffineTransform(F,J),D=cc.rectApplyAffineTransform(D,J),H=cc.rectApplyAffineTransform(H,J),B=cc.rectApplyAffineTransform(B,J),K.x=E.x,K.y=E.y,L.x=I.x,L.y=I.y,M.x=G.x,M.y=G.y,N.x=C.x,N.y=C.y,O.x=A.x,O.y=A.y,P.x=F.x,P.y=F.y,Q.x=D.x,Q.y=D.y,R.x=H.x,R.y=H.y,S.x=B.x,S.y=B.y,this._centre=new cc.Sprite,this._centre.initWithTexture(l,K,!0),j.addChild(this._centre,0,cc.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(l,S,!0),j.addChild(this._top,1,cc.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(l,R,!0),j.addChild(this._bottom,1,cc.Scale9Sprite.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(l,Q,!0),j.addChild(this._left,1,cc.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(l,P,!0),j.addChild(this._right,1,cc.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(l,O,!0),j.addChild(this._topLeft,2,cc.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(l,N,!0),j.addChild(this._topRight,2,cc.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(l,M,!0),j.addChild(this._bottomLeft,2,cc.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(l,L,!0),j.addChild(this._bottomRight,2,cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT)}else J=cc.affineTransformTranslate(J,g.x,g.y),cc._rectApplyAffineTransformIn(E,J),cc._rectApplyAffineTransformIn(I,J),cc._rectApplyAffineTransformIn(G,J),cc._rectApplyAffineTransformIn(C,J),cc._rectApplyAffineTransformIn(A,J),cc._rectApplyAffineTransformIn(F,J),cc._rectApplyAffineTransformIn(D,J),cc._rectApplyAffineTransformIn(H,J),cc._rectApplyAffineTransformIn(B,J),this._centre=new cc.Sprite,this._centre.initWithTexture(l,E),j.addChild(this._centre,0,cc.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(l,B),j.addChild(this._top,1,cc.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(l,H),j.addChild(this._bottom,1,cc.Scale9Sprite.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(l,D),j.addChild(this._left,1,cc.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(l,F),j.addChild(this._right,1,cc.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(l,A),j.addChild(this._topLeft,2,cc.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(l,C),j.addChild(this._topRight,2,cc.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(l,G),j.addChild(this._bottomLeft,2,cc.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(l,I),j.addChild(this._bottomRight,2,cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT);return this.setContentSize(g.width,g.height),cc._renderType===cc._RENDER_TYPE_WEBGL&&this.addChild(j),this._spritesGenerated&&(this.setOpacity(e),this.setColor(f)),this._spritesGenerated=!0,!0},setSpriteFrame:function(a){var b=cc.SpriteBatchNode.create(a.getTexture(),9),c=a.textureLoaded();this._textureLoaded=c,c||a.addLoadedEventListener(function(a){var b=this._preferredSize;b=cc.size(b.width,b.height),this.updateWithBatchNode(this._scale9Image,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),this._capInsets),this.setPreferredSize(b),this._positionsAreDirty=!0,this._callLoadedEventCallbacks()},this),this.updateWithBatchNode(b,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),cc.rect(0,0,0,0)),this._insetLeft=0,this._insetTop=0,this._insetRight=0,this._insetBottom=0}});var _p=cc.Scale9Sprite.prototype;_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.capInsets,cc.defineGetterSetter(_p,"capInsets",_p.getCapInsets,_p.setCapInsets),_p.insetLeft,cc.defineGetterSetter(_p,"insetLeft",_p.getInsetLeft,_p.setInsetLeft),_p.insetTop,cc.defineGetterSetter(_p,"insetTop",_p.getInsetTop,_p.setInsetTop),_p.insetRight,cc.defineGetterSetter(_p,"insetRight",_p.getInsetRight,_p.setInsetRight),_p.insetBottom,cc.defineGetterSetter(_p,"insetBottom",_p.getInsetBottom,_p.setInsetBottom),_p=null,cc.Scale9Sprite.create=function(a,b,c){return new cc.Scale9Sprite(a,b,c)},cc.Scale9Sprite.createWithSpriteFrame=function(a,b){return new cc.Scale9Sprite(a,b)},cc.Scale9Sprite.createWithSpriteFrameName=function(a,b){return new cc.Scale9Sprite(a,b)},cc.Scale9Sprite.POSITIONS_CENTRE=0,cc.Scale9Sprite.POSITIONS_TOP=1,cc.Scale9Sprite.POSITIONS_LEFT=2,cc.Scale9Sprite.POSITIONS_RIGHT=3,cc.Scale9Sprite.POSITIONS_BOTTOM=4,cc.Scale9Sprite.POSITIONS_TOPRIGHT=5,cc.Scale9Sprite.POSITIONS_TOPLEFT=6,cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT=7,cc.Spacer=cc.Layer.extend({}),cc.Spacer.verticalSpacer=function(a){var b=new cc.Spacer;return b.init(),b.setContentSize(0,a),b},cc.Spacer.horizontalSpacer=function(a){var b=new cc.Spacer;return b.init(),b.setContentSize(a,0),b},cc.MenuPassive=cc.Layer.extend({_color:null,_opacity:0,_className:"MenuPassive",ctor:function(){},getColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,a.a)},setColor:function(a){var b=this._color;if(b.r=a.r,b.g=a.g,b.b=a.b,this._children&&this._children.length>0)for(var c=0;c<this._children.length;c++)this._children[c]&&this._children[c].setColor(a);void 0===a.a||a.a_undefined||this.setOpacity(a.a)},getOpacity:function(){return this._opacity},setOpacity:function(a){if(this._opacity=a,this._children&&this._children.length>0)for(var b=0;b<this._children.length;b++)this._children[b]&&this._children[b].setOpacity(a);
this._color.a=a},initWithItems:function(a,b){if(this.init()){var c=cc.director.getWinSize();this.ignoreAnchorPointForPosition(!0),this.setAnchorPoint(.5,.5),this.setContentSize(c),this.setPosition(c.width/2,c.height/2);var d=0;if(a){this.addChild(a,d);for(var e=0;e<b.length;e++)b[e]&&(d++,this.addChild(b[e],d))}return!0}return!1},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(a){var b,c=-a;if(this._children&&this._children.length>0)for(b=0;b<this._children.length;b++)this._children[b]&&(c+=this._children[b].getContentSize().height*this._children[b].getScaleY()+a);var d=0,e=c/2;if(this._children&&this._children.length>0)for(b=0;b<this._children.length;b++)this._children[b]&&(d=Math.max(d,this._children[b].getContentSize().width),this._children[b].setPosition(0,e-this._children[b].getContentSize().height*this._children[b].getScaleY()/2),e-=this._children[b].getContentSize().height*this._children[b].getScaleY()+a);this.setContentSize(d,c)},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(a){var b,c=-a;if(this._children&&this._children.length>0)for(b=0;b<this._children.length;b++)this._children[b]&&(c+=this._children[b].getContentSize().width*this._children[b].getScaleX()+a);var d=0,e=-c/2;if(this._children&&this._children.length>0)for(b=0;b<this._children.length;b++)this._children[b]&&(d=Math.max(d,this._children[b].getContentSize().height),this._children[b].setPosition(e+this._children[b].getContentSize().width*this._children[b].getScaleX()/2,0),e+=this._children[b].getContentSize().width*this._children[b].getScaleX()+a);this.setContentSize(c,d)},alignItemsInColumns:function(){var a,b=[];for(a=1;a<arguments.length;a++)b.push(arguments[a]);var c,d,e=-5,f=0,g=0,h=0;if(this._children&&this._children.length>0)for(a=0;a<this._children.length;a++)if(this._children[a]){if(f>=b.length){cc.log("cc.MenuPassive.alignItemsInColumns(): invalid row index");continue}if(c=b[f],!c){cc.log("cc.MenuPassive.alignItemsInColumns(): can not have zero columns on a row");continue}d=this._children[a].getContentSize().height,g=0|(g>=d||null==d?g:d),++h,h>=c&&(e+=g+5,h=0,g=0,++f)}var i=cc.director.getWinSize();f=0,g=0,c=0;var j=0,k=0,l=e/2;if(this._children&&this._children.length>0)for(a=0;a<this._children.length;a++)this._children[a]&&(0==c&&(c=b[f],j=i.width/(1+c),k=j),d=this._children[a].getContentSize().height,g=0|(g>=d||null==d?g:d),this._children[a].setPosition(k-i.width/2,l-this._children[a].getContentSize().height/2),k+=j,++h,h>=c&&(l-=g+5,h=0,c=0,g=0,++f))},alignItemsInRows:function(){var a,b=[];for(a=1;a<arguments.length;a++)b.push(arguments[a]);var c,d,e=[],f=[],g=-10,h=-5,i=0,j=0,k=0;if(this._children&&this._children.length>0)for(a=0;a<this._children.length;a++)if(this._children[a]){if(i>=b.length){cc.log("cc.MenuPassive.alignItemsInRows(): invalid row index");continue}if(c=b[i],!c){cc.log("cc.MenuPassive.alignItemsInColumns(): can't have zero rows on a column");continue}d=this._children[a].getContentSize().width,j=0|(j>=d||null==d?j:d),h+=0|this._children[a].getContentSize().height+5,++k,k>=c&&(e.push(j),f.push(h),g+=j+10,k=0,j=0,h=-5,++i)}var l=cc.director.getWinSize();i=0,j=0,c=null;var m=-g/2,n=0;if(this._children&&this._children.length>0)for(a=0;a<this._children.length;a++)this._children[a]&&(null==c&&(c=b[i],n=f[i]),d=this._children[a].getContentSize().width,j=0|(j>=d||null==d?j:d),this._children[a].setPosition(m+e[i]/2,n-l.height/2),n-=this._children[a].getContentSize().height+10,++k,k>=c&&(m+=j+5,k=0,c=0,j=0,++i))},setOpacityModifyRGB:function(){},isOpacityModifyRGB:function(){return!1}}),cc.MenuPassive.create=function(a){a||(a=null);for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);var d=new cc.MenuPassive;return d&&d.initWithItems(a,b)?d:null},cc.MenuPassive.createWithItem=function(a){return cc.MenuPassive.create(a,null)},cc.ControlSaturationBrightnessPicker=cc.Control.extend({_saturation:0,_brightness:0,_background:null,_overlay:null,_shadow:null,_slider:null,_startPos:null,_boxPos:0,_boxSize:0,_className:"ControlSaturationBrightnessPicker",ctor:function(a,b){cc.Control.prototype.ctor.call(this),b&&this.initWithTargetAndPos(a,b)},getSaturation:function(){return this._saturation},getBrightness:function(){return this._brightness},getBackground:function(){return this._background},getOverlay:function(){return this._brightness},getShadow:function(){return this._shadow},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(a,b){return cc.Control.prototype.init.call(this)?(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerBackground.png",a,b,cc.p(0,0)),this._overlay=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerOverlay.png",a,b,cc.p(0,0)),this._shadow=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerShadow.png",a,b,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",a,b,cc.p(.5,.5)),this._startPos=b,this._boxPos=35,this._boxSize=this._background.getContentSize().width/2,!0):!1},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a),this._slider&&this._slider.setOpacity(a?255:128)},updateWithHSV:function(a){var b=new cc.HSV;b.s=1,b.h=a.h,b.v=1;var c=cc.ControlUtils.RGBfromHSV(b);this._background.setColor(cc.color(0|255*c.r,0|255*c.g,0|255*c.b))},updateDraggerWithHSV:function(a){var b=cc.p(this._startPos.x+this._boxPos+this._boxSize*(1-a.s),this._startPos.y+this._boxPos+this._boxSize*a.v);this._updateSliderPosition(b)},_updateSliderPosition:function(a){var b=this._startPos.x+.5*this._background.getBoundingBox().width,c=this._startPos.y+.5*this._background.getBoundingBox().height,d=a.x-b,e=a.y-c,f=Math.sqrt(d*d+e*e),g=Math.atan2(e,d),h=.5*this._background.getBoundingBox().width;f>h&&(a.x=b+h*Math.cos(g),a.y=c+h*Math.sin(g)),this._slider.setPosition(a),a.x<this._startPos.x+this._boxPos?a.x=this._startPos.x+this._boxPos:a.x>this._startPos.x+this._boxPos+this._boxSize-1&&(a.x=this._startPos.x+this._boxPos+this._boxSize-1),a.y<this._startPos.y+this._boxPos?a.y=this._startPos.y+this._boxPos:a.y>this._startPos.y+this._boxPos+this._boxSize&&(a.y=this._startPos.y+this._boxPos+this._boxSize),this._saturation=1-Math.abs((this._startPos.x+this._boxPos-a.x)/this._boxSize),this._brightness=Math.abs((this._startPos.y+this._boxPos-a.y)/this._boxSize)},_checkSliderPosition:function(a){var b=this._startPos.x+.5*this._background.getBoundingBox().width,c=this._startPos.y+.5*this._background.getBoundingBox().height,d=a.x-b,e=a.y-c,f=Math.sqrt(d*d+e*e);return f<=.5*this._background.getBoundingBox().width?(this._updateSliderPosition(a),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),!0):!1},onTouchBegan:function(a){if(!this.isEnabled()||!this.isVisible())return!1;var b=this.getTouchLocation(a);return this._checkSliderPosition(b)},onTouchMoved:function(a){var b=this.getTouchLocation(a);this._checkSliderPosition(b)}});var _p=cc.ControlSaturationBrightnessPicker.prototype;_p.saturation,cc.defineGetterSetter(_p,"saturation",_p.getSaturation),_p.brightness,cc.defineGetterSetter(_p,"brightness",_p.getBrightness),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.overlay,cc.defineGetterSetter(_p,"overlay",_p.getOverlay),_p.shadow,cc.defineGetterSetter(_p,"shadow",_p.getShadow),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlSaturationBrightnessPicker.create=function(a,b){return new cc.ControlSaturationBrightnessPicker(a,b)},cc.ControlHuePicker=cc.Control.extend({_hue:0,_huePercentage:0,_background:null,_slider:null,_startPos:null,_className:"ControlHuePicker",ctor:function(a,b){cc.Control.prototype.ctor.call(this),b&&this.initWithTargetAndPos(a,b)},getHue:function(){return this._hue},setHue:function(a){this._hue=a,this.setHuePercentage(this._hue/360)},getHuePercentage:function(){return this._huePercentage},setHuePercentage:function(a){this._huePercentage=a,this._hue=360*this._huePercentage;var b=this._background.getBoundingBox(),c=this._startPos.x+.5*b.width,d=this._startPos.y+.5*b.height,e=.5*b.width-15,f=360*this._huePercentage-180,g=cc.degreesToRadians(f),h=c+e*Math.cos(g),i=d+e*Math.sin(g);this._slider.setPosition(h,i)},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a),this._slider&&this._slider.setOpacity(a?255:128)},getBackground:function(){return this._background},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(a,b){return cc.Control.prototype.init.call(this)?(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("huePickerBackground.png",a,b,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",a,b,cc.p(.5,.5)),this._slider.setPosition(b.x,b.y+.5*this._background.getBoundingBox().height),this._startPos=b,this._hue=0,this._huePercentage=0,!0):!1},_updateSliderPosition:function(a){var b=this._background.getBoundingBox(),c=this._startPos.x+.5*b.width,d=this._startPos.y+.5*b.height,e=a.x-c,f=a.y-d,g=Math.atan2(f,e),h=cc.radiansToDegrees(g)+180;this.setHue(h),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},_checkSliderPosition:function(a){var b=Math.sqrt(Math.pow(a.x+10,2)+Math.pow(a.y,2));return 80>b&&b>59?(this._updateSliderPosition(a),!0):!1},onTouchBegan:function(a){if(!this.isEnabled()||!this.isVisible())return!1;var b=this.getTouchLocation(a);return this._checkSliderPosition(b)},onTouchMoved:function(a){var b=this.getTouchLocation(a);this._checkSliderPosition(b)}});var _p=cc.ControlHuePicker.prototype;_p.hue,cc.defineGetterSetter(_p,"hue",_p.getHue,_p.setHue),_p.huePercent,cc.defineGetterSetter(_p,"huePercent",_p.getHuePercentage,_p.setHuePercentage),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlHuePicker.create=function(a,b){return new cc.ControlHuePicker(a,b)},cc.ControlColourPicker=cc.Control.extend({_hsv:null,_colourPicker:null,_huePicker:null,_background:null,_className:"ControlColourPicker",ctor:function(){cc.Control.prototype.ctor.call(this),this.init()},hueSliderValueChanged:function(a){this._hsv.h=a.getHue();var b=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*b.r,0|255*b.g,0|255*b.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),this._updateControlPicker()},colourSliderValueChanged:function(a){this._hsv.s=a.getSaturation(),this._hsv.v=a.getBrightness();var b=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*b.r,0|255*b.g,0|255*b.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},setColor:function(a){cc.Control.prototype.setColor.call(this,a);var b=new cc.RGBA;b.r=a.r/255,b.g=a.g/255,b.b=a.b/255,b.a=1,this._hsv=cc.ControlUtils.HSVfromRGB(b),this._updateHueAndControlPicker()},getBackground:function(){return this._background},init:function(){if(cc.Control.prototype.init.call(this)){cc.spriteFrameCache.addSpriteFrames(res.CCControlColourPickerSpriteSheet_plist);var a=cc.SpriteBatchNode.create(res.CCControlColourPickerSpriteSheet_png);this.addChild(a),this._hsv=new cc.HSV(0,0,0),this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("menuColourPanelBackground.png",a,cc.p(0,0),cc.p(.5,.5));var b=cc.pSub(this._background.getPosition(),cc.p(this._background.getContentSize().width/2,this._background.getContentSize().height/2)),c=8,d=28;return this._huePicker=cc.ControlHuePicker.create(a,cc.p(b.x+c,b.y+c)),this._colourPicker=cc.ControlSaturationBrightnessPicker.create(a,cc.p(b.x+d,b.y+d)),this._huePicker.addTargetWithActionForControlEvents(this,this.hueSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._colourPicker.addTargetWithActionForControlEvents(this,this.colourSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._updateHueAndControlPicker(),this.addChild(this._huePicker),this.addChild(this._colourPicker),this.setContentSize(this._background.getContentSize()),!0}return!1},_updateControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv)},_updateHueAndControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv),this._colourPicker.updateDraggerWithHSV(this._hsv)},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a),null!=this._huePicker&&this._huePicker.setEnabled(a),this._colourPicker&&this._colourPicker.setEnabled(a)},onTouchBegan:function(){return!1}});var _p=cc.ControlColourPicker.prototype;_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p=null,cc.ControlColourPicker.create=function(){return new cc.ControlColourPicker};var res=res||{};res.CCControlColourPickerSpriteSheet_plist=res.CCControlColourPickerSpriteSheet_plist||"res/extensions/CCControlColourPickerSpriteSheet.plist",res.CCControlColourPickerSpriteSheet_png=res.CCControlColourPickerSpriteSheet_png||"res/extensions/CCControlColourPickerSpriteSheet.png",cc.SLIDER_MARGIN_H=24,cc.SLIDER_MARGIN_V=8,cc.ControlSlider=cc.Control.extend({_value:0,_minimumValue:0,_maximumValue:0,_minimumAllowedValue:0,_maximumAllowedValue:0,_thumbSprite:null,_progressSprite:null,_backgroundSprite:null,_className:"ControlSlider",ctor:function(a,b,c){cc.Control.prototype.ctor.call(this),void 0!=c&&(bgSprite=cc.Sprite.create(a),progressSprite=cc.Sprite.create(b),thumbSprite=cc.Sprite.create(c),this.initWithSprites(bgSprite,progressSprite,thumbSprite))},getValue:function(){return this._value},setValue:function(a){a=Math.max(a,this._minimumValue),a=Math.min(a,this._maximumValue),this._value=a,this.needsLayout(),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getMinimumValue:function(){return this._minimumValue},setMinimumValue:function(a){this._minimumValue=a,this._minimumAllowedValue=a,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setMaximumValue:function(a){this._maximumValue=a,this._maximumAllowedValue=a,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._value)},isTouchInside:function(a){var b=a.getLocation();b=this.getParent().convertToNodeSpace(b);var c=this.getBoundingBox();return c.width+=this._thumbSprite.getContentSize().width,c.x-=this._thumbSprite.getContentSize().width/2,cc.rectContainsPoint(c,b)},locationFromTouch:function(a){var b=a.getLocation();return b=this.convertToNodeSpace(b),b.x<0?b.x=0:b.x>this._backgroundSprite.getContentSize().width&&(b.x=this._backgroundSprite.getContentSize().width),b},getMinimumAllowedValue:function(){return this._minimumAllowedValue},setMinimumAllowedValue:function(a){this._minimumAllowedValue=a},getMaximumAllowedValue:function(){return this._maximumAllowedValue},setMaximumAllowedValue:function(a){this._maximumAllowedValue=a},getThumbSprite:function(){return this._thumbSprite},getProgressSprite:function(){return this._progressSprite},getBackgroundSprite:function(){return this._backgroundSprite},initWithSprites:function(a,b,c){if(cc.Control.prototype.init.call(this)){this.ignoreAnchorPointForPosition(!1),this._backgroundSprite=a,this._progressSprite=b,this._thumbSprite=c;var d=cc.ControlUtils.CCRectUnion(a.getBoundingBox(),c.getBoundingBox());return this.setContentSize(d.width,d.height),this._backgroundSprite.setAnchorPoint(.5,.5),this._backgroundSprite.setPosition(d.width/2,d.height/2),this.addChild(this._backgroundSprite),this._progressSprite.setAnchorPoint(0,.5),this._progressSprite.setPosition(0,d.height/2),this.addChild(this._progressSprite),this._thumbSprite.setPosition(0,d.height/2),this.addChild(this._thumbSprite),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0}return!1},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a),this._thumbSprite&&this._thumbSprite.setOpacity(a?255:128)},sliderBegan:function(a){this.setSelected(!0),this.getThumbSprite().setColor(cc.color.GRAY),this.setValue(this.valueForLocation(a))},sliderMoved:function(a){this.setValue(this.valueForLocation(a))},sliderEnded:function(){this.isSelected()&&this.setValue(this.valueForLocation(this._thumbSprite.getPosition())),this._thumbSprite.setColor(cc.color.WHITE),this.setSelected(!1)},getTouchLocationInControl:function(a){var b=a.getLocation();return b=this.convertToNodeSpace(b),b.x<0?b.x=0:b.x>this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H&&(b.x=this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H),b},onTouchBegan:function(a){if(!this.isTouchInside(a)||!this.isEnabled()||!this.isVisible())return!1;var b=this.locationFromTouch(a);return this.sliderBegan(b),!0},onTouchMoved:function(a){var b=this.locationFromTouch(a);this.sliderMoved(b)},onTouchEnded:function(){this.sliderEnded(cc.p(0,0))},needsLayout:function(){var a=(this._value-this._minimumValue)/(this._maximumValue-this._minimumValue);this._thumbSprite.setPositionX(a*this._backgroundSprite.getContentSize().width);var b=this._progressSprite.getTextureRect();b=cc.rect(b.x,b.y,this._thumbSprite.getPositionX(),b.height),this._progressSprite.setTextureRect(b,this._progressSprite.isTextureRectRotated())},valueForLocation:function(a){var b=a.x/this._backgroundSprite.getContentSize().width;return Math.max(Math.min(this._minimumValue+b*(this._maximumValue-this._minimumValue),this._maximumAllowedValue),this._minimumAllowedValue)}});var _p=cc.ControlSlider.prototype;_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.minAllowedValue,cc.defineGetterSetter(_p,"minAllowedValue",_p.getMinimumAllowedValue,_p.setMinimumAllowedValue),_p.maxAllowedValue,cc.defineGetterSetter(_p,"maxAllowedValue",_p.getMaximumAllowedValue,_p.setMaximumAllowedValue),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite),_p.progressSprite,cc.defineGetterSetter(_p,"progressSprite",_p.getProgressSprite),_p.backgroundSprite,cc.defineGetterSetter(_p,"backgroundSprite",_p.getBackgroundSprite),_p=null,cc.ControlSlider.create=function(a,b,c){return new cc.ControlSlider(a,b,c)},cc.ControlSwitch=cc.Control.extend({_switchSprite:null,_initialTouchXPosition:0,_moved:!1,_on:!1,_className:"ControlSwitch",ctor:function(a,b,c,d,e,f){cc.Control.prototype.ctor.call(this),f&&this.initWithMaskSprite(a,b,c,d,e,f)},initWithMaskSprite:function(a,b,c,d,e,f){if(!a)throw"cc.ControlSwitch.initWithMaskSprite(): maskSprite should be non-null.";if(!b)throw"cc.ControlSwitch.initWithMaskSprite(): onSprite should be non-null.";if(!c)throw"cc.ControlSwitch.initWithMaskSprite(): offSprite should be non-null.";if(!d)throw"cc.ControlSwitch.initWithMaskSprite(): thumbSprite should be non-null.";return this.init()?(this._on=!0,this._switchSprite=new cc.ControlSwitchSprite,this._switchSprite.initWithMaskSprite(a,b,c,d,e,f),this._switchSprite.setPosition(this._switchSprite.getContentSize().width/2,this._switchSprite.getContentSize().height/2),this.addChild(this._switchSprite),this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this.setContentSize(this._switchSprite.getContentSize()),!0):!1},setOn:function(a,b){b=b||!1,this._on=a;var c=this._on?this._switchSprite.getOnPosition():this._switchSprite.getOffPosition();b?this._switchSprite.runAction(cc.ActionTween.create(.2,"sliderXPosition",this._switchSprite.getSliderXPosition(),c)):this._switchSprite.setSliderXPosition(c),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},isOn:function(){return this._on},hasMoved:function(){return this._moved},setEnabled:function(a){this._enabled=a,this._switchSprite.setOpacity(a?255:128)},locationFromTouch:function(a){var b=a.getLocation();return b=this.convertToNodeSpace(b)},onTouchBegan:function(a){if(!this.isTouchInside(a)||!this.isEnabled()||!this.isVisible())return!1;this._moved=!1;var b=this.locationFromTouch(a);return this._initialTouchXPosition=b.x-this._switchSprite.getSliderXPosition(),this._switchSprite.getThumbSprite().setColor(cc.color.GRAY),this._switchSprite.needsLayout(),!0},onTouchMoved:function(a){var b=this.locationFromTouch(a);b=cc.p(b.x-this._initialTouchXPosition,0),this._moved=!0,this._switchSprite.setSliderXPosition(b.x)},onTouchEnded:function(a){var b=this.locationFromTouch(a);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(b.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)},onTouchCancelled:function(a){var b=this.locationFromTouch(a);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(b.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)}}),cc.ControlSwitch.create=function(a,b,c,d,e,f){return new cc.ControlSwitch(a,b,c,d,e,f)},cc.ControlSwitchSprite=cc.Sprite.extend({_sliderXPosition:0,_onPosition:0,_offPosition:0,_textureLocation:0,_maskLocation:0,_maskSize:null,_onSprite:null,_offSprite:null,_thumbSprite:null,_onLabel:null,_offLabel:null,_clipper:null,_stencil:null,_backRT:null,ctor:function(){cc.Sprite.prototype.ctor.call(this),this._sliderXPosition=0,this._onPosition=0,this._offPosition=0,this._maskLocation=0,this._maskSize=cc.size(0,0),this._onSprite=null,this._offSprite=null,this._thumbSprite=null,this._onLabel=null,this._offLabel=null},initWithMaskSprite:function(a,b,c,d,e,f){if(cc.Sprite.prototype.initWithTexture.call(this,a.getTexture())){this._onPosition=0,this._offPosition=-b.getContentSize().width+d.getContentSize().width/2,this._sliderXPosition=this._onPosition,this.setOnSprite(b),this.setOffSprite(c),this.setThumbSprite(d),this.setOnLabel(e),this.setOffLabel(f),this._stencil=a;var g=this._maskSize=this._stencil.getContentSize();return this._stencil.setPosition(0,0),this._clipper=cc.ClippingNode.create(),this._clipper.setAnchorPoint(.5,.5),this._clipper.setPosition(g.width/2,g.height/2),this._clipper.setStencil(this._stencil),this.addChild(this._clipper),this._clipper.addChild(b),this._clipper.addChild(c),this._clipper.addChild(e),this._clipper.addChild(f),this.addChild(this._thumbSprite),this.needsLayout(),!0}return!1},needsLayout:function(){var a=this._maskSize;this._onSprite.setPosition(this._onSprite.getContentSize().width/2+this._sliderXPosition-a.width/2,this._onSprite.getContentSize().height/2-a.height/2),this._offSprite.setPosition(this._onSprite.getContentSize().width+this._offSprite.getContentSize().width/2+this._sliderXPosition-a.width/2,this._offSprite.getContentSize().height/2-a.height/2),this._onLabel&&this._onLabel.setPosition(this._onSprite.getPositionX()-this._thumbSprite.getContentSize().width/6,this._onSprite.getContentSize().height/2-a.height/2),this._offLabel&&this._offLabel.setPosition(this._offSprite.getPositionX()+this._thumbSprite.getContentSize().width/6,this._offSprite.getContentSize().height/2-a.height/2),this._thumbSprite.setPosition(this._onSprite.getContentSize().width+this._sliderXPosition,this._maskSize.height/2)},setSliderXPosition:function(a){a<=this._offPosition?a=this._offPosition:a>=this._onPosition&&(a=this._onPosition),this._sliderXPosition=a,this.needsLayout()},getSliderXPosition:function(){return this._sliderXPosition},_getOnSideWidth:function(){return this._onSprite.getContentSize().width},_getOffSideWidth:function(){return this._offSprite.getContentSize().height},updateTweenAction:function(a,b){cc.log("key = "+b+", value = "+a),this.setSliderXPosition(a)},setOnPosition:function(a){this._onPosition=a},getOnPosition:function(){return this._onPosition},setOffPosition:function(a){this._offPosition=a},getOffPosition:function(){return this._offPosition},setMaskTexture:function(a){this._stencil.setTexture(a)},getMaskTexture:function(){return this._stencil.getTexture()},setTextureLocation:function(a){this._textureLocation=a},getTextureLocation:function(){return this._textureLocation},setMaskLocation:function(a){this._maskLocation=a},getMaskLocation:function(){return this._maskLocation},setOnSprite:function(a){this._onSprite=a},getOnSprite:function(){return this._onSprite},setOffSprite:function(a){this._offSprite=a},getOffSprite:function(){return this._offSprite},setThumbSprite:function(a){this._thumbSprite=a},getThumbSprite:function(){return this._thumbSprite},setOnLabel:function(a){this._onLabel=a},getOnLabel:function(){return this._onLabel},setOffLabel:function(a){this._offLabel=a},getOffLabel:function(){return this._offLabel}});var _p=cc.ControlSwitchSprite.prototype;_p.sliderX,cc.defineGetterSetter(_p,"sliderX",_p.getSliderXPosition,_p.setSliderXPosition),_p.onPos,cc.defineGetterSetter(_p,"onPos",_p.getOnPosition,_p.setOnPosition),_p.offPos,cc.defineGetterSetter(_p,"offPos",_p.getOffPosition,_p.setOffPosition),_p.maskTexture,cc.defineGetterSetter(_p,"maskTexture",_p.getMaskTexture,_p.setMaskTexture),_p.maskPos,cc.defineGetterSetter(_p,"maskPos",_p.getMaskLocation,_p.setMaskLocation),_p.onSprite,cc.defineGetterSetter(_p,"onSprite",_p.getOnSprite,_p.setOnSprite),_p.offSprite,cc.defineGetterSetter(_p,"offSprite",_p.getOffSprite,_p.setOffSprite),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.onLabel,cc.defineGetterSetter(_p,"onLabel",_p.getOnLabel,_p.setOnLabel),_p.offLabel,cc.defineGetterSetter(_p,"offLabel",_p.getOffLabel,_p.setOffLabel),_p.onSideWidth,cc.defineGetterSetter(_p,"onSideWidth",_p._getOnSideWidth),_p.offSideWidth,cc.defineGetterSetter(_p,"offSideWidth",_p._getOffSideWidth),_p=null,cc.CONTROL_STEPPER_PARTMINUS=0,cc.CONTROL_STEPPER_PARTPLUS=1,cc.CONTROL_STEPPER_PARTNONE=2,cc.CONTROL_STEPPER_LABELCOLOR_ENABLED=cc.color(55,55,55),cc.CONTROL_STEPPER_LABELCOLOR_DISABLED=cc.color(147,147,147),cc.CONTROL_STEPPER_LABELFONT="CourierNewPSMT",cc.AUTOREPEAT_DELTATIME=.15,cc.AUTOREPEAT_INCREASETIME_INCREMENT=12,cc.ControlStepper=cc.Control.extend({_minusSprite:null,_plusSprite:null,_minusLabel:null,_plusLabel:null,_value:0,_continuous:!1,_autorepeat:!1,_wraps:!1,_minimumValue:0,_maximumValue:0,_stepValue:0,_touchInsideFlag:!1,_touchedPart:cc.CONTROL_STEPPER_PARTNONE,_autorepeatCount:0,_className:"ControlStepper",ctor:function(a,b){cc.Control.prototype.ctor.call(this),this._minusSprite=null,this._plusSprite=null,this._minusLabel=null,this._plusLabel=null,this._value=0,this._continuous=!1,this._autorepeat=!1,this._wraps=!1,this._minimumValue=0,this._maximumValue=0,this._stepValue=0,this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._autorepeatCount=0,b&&this.initWithMinusSpriteAndPlusSprite(a,b)},initWithMinusSpriteAndPlusSprite:function(a,b){if(!a)throw"cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Minus sprite should be non-null.";if(!b)throw"cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Plus sprite should be non-null.";if(this.init()){this._autorepeat=!0,this._continuous=!0,this._minimumValue=0,this._maximumValue=100,this._value=0,this._stepValue=1,this._wraps=!1,this.ignoreAnchorPointForPosition(!1),this.setMinusSprite(a),this._minusSprite.setPosition(a.getContentSize().width/2,a.getContentSize().height/2),this.addChild(this._minusSprite),this.setMinusLabel(cc.LabelTTF.create("-",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_DISABLED),this._minusLabel.setPosition(this._minusSprite.getContentSize().width/2,this._minusSprite.getContentSize().height/2),this._minusSprite.addChild(this._minusLabel),this.setPlusSprite(b),this._plusSprite.setPosition(a.getContentSize().width+b.getContentSize().width/2,a.getContentSize().height/2),this.addChild(this._plusSprite),this.setPlusLabel(cc.LabelTTF.create("+",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setPosition(this._plusSprite.getContentSize().width/2,this._plusSprite.getContentSize().height/2),this._plusSprite.addChild(this._plusLabel);var c=cc.ControlUtils.CCRectUnion(this._minusSprite.getBoundingBox(),this._plusSprite.getBoundingBox());return this.setContentSize(this._minusSprite.getContentSize().width+this._plusSprite.getContentSize().height,c.height),!0}return!1},setWraps:function(a){this._wraps=a,this._wraps&&(this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),this.setValue(this._value)},getWraps:function(){return this._wraps},setMinimumValue:function(a){if(a>=this._maximumValue)throw"cc.ControlStepper.setMinimumValue(): minimumValue should be numerically less than maximumValue.";this._minimumValue=a,this.setValue(this._value)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(a){if(a<=this._minimumValue)throw"cc.ControlStepper.setMaximumValue(): maximumValue should be numerically less than maximumValue.";this._maximumValue=a,this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setValue:function(a){this.setValueWithSendingEvent(a,!0)},getValue:function(){return this._value},setStepValue:function(a){if(0>=a)throw"cc.ControlStepper.setMaximumValue(): stepValue should be numerically greater than 0.";this._stepValue=a},getStepValue:function(){return this._stepValue},isContinuous:function(){return this._continuous},setValueWithSendingEvent:function(a,b){a<this._minimumValue?a=this._wraps?this._maximumValue:this._minimumValue:a>this._maximumValue&&(a=this._wraps?this._minimumValue:this._maximumValue),this._value=a,this._wraps||(this._minusLabel.setColor(a==this._minimumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(a==this._maximumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),b&&this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},startAutorepeat:function(){this._autorepeatCount=-1,this.schedule(this.update,cc.AUTOREPEAT_DELTATIME,cc.REPEAT_FOREVER,3*cc.AUTOREPEAT_DELTATIME)},stopAutorepeat:function(){this.unschedule(this.update)},update:function(){this._autorepeatCount++,this._autorepeatCount<cc.AUTOREPEAT_INCREASETIME_INCREMENT&&this._autorepeatCount%3!=0||(this._touchedPart==cc.CONTROL_STEPPER_PARTMINUS?this.setValueWithSendingEvent(this._value-this._stepValue,this._continuous):this._touchedPart==cc.CONTROL_STEPPER_PARTPLUS&&this.setValueWithSendingEvent(this._value+this._stepValue,this._continuous))},updateLayoutUsingTouchLocation:function(a){a.x<this._minusSprite.getContentSize().width&&this._value>this._minimumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTMINUS,this._minusSprite.setColor(cc.color.GRAY),this._plusSprite.setColor(cc.color.WHITE)):a.x>=this._minusSprite.getContentSize().width&&this._value<this._maximumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTPLUS,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.GRAY)):(this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE))},onTouchBegan:function(a){if(!this.isTouchInside(a)||!this.isEnabled()||!this.isVisible())return!1;var b=this.getTouchLocation(a);return this.updateLayoutUsingTouchLocation(b),this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat(),!0},onTouchMoved:function(a){if(this.isTouchInside(a)){var b=this.getTouchLocation(a);this.updateLayoutUsingTouchLocation(b),this._touchInsideFlag||(this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat())}else this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat()
},onTouchEnded:function(a){if(this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat(),this.isTouchInside(a)){var b=this.getTouchLocation(a);this.setValue(this._value+(b.x<this._minusSprite.getContentSize().width?0-this._stepValue:this._stepValue))}},setMinusSprite:function(a){this._minusSprite=a},getMinusSprite:function(){return this._minusSprite},setPlusSprite:function(a){this._plusSprite=a},getPlusSprite:function(){return this._plusSprite},setMinusLabel:function(a){this._minusLabel=a},getMinusLabel:function(){return this._minusLabel},setPlusLabel:function(a){this._plusLabel=a},getPlusLabel:function(){return this._plusLabel}});var _p=cc.ControlStepper.prototype;_p.wraps,cc.defineGetterSetter(_p,"wraps",_p.getWraps,_p.setWraps),_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.stepValue,cc.defineGetterSetter(_p,"stepValue",_p.getStepValue,_p.setStepValue),_p.continuous,cc.defineGetterSetter(_p,"continuous",_p.isContinuous),_p.minusSprite,cc.defineGetterSetter(_p,"minusSprite",_p.getMinusSprite,_p.setMinusSprite),_p.plusSprite,cc.defineGetterSetter(_p,"plusSprite",_p.getPlusSprite,_p.setPlusSprite),_p.minusLabel,cc.defineGetterSetter(_p,"minusLabel",_p.getMinusLabel,_p.setMinusLabel),_p.plusLabel,cc.defineGetterSetter(_p,"plusLabel",_p.getPlusLabel,_p.setPlusLabel),_p=null,cc.ControlStepper.create=function(a,b){return new cc.ControlStepper(a,b)},cc.ControlPotentiometer=cc.Control.extend({_thumbSprite:null,_progressTimer:null,_previousLocation:null,_value:0,_minimumValue:0,_maximumValue:1,_className:"ControlPotentiometer",ctor:function(a,b,c){if(cc.Control.prototype.ctor.call(this),void 0!=c){var d=cc.Sprite.create(a),e=cc.Sprite.create(c),f=cc.ProgressTimer.create(cc.Sprite.create(b));this.initWithTrackSprite_ProgressTimer_ThumbSprite(d,f,e)}},initWithTrackSprite_ProgressTimer_ThumbSprite:function(a,b,c){return this.init()?(this.setProgressTimer(b),this.setThumbSprite(c),this._thumbSprite.setPosition(b.getPosition()),this.addChild(c,2),this.addChild(b,1),this.addChild(a),this.setContentSize(a.getContentSize()),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0):!1},setEnabled:function(a){this.setEnabled(a),this._thumbSprite!=NULL&&this._thumbSprite.setOpacity(a?255:128)},setValue:function(a){a<this._minimumValue&&(a=this._minimumValue),a>this._maximumValue&&(a=this._maximumValue),this._value=a;var b=(a-this._minimumValue)/(this._maximumValue-this._minimumValue);this._progressTimer.setPercentage(100*b),this._thumbSprite.setRotation(360*b),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getValue:function(){return this._value},setMinimumValue:function(a){this._minimumValue=a,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._maximumValue)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(a){this._maximumValue=a,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._minimumValue)},getMaximumValue:function(){return this._maximumValue},isTouchInside:function(a){var b=this.getTouchLocation(a),c=this.distanceBetweenPointAndPoint(this._progressTimer.getPosition(),b);return c<Math.min(this.getContentSize().width/2,this.getContentSize().height/2)},onTouchBegan:function(a){return this.isTouchInside(a)&&this.isEnabled()&&this.isVisible()?(this._previousLocation=this.getTouchLocation(a),this.potentiometerBegan(this._previousLocation),!0):!1},onTouchMoved:function(a){var b=this.getTouchLocation(a);this.potentiometerMoved(b)},onTouchEnded:function(){this.potentiometerEnded(cc.p(0,0))},distanceBetweenPointAndPoint:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint:function(a,b,c,d){var e=b.x-a.x,f=b.y-a.y,g=d.x-c.x,h=d.y-c.y,i=Math.atan2(e,f),j=Math.atan2(g,h);return 180*(i-j)/Math.PI},potentiometerBegan:function(){this.setSelected(!0),this.getThumbSprite().setColor(cc.color.GRAY)},potentiometerMoved:function(a){var b=this.angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint(this._progressTimer.getPosition(),a,this._progressTimer.getPosition(),this._previousLocation);b>180?b-=360:-180>b&&(b+=360),this.setValue(this._value+b/360*(this._maximumValue-this._minimumValue)),this._previousLocation=a},potentiometerEnded:function(){this.getThumbSprite().setColor(cc.color.WHITE),this.setSelected(!1)},setThumbSprite:function(a){this._thumbSprite=a},getThumbSprite:function(){return this._thumbSprite},setProgressTimer:function(a){this._progressTimer=a},getProgressTimer:function(){return this._progressTimer},setPreviousLocation:function(a){this._previousLocation=a},getPreviousLocation:function(){return this._previousLocation}});var _p=cc.ControlPotentiometer.prototype;_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.progressTimer,cc.defineGetterSetter(_p,"progressTimer",_p.getProgressTimer,_p.setProgressTimer),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.prevLocation,cc.defineGetterSetter(_p,"prevLocation",_p.getPreviousLocation,_p.setPreviousLocation),_p=null,cc.ControlPotentiometer.create=function(a,b,c){return new cc.ControlPotentiometer(a,b,c)},cc.SCROLLVIEW_DIRECTION_NONE=-1,cc.SCROLLVIEW_DIRECTION_HORIZONTAL=0,cc.SCROLLVIEW_DIRECTION_VERTICAL=1,cc.SCROLLVIEW_DIRECTION_BOTH=2;var SCROLL_DEACCEL_RATE=.95,SCROLL_DEACCEL_DIST=1,BOUNCE_DURATION=.15,INSET_RATIO=.2,MOVE_INCH=7/160,BOUNCE_BACK_FACTOR=.35;cc.convertDistanceFromPointToInch=function(a){var b=cc.view,c=(b.getScaleX()+b.getScaleY())/2;return a*c/160},cc.ScrollViewDelegate=cc.Class.extend({scrollViewDidScroll:function(){},scrollViewDidZoom:function(){}}),cc.ScrollView=cc.Layer.extend({_zoomScale:0,_minZoomScale:0,_maxZoomScale:0,_delegate:null,_direction:cc.SCROLLVIEW_DIRECTION_BOTH,_dragging:!1,_contentOffset:null,_container:null,_touchMoved:!1,_maxInset:null,_minInset:null,_bounceable:!1,_clippingToBounds:!1,_scrollDistance:null,_touchPoint:null,_touchLength:0,_touches:null,_viewSize:null,_minScale:0,_maxScale:0,_parentScissorRect:null,_scissorRestored:!1,_tmpViewRect:null,_touchListener:null,_className:"ScrollView",_beforeDrawCmd:null,_afterDrawCmd:null,ctor:function(a,b){cc.Layer.prototype.ctor.call(this),this._contentOffset=cc.p(0,0),this._maxInset=cc.p(0,0),this._minInset=cc.p(0,0),this._scrollDistance=cc.p(0,0),this._touchPoint=cc.p(0,0),this._touches=[],this._viewSize=cc.size(0,0),this._parentScissorRect=new cc.Rect(0,0,0,0),this._tmpViewRect=new cc.Rect(0,0,0,0),cc._renderType===cc._RENDER_TYPE_CANVAS&&(this.startCmd=new cc.CustomRenderCmdCanvas(this,function(a,b,c){a=a||cc.context,a.save(),a.save(),this.transform();var d=this._transformWorld;a.transform(d.a,d.b,d.c,d.d,d.tx*b,-d.ty*c),cc.ScrollView.prototype._beforeDraw.call(this)}),this.endCmd=new cc.CustomRenderCmdCanvas(this,function(a){a=a||cc.context,cc.ScrollView.prototype._afterDraw.call(this),a.restore()})),void 0!=b?this.initWithViewSize(a,b):this.initWithViewSize(cc.size(200,200),null)},_initRendererCmd:function(){cc._renderType===cc._RENDER_TYPE_WEBGL&&(this._beforeDrawCmd=new cc.CustomRenderCmdWebGL(this,this._onBeforeDraw),this._afterDrawCmd=new cc.CustomRenderCmdWebGL(this,this._onAfterDraw))},init:function(){return this.initWithViewSize(cc.size(200,200),null)},initWithViewSize:function(a,b){var c=cc.p(0,0);return cc.Layer.prototype.init.call(this)?(this._container=b,this._container||(this._container=cc.Layer.create(),this._container.ignoreAnchorPointForPosition(!1),this._container.setAnchorPoint(c)),this.setViewSize(a),this.setTouchEnabled(!0),this._touches.length=0,this._delegate=null,this._bounceable=!0,this._clippingToBounds=!0,this._direction=cc.SCROLLVIEW_DIRECTION_BOTH,this._container.setPosition(c),this._touchLength=0,this.addChild(this._container),this._minScale=this._maxScale=1,!0):!1},setContentOffset:function(a,b){if(b)return void this.setContentOffsetInDuration(a,BOUNCE_DURATION);if(!this._bounceable){var c=this.minContainerOffset(),d=this.maxContainerOffset();a.x=Math.max(c.x,Math.min(d.x,a.x)),a.y=Math.max(c.y,Math.min(d.y,a.y))}this._container.setPosition(a);var e=this._delegate;null!=e&&e.scrollViewDidScroll&&e.scrollViewDidScroll(this)},getContentOffset:function(){var a=this._container.getPosition();return cc.p(a.x,a.y)},setContentOffsetInDuration:function(a,b){var c=cc.MoveTo.create(b,a),d=cc.CallFunc.create(this._stoppedAnimatedScroll,this);this._container.runAction(cc.Sequence.create(c,d)),this.schedule(this._performedAnimatedScroll)},setZoomScale:function(a,b){if(b)return void this.setZoomScaleInDuration(a,BOUNCE_DURATION);var c=this._container;if(c.getScale()!=a){var d,e,f;if(0==this._touchLength){var g=this._viewSize;f=cc.p(.5*g.width,.5*g.height),f=this.convertToWorldSpace(f)}else f=this._touchPoint;d=c.convertToNodeSpace(f),c.setScale(Math.max(this._minScale,Math.min(this._maxScale,a))),e=c.convertToWorldSpace(d);var h=cc.pSub(f,e);this._delegate&&this._delegate.scrollViewDidZoom&&this._delegate.scrollViewDidZoom(this),this.setContentOffset(cc.pAdd(c.getPosition(),h))}},getZoomScale:function(){return this._container.getScale()},setZoomScaleInDuration:function(a,b){if(b>0){var c=this._container.getScale();if(c!=a){var d=cc.ActionTween.create(b,"zoomScale",c,a);this.runAction(d)}}else this.setZoomScale(a)},minContainerOffset:function(){var a=this._container,b=a.getContentSize(),c=this._viewSize;return cc.p(c.width-b.width*a.getScaleX(),c.height-b.height*a.getScaleY())},maxContainerOffset:function(){return cc.p(0,0)},isNodeVisible:function(a){var b=this.getContentOffset(),c=this.getViewSize(),d=this.getZoomScale(),e=cc.rect(-b.x/d,-b.y/d,c.width/d,c.height/d);return cc.rectIntersectsRect(e,a.getBoundingBox())},pause:function(){this._container.pause();for(var a=this._container.getChildren(),b=0;b<a.length;b++)a[b].pause();this._super()},resume:function(){for(var a=this._container.getChildren(),b=0,c=a.length;c>b;b++)a[b].resume();this._container.resume(),this._super()},isDragging:function(){return this._dragging},isTouchMoved:function(){return this._touchMoved},isBounceable:function(){return this._bounceable},setBounceable:function(a){this._bounceable=a},getViewSize:function(){return this._viewSize},setViewSize:function(a){this._viewSize=a,cc.Node.prototype.setContentSize.call(this,a)},getContainer:function(){return this._container},setContainer:function(a){a&&(this.removeAllChildren(!0),this._container=a,a.ignoreAnchorPointForPosition(!1),a.setAnchorPoint(0,0),this.addChild(a),this.setViewSize(this._viewSize))},getDirection:function(){return this._direction},setDirection:function(a){this._direction=a},getDelegate:function(){return this._delegate},setDelegate:function(a){this._delegate=a},onTouchBegan:function(a){if(!this.isVisible())return!1;var b=this._getViewRect(),c=this._container,d=c.convertToWorldSpace(c.convertTouchToNodeSpace(a)),e=this._touches;return e.length>2||this._touchMoved||!cc.rectContainsPoint(b,d)?!1:(e.push(a),1===e.length?(this._touchPoint=this.convertTouchToNodeSpace(a),this._touchMoved=!1,this._dragging=!0,this._scrollDistance.x=0,this._scrollDistance.y=0,this._touchLength=0):2==e.length&&(this._touchPoint=cc.pMidpoint(this.convertTouchToNodeSpace(e[0]),this.convertTouchToNodeSpace(e[1])),this._touchLength=cc.pDistance(c.convertTouchToNodeSpace(e[0]),c.convertTouchToNodeSpace(e[1])),this._dragging=!1),!0)},onTouchMoved:function(a){if(this.isVisible())if(this.setNodeDirty(),1===this._touches.length&&this._dragging){this._touchMoved=!0;var b,c=(this._getViewRect(),this.convertTouchToNodeSpace(a)),d=cc.pSub(c,this._touchPoint),e=0,f=this._direction;if(f===cc.SCROLLVIEW_DIRECTION_VERTICAL)e=d.y,b=this._container.getPositionY(),this.minContainerOffset().y<=b&&b<=this.maxContainerOffset().y||(d.y*=BOUNCE_BACK_FACTOR);else if(f===cc.SCROLLVIEW_DIRECTION_HORIZONTAL)e=d.x,b=this._container.getPositionX(),this.minContainerOffset().x<=b&&b<=this.maxContainerOffset().x||(d.x*=BOUNCE_BACK_FACTOR);else{e=Math.sqrt(d.x*d.x+d.y*d.y),b=this._container.getPositionY();var g=this.minContainerOffset(),h=this.maxContainerOffset();g.y<=b&&b<=h.y||(d.y*=BOUNCE_BACK_FACTOR),b=this._container.getPositionX(),g.x<=b&&b<=h.x||(d.x*=BOUNCE_BACK_FACTOR)}if(!this._touchMoved&&Math.abs(cc.convertDistanceFromPointToInch(e))<MOVE_INCH)return;if(this._touchMoved||(d.x=0,d.y=0),this._touchPoint=c,this._touchMoved=!0,this._dragging){switch(f){case cc.SCROLLVIEW_DIRECTION_VERTICAL:d.x=0;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:d.y=0}var i=this._container.getPosition(),j=i.x+d.x,k=i.y+d.y;this._scrollDistance=d,this.setContentOffset(cc.p(j,k))}}else if(2===this._touches.length&&!this._dragging){var l=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1]));this.setZoomScale(this.getZoomScale()*l/this._touchLength)}},onTouchEnded:function(){this.isVisible()&&(1==this._touches.length&&this._touchMoved&&this.schedule(this._deaccelerateScrolling),this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},onTouchCancelled:function(){this.isVisible()&&(this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},setContentSize:function(a,b){null!=this.getContainer()&&(void 0===b?this.getContainer().setContentSize(a):this.getContainer().setContentSize(a,b),this.updateInset())},_setWidth:function(a){var b=this.getContainer();null!=b&&(b._setWidth(a),this.updateInset())},_setHeight:function(a){var b=this.getContainer();null!=b&&(b._setHeight(a),this.updateInset())},getContentSize:function(){return this._container.getContentSize()},updateInset:function(){if(null!=this.getContainer()){var a=this._viewSize,b=this.maxContainerOffset();this._maxInset.x=b.x+a.width*INSET_RATIO,this._maxInset.y=b.y+a.height*INSET_RATIO,b=this.minContainerOffset(),this._minInset.x=b.x-a.width*INSET_RATIO,this._minInset.y=b.y-a.height*INSET_RATIO}},isClippingToBounds:function(){return this._clippingToBounds},setClippingToBounds:function(a){this._clippingToBounds=a},visit:function(a){if(this.isVisible()){var b,c,d,e=a||cc._renderContext,f=this._children;if(cc._renderType===cc._RENDER_TYPE_CANVAS){if(this.transform(e),this.startCmd&&cc.renderer.pushRenderCommand(this.startCmd),f&&f.length>0){for(d=f.length,this.sortAllChildren(),b=0;d>b&&(c=f[b],c&&c._localZOrder<0);b++)c.visit(e);for(this._rendererCmd&&cc.renderer.pushRenderCommand(this._rendererCmd);d>b;b++)f[b].visit(e)}else this._rendererCmd&&cc.renderer.pushRenderCommand(this._rendererCmd);this.endCmd&&cc.renderer.pushRenderCommand(this.endCmd)}else{if(cc.kmGLPushMatrix(),this.transform(e),this._beforeDraw(e),f&&f.length>0){for(d=f.length,b=0;d>b&&(c=f[b],c&&c._localZOrder<0);b++)c.visit();for(this._rendererCmd&&cc.renderer.pushRenderCommand(this._rendererCmd);d>b;b++)f[b].visit()}else this._rendererCmd&&cc.renderer.pushRenderCommand(this._rendererCmd);this._afterDraw(e),cc.kmGLPopMatrix()}}},addChild:function(a,b,c){if(!a)throw new Error("child must not nil!");b=b||a.getLocalZOrder(),c=c||a.getTag(),this._container!=a?this._container.addChild(a,b,c):cc.Layer.prototype.addChild.call(this,a,b,c)},isTouchEnabled:function(){return null!=this._touchListener},setTouchEnabled:function(a){if(this._touchListener&&cc.eventManager.removeListener(this._touchListener),this._touchListener=null,a){var b=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE});this.onTouchBegan&&(b.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(b.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(b.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(b.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=b,cc.eventManager.addListener(b,this)}else this._dragging=!1,this._touchMoved=!1,this._touches.length=0},_initWithViewSize:function(){return null},_relocateContainer:function(a){var b=this.minContainerOffset(),c=this.maxContainerOffset(),d=this._direction,e=this._container.getPosition(),f=e.x,g=e.y;(d===cc.SCROLLVIEW_DIRECTION_BOTH||d===cc.SCROLLVIEW_DIRECTION_HORIZONTAL)&&(f=Math.max(f,b.x),f=Math.min(f,c.x)),(d==cc.SCROLLVIEW_DIRECTION_BOTH||d==cc.SCROLLVIEW_DIRECTION_VERTICAL)&&(g=Math.min(g,c.y),g=Math.max(g,b.y)),(g!=e.y||f!=e.x)&&this.setContentOffset(cc.p(f,g),a)},_deaccelerateScrolling:function(){if(this._dragging)return void this.unschedule(this._deaccelerateScrolling);var a,b,c=this._container.getPosition(),d=this._scrollDistance;this._container.setPosition(c.x+d.x,c.y+d.y),this._bounceable?(a=this._maxInset,b=this._minInset):(a=this.maxContainerOffset(),b=this.minContainerOffset());var e=this._container.getPositionX(),f=this._container.getPositionY();d.x=d.x*SCROLL_DEACCEL_RATE,d.y=d.y*SCROLL_DEACCEL_RATE,this.setContentOffset(cc.p(e,f)),(Math.abs(d.x)<=SCROLL_DEACCEL_DIST&&Math.abs(d.y)<=SCROLL_DEACCEL_DIST||f>a.y||f<b.y||e>a.x||e<b.x||e==a.x||e==b.x||f==a.y||f==b.y)&&(this.unschedule(this._deaccelerateScrolling),this._relocateContainer(!0))},_performedAnimatedScroll:function(){return this._dragging?void this.unschedule(this._performedAnimatedScroll):void(this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this))},_stoppedAnimatedScroll:function(){this.unschedule(this._performedAnimatedScroll),this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)},_beforeDraw:function(a){if(this._clippingToBounds){this._scissorRestored=!1;var b=cc.view,c=this.getScaleX(),d=this.getScaleY(),e=a||cc._renderContext;if(cc._renderType===cc._RENDER_TYPE_CANVAS){var f=this._viewSize.width*c*b.getScaleX(),g=this._viewSize.height*d*b.getScaleY(),h=0,i=0;e.beginPath(),e.rect(h,i,f,-g),e.restore(),e.clip(),e.closePath()}else cc.renderer.pushRenderCommand(this._beforeDrawCmd)}},_onBeforeDraw:function(){var a=cc.view,b=this._getViewRect();if(a.isScissorEnabled()){if(this._scissorRestored=!0,this._parentScissorRect=a.getScissorRect(),cc.rectIntersection(b,this._parentScissorRect)){var c=this._parentScissorRect,d=Math.max(b.x,c.x),e=Math.max(b.y,c.y),f=Math.min(b.x+b.width,c.x+c.width),g=Math.min(b.y+b.height,c.y+c.height);a.setScissorInPoints(d,e,f-d,g-e)}}else{var h=cc._renderContext;h.enable(h.SCISSOR_TEST),a.setScissorInPoints(b.x,b.y,b.width,b.height)}},_afterDraw:function(){this._clippingToBounds&&cc._renderType===cc._RENDER_TYPE_WEBGL&&cc.renderer.pushRenderCommand(this._afterDrawCmd)},_onAfterDraw:function(){if(this._scissorRestored){var a=this._parentScissorRect;cc.view.setScissorInPoints(a.x,a.y,a.width,a.height)}else{var b=cc._renderContext;b.disable(b.SCISSOR_TEST)}},_handleZoom:function(){},_getViewRect:function(){for(var a=this.convertToWorldSpace(cc.p(0,0)),b=this._viewSize,c=this.getScaleX(),d=this.getScaleY(),e=this._parent;null!=e;e=e.getParent())c*=e.getScaleX(),d*=e.getScaleY();0>c&&(a.x+=b.width*c,c=-c),0>d&&(a.y+=b.height*d,d=-d);var f=this._tmpViewRect;return f.x=a.x,f.y=a.y,f.width=b.width*c,f.height=b.height*d,f}});var _p=cc.ScrollView.prototype;_p.minOffset,cc.defineGetterSetter(_p,"minOffset",_p.minContainerOffset),_p.maxOffset,cc.defineGetterSetter(_p,"maxOffset",_p.maxContainerOffset),_p.bounceable,cc.defineGetterSetter(_p,"bounceable",_p.isBounceable,_p.setBounceable),_p.viewSize,cc.defineGetterSetter(_p,"viewSize",_p.getViewSize,_p.setViewSize),_p.container,cc.defineGetterSetter(_p,"container",_p.getContainer,_p.setContainer),_p.direction,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.clippingToBounds,cc.defineGetterSetter(_p,"clippingToBounds",_p.isClippingToBounds,_p.setClippingToBounds),_p=null,cc.ScrollView.create=function(a,b){return new cc.ScrollView(a,b)},cc.SortableObject=cc.Class.extend({setObjectID:function(){},getObjectID:function(){return 0}}),cc.SortedObject=cc.SortableObject.extend({_objectID:0,ctor:function(){this._objectID=0},setObjectID:function(a){this._objectID=a},getObjectID:function(){return this._objectID}});var _compareObject=function(a,b){return a.getObjectID()-b.getObjectID()};cc.ArrayForObjectSorting=cc.Class.extend({_saveObjectArr:null,ctor:function(){this._saveObjectArr=[]},insertSortedObject:function(a){if(!a)throw"cc.ArrayForObjectSorting.insertSortedObject(): addObject should be non-null.";var b=this.indexOfSortedObject(a);this.insertObject(a,b)},removeSortedObject:function(a){if(0!=this.count()){var b=this.indexOfSortedObject(a);if(b<this.count()&&b!=cc.INVALID_INDEX){var c=this.objectAtIndex(b);c.getObjectID()==a.getObjectID()&&this.removeObjectAtIndex(b)}}},setObjectID_ofSortedObject:function(a,b){var c=this.indexOfSortedObject(b);if(c<this.count()&&c!=cc.INVALID_INDEX){var d=this.objectAtIndex(c);d.getObjectID()==b.getObjectID()&&(this.removeObjectAtIndex(c),d.setObjectID(a),this.insertSortedObject(d))}},objectWithObjectID:function(a){if(0==this.count())return null;var b=new cc.SortedObject;b.setObjectID(a);var c=this.indexOfSortedObject(b);return c<this.count()&&c!=cc.INVALID_INDEX&&(b=this.objectAtIndex(c),b.getObjectID()!=a&&(b=null)),b},getObjectWithObjectID:function(){return null},indexOfSortedObject:function(a){var b=0;if(a)for(var c=0,d=a.getObjectID(),e=this._saveObjectArr,f=0;f<e.length;f++){var g=e[f],h=g.getObjectID();if(d==h||d>=c&&h>d)break;c=h,b++}else b=cc.INVALID_INDEX;return b},count:function(){return this._saveObjectArr.length},lastObject:function(){var a=this._saveObjectArr;return 0==a.length?null:a[a.length-1]},objectAtIndex:function(a){return this._saveObjectArr[a]},addObject:function(a){this._saveObjectArr.push(a),this._saveObjectArr.sort(_compareObject)},removeObjectAtIndex:function(a){this._saveObjectArr.splice(a,1),this._saveObjectArr.sort(_compareObject)},insertObject:function(a,b){this._saveObjectArr.splice(b,0,a),this._saveObjectArr.sort(_compareObject)}}),cc.TABLEVIEW_FILL_TOPDOWN=0,cc.TABLEVIEW_FILL_BOTTOMUP=1,cc.TableViewCell=cc.Node.extend({_idx:0,_className:"TableViewCell",getIdx:function(){return this._idx},setIdx:function(a){this._idx=a},reset:function(){this._idx=cc.INVALID_INDEX},setObjectID:function(a){this._idx=a},getObjectID:function(){return this._idx}});var _p=cc.TableViewCell.prototype;_p.objectId,cc.defineGetterSetter(_p,"objectId",_p.getObjectID,_p.setObjectID),_p=null,cc.TableViewDelegate=cc.ScrollViewDelegate.extend({tableCellTouched:function(){},tableCellHighlight:function(){},tableCellUnhighlight:function(){},tableCellWillRecycle:function(){}}),cc.TableViewDataSource=cc.Class.extend({tableCellSizeForIndex:function(a){return this.cellSizeForTable(a)},cellSizeForTable:function(){return cc.size(0,0)},tableCellAtIndex:function(){return null},numberOfCellsInTableView:function(){return 0}}),cc.TableView=cc.ScrollView.extend({_vOrdering:null,_indices:null,_cellsFreed:null,_dataSource:null,_tableViewDelegate:null,_oldDirection:null,_cellsPositions:null,_touchedCell:null,ctor:function(a,b,c){cc.ScrollView.prototype.ctor.call(this),this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE,this._cellsPositions=[],this.initWithViewSize(b,c),this.setDataSource(a),this._updateCellPositions(),this._updateContentSize()},__indexFromOffset:function(a){var b,c=0,d=this._dataSource.numberOfCellsInTableView(this)-1;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:b=a.x;break;default:b=a.y}for(var e=this._cellsPositions;d>=c;){var f=0|c+(d-c)/2,g=e[f],h=e[f+1];if(b>=g&&h>=b)return f;g>b?d=f-1:c=f+1}return 0>=c?0:-1},_indexFromOffset:function(a){var b={x:a.x,y:a.y},c=this._dataSource,d=c.numberOfCellsInTableView(this)-1;this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(b.y=this.getContainer().getContentSize().height-b.y);var e=this.__indexFromOffset(b);return-1!=e&&(e=Math.max(0,e),e>d&&(e=cc.INVALID_INDEX)),e},__offsetFromIndex:function(a){var b;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:b=cc.p(this._cellsPositions[a],0);break;default:b=cc.p(0,this._cellsPositions[a])}return b},_offsetFromIndex:function(a){var b=this.__offsetFromIndex(a),c=this._dataSource.tableCellSizeForIndex(this,a);return this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(b.y=this.getContainer().getContentSize().height-b.y-c.height),b},_updateCellPositions:function(){var a=this._dataSource.numberOfCellsInTableView(this),b=this._cellsPositions;if(a>0){for(var c,d=0,e=this._dataSource,f=0;a>f;f++)switch(b[f]=d,c=e.tableCellSizeForIndex(this,f),this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:d+=c.width;break;default:d+=c.height}this._cellsPositions[a]=d}},_updateContentSize:function(){var a=cc.size(0,0),b=this._dataSource.numberOfCellsInTableView(this);if(b>0){var c=this._cellsPositions[b];switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:a=cc.size(c,this._viewSize.height);break;default:a=cc.size(this._viewSize.width,c)}}this.setContentSize(a),this._oldDirection!=this._direction&&(this.setContentOffset(this._direction==cc.SCROLLVIEW_DIRECTION_HORIZONTAL?cc.p(0,0):cc.p(0,this.minContainerOffset().y)),this._oldDirection=this._direction)},_moveCellOutOfSight:function(a){this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,a),this._cellsFreed.addObject(a),this._cellsUsed.removeSortedObject(a),cc.arrayRemoveObject(this._indices,a.getIdx()),a.reset(),a.getParent()==this.getContainer()&&this.getContainer().removeChild(a,!0)},_setIndexForCell:function(a,b){b.setAnchorPoint(0,0),b.setPosition(this._offsetFromIndex(a)),b.setIdx(a)},_addCellIfNecessary:function(a){a.getParent()!=this.getContainer()&&this.getContainer().addChild(a),this._cellsUsed.insertSortedObject(a);var b=this._indices,c=a.getIdx();-1==b.indexOf(c)&&(b.push(c),b.sort(function(a,b){return a-b}))},getDataSource:function(){return this._dataSource},setDataSource:function(a){this._dataSource=a},getDelegate:function(){return this._tableViewDelegate},setDelegate:function(a){this._tableViewDelegate=a},setVerticalFillOrder:function(a){this._vOrdering!=a&&(this._vOrdering=a,this._cellsUsed.count()>0&&this.reloadData())},getVerticalFillOrder:function(){return this._vOrdering},initWithViewSize:function(a,b){return cc.ScrollView.prototype.initWithViewSize.call(this,a,b)?(this._cellsUsed=new cc.ArrayForObjectSorting,this._cellsFreed=new cc.ArrayForObjectSorting,this._indices=[],this._tableViewDelegate=null,this._vOrdering=cc.TABLEVIEW_FILL_BOTTOMUP,this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),cc.ScrollView.prototype.setDelegate.call(this,this),!0):!1},updateCellAtIndex:function(a){if(!(a==cc.INVALID_INDEX||a>this._dataSource.numberOfCellsInTableView(this)-1)){var b=this.cellAtIndex(a);b&&this._moveCellOutOfSight(b),b=this._dataSource.tableCellAtIndex(this,a),this._setIndexForCell(a,b),this._addCellIfNecessary(b)}},insertCellAtIndex:function(a){if(!(a==cc.INVALID_INDEX||a>this._dataSource.numberOfCellsInTableView(this)-1)){var b,c=this._cellsUsed,d=c.objectWithObjectID(a);if(d){b=c.indexOfSortedObject(d);for(var e=b;e<c.count();e++)d=c.objectAtIndex(e),this._setIndexForCell(d.getIdx()+1,d)}d=this._dataSource.tableCellAtIndex(this,a),this._setIndexForCell(a,d),this._addCellIfNecessary(d),this._updateCellPositions(),this._updateContentSize()}},removeCellAtIndex:function(a){if(!(a==cc.INVALID_INDEX||a>this._dataSource.numberOfCellsInTableView(this)-1)){var b=this.cellAtIndex(a);if(b){var c=this._cellsUsed,d=c.indexOfSortedObject(b);this._moveCellOutOfSight(b),cc.arrayRemoveObject(this._indices,a),this._updateCellPositions();for(var e=c.count()-1;e>d;e--)b=c.objectAtIndex(e),this._setIndexForCell(b.getIdx()-1,b)}}},reloadData:function(){this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE;for(var a=this._cellsUsed,b=this._cellsFreed,c=this.getContainer(),d=0,e=a.count();e>d;d++){var f=a.objectAtIndex(d);this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,f),b.addObject(f),f.reset(),f.getParent()==c&&c.removeChild(f,!0)}this._indices=[],this._cellsUsed=new cc.ArrayForObjectSorting,this._updateCellPositions(),this._updateContentSize(),this._dataSource.numberOfCellsInTableView(this)>0&&this.scrollViewDidScroll(this)},dequeueCell:function(){if(0===this._cellsFreed.count())return null;var a=this._cellsFreed.objectAtIndex(0);return this._cellsFreed.removeObjectAtIndex(0),a},cellAtIndex:function(a){var b=this._indices.indexOf(a);return-1==b?null:this._cellsUsed.objectWithObjectID(a)},scrollViewDidScroll:function(){var a=this._dataSource,b=a.numberOfCellsInTableView(this);if(0!==b){null!=this._tableViewDelegate&&this._tableViewDelegate.scrollViewDidScroll&&this._tableViewDelegate.scrollViewDidScroll(this);var c=0,d=this._viewSize,e=this.getContainer(),f=this.getContentOffset();f.x*=-1,f.y*=-1;var g=Math.max(b-1,0);this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(f.y=f.y+d.height/e.getScaleY());var h=this._indexFromOffset(f);h===cc.INVALID_INDEX&&(h=b-1),this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN?f.y-=d.height/e.getScaleY():f.y+=d.height/e.getScaleY(),f.x+=d.width/e.getScaleX();var i=this._indexFromOffset(f);i===cc.INVALID_INDEX&&(i=b-1);var j,k=this._cellsUsed;if(k.count()>0)for(j=k.objectAtIndex(0),c=j.getIdx();h>c&&(this._moveCellOutOfSight(j),k.count()>0);)j=k.objectAtIndex(0),c=j.getIdx();if(k.count()>0)for(j=k.lastObject(),c=j.getIdx();g>=c&&c>i&&(this._moveCellOutOfSight(j),k.count()>0);)j=k.lastObject(),c=j.getIdx();for(var l=this._indices,m=h;i>=m;m++)-1==l.indexOf(m)&&this.updateCellAtIndex(m)}},scrollViewDidZoom:function(){},onTouchEnded:function(a,b){if(this.isVisible()){if(this._touchedCell){var c=this.getBoundingBox(),d=cc.p(c.x,c.y);d=this._parent.convertToWorldSpace(d),c.x=d.x,c.y=d.y;var e=this._tableViewDelegate;cc.rectContainsPoint(c,a.getLocation())&&null!=e&&(e.tableCellUnhighlight&&e.tableCellUnhighlight(this,this._touchedCell),e.tableCellTouched&&e.tableCellTouched(this,this._touchedCell)),this._touchedCell=null}cc.ScrollView.prototype.onTouchEnded.call(this,a,b)}},onTouchBegan:function(a,b){if(!this.isVisible())return!1;var c=cc.ScrollView.prototype.onTouchBegan.call(this,a,b);if(1===this._touches.length){var d,e;e=this.getContainer().convertTouchToNodeSpace(a),d=this._indexFromOffset(e),this._touchedCell=d===cc.INVALID_INDEX?null:this.cellAtIndex(d),this._touchedCell&&null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellHighlight&&this._tableViewDelegate.tableCellHighlight(this,this._touchedCell)}else this._touchedCell&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null);return c},onTouchMoved:function(a,b){cc.ScrollView.prototype.onTouchMoved.call(this,a,b),this._touchedCell&&this.isTouchMoved()&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)},onTouchCancelled:function(a,b){cc.ScrollView.prototype.onTouchCancelled.call(this,a,b),this._touchedCell&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)}});var _p=cc.TableView.prototype;_p.dataSource,cc.defineGetterSetter(_p,"dataSource",_p.getDataSource,_p.setDataSource),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.verticalFillOrder,cc.defineGetterSetter(_p,"verticalFillOrder",_p.getVerticalFillOrder,_p.setVerticalFillOrder),_p=null,cc.TableView.create=function(a,b,c){return cc.TableView(a,b,c)};