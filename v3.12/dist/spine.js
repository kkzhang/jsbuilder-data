var sp=sp||{};sp.VERTEX_INDEX={X1:0,Y1:1,X2:2,Y2:3,X3:4,Y3:5,X4:6,Y4:7},sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.Skeleton=cc.Node.extend({_skeleton:null,_rootBone:null,_timeScale:1,_debugSlots:!1,_debugBones:!1,_premultipliedAlpha:!1,_ownsSkeletonData:null,_atlas:null,_blendFunc:null,ctor:function(a,b,c){cc.Node.prototype.ctor.call(this),0===arguments.length?this.init():this.initWithArgs(a,b,c)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new sp.Skeleton.CanvasRenderCmd(this):new sp.Skeleton.WebGLRenderCmd(this)},init:function(){cc.Node.prototype.init.call(this),this._premultipliedAlpha=cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this.scheduleUpdate()},setDebugSolots:function(a){this._debugSlots=a},setDebugBones:function(a){this._debugBones=a},setDebugSlotsEnabled:function(a){this._debugSlots=a},getDebugSlotsEnabled:function(){return this._debugSlots},setDebugBonesEnabled:function(a){this._debugBones=a},getDebugBonesEnabled:function(){return this._debugBones},setTimeScale:function(a){this._timeScale=a},getTimeScale:function(){return this._timeScale},initWithArgs:function(a,b,c){var d,e,f,g=a,h=b;if(cc.isString(g)){if(cc.isString(h)){var i=cc.loader.getRes(h);sp._atlasLoader.setAtlasFile(h),e=new spine.Atlas(i,sp._atlasLoader)}else e=b;c=c||1/cc.director.getContentScaleFactor();var j=new spine.AtlasAttachmentLoader(e),k=new spine.SkeletonJson(j);k.scale=c;var l=cc.loader.getRes(g);d=k.readSkeletonData(l),e.dispose(k),f=!0}else d=a,f=b;this.setSkeletonData(d,f),this.init()},getBoundingBox:function(){for(var a=cc.FLT_MAX,b=cc.FLT_MAX,c=cc.FLT_MIN,d=cc.FLT_MIN,e=this.getScaleX(),f=this.getScaleY(),g=[],h=this._skeleton.slots,i=sp.VERTEX_INDEX,j=0,k=h.length;k>j;++j){var l=h[j];if(l.attachment&&l.attachment.type==sp.ATTACHMENT_TYPE.REGION){var m=l.attachment;this._computeRegionAttachmentWorldVertices(m,l.bone.skeleton.x,l.bone.skeleton.y,l.bone,g),a=Math.min(a,g[i.X1]*e,g[i.X4]*e,g[i.X2]*e,g[i.X3]*e),b=Math.min(b,g[i.Y1]*f,g[i.Y4]*f,g[i.Y2]*f,g[i.Y3]*f),c=Math.max(c,g[i.X1]*e,g[i.X4]*e,g[i.X2]*e,g[i.X3]*e),d=Math.max(d,g[i.Y1]*f,g[i.Y4]*f,g[i.Y2]*f,g[i.Y3]*f)}}var n=this.getPosition();return cc.rect(n.x+a,n.y+b,c-a,d-b)},_computeRegionAttachmentWorldVertices:function(a,b,c,d,e){var f=a.offset,g=sp.VERTEX_INDEX;b+=d.worldX,c+=d.worldY,e[g.X1]=f[g.X1]*d.m00+f[g.Y1]*d.m01+b,e[g.Y1]=f[g.X1]*d.m10+f[g.Y1]*d.m11+c,e[g.X2]=f[g.X2]*d.m00+f[g.Y2]*d.m01+b,e[g.Y2]=f[g.X2]*d.m10+f[g.Y2]*d.m11+c,e[g.X3]=f[g.X3]*d.m00+f[g.Y3]*d.m01+b,e[g.Y3]=f[g.X3]*d.m10+f[g.Y3]*d.m11+c,e[g.X4]=f[g.X4]*d.m00+f[g.Y4]*d.m01+b,e[g.Y4]=f[g.X4]*d.m10+f[g.Y4]*d.m11+c},updateWorldTransform:function(){this._skeleton.updateWorldTransform()},setToSetupPose:function(){this._skeleton.setToSetupPose()},setBonesToSetupPose:function(){this._skeleton.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._skeleton.setSlotsToSetupPose()},findBone:function(a){return this._skeleton.findBone(a)},findSlot:function(a){return this._skeleton.findSlot(a)},setSkin:function(a){return this._skeleton.setSkinByName(a)},getAttachment:function(a,b){return this._skeleton.getAttachmentBySlotName(a,b)},setAttachment:function(a,b){this._skeleton.setAttachment(a,b)},setPremultipliedAlpha:function(a){this._premultipliedAlpha=a},isPremultipliedAlpha:function(){return this._premultipliedAlpha},setSkeletonData:function(a,b){null!=a.width&&null!=a.height&&this.setContentSize(a.width/cc.director.getContentScaleFactor(),a.height/cc.director.getContentScaleFactor()),this._skeleton=new spine.Skeleton(a),this._skeleton.updateWorldTransform(),this._rootBone=this._skeleton.getRootBone(),this._ownsSkeletonData=b,this._renderCmd._createChildFormSkeletonData()},getTextureAtlas:function(a){return a.rendererObject.page.rendererObject},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(a,b){var c=this._blendFunc;void 0===b?(c.src=a.src,c.dst=a.dst):(c.src=a,c.dst=b)},update:function(a){this._skeleton.update(a)}}),sp.Skeleton.create=function(a,b,c){return new sp.Skeleton(a,b,c)};var spine={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"==typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};spine.BoneData=function(a,b){this.length=this.x=this.y=this.rotation=0,this.scaleX=this.scaleY=1,this.name=a,this.parent=b},spine.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1},spine.BlendMode={normal:0,additive:1,multiply:2,screen:3},spine.SlotData=function(a,b){this.r=this.g=this.b=this.a=1,this.blendMode=spine.BlendMode.normal,this.name=a,this.boneData=b},spine.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,blendMode:spine.BlendMode.normal},spine.IkConstraintData=function(a){this.bendDirection=this.mix=1,this.name=a,this.bones=[]},spine.IkConstraintData.prototype={target:null,bendDirection:1,mix:1},spine.Bone=function(a,b,c){this.x=this.y=this.rotation=this.rotationIK=0,this.scaleX=this.scaleY=1,this.flipX=this.flipY=!1,this.m00=this.m01=this.worldX=0,this.m10=this.m11=this.worldY=0,this.worldRotation=0,this.worldScaleX=this.worldScaleY=1,this.worldFlipX=this.worldFlipY=!1,this.data=a,this.skeleton=b,this.parent=c,this.setToSetupPose()},spine.Bone.yDown=!1,spine.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var a=this.parent;if(a)this.worldX=this.x*a.m00+this.y*a.m01+a.worldX,this.worldY=this.x*a.m10+this.y*a.m11+a.worldY,this.data.inheritScale?(this.worldScaleX=a.worldScaleX*this.scaleX,this.worldScaleY=a.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY),this.worldRotation=this.data.inheritRotation?a.worldRotation+this.rotationIK:this.rotationIK,this.worldFlipX=a.worldFlipX!=this.flipX,this.worldFlipY=a.worldFlipY!=this.flipY;else{var b=this.skeleton.flipX,c=this.skeleton.flipY;this.worldX=b?-this.x:this.x,this.worldY=c!=spine.Bone.yDown?-this.y:this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotationIK,this.worldFlipX=b!=this.flipX,this.worldFlipY=c!=this.flipY}var d=this.worldRotation*spine.degRad,e=Math.cos(d),f=Math.sin(d);this.worldFlipX?(this.m00=-e*this.worldScaleX,this.m01=f*this.worldScaleY):(this.m00=e*this.worldScaleX,this.m01=-f*this.worldScaleY),this.worldFlipY!=spine.Bone.yDown?(this.m10=-f*this.worldScaleX,this.m11=-e*this.worldScaleY):(this.m10=f*this.worldScaleX,this.m11=e*this.worldScaleY)},setToSetupPose:function(){var a=this.data;this.x=a.x,this.y=a.y,this.rotation=a.rotation,this.rotationIK=this.rotation,this.scaleX=a.scaleX,this.scaleY=a.scaleY,this.flipX=a.flipX,this.flipY=a.flipY},worldToLocal:function(a){var b=a[0]-this.worldX,c=a[1]-this.worldY,d=this.m00,e=this.m10,f=this.m01,g=this.m11;this.worldFlipX!=(this.worldFlipY!=spine.Bone.yDown)&&(d=-d,g=-g);var h=1/(d*g-f*e);a[0]=b*d*h-c*f*h,a[1]=c*g*h-b*e*h},localToWorld:function(a){var b=a[0],c=a[1];a[0]=b*this.m00+c*this.m01+this.worldX,a[1]=b*this.m10+c*this.m11+this.worldY}},spine.Slot=function(a,b){this.r=this.g=this.b=this.a=1,this._attachmentTime=0,this.data=a,this.bone=b,this.setToSetupPose()},spine.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(a){this.attachment=a,this._attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0},setAttachmentTime:function(a){this._attachmentTime=this.bone.skeleton.time-a},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var a=this.data;this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a;for(var b=this.bone.skeleton.data.slots,c=0,d=b.length;d>c;c++)if(b[c]==a){this.setAttachment(a.attachmentName?this.bone.skeleton.getAttachmentBySlotIndex(c,a.attachmentName):null);break}}},spine.IkConstraint=function(a,b){this.data=a,this.mix=a.mix,this.bendDirection=a.bendDirection,this.bones=[];for(var c=0,d=a.bones.length;d>c;c++)this.bones.push(b.findBone(a.bones[c].name));this.target=b.findBone(a.target.name)},spine.IkConstraint.prototype={apply:function(){var a=this.target,b=this.bones;switch(b.length){case 1:spine.IkConstraint.apply1(b[0],a.worldX,a.worldY,this.mix);break;case 2:spine.IkConstraint.apply2(b[0],b[1],a.worldX,a.worldY,this.bendDirection,this.mix)}}},spine.IkConstraint.apply1=function(a,b,c,d){var e=a.data.inheritRotation&&a.parent?a.parent.worldRotation:0,f=a.rotation,g=Math.atan2(c-a.worldY,b-a.worldX)*spine.radDeg;a.worldFlipX!=(a.worldFlipY!=spine.Bone.yDown)&&(g=-g),g-=e,a.rotationIK=f+(g-f)*d},spine.IkConstraint.apply2=function(a,b,c,d,e,f){var g=b.rotation,h=a.rotation;if(!f)return b.rotationIK=g,void(a.rotationIK=h);var i,j,k=spine.temp,l=a.parent;l?(k[0]=c,k[1]=d,l.worldToLocal(k),c=(k[0]-a.x)*l.worldScaleX,d=(k[1]-a.y)*l.worldScaleY):(c-=a.x,d-=a.y),b.parent==a?(i=b.x,j=b.y):(k[0]=b.x,k[1]=b.y,b.parent.localToWorld(k),a.worldToLocal(k),i=k[0],j=k[1]);var m=i*a.worldScaleX,n=j*a.worldScaleY,o=Math.atan2(n,m),p=Math.sqrt(m*m+n*n),q=b.data.length*b.worldScaleX,r=2*p*q;if(1e-4>r)return void(b.rotationIK=g+(Math.atan2(d,c)*spine.radDeg-h-g)*f);var s=(c*c+d*d-p*p-q*q)/r;-1>s?s=-1:s>1&&(s=1);var t=Math.acos(s)*e,u=p+q*s,v=q*Math.sin(t),w=Math.atan2(d*u-c*v,c*u+d*v),x=(w-o)*spine.radDeg-h;x>180?x-=360:-180>x&&(x+=360),a.rotationIK=h+x*f,x=(t+o)*spine.radDeg-g,x>180?x-=360:-180>x&&(x+=360),b.rotationIK=g+(x+a.worldRotation-b.parent.worldRotation)*f},spine.Skin=function(a){this.name=a,this.attachments={}},spine.Skin.prototype={addAttachment:function(a,b,c){this.attachments[a+":"+b]=c},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(a,b){for(var c in b.attachments){var d=c.indexOf(":"),e=parseInt(c.substring(0,d)),f=c.substring(d+1),g=a.slots[e];if(g.attachment&&g.attachment.name==f){var h=this.getAttachment(e,f);h&&g.setAttachment(h)}}}},spine.Animation=function(a,b,c){this.name=a,this.timelines=b,this.duration=c},spine.Animation.prototype={apply:function(a,b,c,d,e){d&&0!=this.duration&&(c%=this.duration,b%=this.duration);for(var f=this.timelines,g=0,h=f.length;h>g;g++)f[g].apply(a,b,c,e,1)},mix:function(a,b,c,d,e,f){d&&0!=this.duration&&(c%=this.duration,b%=this.duration);for(var g=this.timelines,h=0,i=g.length;i>h;h++)g[h].apply(a,b,c,e,f)}},spine.Animation.binarySearch=function(a,b,c){var d=0,e=Math.floor(a.length/c)-2;if(!e)return c;for(var f=e>>>1;;){if(a[(f+1)*c]<=b?d=f+1:e=f,d==e)return(d+1)*c;f=d+e>>>1}},spine.Animation.binarySearch1=function(a,b){var c=0,d=a.length-2;if(!d)return 1;for(var e=d>>>1;;){if(a[e+1]<=b?c=e+1:d=e,c==d)return c+1;e=c+d>>>1}},spine.Animation.linearSearch=function(a,b,c){for(var d=0,e=a.length-c;e>=d;d+=c)if(a[d]>b)return d;return-1},spine.Curves=function(a){this.curves=[]},spine.Curves.prototype={setLinear:function(a){this.curves[19*a]=0},setStepped:function(a){this.curves[19*a]=1},setCurve:function(a,b,c,d,e){var f=.1,g=f*f,h=g*f,i=3*f,j=3*g,k=6*g,l=6*h,m=2*-b+d,n=2*-c+e,o=3*(b-d)+1,p=3*(c-e)+1,q=b*i+m*j+o*h,r=c*i+n*j+p*h,s=m*k+o*l,t=n*k+p*l,u=o*l,v=p*l,w=19*a,x=this.curves;x[w++]=2;for(var y=q,z=r,A=w+19-1;A>w;w+=2)x[w]=y,x[w+1]=z,q+=s,r+=t,s+=u,t+=v,y+=q,z+=r},getCurvePercent:function(a,b){b=0>b?0:b>1?1:b;var c=this.curves,d=19*a,e=c[d];if(0===e)return b;if(1==e)return 0;d++;for(var f=0,g=d,h=d+19-1;h>d;d+=2)if(f=c[d],f>=b){var i,j;return d==g?(i=0,j=0):(i=c[d-2],j=c[d-1]),j+(c[d+1]-j)*(b-i)/(f-i)}var k=c[d-1];return k+(1-k)*(b-f)/(1-f)}},spine.RotateTimeline=function(a){this.boneIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=2*a},spine.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c},apply:function(a,b,c,d,e){var f=this.frames;if(!(c<f[0])){var g=a.bones[this.boneIndex];if(c>=f[f.length-2]){for(var h=g.data.rotation+f[f.length-1]-g.rotation;h>180;)h-=360;for(;-180>h;)h+=360;return void(g.rotation+=h*e)}var i=spine.Animation.binarySearch(f,c,2),j=f[i-1],k=f[i],l=1-(c-k)/(f[i-2]-k);l=this.curves.getCurvePercent(i/2-1,l);for(var h=f[i+1]-j;h>180;)h-=360;for(;-180>h;)h+=360;for(h=g.data.rotation+(j+h*l)-g.rotation;h>180;)h-=360;for(;-180>h;)h+=360;g.rotation+=h*e}}},spine.TranslateTimeline=function(a){this.boneIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=3*a},spine.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,e){var f=this.frames;if(!(c<f[0])){var g=a.bones[this.boneIndex];if(c>=f[f.length-3])return g.x+=(g.data.x+f[f.length-2]-g.x)*e,void(g.y+=(g.data.y+f[f.length-1]-g.y)*e);var h=spine.Animation.binarySearch(f,c,3),i=f[h-2],j=f[h-1],k=f[h],l=1-(c-k)/(f[h+-3]-k);l=this.curves.getCurvePercent(h/3-1,l),g.x+=(g.data.x+i+(f[h+1]-i)*l-g.x)*e,g.y+=(g.data.y+j+(f[h+2]-j)*l-g.y)*e}}},spine.ScaleTimeline=function(a){this.boneIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=3*a},spine.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,e){var f=this.frames;if(!(c<f[0])){var g=a.bones[this.boneIndex];if(c>=f[f.length-3])return g.scaleX+=(g.data.scaleX*f[f.length-2]-g.scaleX)*e,void(g.scaleY+=(g.data.scaleY*f[f.length-1]-g.scaleY)*e);var h=spine.Animation.binarySearch(f,c,3),i=f[h-2],j=f[h-1],k=f[h],l=1-(c-k)/(f[h+-3]-k);l=this.curves.getCurvePercent(h/3-1,l),g.scaleX+=(g.data.scaleX*(i+(f[h+1]-i)*l)-g.scaleX)*e,g.scaleY+=(g.data.scaleY*(j+(f[h+2]-j)*l)-g.scaleY)*e}}},spine.ColorTimeline=function(a){this.boneIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=5*a},spine.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(a,b,c,d,e,f){a*=5,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d,this.frames[a+3]=e,this.frames[a+4]=f},apply:function(a,b,c,d,e){var f=this.frames;if(!(c<f[0])){var g,h,i,j;if(c>=f[f.length-5]){var k=f.length-1;g=f[k-3],h=f[k-2],i=f[k-1],j=f[k]}else{var l=spine.Animation.binarySearch(f,c,5),m=f[l-4],n=f[l-3],o=f[l-2],p=f[l-1],q=f[l],r=1-(c-q)/(f[l-5]-q);r=this.curves.getCurvePercent(l/5-1,r),g=m+(f[l+1]-m)*r,h=n+(f[l+2]-n)*r,i=o+(f[l+3]-o)*r,j=p+(f[l+4]-p)*r}var s=a.slots[this.slotIndex];1>e?(s.r+=(g-s.r)*e,s.g+=(h-s.g)*e,s.b+=(i-s.b)*e,s.a+=(j-s.a)*e):(s.r=g,s.g=h,s.b=i,s.a=j)}}},spine.AttachmentTimeline=function(a){this.slotIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=a,this.attachmentNames=[],this.attachmentNames.length=a},spine.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.attachmentNames[a]=c},apply:function(a,b,c,d,e){var f=this.frames;if(c<f[0])return void(b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var g=c>=f[f.length-1]?f.length-1:spine.Animation.binarySearch1(f,c)-1;if(!(f[g]<b)){var h=this.attachmentNames[g];a.slots[this.slotIndex].setAttachment(h?a.getAttachmentBySlotIndex(this.slotIndex,h):null)}}},spine.EventTimeline=function(a){this.frames=[],this.frames.length=a,this.events=[],this.events.length=a},spine.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.events[a]=c},apply:function(a,b,c,d,e){if(d){var f=this.frames,g=f.length;if(b>c)this.apply(a,b,Number.MAX_VALUE,d,e),b=-1;else if(b>=f[g-1])return;if(!(c<f[0])){var h;if(b<f[0])h=0;else{h=spine.Animation.binarySearch1(f,b);for(var i=f[h];h>0&&f[h-1]==i;)h--}for(var j=this.events;g>h&&c>=f[h];h++)d.push(j[h])}}}},spine.DrawOrderTimeline=function(a){this.frames=[],this.frames.length=a,this.drawOrders=[],this.drawOrders.length=a},spine.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.drawOrders[a]=c},apply:function(a,b,c,d,e){var f=this.frames;if(!(c<f[0])){var g;g=c>=f[f.length-1]?f.length-1:spine.Animation.binarySearch1(f,c)-1;var h=a.drawOrder,i=a.slots,j=this.drawOrders[g];if(j)for(var k=0,l=j.length;l>k;k++)h[k]=a.slots[j[k]];else for(var k=0,l=i.length;l>k;k++)h[k]=i[k]}}},spine.FfdTimeline=function(a){this.slotIndex=this.attachment=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=a,this.frameVertices=[],this.frameVertices.length=a},spine.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.frameVertices[a]=c},apply:function(a,b,c,d,e){var f=a.slots[this.slotIndex];if(f.attachment==this.attachment){var g=this.frames;if(!(c<g[0])){var h=this.frameVertices,i=h[0].length,j=f.attachmentVertices;if(j.length!=i&&(e=1),j.length=i,c>=g[g.length-1]){var k=h[g.length-1];if(1>e)for(var l=0;i>l;l++)j[l]+=(k[l]-j[l])*e;else for(var l=0;i>l;l++)j[l]=k[l]}else{var m=spine.Animation.binarySearch1(g,c),n=g[m],o=1-(c-n)/(g[m-1]-n);o=this.curves.getCurvePercent(m-1,0>o?0:o>1?1:o);var p=h[m-1],q=h[m];if(1>e)for(var l=0;i>l;l++){var r=p[l];j[l]+=(r+(q[l]-r)*o-j[l])*e}else for(var l=0;i>l;l++){var r=p[l];j[l]=r+(q[l]-r)*o}}}}}},spine.IkConstraintTimeline=function(a){this.ikConstraintIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=3*a},spine.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,e){var f=this.frames;if(!(c<f[0])){var g=a.ikConstraints[this.ikConstraintIndex];if(c>=f[f.length-3])return g.mix+=(f[f.length-2]-g.mix)*e,void(g.bendDirection=f[f.length-1]);var h=spine.Animation.binarySearch(f,c,3),i=f[h+-2],j=f[h],k=1-(c-j)/(f[h+-3]-j);k=this.curves.getCurvePercent(h/3-1,k);var l=i+(f[h+1]-i)*k;g.mix+=(l-g.mix)*e,g.bendDirection=f[h+-1]}}},spine.FlipXTimeline=function(a){this.boneIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=2*a},spine.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c?1:0},apply:function(a,b,c,d,e){var f=this.frames;if(c<f[0])return void(b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var g=(c>=f[f.length-2]?f.length:spine.Animation.binarySearch(f,c,2))-2;f[g]<b||(a.bones[this.boneIndex].flipX=0!=f[g+1])}},spine.FlipYTimeline=function(a){this.boneIndex=0,this.curves=new spine.Curves(a),this.frames=[],this.frames.length=2*a},spine.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c?1:0},apply:function(a,b,c,d,e){var f=this.frames;if(c<f[0])return void(b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var g=(c>=f[f.length-2]?f.length:spine.Animation.binarySearch(f,c,2))-2;f[g]<b||(a.bones[this.boneIndex].flipY=0!=f[g+1])}},spine.SkeletonData=function(){this.width=this.height=0,this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[]},spine.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return slot[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSkin:function(a){for(var b=this.skins,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findEvent:function(a){for(var b=this.events,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findAnimation:function(a){for(var b=this.animations,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findIkConstraint:function(a){for(var b=this.ikConstraints,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null}},spine.Skeleton=function(a){this.x=this.y=0,this.r=this.g=this.b=this.a=1,this.time=0,this.flipX=this.flipY=!1,this.data=a,this.bones=[];for(var b=0,c=a.bones.length;c>b;b++){var d=a.bones[b],e=d.parent?this.bones[a.bones.indexOf(d.parent)]:null;this.bones.push(new spine.Bone(d,this,e))}this.slots=[],this.drawOrder=[];for(var b=0,c=a.slots.length;c>b;b++){var f=a.slots[b],g=this.bones[a.bones.indexOf(f.boneData)],h=new spine.Slot(f,g);this.slots.push(h),this.drawOrder.push(h)}this.ikConstraints=[];for(var b=0,c=a.ikConstraints.length;c>b;b++)this.ikConstraints.push(new spine.IkConstraint(a.ikConstraints[b],this));this.boneCache=[],this.updateCache()},spine.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var a=this.ikConstraints,b=a.length,c=b+1,d=this.boneCache;d.length>c&&(d.length=c);for(var e=0,f=d.length;f>e;e++)d[e].length=0;for(;d.length<c;)d[d.length]=[];var g=d[0],h=this.bones;a:for(var e=0,f=h.length;f>e;e++){var i=h[e],j=i;do{for(var k=0;b>k;k++)for(var l=a[k],m=l.bones[0],n=l.bones[l.bones.length-1];;){if(j==n){d[k].push(i),d[k+1].push(i);continue a}if(n==m)break;n=n.parent}j=j.parent}while(j);g[g.length]=i}},updateWorldTransform:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++){var d=a[b];d.rotationIK=d.rotation}for(var b=0,e=this.boneCache.length-1;;){for(var f=this.boneCache[b],g=0,h=f.length;h>g;g++)f[g].updateWorldTransform();if(b==e)break;this.ikConstraints[b].apply(),b++}},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++)a[b].setToSetupPose();for(var d=this.ikConstraints,b=0,c=d.length;c>b;b++){var e=d[b];e.bendDirection=e.data.bendDirection,e.mix=e.data.mix}},setSlotsToSetupPose:function(){for(var a=this.slots,b=this.drawOrder,c=0,d=a.length;d>c;c++)b[c]=a[c],a[c].setToSetupPose(c)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b)throw new Error("Skin not found: "+a);this.setSkin(b)},setSkin:function(a){if(a)if(this.skin)a._attachAll(this,this.skin);else for(var b=this.slots,c=0,d=b.length;d>c;c++){var e=b[c],f=e.data.attachmentName;if(f){var g=a.getAttachment(c,f);g&&e.setAttachment(g)}}this.skin=a},getAttachmentBySlotName:function(a,b){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a),b)},getAttachmentBySlotIndex:function(a,b){if(this.skin){var c=this.skin.getAttachment(a,b);if(c)return c}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},setAttachment:function(a,b){for(var c=this.slots,d=0,e=c.length;e>d;d++){var f=c[d];if(f.data.name==a){var g=null;if(b&&(g=this.getAttachmentBySlotIndex(d,b),!g))throw new Error("Attachment not found: "+b+", for slot: "+a);return void f.setAttachment(g)}}throw new Error("Slot not found: "+a)},findIkConstraint:function(a){for(var b=this.ikConstraints,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},update:function(a){this.time+=a}},spine.EventData=function(a){this.intValue=this.floatValue=0,this.name=a},spine.EventData.prototype={intValue:0,floatValue:0,stringValue:null},spine.Event=function(a){this.intValue=this.floatValue=0,this.data=a},spine.Event.prototype={intValue:0,floatValue:0,stringValue:null},spine.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3},spine.RegionAttachment=function(a){this.type=spine.AttachmentType.region,this.x=this.y=this.rotation=0,this.scaleX=this.scaleY=1,this.width=this.height=0,this.r=this.g=this.b=this.a=1,this.regionOffsetX=this.regionOffsetY=this.regionWidth=this.regionHeight=this.regionOriginalWidth=this.regionOriginalHeight=0,this.name=a,this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},spine.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(a,b,c,d,e){var f=this.uvs;e?(f[2]=a,f[3]=d,f[4]=a,f[5]=b,f[6]=c,f[7]=b,f[0]=c,f[1]=d):(f[0]=a,f[1]=d,f[2]=a,f[3]=b,f[4]=c,f[5]=b,f[6]=c,f[7]=d)},updateOffset:function(){var a=this.width/this.regionOriginalWidth*this.scaleX,b=this.height/this.regionOriginalHeight*this.scaleY,c=-this.width/2*this.scaleX+this.regionOffsetX*a,d=-this.height/2*this.scaleY+this.regionOffsetY*b,e=c+this.regionWidth*a,f=d+this.regionHeight*b,g=this.rotation*spine.degRad,h=Math.cos(g),i=Math.sin(g),j=c*h+this.x,k=c*i,l=d*h+this.y,m=d*i,n=e*h+this.x,o=e*i,p=f*h+this.y,q=f*i,r=this.offset;r[0]=j-m,r[1]=l+k,r[2]=j-q,r[3]=p+k,r[4]=n-q,r[5]=p+o,r[6]=n-m,r[7]=l+o},computeVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.offset;d[0]=i[0]*e+i[1]*f+a,d[1]=i[0]*g+i[1]*h+b,d[2]=i[2]*e+i[3]*f+a,d[3]=i[2]*g+i[3]*h+b,d[4]=i[4]*e+i[5]*f+a,d[5]=i[4]*g+i[5]*h+b,d[6]=i[6]*e+i[7]*f+a,d[7]=i[6]*g+i[7]*h+b}},spine.MeshAttachment=function(a){this.type=spine.AttachmentType.mesh,this.hullLength=0,this.r=this.g=this.b=this.a=1,this.regionU=this.regionV=this.regionV2=0,this.regionRotate=!1,this.regionOffsetX=this.regionOffsetY=this.regionWidth=this.regionHeight=this.regionOriginalWidth=this.regionOriginalHeight=0,this.width=this.height=0,this.name=a},spine.MeshAttachment.prototype={vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var a=this.regionU2-this.regionU,b=this.regionV2-this.regionV,c=this.regionUVs.length;if(this.uvs&&this.uvs.length==c||(this.uvs=new spine.Float32Array(c)),this.regionRotate)for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d+1]*a,this.uvs[d+1]=this.regionV+b-this.regionUVs[d]*b;else for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d]*a,this.uvs[d+1]=this.regionV+this.regionUVs[d+1]*b},computeWorldVertices:function(a,b,c,d){var e=c.bone;a+=e.worldX,b+=e.worldY;var f=e.m00,g=e.m01,h=e.m10,i=e.m11,j=this.vertices,k=j.length;c.attachmentVertices.length==k&&(j=c.attachmentVertices);for(var l=0;k>l;l+=2){var m=j[l],n=j[l+1];d[l]=m*f+n*g+a,d[l+1]=m*h+n*i+b}}},spine.SkinnedMeshAttachment=function(a){this.type=spine.AttachmentType.skinnedmesh,this.hullLength=0,this.r=this.g=this.b=this.a=1,this.regionU=this.regionV=this.regionU2=this.regionV2=0,this.regionRotate=!1,this.regionOffsetX=this.regionOffsetY=this.regionWidth=this.regionHeight=this.regionOriginalWidth=this.regionOriginalHeight=0,this.width=this.height=0,this.name=a},spine.SkinnedMeshAttachment.prototype={bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(a,b,c,d,e){var f=this.regionU2-this.regionU,g=this.regionV2-this.regionV,h=this.regionUVs.length;if(this.uvs&&this.uvs.length==h||(this.uvs=new spine.Float32Array(h)),this.regionRotate)for(var i=0;h>i;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i+1]*f,this.uvs[i+1]=this.regionV+g-this.regionUVs[i]*g;else for(var i=0;h>i;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i]*f,this.uvs[i+1]=this.regionV+this.regionUVs[i+1]*g},computeWorldVertices:function(a,b,c,d){var e,f,g,h,i,j,k,l=c.bone.skeleton.bones,m=this.weights,n=this.bones,o=0,p=0,q=0,r=0,s=n.length;if(c.attachmentVertices.length)for(var t=c.attachmentVertices;s>p;o+=2){for(f=0,g=0,e=n[p++]+p;e>p;p++,q+=3,r+=2)h=l[n[p]],i=m[q]+t[r],j=m[q+1]+t[r+1],k=m[q+2],f+=(i*h.m00+j*h.m01+h.worldX)*k,g+=(i*h.m10+j*h.m11+h.worldY)*k;d[o]=f+a,d[o+1]=g+b}else for(;s>p;o+=2){for(f=0,g=0,e=n[p++]+p;e>p;p++,q+=3)h=l[n[p]],i=m[q],j=m[q+1],k=m[q+2],f+=(i*h.m00+j*h.m01+h.worldX)*k,g+=(i*h.m10+j*h.m11+h.worldY)*k;d[o]=f+a,d[o+1]=g+b}}},spine.BoundingBoxAttachment=function(a){this.type=spine.AttachmentType.boundingbox,this.name=a,this.vertices=[]},spine.BoundingBoxAttachment.prototype={computeWorldVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;for(var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.vertices,j=0,k=i.length;k>j;j+=2){var l=i[j],m=i[j+1];d[j]=l*e+m*f+a,d[j+1]=l*g+m*h+b}}},spine.AnimationStateData=function(a){this.skeletonData=a,this.animationToMixTime={},this.defaultMix=0},spine.AnimationStateData.prototype={defaultMix:0,setMixByName:function(a,b,c){var d=this.skeletonData.findAnimation(a);if(!d)throw new Error("Animation not found: "+a);var e=this.skeletonData.findAnimation(b);if(!e)throw new Error("Animation not found: "+b);this.setMix(d,e,c)},setMix:function(a,b,c){this.animationToMixTime[a.name+":"+b.name]=c},getMix:function(a,b){var c=a.name+":"+b.name;return this.animationToMixTime.hasOwnProperty(c)?this.animationToMixTime[c]:this.defaultMix}},spine.TrackEntry=function(){this.delay=this.time=this.endTime=0,this.lastTime=-1,this.timeScale=1,this.mixTime=this.mixDuration=1,this.mix=1},spine.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null},spine.AnimationState=function(a){this.timeScale=1,this.data=a,this.tracks=[],this.events=[]},spine.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(a){a*=this.timeScale;for(var b=0;b<this.tracks.length;b++){var c=this.tracks[b];if(c){if(c.time+=a*c.timeScale,c.previous){var d=a*c.previous.timeScale;c.previous.time+=d,c.mixTime+=d}var e=c.next;e?(e.time=c.lastTime-e.delay,e.time>=0&&this.setCurrent(b,e)):!c.loop&&c.lastTime>=c.endTime&&this.clearTrack(b)}}},apply:function(a){for(var b=0;b<this.tracks.length;b++){var c=this.tracks[b];if(c){this.events.length=0;var d=c.time,e=c.lastTime,f=c.endTime,g=c.loop;!g&&d>f&&(d=f);var h=c.previous;if(h){var i=h.time;!h.loop&&i>h.endTime&&(i=h.endTime),h.animation.apply(a,i,i,h.loop,null);var j=c.mixTime/c.mixDuration*c.mix;j>=1&&(j=1,c.previous=null),c.animation.mix(a,c.lastTime,d,g,this.events,j)}else 1==c.mix?c.animation.apply(a,c.lastTime,d,g,this.events):c.animation.mix(a,c.lastTime,d,g,this.events,c.mix);for(var k=0,l=this.events.length;l>k;k++){var m=this.events[k];c.onEvent&&c.onEvent(b,m),this.onEvent&&this.onEvent(b,m)}if(g?e%f>d%f:f>e&&d>=f){var n=Math.floor(d/f);c.onComplete&&c.onComplete(b,n),this.onComplete&&this.onComplete(b,n)}c.lastTime=c.time}}},clearTracks:function(){for(var a=0,b=this.tracks.length;b>a;a++)this.clearTrack(a);this.tracks.length=0},clearTrack:function(a){if(!(a>=this.tracks.length)){var b=this.tracks[a];b&&(b.onEnd&&b.onEnd(a),this.onEnd&&this.onEnd(a),this.tracks[a]=null)}},_expandToIndex:function(a){if(a<this.tracks.length)return this.tracks[a];for(;a>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(a,b){var c=this._expandToIndex(a);if(c){var d=c.previous;c.previous=null,c.onEnd&&c.onEnd(a),this.onEnd&&this.onEnd(a),
b.mixDuration=this.data.getMix(c.animation,b.animation),b.mixDuration>0&&(b.mixTime=0,d&&c.mixTime/c.mixDuration<.5?b.previous=d:b.previous=c)}this.tracks[a]=b,b.onStart&&b.onStart(a),this.onStart&&this.onStart(a)},setAnimationByName:function(a,b,c){var d=this.data.skeletonData.findAnimation(b);if(!d)throw new Error("Animation not found: "+b);return this.setAnimation(a,d,c)},setAnimation:function(a,b,c){var d=new spine.TrackEntry;return d.animation=b,d.loop=c,d.endTime=b.duration,this.setCurrent(a,d),d},addAnimationByName:function(a,b,c,d){var e=this.data.skeletonData.findAnimation(b);if(!e)throw new Error("Animation not found: "+b);return this.addAnimation(a,e,c,d)},addAnimation:function(a,b,c,d){var e=new spine.TrackEntry;e.animation=b,e.loop=c,e.endTime=b.duration;var f=this._expandToIndex(a);if(f){for(;f.next;)f=f.next;f.next=e}else this.tracks[a]=e;return 0>=d&&(f?d+=f.endTime-this.data.getMix(f.animation,b):d=0),e.delay=d,e},getCurrent:function(a){return a>=this.tracks.length?null:this.tracks[a]}},spine.SkeletonJson=function(a){this.scale=1,this.attachmentLoader=a},spine.SkeletonJson.prototype={scale:1,readSkeletonData:function(a,b){var c=new spine.SkeletonData;c.name=b;var d=a.skeleton;d&&(c.hash=d.hash,c.version=d.spine,c.width=d.width||0,c.height=d.height||0);for(var e=a.bones,f=0,g=e.length;g>f;f++){var h=e[f],i=null;if(h.parent&&(i=c.findBone(h.parent),!i))throw new Error("Parent bone not found: "+h.parent);var j=new spine.BoneData(h.name,i);j.length=(h.length||0)*this.scale,j.x=(h.x||0)*this.scale,j.y=(h.y||0)*this.scale,j.rotation=h.rotation||0,j.scaleX=h.hasOwnProperty("scaleX")?h.scaleX:1,j.scaleY=h.hasOwnProperty("scaleY")?h.scaleY:1,j.inheritScale=h.hasOwnProperty("inheritScale")?h.inheritScale:!0,j.inheritRotation=h.hasOwnProperty("inheritRotation")?h.inheritRotation:!0,c.bones.push(j)}var k=a.ik;if(k)for(var f=0,g=k.length;g>f;f++){for(var l=k[f],m=new spine.IkConstraintData(l.name),e=l.bones,n=0,o=e.length;o>n;n++){var p=c.findBone(e[n]);if(!p)throw new Error("IK bone not found: "+e[n]);m.bones.push(p)}if(m.target=c.findBone(l.target),!m.target)throw new Error("Target bone not found: "+l.target);m.bendDirection=!l.hasOwnProperty("bendPositive")||l.bendPositive?1:-1,m.mix=l.hasOwnProperty("mix")?l.mix:1,c.ikConstraints.push(m)}for(var q=a.slots,f=0,g=q.length;g>f;f++){var r=q[f],j=c.findBone(r.bone);if(!j)throw new Error("Slot bone not found: "+r.bone);var s=new spine.SlotData(r.name,j),t=r.color;t&&(s.r=this.toColor(t,0),s.g=this.toColor(t,1),s.b=this.toColor(t,2),s.a=this.toColor(t,3)),s.attachmentName=r.attachment,s.blendMode=spine.AttachmentType[r.blend||"normal"],c.slots.push(s)}var u=a.skins;for(var v in u)if(u.hasOwnProperty(v)){var w=u[v],x=new spine.Skin(v);for(var y in w)if(w.hasOwnProperty(y)){var z=c.findSlotIndex(y),A=w[y];for(var B in A)if(A.hasOwnProperty(B)){var C=this.readAttachment(x,B,A[B]);C&&x.addAttachment(z,B,C)}}c.skins.push(x),"default"==x.name&&(c.defaultSkin=x)}var D=a.events;for(var E in D)if(D.hasOwnProperty(E)){var F=D[E],G=new spine.EventData(E);G.intValue=F["int"]||0,G.floatValue=F["float"]||0,G.stringValue=F.string||null,c.events.push(G)}var H=a.animations;for(var I in H)H.hasOwnProperty(I)&&this.readAnimation(I,H[I],c);return c},readAttachment:function(a,b,c){b=c.name||b;var d=spine.AttachmentType[c.type||"region"],e=c.path||b,f=this.scale;if(d==spine.AttachmentType.region){var g=this.attachmentLoader.newRegionAttachment(a,b,e);if(!g)return null;g.path=e,g.x=(c.x||0)*f,g.y=(c.y||0)*f,g.scaleX=c.hasOwnProperty("scaleX")?c.scaleX:1,g.scaleY=c.hasOwnProperty("scaleY")?c.scaleY:1,g.rotation=c.rotation||0,g.width=(c.width||0)*f,g.height=(c.height||0)*f;var h=c.color;return h&&(g.r=this.toColor(h,0),g.g=this.toColor(h,1),g.b=this.toColor(h,2),g.a=this.toColor(h,3)),g.updateOffset(),g}if(d==spine.AttachmentType.mesh){var i=this.attachmentLoader.newMeshAttachment(a,b,e);return i?(i.path=e,i.vertices=this.getFloatArray(c,"vertices",f),i.triangles=this.getIntArray(c,"triangles"),i.regionUVs=this.getFloatArray(c,"uvs",1),i.updateUVs(),h=c.color,h&&(i.r=this.toColor(h,0),i.g=this.toColor(h,1),i.b=this.toColor(h,2),i.a=this.toColor(h,3)),i.hullLength=2*(c.hull||0),c.edges&&(i.edges=this.getIntArray(c,"edges")),i.width=(c.width||0)*f,i.height=(c.height||0)*f,i):null}if(d==spine.AttachmentType.skinnedmesh){var i=this.attachmentLoader.newSkinnedMeshAttachment(a,b,e);if(!i)return null;i.path=e;for(var j=this.getFloatArray(c,"uvs",1),k=this.getFloatArray(c,"vertices",1),l=[],m=[],n=0,o=k.length;o>n;){var p=0|k[n++];m[m.length]=p;for(var q=n+4*p;q>n;)m[m.length]=k[n],l[l.length]=k[n+1]*f,l[l.length]=k[n+2]*f,l[l.length]=k[n+3],n+=4}return i.bones=m,i.weights=l,i.triangles=this.getIntArray(c,"triangles"),i.regionUVs=j,i.updateUVs(),h=c.color,h&&(i.r=this.toColor(h,0),i.g=this.toColor(h,1),i.b=this.toColor(h,2),i.a=this.toColor(h,3)),i.hullLength=2*(c.hull||0),c.edges&&(i.edges=this.getIntArray(c,"edges")),i.width=(c.width||0)*f,i.height=(c.height||0)*f,i}if(d==spine.AttachmentType.boundingbox){for(var r=this.attachmentLoader.newBoundingBoxAttachment(a,b),k=c.vertices,n=0,o=k.length;o>n;n++)r.vertices.push(k[n]*f);return r}throw new Error("Unknown attachment type: "+d)},readAnimation:function(a,b,c){var d=[],e=0,f=b.slots;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g],i=c.findSlotIndex(g);for(var j in h)if(h.hasOwnProperty(j)){var k=h[j];if("color"==j){var l=new spine.ColorTimeline(k.length);l.slotIndex=i;for(var m=0,n=0,o=k.length;o>n;n++){var p=k[n],q=p.color,r=this.toColor(q,0),s=this.toColor(q,1),t=this.toColor(q,2),u=this.toColor(q,3);l.setFrame(m,p.time,r,s,t,u),this.readCurve(l,m,p),m++}d.push(l),e=Math.max(e,l.frames[5*l.getFrameCount()-5])}else{if("attachment"!=j)throw new Error("Invalid timeline type for a slot: "+j+" ("+g+")");var l=new spine.AttachmentTimeline(k.length);l.slotIndex=i;for(var m=0,n=0,o=k.length;o>n;n++){var p=k[n];l.setFrame(m++,p.time,p.name)}d.push(l),e=Math.max(e,l.frames[l.getFrameCount()-1])}}}var v=b.bones;for(var w in v)if(v.hasOwnProperty(w)){var x=c.findBoneIndex(w);if(-1==x)throw new Error("Bone not found: "+w);var y=v[w];for(var j in y)if(y.hasOwnProperty(j)){var k=y[j];if("rotate"==j){var l=new spine.RotateTimeline(k.length);l.boneIndex=x;for(var m=0,n=0,o=k.length;o>n;n++){var p=k[n];l.setFrame(m,p.time,p.angle),this.readCurve(l,m,p),m++}d.push(l),e=Math.max(e,l.frames[2*l.getFrameCount()-2])}else if("translate"==j||"scale"==j){var l,z=1;"scale"==j?l=new spine.ScaleTimeline(k.length):(l=new spine.TranslateTimeline(k.length),z=this.scale),l.boneIndex=x;for(var m=0,n=0,o=k.length;o>n;n++){var p=k[n],A=(p.x||0)*z,B=(p.y||0)*z;l.setFrame(m,p.time,A,B),this.readCurve(l,m,p),m++}d.push(l),e=Math.max(e,l.frames[3*l.getFrameCount()-3])}else{if("flipX"!=j&&"flipY"!=j)throw new Error("Invalid timeline type for a bone: "+j+" ("+w+")");var A="flipX"==j,l=A?new spine.FlipXTimeline(k.length):new spine.FlipYTimeline(k.length);l.boneIndex=x;for(var C=A?"x":"y",m=0,n=0,o=k.length;o>n;n++){var p=k[n];l.setFrame(m,p.time,p[C]||!1),m++}d.push(l),e=Math.max(e,l.frames[2*l.getFrameCount()-2])}}}var D=b.ik;for(var E in D)if(D.hasOwnProperty(E)){var F=c.findIkConstraint(E),k=D[E],l=new spine.IkConstraintTimeline(k.length);l.ikConstraintIndex=c.ikConstraints.indexOf(F);for(var m=0,n=0,o=k.length;o>n;n++){var p=k[n],G=p.hasOwnProperty("mix")?p.mix:1,H=!p.hasOwnProperty("bendPositive")||p.bendPositive?1:-1;l.setFrame(m,p.time,G,H),this.readCurve(l,m,p),m++}d.push(l),e=Math.max(e,l.frames[3*l.frameCount-3])}var I=b.ffd;for(var J in I){var K=c.findSkin(J),h=I[J];for(g in h){var i=c.findSlotIndex(g),L=h[g];for(var M in L){var k=L[M],l=new spine.FfdTimeline(k.length),N=K.getAttachment(i,M);if(!N)throw new Error("FFD attachment not found: "+M);l.slotIndex=i,l.attachment=N;var O,P=N.type==spine.AttachmentType.mesh;O=P?N.vertices.length:N.weights.length/3*2;for(var m=0,n=0,o=k.length;o>n;n++){var Q,p=k[n];if(p.vertices){var R=p.vertices,Q=[];Q.length=O;var S=p.offset||0,T=R.length;if(1==this.scale)for(var U=0;T>U;U++)Q[U+S]=R[U];else for(var U=0;T>U;U++)Q[U+S]=R[U]*this.scale;if(P)for(var V=N.vertices,U=0,T=Q.length;T>U;U++)Q[U]+=V[U]}else P?Q=N.vertices:(Q=[],Q.length=O);l.setFrame(m,p.time,Q),this.readCurve(l,m,p),m++}d[d.length]=l,e=Math.max(e,l.frames[l.frameCount-1])}}}var W=b.drawOrder;if(W||(W=b.draworder),W){for(var l=new spine.DrawOrderTimeline(W.length),X=c.slots.length,m=0,n=0,o=W.length;o>n;n++){var Y=W[n],Z=null;if(Y.offsets){Z=[],Z.length=X;for(var U=X-1;U>=0;U--)Z[U]=-1;var $=Y.offsets,_=[];_.length=X-$.length;for(var aa=0,ba=0,U=0,T=$.length;T>U;U++){var ca=$[U],i=c.findSlotIndex(ca.slot);if(-1==i)throw new Error("Slot not found: "+ca.slot);for(;aa!=i;)_[ba++]=aa++;Z[aa+ca.offset]=aa++}for(;X>aa;)_[ba++]=aa++;for(var U=X-1;U>=0;U--)-1==Z[U]&&(Z[U]=_[--ba])}l.setFrame(m++,Y.time,Z)}d.push(l),e=Math.max(e,l.frames[l.getFrameCount()-1])}var da=b.events;if(da){for(var l=new spine.EventTimeline(da.length),m=0,n=0,o=da.length;o>n;n++){var ea=da[n],fa=c.findEvent(ea.name);if(!fa)throw new Error("Event not found: "+ea.name);var ga=new spine.Event(fa);ga.intValue=ea.hasOwnProperty("int")?ea["int"]:fa.intValue,ga.floatValue=ea.hasOwnProperty("float")?ea["float"]:fa.floatValue,ga.stringValue=ea.hasOwnProperty("string")?ea.string:fa.stringValue,l.setFrame(m++,ea.time,ga)}d.push(l),e=Math.max(e,l.frames[l.getFrameCount()-1])}c.animations.push(new spine.Animation(a,d,e))},readCurve:function(a,b,c){var d=c.curve;d?"stepped"==d?a.curves.setStepped(b):d instanceof Array&&a.curves.setCurve(b,d[0],d[1],d[2],d[3]):a.curves.setLinear(b)},toColor:function(a,b){if(8!=a.length)throw new Error("Color hexadecimal length must be 8, received: "+a);return parseInt(a.substring(2*b,2*b+2),16)/255},getFloatArray:function(a,b,c){var d=a[b],e=new spine.Float32Array(d.length),f=0,g=d.length;if(1==c)for(;g>f;f++)e[f]=d[f];else for(;g>f;f++)e[f]=d[f]*c;return e},getIntArray:function(a,b){for(var c=a[b],d=new spine.Uint16Array(c.length),e=0,f=c.length;f>e;e++)d[e]=0|c[e];return d}},spine.Atlas=function(a,b){this.textureLoader=b,this.pages=[],this.regions=[];var c=new spine.AtlasReader(a),d=[];d.length=4;for(var e=null;;){var f=c.readLine();if(null===f)break;if(f=c.trim(f),f.length)if(e){var g=new spine.AtlasRegion;g.name=f,g.page=e,g.rotate="true"==c.readValue(),c.readTuple(d);var h=parseInt(d[0]),i=parseInt(d[1]);c.readTuple(d);var j=parseInt(d[0]),k=parseInt(d[1]);g.u=h/e.width,g.v=i/e.height,g.rotate?(g.u2=(h+k)/e.width,g.v2=(i+j)/e.height):(g.u2=(h+j)/e.width,g.v2=(i+k)/e.height),g.x=h,g.y=i,g.width=Math.abs(j),g.height=Math.abs(k),4==c.readTuple(d)&&(g.splits=[parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3])],4==c.readTuple(d)&&(g.pads=[parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3])],c.readTuple(d))),g.originalWidth=parseInt(d[0]),g.originalHeight=parseInt(d[1]),c.readTuple(d),g.offsetX=parseInt(d[0]),g.offsetY=parseInt(d[1]),g.index=parseInt(c.readValue()),this.regions.push(g)}else{e=new spine.AtlasPage,e.name=f,2==c.readTuple(d)&&(e.width=parseInt(d[0]),e.height=parseInt(d[1]),c.readTuple(d)),e.format=spine.Atlas.Format[d[0]],c.readTuple(d),e.minFilter=spine.Atlas.TextureFilter[d[0]],e.magFilter=spine.Atlas.TextureFilter[d[1]];var l=c.readValue();e.uWrap=spine.Atlas.TextureWrap.clampToEdge,e.vWrap=spine.Atlas.TextureWrap.clampToEdge,"x"==l?e.uWrap=spine.Atlas.TextureWrap.repeat:"y"==l?e.vWrap=spine.Atlas.TextureWrap.repeat:"xy"==l&&(e.uWrap=e.vWrap=spine.Atlas.TextureWrap.repeat),b.load(e,f,this),this.pages.push(e)}else e=null}},spine.Atlas.prototype={findRegion:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},dispose:function(){for(var a=this.pages,b=0,c=a.length;c>b;b++)this.textureLoader.unload(a[b].rendererObject)},updateUVs:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++){var e=b[c];e.page==a&&(e.u=e.x/a.width,e.v=e.y/a.height,e.rotate?(e.u2=(e.x+e.height)/a.width,e.v2=(e.y+e.width)/a.height):(e.u2=(e.x+e.width)/a.width,e.v2=(e.y+e.height)/a.height))}}},spine.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},spine.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},spine.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},spine.AtlasPage=function(){this.width=this.height=0},spine.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},spine.AtlasRegion=function(){this.x=this.y=this.width=this.height=this.u=this.v=this.u2=this.v2=this.offsetX=this.offsetY=this.originalWidth=this.originalHeight=0,this.index=0},spine.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},spine.AtlasReader=function(a){this.index=0,this.lines=a.split(/\r\n|\r|\n/)},spine.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw new Error("Invalid line: "+a);return this.trim(a.substring(b+1))},readTuple:function(a){var b=this.readLine(),c=b.indexOf(":");if(-1==c)throw new Error("Invalid line: "+b);for(var d=0,e=c+1;3>d;d++){var f=b.indexOf(",",e);if(-1==f)break;a[d]=this.trim(b.substr(e,f-e)),e=f+1}return a[d]=this.trim(b.substring(e)),d+1}},spine.AtlasAttachmentLoader=function(a){this.atlas=a},spine.AtlasAttachmentLoader.prototype={newRegionAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw new Error("Region not found in atlas: "+c+" (region attachment: "+b+")");var e=new spine.RegionAttachment(b);return e.rendererObject=d,e.setUVs(d.u,d.v,d.u2,d.v2,d.rotate),e.regionOffsetX=d.offsetX,e.regionOffsetY=d.offsetY,e.regionWidth=d.width,e.regionHeight=d.height,e.regionOriginalWidth=d.originalWidth,e.regionOriginalHeight=d.originalHeight,e},newMeshAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw new Error("Region not found in atlas: "+c+" (mesh attachment: "+b+")");var e=new spine.MeshAttachment(b);return e.rendererObject=d,e.regionU=d.u,e.regionV=d.v,e.regionU2=d.u2,e.regionV2=d.v2,e.regionRotate=d.rotate,e.regionOffsetX=d.offsetX,e.regionOffsetY=d.offsetY,e.regionWidth=d.width,e.regionHeight=d.height,e.regionOriginalWidth=d.originalWidth,e.regionOriginalHeight=d.originalHeight,e},newSkinnedMeshAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw new Error("Region not found in atlas: "+c+" (skinned mesh attachment: "+b+")");var e=new spine.SkinnedMeshAttachment(b);return e.rendererObject=d,e.regionU=d.u,e.regionV=d.v,e.regionU2=d.u2,e.regionV2=d.v2,e.regionRotate=d.rotate,e.regionOffsetX=d.offsetX,e.regionOffsetY=d.offsetY,e.regionWidth=d.width,e.regionHeight=d.height,e.regionOriginalWidth=d.originalWidth,e.regionOriginalHeight=d.originalHeight,e},newBoundingBoxAttachment:function(a,b){return new spine.BoundingBoxAttachment(b)}},spine.SkeletonBounds=function(){this.minX=this.minY=this.maxX=this.maxY=0,this.polygonPool=[],this.polygons=[],this.boundingBoxes=[]},spine.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(a,b){var c=a.slots,d=c.length,e=a.x,f=a.y,g=this.boundingBoxes,h=this.polygonPool,i=this.polygons;g.length=0;for(var j=0,k=i.length;k>j;j++)h.push(i[j]);i.length=0;for(var j=0;d>j;j++){var l=c[j],m=l.attachment;if(m.type==spine.AttachmentType.boundingbox){g.push(m);var n,o=h.length;o>0?(n=h[o-1],h.splice(o-1,1)):n=[],i.push(n),n.length=m.vertices.length,m.computeWorldVertices(e,f,l.bone,n)}}b&&this.aabbCompute()},aabbCompute:function(){for(var a=this.polygons,b=Number.MAX_VALUE,c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=Number.MIN_VALUE,f=0,g=a.length;g>f;f++)for(var h=a[f],i=0,j=h.length;j>i;i+=2){var k=h[i],l=h[i+1];b=Math.min(b,k),c=Math.min(c,l),d=Math.max(d,k),e=Math.max(e,l)}this.minX=b,this.minY=c,this.maxX=d,this.maxY=e},aabbContainsPoint:function(a,b){return a>=this.minX&&a<=this.maxX&&b>=this.minY&&b<=this.maxY},aabbIntersectsSegment:function(a,b,c,d){var e=this.minX,f=this.minY,g=this.maxX,h=this.maxY;if(e>=a&&e>=c||f>=b&&f>=d||a>=g&&c>=g||b>=h&&d>=h)return!1;var i=(d-b)/(c-a),j=i*(e-a)+b;if(j>f&&h>j)return!0;if(j=i*(g-a)+b,j>f&&h>j)return!0;var k=(f-b)/i+a;return k>e&&g>k?!0:(k=(h-b)/i+a,k>e&&g>k)},aabbIntersectsSkeleton:function(a){return this.minX<a.maxX&&this.maxX>a.minX&&this.minY<a.maxY&&this.maxY>a.minY},containsPoint:function(a,b){for(var c=this.polygons,d=0,e=c.length;e>d;d++)if(this.polygonContainsPoint(c[d],a,b))return this.boundingBoxes[d];return null},intersectsSegment:function(a,b,c,d){for(var e=this.polygons,f=0,g=e.length;g>f;f++)if(e[f].intersectsSegment(a,b,c,d))return this.boundingBoxes[f];return null},polygonContainsPoint:function(a,b,c){for(var d=a.length,e=d-2,f=!1,g=0;d>g;g+=2){var h=a[g+1],i=a[e+1];if(c>h&&i>=c||c>i&&h>=c){var j=a[g];j+(c-h)/(i-h)*(a[e]-j)<b&&(f=!f)}e=g}return f},polygonIntersectsSegment:function(a,b,c,d,e){for(var f=a.length,g=b-d,h=c-e,i=b*e-c*d,j=a[f-2],k=a[f-1],l=0;f>l;l+=2){var m=a[l],n=a[l+1],o=j*n-k*m,p=j-m,q=k-n,r=g*q-h*p,s=(i*p-g*o)/r;if((s>=j&&m>=s||s>=m&&j>=s)&&(s>=b&&d>=s||s>=d&&b>=s)){var t=(i*q-h*o)/r;if((t>=k&&n>=t||t>=n&&k>=t)&&(t>=c&&e>=t||t>=e&&c>=t))return!0}j=m,k=n}return!1},getPolygon:function(a){var b=this.boundingBoxes.indexOf(a);return-1==b?null:this.polygons[b]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}},sp._atlasPage_createTexture_webGL=function(a,b){var c=cc.textureCache.addImage(b);a.rendererObject=new cc.TextureAtlas(c,128),a.width=c.getPixelsWide(),a.height=c.getPixelsHigh()},sp._atlasPage_createTexture_canvas=function(a,b){a._texture=cc.textureCache.addImage(b)},sp._atlasPage_disposeTexture=function(a){a.rendererObject.release()},sp._atlasLoader={spAtlasFile:null,setAtlasFile:function(a){this.spAtlasFile=a},load:function(a,b,c){var d=cc.path.join(cc.path.dirname(this.spAtlasFile),b);cc._renderType===cc.game.RENDER_TYPE_WEBGL?sp._atlasPage_createTexture_webGL(a,d):sp._atlasPage_createTexture_canvas(a,d)},unload:function(a){}},sp.ANIMATION_EVENT_TYPE={START:0,END:1,COMPLETE:2,EVENT:3},sp.TrackEntryListeners=function(a,b,c,d){this.startListener=a||null,this.endListener=b||null,this.completeListener=c||null,this.eventListener=d||null},sp.TrackEntryListeners.getListeners=function(a){return a.rendererObject||(a.rendererObject=new sp.TrackEntryListeners,a.listener=sp.trackEntryCallback),a.rendererObject},sp.trackEntryCallback=function(a,b,c,d,e){a.rendererObject.onTrackEntryEvent(b,c,d,e)},sp.SkeletonAnimation=sp.Skeleton.extend({_state:null,_target:null,_callback:null,_ownsAnimationStateData:!1,_startListener:null,_endListener:null,_completeListener:null,_eventListener:null,init:function(){sp.Skeleton.prototype.init.call(this),this._ownsAnimationStateData=!0,this.setAnimationStateData(new spine.AnimationStateData(this._skeleton.data))},setAnimationStateData:function(a){var b=new spine.AnimationState(a);b.rendererObject=this,b.onStart=this._onAnimationStateStart.bind(this),b.onComplete=this._onAnimationStateComplete.bind(this),b.onEnd=this._onAnimationStateEnd.bind(this),b.onEvent=this._onAnimationStateEvent.bind(this),this._state=b},setMix:function(a,b,c){this._state.data.setMixByName(a,b,c)},setAnimationListener:function(a,b){this._target=a,this._callback=b},setAnimation:function(a,b,c){var d=this._skeleton.data.findAnimation(b);return d?this._state.setAnimation(a,d,c):(cc.log("Spine: Animation not found: "+b),null)},addAnimation:function(a,b,c,d){d=null==d?0:d;var e=this._skeleton.data.findAnimation(b);return e?this._state.addAnimation(a,e,c,d):(cc.log("Spine: Animation not found:"+b),null)},getCurrent:function(a){return this._state.getCurrent(a)},clearTracks:function(){this._state.clearTracks()},clearTrack:function(a){this._state.clearTrack(a)},update:function(a){this._super(a),a*=this._timeScale,this._state.update(a),this._state.apply(this._skeleton),this._skeleton.updateWorldTransform(),this._renderCmd._updateChild()},setStartListener:function(a){this._startListener=a},setEndListener:function(a){this._endListener=a},setCompleteListener:function(a){this._completeListener=a},setEventListener:function(a){this._eventListener=a},setTrackStartListener:function(a,b){sp.TrackEntryListeners.getListeners(a).startListener=b},setTrackEndListener:function(a,b){sp.TrackEntryListeners.getListeners(a).endListener=b},setTrackCompleteListener:function(a,b){sp.TrackEntryListeners.getListeners(a).completeListener=b},setTrackEventListener:function(a,b){sp.TrackEntryListeners.getListeners(a).eventListener=b},onTrackEntryEvent:function(a,b,c,d){var e=this._state.getCurrent(a);if(e.rendererObject){var f=e.rendererObject;switch(b){case sp.ANIMATION_EVENT_TYPE.START:f.startListener&&f.startListener(a);break;case sp.ANIMATION_EVENT_TYPE.END:f.endListener&&f.endListener(a);break;case sp.ANIMATION_EVENT_TYPE.COMPLETE:f.completeListener&&f.completeListener(a,d);break;case sp.ANIMATION_EVENT_TYPE.EVENT:f.eventListener&&f.eventListener(a,c)}}},onAnimationStateEvent:function(a,b,c,d){switch(b){case sp.ANIMATION_EVENT_TYPE.START:this._startListener&&this._startListener(a);break;case sp.ANIMATION_EVENT_TYPE.END:this._endListener&&this._endListener(a);break;case sp.ANIMATION_EVENT_TYPE.COMPLETE:this._completeListener&&this._completeListener(a,d);break;case sp.ANIMATION_EVENT_TYPE.EVENT:this._eventListener&&this._eventListener(a,c)}},getState:function(){return this._state},_onAnimationStateStart:function(a){this._animationStateCallback(a,sp.ANIMATION_EVENT_TYPE.START,null,0)},_onAnimationStateEnd:function(a){this._animationStateCallback(a,sp.ANIMATION_EVENT_TYPE.END,null,0)},_onAnimationStateComplete:function(a,b){this._animationStateCallback(a,sp.ANIMATION_EVENT_TYPE.COMPLETE,null,b)},_onAnimationStateEvent:function(a,b){this._animationStateCallback(a,sp.ANIMATION_EVENT_TYPE.EVENT,b,0)},_animationStateCallback:function(a,b,c,d){this.onAnimationStateEvent(a,b,c,d),this._target&&this._callback&&this._callback.call(this._target,this,a,b,c,d)}}),sp.SkeletonAnimation.create=function(a,b,c){return new sp.SkeletonAnimation(a,b,c)},function(){sp.Skeleton.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a),this._needDraw=!0};var a=sp.Skeleton.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);a.constructor=sp.Skeleton.CanvasRenderCmd,a.rendering=function(a,b,c){var d,e,f,g,h=this._node;a=a||cc._renderContext;var i=h._skeleton,j=i.drawOrder;for(d=0,e=j.length;e>d;d++)f=j[d],g=f._slotNode,g._visible&&g._renderCmd&&f.currentSprite&&(g._renderCmd.transform(this,!0),f.currentSprite._renderCmd.rendering(a,b,c),g._renderCmd._dirtyFlag=f.currentSprite._renderCmd._dirtyFlag=0);if(h._debugSlots||h._debugBones){a.setTransform(this._worldTransform,b,c),a.setGlobalAlpha(1);var k,l=cc._drawingUtil;if(h._debugSlots){l.setDrawColor(0,0,255,255),l.setLineWidth(1);var m=[];for(d=0,e=i.slots.length;e>d;d++)f=i.drawOrder[d],f.attachment&&f.attachment.type==sp.ATTACHMENT_TYPE.REGION&&(k=f.attachment,this._updateRegionAttachmentSlot(k,f,m),l.drawPoly(m,4,!0))}if(h._debugBones){var n;for(l.setLineWidth(2),l.setDrawColor(255,0,0,255),d=0,e=i.bones.length;e>d;d++){n=i.bones[d];var o=n.data.length*n.m00+n.worldX,p=n.data.length*n.m10+n.worldY;l.drawLine({x:n.worldX,y:n.worldY},{x:o,y:p})}for(l.setPointSize(4),l.setDrawColor(0,0,255,255),d=0,e=i.bones.length;e>d;d++)n=i.bones[d],l.drawPoint({x:n.worldX,y:n.worldY}),0===d&&l.setDrawColor(0,255,0,255)}}},a._updateRegionAttachmentSlot=function(a,b,c){if(c){var d={},e=sp.VERTEX_INDEX,f=b.bone;a.computeVertices(f.skeleton.x,f.skeleton.y,f,d),c.length=0,c.push(cc.p(d[e.X1],d[e.Y1])),c.push(cc.p(d[e.X4],d[e.Y4])),c.push(cc.p(d[e.X3],d[e.Y3])),c.push(cc.p(d[e.X2],d[e.Y2]))}},a._createChildFormSkeletonData=function(){for(var a,b,c=this._node,d=c._skeleton,e=0,f=d.slots.length;f>e;e++){var g=d.slots[e],h=g.attachment,i=new cc.Node;g._slotNode=i,h instanceof spine.RegionAttachment?(a=h.rendererObject.name,b=this._createSprite(g,h),g.currentSprite=b,g.currentSpriteName=a,i.addChild(b)):h instanceof spine.MeshAttachment}},a._createSprite=function(a,b){var c=b.rendererObject,d=(c.page._texture,new cc.Rect(c.x,c.y,c.width,c.height)),e=new cc.Sprite;return e.initWithTexture(c.page._texture,d,c.rotate,!1),e._rect.width=b.width,e._rect.height=b.height,e.setContentSize(b.width,b.height),e.setRotation(-b.rotation),e.setScale(c.width/c.originalWidth*b.scaleX,c.height/c.originalHeight*b.scaleY),a.sprites=a.sprites||{},a.sprites[c.name]=e,e},a._updateChild=function(){var a,b,c,d,e,f,g=this._node._skeleton,h=g.slots;for(a=0,b=h.length;b>a;a++)if(d=h[a],e=d.attachment,f=d._slotNode,e){var i=e.type;if(i===spine.AttachmentType.region){if(e.rendererObject&&(!d.currentSpriteName||d.currentSpriteName!==e.name)){var j=e.rendererObject.name;if(void 0!==d.currentSprite&&d.currentSprite.setVisible(!1),d.sprites=d.sprites||{},void 0!==d.sprites[j])d.sprites[j].setVisible(!0);else{var k=this._createSprite(d,e);f.addChild(k)}d.currentSprite=d.sprites[j],d.currentSpriteName=j}var l=d.bone;f.setPosition(l.worldX+e.x*l.m00+e.y*l.m01,l.worldY+e.x*l.m10+e.y*l.m11),f.setScale(l.worldScaleX,l.worldScaleY),c=d.currentSprite,c._flippedX=l.worldFlipX,c._flippedY=l.worldFlipY,c._flippedY||c._flippedX?(f.setRotation(l.worldRotation),c.setRotation(e.rotation)):(f.setRotation(-l.worldRotation),c.setRotation(-e.rotation)),c._renderCmd._displayedOpacity=0|this._node.getOpacity()*g.a*d.a;var m=0|g.r*d.r*255,n=0|g.g*d.g*255,o=0|g.b*d.b*255;c.setColor(cc.color(m,n,o)),c._renderCmd._updateColor()}else if(i!==spine.AttachmentType.skinnedmesh){f.setVisible(!1);continue}f.setVisible(!0)}else f.setVisible(!1)}}();