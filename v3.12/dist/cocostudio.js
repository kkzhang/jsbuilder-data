cc.Component=cc.Class.extend({_owner:null,_name:"",_enabled:!0,ctor:function(){this._owner=null,this._name="",this._enabled=!0},init:function(){return!0},onEnter:function(){},onExit:function(){},update:function(a){},serialize:function(a){},isEnabled:function(){return this._enabled},setEnabled:function(a){this._enabled=a},getName:function(){return this._name},setName:function(a){this._name=a},setOwner:function(a){this._owner=a},getOwner:function(){return this._owner}}),cc.Component.create=function(){return new cc.Component},ccui.LayoutComponent_ReferencePoint={BOTTOM_LEFT:0,TOP_LEFT:1,BOTTOM_RIGHT:2,TOP_RIGHT:3},ccui.LayoutComponent_PositionType={Position:0,RelativePosition:1,PreRelativePosition:2,PreRelativePositionEnable:3},ccui.LayoutComponent_SizeType={Size:0,PreSize:1,PreSizeEnable:2},ccui.LayoutComponent=cc.Component.extend({_horizontalEdge:0,_verticalEdge:0,_leftMargin:0,_rightMargin:0,_bottomMargin:0,_topMargin:0,_usingPositionPercentX:!1,_positionPercentX:0,_usingPositionPercentY:!1,_positionPercentY:0,_usingStretchWidth:!1,_usingStretchHeight:!1,_percentWidth:0,_usingPercentWidth:!1,_percentHeight:0,_usingPercentHeight:!1,_actived:!0,_isPercentOnly:!1,ctor:function(){this._name=ccui.LayoutComponent.NAME},init:function(){var a=!0;return cc.Component.prototype.init.call(this)?a:!1},getPercentContentSize:function(){return cc.p(this._percentWidth,this._percentHeight)},setPercentContentSize:function(a){this.setPercentWidth(a.x),this.setPercentHeight(a.y)},setUsingPercentContentSize:function(a){this._usingPercentWidth=this._usingPercentHeight=a},SetActiveEnable:function(a){this._actived=a},getUsingPercentContentSize:function(){return this._usingPercentWidth&&this._usingPercentHeight},getAnchorPosition:function(){return this._owner.getAnchorPoint()},setAnchorPosition:function(a,b){var c=this._owner.getBoundingBox();this._owner.setAnchorPoint(a,b);var d=this._owner.getBoundingBox(),e=c.x-d.x,f=c.y-d.y,g=this._owner.getPosition();g.x+=e,g.y+=f,this.setPosition(g)},getPosition:function(){return this._owner.getPosition()},setPosition:function(a,b){var c,d=this._getOwnerParent();if(null!=d){void 0===b?(c=a.x,b=a.y):c=a;var e=d.getContentSize();0!==e.width?this._positionPercentX=c/e.width:(this._positionPercentX=0,this._usingPositionPercentX&&(c=0)),0!==e.height?this._positionPercentY=b/e.height:(this._positionPercentY=0,this._usingPositionPercentY&&(b=0)),this._owner.setPosition(c,b),this._refreshHorizontalMargin(),this._refreshVerticalMargin()}else this._owner.setPosition(a,b)},isPositionPercentXEnabled:function(){return this._usingPositionPercentX},setPositionPercentXEnabled:function(a){this._usingPositionPercentX=a,this._usingPositionPercentX&&(this._horizontalEdge=ccui.LayoutComponent.horizontalEdge.NONE)},getPositionPercentX:function(){return this._positionPercentX},setPositionPercentX:function(a){this._positionPercentX=a;var b=this._getOwnerParent();null!==b&&(this._owner.setPositionX(b.width*this._positionPercentX),this._refreshHorizontalMargin())},isPositionPercentYEnabled:function(){return this._usingPositionPercentY},setPositionPercentYEnabled:function(a){this._usingPositionPercentY=a,this._usingPositionPercentY&&(this._verticalEdge=ccui.LayoutComponent.verticalEdge.NONE)},getPositionPercentY:function(){return this._positionPercentY},setPositionPercentY:function(a){this._positionPercentY=a;var b=this._getOwnerParent();null!==b&&(this._owner.setPositionY(b.height*this._positionPercentY),this._refreshVerticalMargin())},getHorizontalEdge:function(){return this._horizontalEdge},setHorizontalEdge:function(a){this._horizontalEdge=a,this._horizontalEdge!==ccui.LayoutComponent.horizontalEdge.NONE&&(this._usingPositionPercentX=!1);var b=this._getOwnerParent();if(null!==b){var c=this._owner.getPosition(),d=b.getContentSize();0!==d.width?this._positionPercentX=c.x/d.width:(this._positionPercentX=0,c.x=0,this._usingPositionPercentX&&this._owner.setPosition(c)),this._refreshHorizontalMargin()}},getVerticalEdge:function(){return this._verticalEdge},setVerticalEdge:function(a){this._verticalEdge=a,this._verticalEdge!==ccui.LayoutComponent.verticalEdge.NONE&&(this._usingPositionPercentY=!1);var b=this._getOwnerParent();if(null!==b){var c=this._owner.getPosition(),d=b.getContentSize();0!==d.height?this._positionPercentY=c.y/d.height:(this._positionPercentY=0,c.y=0,this._usingPositionPercentY&&this._owner.setPosition(c)),this._refreshVerticalMargin()}},getLeftMargin:function(){return this._leftMargin},setLeftMargin:function(a){this._leftMargin=a},getRightMargin:function(){return this._rightMargin},setRightMargin:function(a){this._rightMargin=a},getTopMargin:function(){return this._topMargin},setTopMargin:function(a){this._topMargin=a},getBottomMargin:function(){return this._bottomMargin},setBottomMargin:function(a){this._bottomMargin=a},getSize:function(){return this.getOwner().getContentSize()},setSize:function(a){var b=this._getOwnerParent();if(null!==b){var c=a,d=b.getContentSize();0!==d.width?this._percentWidth=c.width/d.width:(this._percentWidth=0,this._usingPercentWidth&&(c.width=0)),0!==d.height?this._percentHeight=c.height/d.height:(this._percentHeight=0,this._usingPercentHeight&&(c.height=0)),this._owner.setContentSize(c),this._refreshHorizontalMargin(),this._refreshVerticalMargin()}else this._owner.setContentSize(a)},isPercentWidthEnabled:function(){return this._usingPercentWidth},setPercentWidthEnabled:function(a){this._usingPercentWidth=a,this._usingPercentWidth&&(this._usingStretchWidth=!1)},getSizeWidth:function(){return this._owner.width},setSizeWidth:function(a){var b=this._owner.getContentSize();b.width=a;var c=this._getOwnerParent();if(null!==c){var d=c.getContentSize();0!==d.width?this._percentWidth=b.width/d.width:(this._percentWidth=0,this._usingPercentWidth&&(b.width=0)),this._owner.setContentSize(b),this._refreshHorizontalMargin()}else this._owner.setContentSize(b)},getPercentWidth:function(){return this._percentWidth},setPercentWidth:function(a){this._percentWidth=a;var b=this._getOwnerParent();if(null!==b){var c=this._owner.getContentSize();c.width=b.width*this._percentWidth,this._owner.setContentSize(c),this._refreshHorizontalMargin()}},isPercentHeightEnabled:function(){return this._usingPercentHeight},setPercentHeightEnabled:function(a){this._usingPercentHeight=a,this._usingPercentHeight&&(this._usingStretchHeight=!1)},getSizeHeight:function(){return this._owner.height},setSizeHeight:function(a){var b=this._owner.getContentSize();b.height=a;var c=this._getOwnerParent();if(null!==c){var d=c.getContentSize();0!==d.height?this._percentHeight=b.height/d.height:(this._percentHeight=0,this._usingPercentHeight&&(b.height=0)),this._owner.setContentSize(b),this._refreshVerticalMargin()}else this._owner.setContentSize(b)},getPercentHeight:function(){return this._percentHeight},setPercentHeight:function(a){this._percentHeight=a;var b=this._getOwnerParent();if(null!==b){var c=this._owner.getContentSize();c.height=b.height*this._percentHeight,this._owner.setContentSize(c),this._refreshVerticalMargin()}},isStretchWidthEnabled:function(){return this._usingStretchWidth},setStretchWidthEnabled:function(a){this._usingStretchWidth=a,this._usingStretchWidth&&(this._usingPercentWidth=!1)},isStretchHeightEnabled:function(){return this._usingStretchHeight},setStretchHeightEnabled:function(a){this._usingStretchHeight=a,this._usingStretchHeight&&(this._usingPercentHeight=!1)},setPercentOnlyEnabled:function(a){this._isPercentOnly=a},setActiveEnabled:function(a){this._actived=a},refreshLayout:function(){if(this._actived){var a=this._getOwnerParent();if(null!==a){var b=a.getContentSize(),c=this._owner,d=c.getAnchorPoint(),e=c.getContentSize(),f=c.getPosition();switch(this._horizontalEdge){case ccui.LayoutComponent.horizontalEdge.NONE:this._usingStretchWidth&&!this._isPercentOnly?(e.width=b.width*this._percentWidth,f.x=this._leftMargin+d.x*e.width):(this._usingPositionPercentX&&(f.x=b.width*this._positionPercentX),this._usingPercentWidth&&(e.width=b.width*this._percentWidth));break;case ccui.LayoutComponent.horizontalEdge.LEFT:if(this._isPercentOnly)break;(this._usingPercentWidth||this._usingStretchWidth)&&(e.width=b.width*this._percentWidth),f.x=this._leftMargin+d.x*e.width;break;case ccui.LayoutComponent.horizontalEdge.RIGHT:if(this._isPercentOnly)break;(this._usingPercentWidth||this._usingStretchWidth)&&(e.width=b.width*this._percentWidth),f.x=b.width-(this._rightMargin+(1-d.x)*e.width);break;case ccui.LayoutComponent.horizontalEdge.CENTER:if(this._isPercentOnly)break;this._usingStretchWidth?(e.width=b.width-this._leftMargin-this._rightMargin,e.width<0&&(e.width=0),f.x=this._leftMargin+d.x*e.width):(this._usingPercentWidth&&(e.width=b.width*this._percentWidth),f.x=b.width*this._positionPercentX)}switch(this._verticalEdge){case ccui.LayoutComponent.verticalEdge.NONE:this._usingStretchHeight&&!this._isPercentOnly?(e.height=b.height*this._percentHeight,f.y=this._bottomMargin+d.y*e.height):(this._usingPositionPercentY&&(f.y=b.height*this._positionPercentY),this._usingPercentHeight&&(e.height=b.height*this._percentHeight));break;case ccui.LayoutComponent.verticalEdge.BOTTOM:if(this._isPercentOnly)break;(this._usingPercentHeight||this._usingStretchHeight)&&(e.height=b.height*this._percentHeight),f.y=this._bottomMargin+d.y*e.height;break;case ccui.LayoutComponent.verticalEdge.TOP:if(this._isPercentOnly)break;(this._usingPercentHeight||this._usingStretchHeight)&&(e.height=b.height*this._percentHeight),f.y=b.height-(this._topMargin+(1-d.y)*e.height);break;case ccui.LayoutComponent.verticalEdge.CENTER:if(this._isPercentOnly)break;this._usingStretchHeight?(e.height=b.height-this._topMargin-this._bottomMargin,e.height<0&&(e.height=0),f.y=this._bottomMargin+d.y*e.height):(this._usingPercentHeight&&(e.height=b.height*this._percentHeight),f.y=b.height*this._positionPercentY)}if(c.setPosition(f),c.setContentSize(e),c instanceof ccui.PageView){c.forceDoLayout();for(var g=c.getPages(),h=0;h<g.length;h++)ccui.helper.doLayout(g[h])}else ccui.helper.doLayout(c)}}},_getOwnerParent:function(){return this._owner?this._owner.getParent():null},_refreshHorizontalMargin:function(){var a=this._getOwnerParent();if(null!==a){var b=this._owner.getPosition(),c=this._owner.getAnchorPoint(),d=this._owner.getContentSize(),e=a.getContentSize();this._leftMargin=b.x-c.x*d.width,this._rightMargin=e.width-(b.x+(1-c.x)*d.width)}},_refreshVerticalMargin:function(){var a=this._getOwnerParent();if(null!==a){var b=this._owner.getPosition(),c=this._owner.getAnchorPoint(),d=this._owner.getContentSize(),e=a.getContentSize();this._bottomMargin=b.y-c.y*d.height,this._topMargin=e.height-(b.y+(1-c.y)*d.height)}}}),ccui.LayoutComponent.horizontalEdge={NONE:0,LEFT:1,RIGHT:2,CENTER:3},ccui.LayoutComponent.verticalEdge={NONE:0,BOTTOM:1,TOP:2,CENTER:3},ccui.LayoutComponent.NAME="__ui_layout",ccui.LayoutComponent.bindLayoutComponent=function(a){var b=a.getComponent(ccui.LayoutComponent.NAME);return void 0!==b?b:(b=new ccui.LayoutComponent,b&&b.init()?(a.addComponent(b),b):null)},cc.ComponentContainer=cc.Class.extend({_components:null,_owner:null,ctor:function(a){this._components=null,this._owner=a},getComponent:function(a){if(!a)throw new Error("cc.ComponentContainer.getComponent(): name should be non-null");return a=a.trim(),this._components||(this._components={}),this._components[a]},add:function(a){if(!a)throw new Error("cc.ComponentContainer.add(): component should be non-null");if(a.getOwner())return cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1;null==this._components&&(this._components={},this._owner.scheduleUpdate());var b=this._components[a.getName()];return b?(cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1):(a.setOwner(this._owner),this._components[a.getName()]=a,a.onEnter(),!0)},remove:function(a){if(!a)throw new Error("cc.ComponentContainer.remove(): name should be non-null");return this._components?a instanceof cc.Component?this._removeByComponent(a):(a=a.trim(),this._removeByComponent(this._components[a])):!1},_removeByComponent:function(a){return a?(a.onExit(),a.setOwner(null),delete this._components[a.getName()],!0):!1},removeAll:function(){if(this._components){var a=this._components;for(var b in a){var c=a[b];c.onExit(),c.setOwner(null),delete a[b]}this._owner.unscheduleUpdate(),this._components=null}},_alloc:function(){this._components={}},visit:function(a){if(this._components){var b=this._components;for(var c in b)b[c].update(a)}},isEmpty:function(){return this._components?0===this._components.length:!0}});var ccs=ccs||{};ccs.Class=ccs.Class||cc.Class,ccs.Class.extend=ccs.Class.extend||cc.Class.extend,ccs.Node=ccs.Node||cc.Node,ccs.Node.extend=ccs.Node.extend||cc.Node.extend,ccs.Sprite=ccs.Sprite||cc.Sprite,ccs.Sprite.extend=ccs.Sprite.extend||cc.Sprite.extend,ccs.Component=ccs.Component||cc.Component,ccs.Component.extend=ccs.Component.extend||cc.Component.extend,ccs.cocostudioVersion="v1.3.0.0",ccs.VERSION_COMBINED=.3,ccs.VERSION_CHANGE_ROTATION_RANGE=1,ccs.VERSION_COLOR_READING=1.1,ccs.MAX_VERTEXZ_VALUE=5e6,ccs.ARMATURE_MAX_CHILD=50,ccs.ARMATURE_MAX_ZORDER=100,ccs.ARMATURE_MAX_COUNT=ccs.MAX_VERTEXZ_VALUE/ccs.ARMATURE_MAX_CHILD/ccs.ARMATURE_MAX_ZORDER,ccs.AUTO_ADD_SPRITE_FRAME_NAME_PREFIX=!1,ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT=!1,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX=!1,ccs.armatureVersion=function(){return"v1.1.0.0"},ccs.CONST_VERSION="version",ccs.CONST_VERSION_2_0=2,ccs.CONST_VERSION_COMBINED=.3,ccs.CONST_ARMATURES="armatures",ccs.CONST_ARMATURE="armature",ccs.CONST_BONE="b",ccs.CONST_DISPLAY="d",ccs.CONST_ANIMATIONS="animations",ccs.CONST_ANIMATION="animation",ccs.CONST_MOVEMENT="mov",ccs.CONST_FRAME="f",ccs.CONST_TEXTURE_ATLAS="TextureAtlas",ccs.CONST_SUB_TEXTURE="SubTexture",ccs.CONST_SKELETON="skeleton",ccs.CONST_A_NAME="name",ccs.CONST_A_DURATION="dr",ccs.CONST_A_FRAME_INDEX="fi",ccs.CONST_A_DURATION_TO="to",ccs.CONST_A_DURATION_TWEEN="drTW",ccs.CONST_A_LOOP="lp",ccs.CONST_A_MOVEMENT_SCALE="sc",ccs.CONST_A_MOVEMENT_DELAY="dl",ccs.CONST_A_DISPLAY_INDEX="dI",ccs.CONST_A_PLIST="plist",ccs.CONST_A_PARENT="parent",ccs.CONST_A_SKEW_X="kX",ccs.CONST_A_SKEW_Y="kY",ccs.CONST_A_SCALE_X="cX",ccs.CONST_A_SCALE_Y="cY",ccs.CONST_A_Z="z",ccs.CONST_A_EVENT="evt",ccs.CONST_A_SOUND="sd",ccs.CONST_A_SOUND_EFFECT="sdE",ccs.CONST_A_TWEEN_EASING="twE",ccs.CONST_A_EASING_PARAM="twEP",ccs.CONST_A_TWEEN_ROTATE="twR",ccs.CONST_A_IS_ARMATURE="isArmature",ccs.CONST_A_DISPLAY_TYPE="displayType",ccs.CONST_A_MOVEMENT="mov",ccs.CONST_A_X="x",ccs.CONST_A_Y="y",ccs.CONST_A_COCOS2DX_X="cocos2d_x",ccs.CONST_A_COCOS2DX_Y="cocos2d_y",ccs.CONST_A_WIDTH="width",ccs.CONST_A_HEIGHT="height",ccs.CONST_A_PIVOT_X="pX",ccs.CONST_A_PIVOT_Y="pY",ccs.CONST_A_COCOS2D_PIVOT_X="cocos2d_pX",ccs.CONST_A_COCOS2D_PIVOT_Y="cocos2d_pY",ccs.CONST_A_BLEND_TYPE="bd",ccs.CONST_A_BLEND_SRC="bd_src",ccs.CONST_A_BLEND_DST="bd_dst",ccs.CONST_A_ALPHA="a",ccs.CONST_A_RED="r",ccs.CONST_A_GREEN="g",ccs.CONST_A_BLUE="b",ccs.CONST_A_ALPHA_OFFSET="aM",ccs.CONST_A_RED_OFFSET="rM",ccs.CONST_A_GREEN_OFFSET="gM",ccs.CONST_A_BLUE_OFFSET="bM",ccs.CONST_A_COLOR_TRANSFORM="colorTransform",ccs.CONST_A_TWEEN_FRAME="tweenFrame",ccs.CONST_CONTOUR="con",ccs.CONST_CONTOUR_VERTEX="con_vt",ccs.CONST_FL_NAN="NaN",ccs.CONST_FRAME_DATA="frame_data",ccs.CONST_MOVEMENT_BONE_DATA="mov_bone_data",ccs.CONST_MOVEMENT_DATA="mov_data",ccs.CONST_ANIMATION_DATA="animation_data",ccs.CONST_DISPLAY_DATA="display_data",ccs.CONST_SKIN_DATA="skin_data",ccs.CONST_BONE_DATA="bone_data",ccs.CONST_ARMATURE_DATA="armature_data",ccs.CONST_CONTOUR_DATA="contour_data",ccs.CONST_TEXTURE_DATA="texture_data",ccs.CONST_VERTEX_POINT="vertex",ccs.CONST_COLOR_INFO="color",ccs.CONST_CONFIG_FILE_PATH="config_file_path",ccs.CONST_CONTENT_SCALE="content_scale",ccs.DataInfo=function(){this.asyncStruct=null,this.configFileQueue=[],this.contentScale=1,this.filename="",this.baseFilePath="",this.flashToolVersion=0,this.cocoStudioVersion=0},ccs.dataReaderHelper={ConfigType:{DragonBone_XML:0,CocoStudio_JSON:1,CocoStudio_Binary:2},_configFileList:[],_flashToolVersion:ccs.CONST_VERSION_2_0,_positionReadScale:1,_asyncRefCount:0,_asyncRefTotalCount:0,_dataQueue:null,setPositionReadScale:function(a){this._positionReadScale=a},getPositionReadScale:function(){return this._positionReadScale},addDataFromFile:function(a){if(-1===this._configFileList.indexOf(a)){this._configFileList.push(a);var b=this._initBaseFilePath(a),c=cc.path.extname(a).toLowerCase(),d=new ccs.DataInfo;d.filename=a,d.basefilePath=b,".xml"===c?ccs.dataReaderHelper.addDataFromXML(a,d):".json"===c||".exportjson"===c?ccs.dataReaderHelper.addDataFromJson(a,d):".csb"===c&&ccs.dataReaderHelper.addDataFromBinaryCache(a,d)}},addDataFromFileAsync:function(a,b,c,d,e){if(-1!==this._configFileList.indexOf(c))return void(e&&d&&(0===this._asyncRefTotalCount&&0===this._asyncRefCount?this._asyncCallBack(d,e,1):this._asyncCallBack(d,e,(this._asyncRefTotalCount-this._asyncRefCount)/this._asyncRefTotalCount)));this._asyncRefTotalCount++,this._asyncRefCount++;var f=this,g=function(){f.addDataFromFile(c),f._asyncRefCount--,f._asyncCallBack(d,e,(f._asyncRefTotalCount-f._asyncRefCount)/f._asyncRefTotalCount)};cc.director.getScheduler().schedule(g,this,.1,!1,0,!1,"armatrueDataHelper")},removeConfigFile:function(a){for(var b=this._configFileList,c=b.length,d=b[c],e=0;c>e;e++)b[e]===a&&(d=e);d!==b[c]&&cc.arrayRemoveObject(b,a)},addDataFromCache:function(a,b){if(!a)return void cc.log("XML error  or  XML is empty.");b.flashToolVersion=parseFloat(a.getAttribute(ccs.CONST_VERSION));var c,d=a.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ARMATURES+" >  "+ccs.CONST_ARMATURE),e=ccs.armatureDataManager;for(c=0;c<d.length;c++){var f=this.decodeArmature(d[c],b);e.addArmatureData(f.name,f,b.filename)}var g=a.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ANIMATIONS+" >  "+ccs.CONST_ANIMATION);for(c=0;c<g.length;c++){var h=this.decodeAnimation(g[c],b);e.addAnimationData(h.name,h,b.filename)}var i=a.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_TEXTURE_ATLAS+" >  "+ccs.CONST_SUB_TEXTURE);for(c=0;c<i.length;c++){var j=this.decodeTexture(i[c],b);e.addTextureData(j.name,j,b.filename)}},decodeArmature:function(a,b){var c=new ccs.ArmatureData;c.init(),c.name=a.getAttribute(ccs.CONST_A_NAME);for(var d=a.querySelectorAll(ccs.CONST_ARMATURE+" > "+ccs.CONST_BONE),e=0;e<d.length;e++){var f=d[e],g=f.getAttribute(ccs.CONST_A_PARENT),h=null;if(g)for(var i=0;i<d.length&&(h=d[i],g!=d[i].getAttribute(ccs.CONST_A_NAME));i++);var j=this.decodeBone(f,h,b);c.addBoneData(j)}return c},decodeArmatureFromJSON:function(a,b){var c=new ccs.ArmatureData;c.init();var d=a[ccs.CONST_A_NAME];d&&(c.name=d),b.cocoStudioVersion=c.dataVersion=a[ccs.CONST_VERSION]||.1;for(var e=a[ccs.CONST_BONE_DATA],f=0;f<e.length;f++){var g=this.decodeBoneFromJson(e[f],b);c.addBoneData(g)}return c},decodeBone:function(a,b,c){var d=new ccs.BoneData;d.init(),d.name=a.getAttribute(ccs.CONST_A_NAME),d.parentName=a.getAttribute(ccs.CONST_A_PARENT)||"",d.zOrder=parseInt(a.getAttribute(ccs.CONST_A_Z))||0;for(var e=a.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_DISPLAY),f=0;f<e.length;f++){var g=e[f],h=this.decodeBoneDisplay(g,c);d.addDisplayData(h)}return d},decodeBoneFromJson:function(a,b){var c=new ccs.BoneData;c.init(),this.decodeNodeFromJson(c,a,b),c.name=a[ccs.CONST_A_NAME]||"",c.parentName=a[ccs.CONST_A_PARENT]||"";for(var d=a[ccs.CONST_DISPLAY_DATA]||[],e=0;e<d.length;e++){var f=this.decodeBoneDisplayFromJson(d[e],b);c.addDisplayData(f)}return c},decodeBoneDisplay:function(a,b){var c=parseFloat(a.getAttribute(ccs.CONST_A_IS_ARMATURE))||0,d=null;1===c?(d=new ccs.ArmatureDisplayData,d.displayType=ccs.DISPLAY_TYPE_ARMATURE):(d=new ccs.SpriteDisplayData,d.displayType=ccs.DISPLAY_TYPE_SPRITE);var e=a.getAttribute(ccs.CONST_A_NAME)||"";return e&&(d.displayName=e),d},decodeBoneDisplayFromJson:function(a,b){var c=a[ccs.CONST_A_DISPLAY_TYPE]||ccs.DISPLAY_TYPE_SPRITE,d=null;switch(c){case ccs.DISPLAY_TYPE_SPRITE:d=new ccs.SpriteDisplayData;var e=a[ccs.CONST_A_NAME];null!=e&&(d.displayName=e);var f=a[ccs.CONST_SKIN_DATA]||[],g=f[0];if(g){var h=d.skinData;h.x=g[ccs.CONST_A_X]*this._positionReadScale,h.y=g[ccs.CONST_A_Y]*this._positionReadScale,h.scaleX=null==g[ccs.CONST_A_SCALE_X]?1:g[ccs.CONST_A_SCALE_X],h.scaleY=null==g[ccs.CONST_A_SCALE_Y]?1:g[ccs.CONST_A_SCALE_Y],h.skewX=null==g[ccs.CONST_A_SKEW_X]?1:g[ccs.CONST_A_SKEW_X],h.skewY=null==g[ccs.CONST_A_SKEW_Y]?1:g[ccs.CONST_A_SKEW_Y],h.x*=b.contentScale,h.y*=b.contentScale}break;case ccs.DISPLAY_TYPE_ARMATURE:d=new ccs.ArmatureDisplayData;var e=a[ccs.CONST_A_NAME];null!=e&&(d.displayName=a[ccs.CONST_A_NAME]);break;case ccs.DISPLAY_TYPE_PARTICLE:d=new ccs.ParticleDisplayData;var i=a[ccs.CONST_A_PLIST];null!=i&&(b.asyncStruct?d.displayName=b.asyncStruct.basefilePath+i:d.displayName=b.basefilePath+i);break;default:d=new ccs.SpriteDisplayData}return d.displayType=c,d},decodeAnimation:function(a,b){var c=new ccs.AnimationData,d=a.getAttribute(ccs.CONST_A_NAME),e=ccs.armatureDataManager.getArmatureData(d);c.name=d;for(var f=a.querySelectorAll(ccs.CONST_ANIMATION+" > "+ccs.CONST_MOVEMENT),g=null,h=0;h<f.length;h++){g=f[h];var i=this.decodeMovement(g,e,b);c.addMovement(i)}return c},decodeAnimationFromJson:function(a,b){var c=new ccs.AnimationData,d=a[ccs.CONST_A_NAME];d&&(c.name=a[ccs.CONST_A_NAME]);for(var e=a[ccs.CONST_MOVEMENT_DATA]||[],f=0;f<e.length;f++){var g=this.decodeMovementFromJson(e[f],b);c.addMovement(g)}return c},decodeMovement:function(a,b,c){var d=new ccs.MovementData;d.name=a.getAttribute(ccs.CONST_A_NAME);var e,f,g,h,i=0;e=a.getAttribute(ccs.CONST_A_DURATION),d.duration=null==e?0:parseFloat(e),f=a.getAttribute(ccs.CONST_A_DURATION_TO),d.durationTo=null==f?0:parseFloat(f),g=a.getAttribute(ccs.CONST_A_DURATION_TWEEN),d.durationTween=null==g?0:parseFloat(g),h=a.getAttribute(ccs.CONST_A_LOOP),d.loop=h?Boolean(parseFloat(h)):!0;var j=a.getAttribute(ccs.CONST_A_TWEEN_EASING);j&&(j!=ccs.CONST_FL_NAN?(i=null==j?0:parseFloat(j),d.tweenEasing=2===i?ccs.TweenType.SINE_EASEINOUT:i):d.tweenEasing=ccs.TweenType.LINEAR);for(var k=a.querySelectorAll(ccs.CONST_MOVEMENT+" > "+ccs.CONST_BONE),l=null,m=0;m<k.length;m++){l=k[m];var n=l.getAttribute(ccs.CONST_A_NAME);if(!d.getMovementBoneData(n)){var o=b.getBoneData(n),p=o.parentName,q=null;if(""!==p)for(var r=0;r<k.length&&(q=k[r],p!==q.getAttribute(ccs.CONST_A_NAME));r++);var s=this.decodeMovementBone(l,q,o,c);d.addMovementBoneData(s)}}return d},decodeMovementFromJson:function(a,b){var c=new ccs.MovementData;c.loop=null==a[ccs.CONST_A_LOOP]?!1:a[ccs.CONST_A_LOOP],c.durationTween=a[ccs.CONST_A_DURATION_TWEEN]||0,c.durationTo=a[ccs.CONST_A_DURATION_TO]||0,c.duration=a[ccs.CONST_A_DURATION]||0,null==a[ccs.CONST_A_DURATION]?c.scale=1:c.scale=null==a[ccs.CONST_A_MOVEMENT_SCALE]?1:a[ccs.CONST_A_MOVEMENT_SCALE],c.tweenEasing=null==a[ccs.CONST_A_TWEEN_EASING]?ccs.TweenType.LINEAR:a[ccs.CONST_A_TWEEN_EASING];var d=a[ccs.CONST_A_NAME];d&&(c.name=d);for(var e=a[ccs.CONST_MOVEMENT_BONE_DATA]||[],f=0;f<e.length;f++){var g=this.decodeMovementBoneFromJson(e[f],b);c.addMovementBoneData(g)}return c},decodeMovementBone:function(a,b,c,d){var e=new ccs.MovementBoneData;e.init();var f,g;a&&(f=parseFloat(a.getAttribute(ccs.CONST_A_MOVEMENT_SCALE))||0,e.scale=f,g=parseFloat(a.getAttribute(ccs.CONST_A_MOVEMENT_DELAY))||0,g>0&&(g-=1),e.delay=g);var h=0,i=0,j=0,k=null,l=[];if(null!=b){for(var m=b.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),n=0;n<m.length;n++)l.push(m[n]);h=l.length}e.name=a.getAttribute(ccs.CONST_A_NAME);for(var o=a.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),p=0,q=0,r=0;r<o.length;r++){var s=o[r];if(b)for(;h>p&&(k?i>q||q>=i+j:!0);)k=l[p],i+=j,j=parseFloat(k.getAttribute(ccs.CONST_A_DURATION)),p++;var t=this.decodeFrame(s,k,c,d);e.addFrameData(t),t.frameID=q,q+=t.duration,e.duration=q}for(var u=e.frameList,v=Math.PI,n=u.length-1;n>=0;n--)if(n>0){var w=u[n].skewX-u[n-1].skewX,x=u[n].skewY-u[n-1].skewY;(-v>w||w>v)&&(u[n-1].skewX=0>w?u[n-1].skewX-2*v:u[n-1].skewX+2*v),(-v>x||x>v)&&(u[n-1].skewY=0>x?u[n-1].skewY-2*v:u[n-1].skewY+2*v)}var y=new ccs.FrameData;return y.copy(e.frameList[e.frameList.length-1]),y.frameID=e.duration,e.addFrameData(y),e},decodeMovementBoneFromJson:function(a,b){var c=new ccs.MovementBoneData;c.init(),c.delay=a[ccs.CONST_A_MOVEMENT_DELAY]||0;var d=a[ccs.CONST_A_NAME];d&&(c.name=d);for(var e=a[ccs.CONST_FRAME_DATA]||[],f=e.length,g=0;f>g;g++){var h=a[ccs.CONST_FRAME_DATA][g],i=this.decodeFrameFromJson(h,b);c.addFrameData(i),b.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&(i.frameID=c.duration,c.duration+=i.duration)}if(b.cocoStudioVersion<ccs.VERSION_CHANGE_ROTATION_RANGE)for(var j=c.frameList,k=Math.PI,g=j.length-1;g>=0;g--)if(g>0){var l=j[g].skewX-j[g-1].skewX,m=j[g].skewY-j[g-1].skewY;(-k>l||l>k)&&(j[g-1].skewX=0>l?j[g-1].skewX-2*k:j[g-1].skewX+2*k),(-k>m||m>k)&&(j[g-1].skewY=0>m?j[g-1].skewY-2*k:j[g-1].skewY+2*k)}if(b.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&c.frameList.length>0){var i=new ccs.FrameData;i.copy(c.frameList[c.frameList.length-1]),c.addFrameData(i),i.frameID=c.duration}return c},decodeFrame:function(a,b,c,d){var e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=new ccs.FrameData;q.strMovement=a.getAttribute(ccs.CONST_A_MOVEMENT)||"",q.movement=q.strMovement,q.strEvent=a.getAttribute(ccs.CONST_A_EVENT)||"",q.event=q.strEvent,q.strSound=a.getAttribute(ccs.CONST_A_SOUND)||"",q.sound=q.strSound,q.strSoundEffect=a.getAttribute(ccs.CONST_A_SOUND_EFFECT)||"",q.soundEffect=q.strSoundEffect;var r=a.getAttribute(ccs.CONST_A_TWEEN_FRAME);if(q.isTween=!(void 0!==r&&("false"===r||"0"===r)),d.flashToolVersion>=ccs.CONST_VERSION_2_0?(e=a.getAttribute(ccs.CONST_A_COCOS2DX_X),e&&(q.x=parseFloat(e),q.x*=this._positionReadScale),f=a.getAttribute(ccs.CONST_A_COCOS2DX_Y),f&&(q.y=-parseFloat(f),q.y*=this._positionReadScale)):(e=a.getAttribute(ccs.CONST_A_X),e&&(q.x=parseFloat(e),q.x*=this._positionReadScale),f=a.getAttribute(ccs.CONST_A_Y),f&&(q.y=-parseFloat(f),q.y*=this._positionReadScale)),g=a.getAttribute(ccs.CONST_A_SCALE_X),null!=g&&(q.scaleX=parseFloat(g)),h=a.getAttribute(ccs.CONST_A_SCALE_Y),null!=h&&(q.scaleY=parseFloat(h)),i=a.getAttribute(ccs.CONST_A_SKEW_X),null!=i&&(q.skewX=cc.degreesToRadians(parseFloat(i))),j=a.getAttribute(ccs.CONST_A_SKEW_Y),null!=j&&(q.skewY=cc.degreesToRadians(-parseFloat(j))),l=a.getAttribute(ccs.CONST_A_DURATION),null!=l&&(q.duration=parseFloat(l)),m=a.getAttribute(ccs.CONST_A_DISPLAY_INDEX),null!=m&&(q.displayIndex=parseFloat(m)),n=a.getAttribute(ccs.CONST_A_Z),null!=n&&(q.zOrder=parseInt(n)),k=a.getAttribute(ccs.CONST_A_TWEEN_ROTATE),null!=k&&(q.tweenRotate=parseFloat(k)),p=a.getAttribute(ccs.CONST_A_BLEND_TYPE),null!=p){var s=q.blendFunc;switch(p){case ccs.BLEND_TYPE_NORMAL:s.src=cc.BLEND_SRC,s.dst=cc.BLEND_DST;break;case ccs.BLEND_TYPE_ADD:s.src=cc.SRC_ALPHA,s.dst=cc.ONE;break;case ccs.BLEND_TYPE_MULTIPLY:s.src=cc.DST_COLOR,s.dst=cc.ONE_MINUS_SRC_ALPHA;break;case ccs.BLEND_TYPE_SCREEN:s.src=cc.ONE,s.dst=cc.ONE_MINUS_DST_COLOR;break;default:q.blendFunc.src=cc.BLEND_SRC,q.blendFunc.dst=cc.BLEND_DST}}var t=a.querySelectorAll(ccs.CONST_FRAME+" > "+ccs.CONST_A_COLOR_TRANSFORM);if(t&&t.length>0){t=t[0];var u,v,w,x,y,z,A,B;u=parseFloat(t.getAttribute(ccs.CONST_A_ALPHA))||0,v=parseFloat(t.getAttribute(ccs.CONST_A_RED))||0,w=parseFloat(t.getAttribute(ccs.CONST_A_GREEN))||0,x=parseFloat(t.getAttribute(ccs.CONST_A_BLUE))||0,y=parseFloat(t.getAttribute(ccs.CONST_A_ALPHA_OFFSET))||0,z=parseFloat(t.getAttribute(ccs.CONST_A_RED_OFFSET))||0,A=parseFloat(t.getAttribute(ccs.CONST_A_GREEN_OFFSET))||0,B=parseFloat(t.getAttribute(ccs.CONST_A_BLUE_OFFSET))||0,q.a=2.55*y+u,q.r=2.55*z+v,q.g=2.55*A+w,q.b=2.55*B+x,q.isUseColorInfo=!0}var C=a.getAttribute(ccs.CONST_A_TWEEN_EASING);if(null!=C&&(C!=ccs.CONST_FL_NAN?(o=a.getAttribute(ccs.CONST_A_TWEEN_EASING),o&&(q.tweenEasing=2===o?ccs.TweenType.SINE_EASEINOUT:o)):q.tweenEasing=ccs.TweenType.LINEAR),b){var D=new ccs.BaseData;d.flashToolVersion>=ccs.CONST_VERSION_2_0?(D.x=parseFloat(b.getAttribute(ccs.CONST_A_COCOS2DX_X)),D.y=parseFloat(b.getAttribute(ccs.CONST_A_COCOS2DX_Y))):(D.x=parseFloat(b.getAttribute(ccs.CONST_A_X)),D.y=parseFloat(b.getAttribute(ccs.CONST_A_Y))),D.skewX=parseFloat(b.getAttribute(ccs.CONST_A_SKEW_X)),D.skewY=parseFloat(b.getAttribute(ccs.CONST_A_SKEW_Y)),D.y=-D.y,D.skewX=cc.degreesToRadians(D.skewX),D.skewY=cc.degreesToRadians(-D.skewY),ccs.TransformHelp.transformFromParent(q,D)}return q},decodeFrameFromJson:function(a,b){var c=new ccs.FrameData;this.decodeNodeFromJson(c,a,b),c.tweenEasing=a[ccs.CONST_A_TWEEN_EASING]||ccs.TweenType.LINEAR,c.displayIndex=a[ccs.CONST_A_DISPLAY_INDEX];var d=null==a[ccs.CONST_A_BLEND_SRC]?cc.BLEND_SRC:a[ccs.CONST_A_BLEND_SRC],e=null==a[ccs.CONST_A_BLEND_DST]?cc.BLEND_DST:a[ccs.CONST_A_BLEND_DST];c.blendFunc.src=d,c.blendFunc.dst=e,c.isTween=null==a[ccs.CONST_A_TWEEN_FRAME]?!0:a[ccs.CONST_A_TWEEN_FRAME];var f=a[ccs.CONST_A_EVENT];null!=f&&(c.strEvent=f,c.event=f),b.cocoStudioVersion<ccs.CONST_VERSION_COMBINED?c.duration=null==a[ccs.CONST_A_DURATION]?1:a[ccs.CONST_A_DURATION]:c.frameID=a[ccs.CONST_A_FRAME_INDEX];for(var g=a[ccs.CONST_A_EASING_PARAM]||[],h=0;h<g.length;h++)c.easingParams[h]=g[h];return c},decodeTexture:function(a,b){var c=new ccs.TextureData;c.init(),a.getAttribute(ccs.CONST_A_NAME)&&(c.name=a.getAttribute(ccs.CONST_A_NAME));var d,e;b.flashToolVersion>=ccs.CONST_VERSION_2_0?(d=parseFloat(a.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_X))||0,e=parseFloat(a.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_Y))||0):(d=parseFloat(a.getAttribute(ccs.CONST_A_PIVOT_X))||0,e=parseFloat(a.getAttribute(ccs.CONST_A_PIVOT_Y))||0);var f=parseFloat(a.getAttribute(ccs.CONST_A_WIDTH))||0,g=parseFloat(a.getAttribute(ccs.CONST_A_HEIGHT))||0,h=d/f,i=(g-e)/g;c.pivotX=h,c.pivotY=i;for(var j=a.querySelectorAll(ccs.CONST_SUB_TEXTURE+" > "+ccs.CONST_CONTOUR),k=0;k<j.length;k++)c.addContourData(this.decodeContour(j[k],b));return c},decodeTextureFromJson:function(a){var b=new ccs.TextureData;b.init();var c=a[ccs.CONST_A_NAME];null!=c&&(b.name=c),b.width=a[ccs.CONST_A_WIDTH]||0,b.height=a[ccs.CONST_A_HEIGHT]||0,b.pivotX=a[ccs.CONST_A_PIVOT_X]||0,b.pivotY=a[ccs.CONST_A_PIVOT_Y]||0;for(var d=a[ccs.CONST_CONTOUR_DATA]||[],e=0;e<d.length;e++)b.contourDataList.push(this.decodeContourFromJson(d[e]));return b},decodeContour:function(a,b){var c=new ccs.ContourData;c.init();for(var d,e=a.querySelectorAll(ccs.CONST_CONTOUR+" > "+ccs.CONST_CONTOUR_VERTEX),f=0;f<e.length;f++){d=e[f];var g=cc.p(0,0);g.x=parseFloat(d.getAttribute(ccs.CONST_A_X))||0,g.y=parseFloat(d.getAttribute(ccs.CONST_A_Y))||0,g.y=-g.y,c.vertexList.push(g)}return c},decodeContourFromJson:function(a){var b=new ccs.ContourData;b.init();for(var c=a[ccs.CONST_VERTEX_POINT]||[],d=c.length,e=0;d>e;e++){var f=c[e],g=cc.p(0,0);g.x=f[ccs.CONST_A_X]||0,g.y=f[ccs.CONST_A_Y]||0,b.vertexList.push(g)}return b},addDataFromJsonCache:function(a,b){b.contentScale=null==a[ccs.CONST_CONTENT_SCALE]?1:a[ccs.CONST_CONTENT_SCALE];var c,d,e=a[ccs.CONST_ARMATURE_DATA]||[];for(c=0;c<e.length;c++)d=this.decodeArmatureFromJSON(e[c],b),ccs.armatureDataManager.addArmatureData(d.name,d,b.filename);var f,g=a[ccs.CONST_ANIMATION_DATA]||[];for(c=0;c<g.length;c++)f=this.decodeAnimationFromJson(g[c],b),ccs.armatureDataManager.addAnimationData(f.name,f,b.filename);var h,i=a[ccs.CONST_TEXTURE_DATA]||[];for(c=0;c<i.length;c++)h=this.decodeTextureFromJson(i[c],b),ccs.armatureDataManager.addTextureData(h.name,h,b.filename);var j=null==b.asyncStruct?ccs.armatureDataManager.isAutoLoadSpriteFile():b.asyncStruct.autoLoadSpriteFile;if(j){var k,l,m,n,o=a[ccs.CONST_CONFIG_FILE_PATH]||[];for(c=0;c<o.length;c++)k=o[c],l=k.lastIndexOf("."),k=k.substring(0,l),m=b.basefilePath+k+".plist",n=b.basefilePath+k+".png",ccs.armatureDataManager.addSpriteFrameFromFile(m,n,b.filename)}d=null,f=null},decodeNodeFromJson:function(a,b,c){a.x=b[ccs.CONST_A_X]*this._positionReadScale,a.y=b[ccs.CONST_A_Y]*this._positionReadScale,a.x*=c.contentScale,a.y*=c.contentScale,a.zOrder=b[ccs.CONST_A_Z],
a.skewX=b[ccs.CONST_A_SKEW_X]||0,a.skewY=b[ccs.CONST_A_SKEW_Y]||0,a.scaleX=null==b[ccs.CONST_A_SCALE_X]?1:b[ccs.CONST_A_SCALE_X],a.scaleY=null==b[ccs.CONST_A_SCALE_Y]?1:b[ccs.CONST_A_SCALE_Y];var d;c.cocoStudioVersion<ccs.VERSION_COLOR_READING?(d=b[0],d&&(a.a=null==d[ccs.CONST_A_ALPHA]?255:d[ccs.CONST_A_ALPHA],a.r=null==d[ccs.CONST_A_RED]?255:d[ccs.CONST_A_RED],a.g=null==d[ccs.CONST_A_GREEN]?255:d[ccs.CONST_A_GREEN],a.b=null==d[ccs.CONST_A_BLUE]?255:d[ccs.CONST_A_BLUE],a.isUseColorInfo=!0)):(d=b[ccs.CONST_COLOR_INFO]||null,d&&(a.a=null==d[ccs.CONST_A_ALPHA]?255:d[ccs.CONST_A_ALPHA],a.r=null==d[ccs.CONST_A_RED]?255:d[ccs.CONST_A_RED],a.g=null==d[ccs.CONST_A_GREEN]?255:d[ccs.CONST_A_GREEN],a.b=null==d[ccs.CONST_A_BLUE]?255:d[ccs.CONST_A_BLUE],a.isUseColorInfo=!0))},clear:function(){this._configFileList=[],this._asyncRefCount=0,this._asyncRefTotalCount=0},_asyncCallBack:function(a,b,c){a&&cc.isFunction(a)&&a.call(b,c),b&&a&&"string"==typeof a&&b[a](c)},_initBaseFilePath:function(a){var b=a,c=b.lastIndexOf("/");return b=c>-1?b.substr(0,c+1):""},addDataFromXML:function(a,b){var c=cc.loader.getRes(a);if(!c)throw new Error("Please load the resource first : "+a);var d=cc.saxParser.parse(c),e=d.documentElement;e&&this.addDataFromCache(e,b)},addDataFromJson:function(a,b){var c=cc.loader.getRes(a);this.addDataFromJsonCache(c,b)}},ccs.spriteFrameCacheHelper={_textureAtlasDic:{},_imagePaths:[],addSpriteFrameFromFile:function(a,b){cc.spriteFrameCache.addSpriteFrames(a,b)},getTextureAtlasWithTexture:function(a){return null},clear:function(){this._textureAtlasDic={},this._imagePaths=[]}},ccs.TransformHelp=ccs.TransformHelp||ccs.Class.extend({}),ccs.TransformHelp.helpMatrix1=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpMatrix2=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpPoint1=cc.p(0,0),ccs.TransformHelp.helpPoint2=cc.p(0,0),ccs.TransformHelp.helpParentNode={},ccs.TransformHelp.transformFromParent=function(a,b){this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(b,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.transformToParent=function(a,b){this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(b,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.transformFromParentWithoutScale=function(a,b){for(var c in b)this.helpParentNode[c]=b[c];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.transformToParentWithoutScale=function(a,b){for(var c in b)this.helpParentNode[c]=b[c];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(a,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,a)},ccs.TransformHelp.nodeToMatrix=function(a,b){if(a.skewX===-a.skewY){var c=Math.sin(a.skewX),d=Math.cos(a.skewX);b.a=a.scaleX*d,b.b=a.scaleX*-c,b.c=a.scaleY*c,b.d=a.scaleY*d}else b.a=a.scaleX*Math.cos(a.skewY),b.b=a.scaleX*Math.sin(a.skewY),b.c=a.scaleY*Math.sin(a.skewX),b.d=a.scaleY*Math.cos(a.skewX);b.tx=a.x,b.ty=a.y},ccs.TransformHelp.matrixToNode=function(a,b){this.helpPoint1.x=0,this.helpPoint1.y=1,this.helpPoint1=cc.pointApplyAffineTransform(this.helpPoint1,a),this.helpPoint1.x-=a.tx,this.helpPoint1.y-=a.ty,this.helpPoint2.x=1,this.helpPoint2.y=0,this.helpPoint2=cc.pointApplyAffineTransform(this.helpPoint2,a),this.helpPoint2.x-=a.tx,this.helpPoint2.y-=a.ty,b.skewX=-(Math.atan2(this.helpPoint1.y,this.helpPoint1.x)-1.5707964),b.skewY=Math.atan2(this.helpPoint2.y,this.helpPoint2.x),b.scaleX=Math.sqrt(a.a*a.a+a.b*a.b),b.scaleY=Math.sqrt(a.c*a.c+a.d*a.d),b.x=a.tx,b.y=a.ty},ccs.TransformHelp.nodeConcat=function(a,b){a.x+=b.x,a.y+=b.y,a.skewX+=b.skewX,a.skewY+=b.skewY,a.scaleX+=b.scaleX,a.scaleY+=b.scaleY},ccs.TransformHelp.nodeSub=function(a,b){a.x-=b.x,a.y-=b.y,a.skewX-=b.skewX,a.skewY-=b.skewY,a.scaleX-=b.scaleX,a.scaleY-=b.scaleY},ccs.TweenType={CUSTOM_EASING:-1,LINEAR:0,SINE_EASEIN:1,SINE_EASEOUT:2,SINE_EASEINOUT:3,QUAD_EASEIN:4,QUAD_EASEOUT:5,QUAD_EASEINOUT:6,CUBIC_EASEIN:7,CUBIC_EASEOUT:8,CUBIC_EASEINOUT:9,QUART_EASEIN:10,QUART_EASEOUT:11,QUART_EASEINOUT:12,QUINT_EASEIN:13,QUINT_EASEOUT:14,QUINT_EASEINOUT:15,EXPO_EASEIN:16,EXPO_EASEOUT:17,EXPO_EASEINOUT:18,CIRC_EASEIN:19,CIRC_EASEOUT:20,CIRC_EASEINOUT:21,ELASTIC_EASEIN:22,ELASTIC_EASEOUT:23,ELASTIC_EASEINOUT:24,BACK_EASEIN:25,BACK_EASEOUT:26,BACK_EASEINOUT:27,BOUNCE_EASEIN:28,BOUNCE_EASEOUT:29,BOUNCE_EASEINOUT:30,TWEEN_EASING_MAX:1e4},ccs.TweenFunction=ccs.TweenFunction||ccs.Class.extend({}),ccs.DOUBLE_PI=ccs.M_PI_X_2=2*Math.PI,ccs.HALF_PI=ccs.M_PI_2=Math.PI/2,ccs.M_PI=Math.PI,ccs.TweenFunction.tweenTo=function(a,b,c){var d=0;switch(b){case ccs.TweenType.CUSTOM_EASING:d=this.customEase(a,c);break;case ccs.TweenType.LINEAR:d=this.linear(a);break;case ccs.TweenType.SINE_EASEIN:d=this.sineEaseIn(a);break;case ccs.TweenType.SINE_EASEOUT:d=this.sineEaseOut(a);break;case ccs.TweenType.SINE_EASEINOUT:d=this.sineEaseInOut(a);break;case ccs.TweenType.QUAD_EASEIN:d=this.quadEaseIn(a);break;case ccs.TweenType.QUAD_EASEOUT:d=this.quadEaseOut(a);break;case ccs.TweenType.QUAD_EASEINOUT:d=this.quadEaseInOut(a);break;case ccs.TweenType.CUBIC_EASEIN:d=this.cubicEaseIn(a);break;case ccs.TweenType.CUBIC_EASEOUT:d=this.cubicEaseOut(a);break;case ccs.TweenType.CUBIC_EASEINOUT:d=this.cubicEaseInOut(a);break;case ccs.TweenType.QUART_EASEIN:d=this.quartEaseIn(a);break;case ccs.TweenType.QUART_EASEOUT:d=this.quartEaseOut(a);break;case ccs.TweenType.QUART_EASEINOUT:d=this.quartEaseInOut(a);break;case ccs.TweenType.QUINT_EASEIN:d=this.quintEaseIn(a);break;case ccs.TweenType.QUINT_EASEOUT:d=this.quintEaseOut(a);break;case ccs.TweenType.QUINT_EASEINOUT:d=this.quintEaseInOut(a);break;case ccs.TweenType.EXPO_EASEIN:d=this.expoEaseIn(a);break;case ccs.TweenType.EXPO_EASEOUT:d=this.expoEaseOut(a);break;case ccs.TweenType.EXPO_EASEINOUT:d=this.expoEaseInOut(a);break;case ccs.TweenType.CIRC_EASEIN:d=this.circEaseIn(a);break;case ccs.TweenType.CIRC_EASEOUT:d=this.circEaseOut(a);break;case ccs.TweenType.CIRC_EASEINOUT:d=this.circEaseInOut(a);break;case ccs.TweenType.ELASTIC_EASEIN:var e=.3;null!=c&&c.length>0&&(e=c[0]),d=this.elasticEaseIn(a,e);break;case ccs.TweenType.ELASTIC_EASEOUT:var e=.3;null!=c&&c.length>0&&(e=c[0]),d=this.elasticEaseOut(a,e);break;case ccs.TweenType.ELASTIC_EASEINOUT:var e=.3;null!=c&&c.length>0&&(e=c[0]),d=this.elasticEaseInOut(a,e);break;case ccs.TweenType.BACK_EASEIN:d=this.backEaseIn(a);break;case ccs.TweenType.BACK_EASEOUT:d=this.backEaseOut(a);break;case ccs.TweenType.BACK_EASEINOUT:d=this.backEaseInOut(a);break;case ccs.TweenType.BOUNCE_EASEIN:d=this.bounceEaseIn(a);break;case ccs.TweenType.BOUNCE_EASEOUT:d=this.bounceEaseOut(a);break;case ccs.TweenType.BOUNCE_EASEINOUT:d=this.bounceEaseInOut(a);break;default:d=this.sineEaseInOut(a)}return d},ccs.TweenFunction.linear=function(a){return a},ccs.TweenFunction.sineEaseIn=function(a){return-1*Math.cos(a*ccs.HALF_PI)+1},ccs.TweenFunction.sineEaseOut=function(a){return Math.sin(a*ccs.HALF_PI)},ccs.TweenFunction.sineEaseInOut=function(a){return-.5*(Math.cos(ccs.M_PI*a)-1)},ccs.TweenFunction.quadEaseIn=function(a){return a*a},ccs.TweenFunction.quadEaseOut=function(a){return-1*a*(a-2)},ccs.TweenFunction.quadEaseInOut=function(a){return a=2*a,1>a?.5*a*a:(--a,-.5*(a*(a-2)-1))},ccs.TweenFunction.cubicEaseIn=function(a){return a*a*a},ccs.TweenFunction.cubicEaseOut=function(a){return a-=1,a*a*a+1},ccs.TweenFunction.cubicEaseInOut=function(a){return a=2*a,1>a?.5*a*a*a:(a-=2,.5*(a*a*a+2))},ccs.TweenFunction.quartEaseIn=function(a){return a*a*a*a},ccs.TweenFunction.quartEaseOut=function(a){return a-=1,-(a*a*a*a-1)},ccs.TweenFunction.quartEaseInOut=function(a){return a=2*a,1>a?.5*a*a*a*a:(a-=2,-.5*(a*a*a*a-2))},ccs.TweenFunction.quintEaseIn=function(a){return a*a*a*a*a},ccs.TweenFunction.quintEaseOut=function(a){return a-=1,a*a*a*a*a+1},ccs.TweenFunction.quintEaseInOut=function(a){return a=2*a,1>a?.5*a*a*a*a*a:(a-=2,.5*(a*a*a*a*a+2))},ccs.TweenFunction.expoEaseIn=function(a){return 0===a?0:Math.pow(2,10*(a-1))-.001},ccs.TweenFunction.expoEaseOut=function(a){return 1===a?1:-Math.pow(2,-10*a)+1},ccs.TweenFunction.expoEaseInOut=function(a){return a/=.5,a=1>a?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*(a-1))+2)},ccs.TweenFunction.circEaseIn=function(a){return-1*(Math.sqrt(1-a*a)-1)},ccs.TweenFunction.circEaseOut=function(a){return a-=1,Math.sqrt(1-a*a)},ccs.TweenFunction.circEaseInOut=function(a){return a=2*a,1>a?-.5*(Math.sqrt(1-a*a)-1):(a-=2,.5*(Math.sqrt(1-a*a)+1))},ccs.TweenFunction.elasticEaseIn=function(a,b){var c=.3;b.length>0&&(c=b[0]);var d=0;if(0===a||1===a)d=a;else{var e=c/4;a-=1,d=-Math.pow(2,10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c)}return d},ccs.TweenFunction.elasticEaseOut=function(a,b){var c=.3;b.length>0&&(c=b[0]);var d=0;if(0===a||1===a)d=a;else{var e=c/4;d=Math.pow(2,-10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c)+1}return d},ccs.TweenFunction.elasticEaseInOut=function(a,b){var c=.3;b.length>0&&(c=b[0]);var d=0;if(0===a||1===a)d=a;else{a=2*a,c||(c=.3*1.5);var e=c/4;a-=1,d=0>a?-.5*Math.pow(2,10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c):Math.pow(2,-10*a)*Math.sin((a-e)*ccs.DOUBLE_PI/c)*.5+1}return d},ccs.TweenFunction.backEaseIn=function(a){var b=1.70158;return a*a*((b+1)*a-b)},ccs.TweenFunction.backEaseOut=function(a){var b=1.70158;return a-=1,a*a*((b+1)*a+b)+1},ccs.TweenFunction.backEaseInOut=function(a){var b=2.5949095;return a=2*a,1>a?a*a*((b+1)*a-b)/2:(a-=2,a*a*((b+1)*a+b)/2+1)},ccs.bounceTime=function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?(a-=1.5/2.75,7.5625*a*a+.75):2.5/2.75>a?(a-=2.25/2.75,7.5625*a*a+.9375):(a-=2.625/2.75,7.5625*a*a+.984375)},ccs.TweenFunction.bounceEaseIn=function(a){return 1-ccs.bounceTime(1-a)},ccs.TweenFunction.bounceEaseOut=function(a){return ccs.bounceTime(a)},ccs.TweenFunction.bounceEaseInOut=function(a){var b=0;return.5>a?(a=2*a,b=.5*(1-ccs.bounceTime(1-a))):b=.5*ccs.bounceTime(2*a-1)+.5,b},ccs.TweenFunction.customEase=function(a,b){if(b.length>0){var c=1-a;return b[1]*c*c*c+3*b[3]*a*c*c+3*b[5]*a*a*c+b[7]*a*a*a}return a},ccs.TweenFunction.easeIn=function(a,b){return Math.pow(a,b)},ccs.TweenFunction.easeOut=function(a,b){return Math.pow(a,1/b)},ccs.TweenFunction.easeInOut=function(a,b){return a*=2,1>a?.5*Math.pow(a,b):1-.5*Math.pow(2-a,b)},ccs.TweenFunction.quadraticIn=function(a){return Math.pow(a,2)},ccs.TweenFunction.quadraticOut=function(a){return-a*(a-2)},ccs.TweenFunction.bezieratFunction=function(a,b,c,d,e){return Math.pow(1-e,3)*a+3*e*Math.pow(1-e,2)*b+3*Math.pow(e,2)*(1-e)*c+Math.pow(e,3)*d};var ENABLE_PHYSICS_DETECT=!1;ccs.fmodf=function(a,b){for(;a>b;)a-=b;return a};var CC_SAFE_RELEASE=function(a){a&&a.release&&a.release()};ccs.isSpriteContainPoint=function(a,b,c){var d=a.convertToNodeSpace(b);c&&(c.x=d.x,c.y=d.y);var e=a.getContentSize();return cc.rectContainsPoint(cc.rect(0,0,e.width,e.height),d)},ccs.SPRITE_CONTAIN_POINT=ccs.isSpriteContainPoint,ccs.SPRITE_CONTAIN_POINT_WITH_RETURN=ccs.isSpriteContainPoint,ccs.extBezierTo=function(a,b,c,d,e){var f=cc.p(0,0);return d&&!e&&(f.x=Math.pow(1-a,2)*b.x+2*a*(1-a)*c.x+Math.pow(a,2)*d.x,f.y=Math.pow(1-a,2)*b.y+2*a*(1-a)*c.y+Math.pow(a,2)*d.y),e&&(f.x=b.x*Math.pow(1-a,3)+3*a*c.x*Math.pow(1-a,2)+3*d.x*Math.pow(a,2)*(1-a)+e.x*Math.pow(a,3),f.y=b.y*Math.pow(1-a,3)+3*a*c.y*Math.pow(1-a,2)+3*d.y*Math.pow(a,2)*(1-a)+e.y*Math.pow(a,3)),f},ccs.extCircleTo=function(a,b,c,d,e){var f=cc.p(0,0);return f.x=b.x+c*Math.cos(d+e*a),f.y=b.y+c*Math.sin(d+e*a),f},ccs.RelativeData=function(){this.plistFiles=[],this.armatures=[],this.animations=[],this.textures=[]},ccs.armatureDataManager={_animationDatas:{},_armatureDatas:{},_textureDatas:{},_autoLoadSpriteFile:!1,_relativeDatas:{},s_sharedArmatureDataManager:null,removeArmatureFileInfo:function(a){var b=this.getRelativeData(a);if(b){var c,d;for(c=0;c<b.armatures.length;c++)d=b.armatures[c],this.removeArmatureData(d);for(c=0;c<b.animations.length;c++)d=b.animations[c],this.removeAnimationData(d);for(c=0;c<b.textures.length;c++)d=b.textures[c],this.removeTextureData(d);for(c=0;c<b.plistFiles.length;c++)d=b.plistFiles[c],cc.spriteFrameCache.removeSpriteFramesFromFile(d);delete this._relativeDatas[a],ccs.dataReaderHelper.removeConfigFile(a)}},addArmatureData:function(a,b,c){var d=this.getRelativeData(c);d&&d.armatures.push(a),this._armatureDatas[a]=b},getArmatureData:function(a){var b=null;return this._armatureDatas&&(b=this._armatureDatas[a]),b},removeArmatureData:function(a){this._armatureDatas[a]&&delete this._armatureDatas[a]},addAnimationData:function(a,b,c){var d=this.getRelativeData(c);d&&d.animations.push(a),this._animationDatas[a]=b},getAnimationData:function(a){var b=null;return this._animationDatas[a]&&(b=this._animationDatas[a]),b},removeAnimationData:function(a){this._animationDatas[a]&&delete this._animationDatas[a]},addTextureData:function(a,b,c){var d=this.getRelativeData(c);d&&d.textures.push(a),this._textureDatas[a]=b},getTextureData:function(a){var b=null;return this._textureDatas&&(b=this._textureDatas[a]),b},removeTextureData:function(a){this._textureDatas[a]&&delete this._textureDatas[a]},addArmatureFileInfo:function(){var a,b,c;switch(arguments.length){case 1:c=arguments[0],this.addRelativeData(c),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFile(c);break;case 3:a=arguments[0],b=arguments[1],c=arguments[2],this.addRelativeData(c),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFile(c),this.addSpriteFrameFromFile(b,a)}},addArmatureFileInfoAsync:function(){var a,b,c,d,e;switch(arguments.length){case 3:c=arguments[0],d=arguments[2],e=arguments[1],this.addRelativeData(c),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFileAsync("","",c,e,d);break;case 5:a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[4],e=arguments[3],this.addRelativeData(c),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFileAsync(a,b,c,e,d),this.addSpriteFrameFromFile(b,a)}},addSpriteFrameFromFile:function(a,b,c){var d=this.getRelativeData(c);d&&d.plistFiles.push(a),ccs.spriteFrameCacheHelper.addSpriteFrameFromFile(a,b)},isAutoLoadSpriteFile:function(){return this._autoLoadSpriteFile},getArmatureDatas:function(){return this._armatureDatas},getAnimationDatas:function(){return this._animationDatas},getTextureDatas:function(){return this._textureDatas},addRelativeData:function(a){this._relativeDatas[a]||(this._relativeDatas[a]=new ccs.RelativeData)},getRelativeData:function(a){return this._relativeDatas[a]},clear:function(){for(var a in this._relativeDatas)this.removeArmatureFileInfo(a);this._animationDatas={},this._armatureDatas={},this._textureDatas={},this._relativeDatas={},ccs.spriteFrameCacheHelper.clear(),ccs.dataReaderHelper.clear()}},ccs.BLEND_TYPE_NORMAL=0,ccs.BLEND_TYPE_LAYER=1,ccs.BLEND_TYPE_DARKEN=2,ccs.BLEND_TYPE_MULTIPLY=3,ccs.BLEND_TYPE_LIGHTEN=4,ccs.BLEND_TYPE_SCREEN=5,ccs.BLEND_TYPE_OVERLAY=6,ccs.BLEND_TYPE_HIGHLIGHT=7,ccs.BLEND_TYPE_ADD=8,ccs.BLEND_TYPE_SUBTRACT=9,ccs.BLEND_TYPE_DIFFERENCE=10,ccs.BLEND_TYPE_INVERT=11,ccs.BLEND_TYPE_ALPHA=12,ccs.BLEND_TYPE_ERASE=13,ccs.DISPLAY_TYPE_SPRITE=0,ccs.DISPLAY_TYPE_ARMATURE=1,ccs.DISPLAY_TYPE_PARTICLE=2,ccs.DISPLAY_TYPE_MAX=3,ccs.BaseData=ccs.Class.extend({x:0,y:0,zOrder:0,skewX:0,skewY:0,scaleX:1,scaleY:1,tweenRotate:0,isUseColorInfo:!1,r:255,g:255,b:255,a:255,ctor:function(){this.x=0,this.y=0,this.zOrder=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1,this.tweenRotate=0,this.isUseColorInfo=!1,this.r=255,this.g=255,this.b=255,this.a=255},copy:function(a){this.x=a.x,this.y=a.y,this.zOrder=a.zOrder,this.scaleX=a.scaleX,this.scaleY=a.scaleY,this.skewX=a.skewX,this.skewY=a.skewY,this.tweenRotate=a.tweenRotate,this.isUseColorInfo=a.isUseColorInfo,this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a},setColor:function(a){this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a},getColor:function(){return cc.color(this.r,this.g,this.b,this.a)},subtract:function(a,b,c){this.x=b.x-a.x,this.y=b.y-a.y,this.scaleX=b.scaleX-a.scaleX,this.scaleY=b.scaleY-a.scaleY,this.skewX=b.skewX-a.skewX,this.skewY=b.skewY-a.skewY,this.isUseColorInfo||a.isUseColorInfo||b.isUseColorInfo?(this.a=b.a-a.a,this.r=b.r-a.r,this.g=b.g-a.g,this.b=b.b-a.b,this.isUseColorInfo=!0):(this.a=this.r=this.g=this.b=0,this.isUseColorInfo=!1),c&&(this.skewX>ccs.M_PI&&(this.skewX-=ccs.DOUBLE_PI),this.skewX<-ccs.M_PI&&(this.skewX+=ccs.DOUBLE_PI),this.skewY>ccs.M_PI&&(this.skewY-=ccs.DOUBLE_PI),this.skewY<-ccs.M_PI&&(this.skewY+=ccs.DOUBLE_PI)),b.tweenRotate&&(this.skewX+=b.tweenRotate*ccs.PI*2,this.skewY-=b.tweenRotate*ccs.PI*2)}}),ccs.DisplayData=ccs.Class.extend({displayType:ccs.DISPLAY_TYPE_MAX,displayName:"",ctor:function(){this.displayType=ccs.DISPLAY_TYPE_MAX},changeDisplayToTexture:function(a){var b=a,c=b.lastIndexOf(".");return-1!==c&&(b=b.substring(0,c)),b},copy:function(a){this.displayName=a.displayName,this.displayType=a.displayType}}),ccs.SpriteDisplayData=ccs.DisplayData.extend({skinData:null,ctor:function(){this.skinData=new ccs.BaseData,this.displayType=ccs.DISPLAY_TYPE_SPRITE},copy:function(a){ccs.DisplayData.prototype.copy.call(this,a),this.skinData=a.skinData}}),ccs.ArmatureDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayName="",this.displayType=ccs.DISPLAY_TYPE_ARMATURE}}),ccs.ParticleDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayType=ccs.DISPLAY_TYPE_PARTICLE}}),ccs.BoneData=ccs.BaseData.extend({displayDataList:null,name:"",parentName:"",boneDataTransform:null,ctor:function(){this.displayDataList=[],this.name="",this.parentName="",this.boneDataTransform=null},init:function(){return this.displayDataList.length=0,!0},addDisplayData:function(a){this.displayDataList.push(a)},getDisplayData:function(a){return this.displayDataList[a]}}),ccs.ArmatureData=ccs.Class.extend({boneDataDic:null,name:"",dataVersion:.1,ctor:function(){this.boneDataDic={},this.name="",this.dataVersion=.1},init:function(){return!0},addBoneData:function(a){this.boneDataDic[a.name]=a},getBoneDataDic:function(){return this.boneDataDic},getBoneData:function(a){return this.boneDataDic[a]}}),ccs.FrameData=ccs.BaseData.extend({duration:0,tweenEasing:0,easingParamNumber:0,easingParams:null,displayIndex:-1,movement:"",event:"",sound:"",soundEffect:"",blendFunc:null,frameID:0,isTween:!0,ctor:function(){ccs.BaseData.prototype.ctor.call(this),this.duration=1,this.tweenEasing=ccs.TweenType.LINEAR,this.easingParamNumber=0,this.easingParams=[],this.displayIndex=0,this.movement="",this.event="",this.sound="",this.soundEffect="",this.blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.frameID=0,this.isTween=!0},copy:function(a){if(ccs.BaseData.prototype.copy.call(this,a),this.duration=a.duration,this.displayIndex=a.displayIndex,this.tweenEasing=a.tweenEasing,this.easingParamNumber=a.easingParamNumber,0!==this.easingParamNumber){this.easingParams.length=0;for(var b=0;b<this.easingParamNumber;b++)this.easingParams[b]=a.easingParams[b]}this.blendFunc=a.blendFunc,this.isTween=a.isTween}}),ccs.MovementBoneData=ccs.Class.extend({delay:0,scale:1,duration:0,frameList:null,name:"",ctor:function(){this.delay=0,this.scale=1,this.duration=0,this.frameList=[],this.name=""},init:function(){return!0},addFrameData:function(a){this.frameList.push(a)},getFrameData:function(a){return this.frameList[a]}}),ccs.MovementData=function(){this.name="",this.duration=0,this.scale=1,this.durationTo=0,this.durationTween=0,this.loop=!0,this.tweenEasing=ccs.TweenType.LINEAR,this.movBoneDataDic={}},ccs.MovementData.prototype.addMovementBoneData=function(a){this.movBoneDataDic[a.name]=a},ccs.MovementData.prototype.getMovementBoneData=function(a){return this.movBoneDataDic[a]},ccs.AnimationData=function(){this.movementDataDic={},this.movementNames=[],this.name=""},ccs.AnimationData.prototype.addMovement=function(a){this.movementDataDic[a.name]=a,this.movementNames.push(a.name)},ccs.AnimationData.prototype.getMovement=function(a){return this.movementDataDic[a]},ccs.AnimationData.prototype.getMovementCount=function(){return Object.keys(this.movementDataDic).length},ccs.ContourVertex2=function(a,b){this.x=a||0,this.y=b||0},ccs.ContourData=function(){this.vertexList=[]},ccs.ContourData.prototype.init=function(){return this.vertexList.length=0,!0},ccs.ContourData.prototype.addVertex=function(a){this.vertexList.push(a)},ccs.TextureData=function(){this.height=0,this.width=0,this.pivotX=.5,this.pivotY=.5,this.name="",this.contourDataList=[]},ccs.TextureData.prototype.init=function(){this.contourDataList.length=0},ccs.TextureData.prototype.addContourData=function(a){this.contourDataList.push(a)},ccs.TextureData.prototype.getContourData=function(a){return this.contourDataList[a]},ccs.DecorativeDisplay=ccs.Class.extend({_display:null,_colliderDetector:null,_displayData:null,ctor:function(){this._display=null,this._colliderDetector=null,this._displayData=null},init:function(){return!0},setDisplay:function(a){a._parent&&(a._parent.removeChild(a),delete a._parent),this._display=a},getDisplay:function(){return this._display},setColliderDetector:function(a){this._colliderDetector=a},getColliderDetector:function(){return this._colliderDetector},setDisplayData:function(a){this._displayData=a},getDisplayData:function(){return this._displayData},release:function(){this._display=null,this._displayData=null,this._colliderDetector=null}}),ccs.DecorativeDisplay.create=function(){return new ccs.DecorativeDisplay},ccs.displayFactory={addDisplay:function(a,b,c){switch(c.displayType){case ccs.DISPLAY_TYPE_SPRITE:this.addSpriteDisplay(a,b,c);break;case ccs.DISPLAY_TYPE_PARTICLE:this.addParticleDisplay(a,b,c);break;case ccs.DISPLAY_TYPE_ARMATURE:this.addArmatureDisplay(a,b,c)}},createDisplay:function(a,b){switch(b.getDisplayData().displayType){case ccs.DISPLAY_TYPE_SPRITE:this.createSpriteDisplay(a,b);break;case ccs.DISPLAY_TYPE_PARTICLE:this.createParticleDisplay(a,b);break;case ccs.DISPLAY_TYPE_ARMATURE:this.createArmatureDisplay(a,b)}},_helpTransform:{a:1,b:0,c:0,d:1,tx:0,ty:0},updateDisplay:function(a,b,c){var d=a.getDisplayRenderNode();if(d){switch(a.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:c&&(d._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),d.updateArmatureTransform());break;case ccs.DISPLAY_TYPE_PARTICLE:this.updateParticleDisplay(a,d,b);break;case ccs.DISPLAY_TYPE_ARMATURE:this.updateArmatureDisplay(a,d,b);break;default:var e=a.getNodeToArmatureTransform();d.setAdditionalTransform(e)}if((ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&c){var f=a.getDisplayManager().getCurrentDecorativeDisplay(),g=f.getColliderDetector();if(g){var h=f.getDisplay(),i=h.getNodeToParentTransform(),j=this._helpTransform;j.a=i.a,j.b=i.b,j.c=i.c,j.d=i.d,j.tx=i.tx,j.ty=i.ty;var k=cc.pointApplyAffineTransform(h.getAnchorPointInPoints(),j);j.tx=k.x,j.ty=k.y;var l=cc.affineTransformConcat(j,a.getArmature().getNodeToParentTransform());g.updateTransform(l)}}}},addSpriteDisplay:function(a,b,c){var d=new ccs.SpriteDisplayData;d.copy(c),b.setDisplayData(d),this.createSpriteDisplay(a,b)},createSpriteDisplay:function(a,b){var c=null,d=b.getDisplayData(),e=d.displayName,f=e.lastIndexOf(".");-1!==f&&(e=e.substring(0,f)),c=""===e?new ccs.Skin:new ccs.Skin("#"+e+".png"),b.setDisplay(c),c.setBone(a),this.initSpriteDisplay(a,b,d.displayName,c);var g=a.getArmature();g&&(g.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?c.setSkinData(d.skinData):c.setSkinData(a.boneData))},initSpriteDisplay:function(a,b,c,d){var e=c,f=e.lastIndexOf(".");-1!==f&&(e=e.substring(0,f));var g=ccs.armatureDataManager.getTextureData(e);if(g&&d.setAnchorPoint(cc.p(g.pivotX,g.pivotY)),(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&g&&g.contourDataList.length>0){var h=new ccs.ColliderDetector(a);h.addContourDataList(g.contourDataList),b.setColliderDetector(h)}},addArmatureDisplay:function(a,b,c){var d=new ccs.ArmatureDisplayData;d.copy(c),b.setDisplayData(d),this.createArmatureDisplay(a,b)},createArmatureDisplay:function(a,b){var c=b.getDisplayData(),d=new ccs.Armature(c.displayName,a);b.setDisplay(d)},updateArmatureDisplay:function(a,b,c){b&&(b.sortAllChildren(),b.update(c))},addParticleDisplay:function(a,b,c){var d=new ccs.ParticleDisplayData;d.copy(c),b.setDisplayData(d),this.createParticleDisplay(a,b)},createParticleDisplay:function(a,b){var c=b.getDisplayData(),d=new cc.ParticleSystem(c.displayName);d.removeFromParent(),d.cleanup();var e=a.getArmature();e&&d.setParent(a.getArmature()),b.setDisplay(d)},updateParticleDisplay:function(a,b,c){var d=new ccs.BaseData;ccs.TransformHelp.matrixToNode(a.nodeToArmatureTransform(),d),b.setPosition(d.x,d.y),b.setScaleX(d.scaleX),b.setScaleY(d.scaleY),b.update(c)}},ccs.DisplayManager=ccs.Class.extend({_decoDisplayList:null,_currentDecoDisplay:null,_displayRenderNode:null,_displayIndex:null,_forceChangeDisplay:!1,_bone:null,_visible:!0,_displayType:null,ctor:function(a){this._decoDisplayList=[],this._currentDecoDisplay=null,this._displayRenderNode=null,this._displayIndex=null,this._forceChangeDisplay=!1,this._bone=null,this._visible=!0,this._displayType=ccs.DISPLAY_TYPE_MAX,a&&ccs.DisplayManager.prototype.init.call(this,a)},init:function(a){return this._bone=a,this.initDisplayList(a.getBoneData()),!0},addDisplay:function(a,b){var c,d=this._decoDisplayList;if(b>=0&&b<d.length?c=d[b]:(c=new ccs.DecorativeDisplay,d.push(c)),a instanceof ccs.DisplayData)return ccs.displayFactory.addDisplay(this._bone,c,a),void(b===this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(b,!1)));var e=null;if(a instanceof ccs.Skin){a.setBone(this._bone),e=new ccs.SpriteDisplayData,ccs.displayFactory.initSpriteDisplay(this._bone,c,a.getDisplayName(),a);var f=c.getDisplayData();if(f instanceof ccs.SpriteDisplayData)a.setSkinData(f.skinData),e.skinData=f.skinData;else{for(var g=!1,h=d.length-2;h>=0;h--){var i=d[h],j=i.getDisplayData();if(j instanceof ccs.SpriteDisplayData){g=!0,a.setSkinData(j.skinData),e.skinData=j.skinData;break}}g||a.setSkinData(new ccs.BaseData)}}else if(a instanceof cc.ParticleSystem){e=new ccs.ParticleDisplayData,a.removeFromParent(),a.cleanup();var k=this._bone.getArmature();k&&a.setParent(k)}else a instanceof ccs.Armature?(e=new ccs.ArmatureDisplayData,e.displayName=a.getName(),a.setParentBone(this._bone)):e=new ccs.DisplayData;c.setDisplay(a),c.setDisplayData(e),b===this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(b,!1))},_addDisplayOther:function(a,b){var c=null;if(b instanceof ccs.Skin){var d=b;d.setBone(this._bone),c=new ccs.SpriteDisplayData,c.displayName=d.getDisplayName(),ccs.displayFactory.initSpriteDisplay(this._bone,a,d.getDisplayName(),d);var e=a.getDisplayData();if(e instanceof ccs.SpriteDisplayData)d.setSkinData(e.skinData);else{for(var f=!1,g=this._decoDisplayList.length-2;g>=0;g--){var h=this._decoDisplayList[g],i=h.getDisplayData();if(i){f=!0,d.setSkinData(i.skinData),c.skinData=i.skinData;break}}f||d.setSkinData(new ccs.BaseData),d.setSkinData(new ccs.BaseData)}}else b instanceof cc.ParticleSystem?(c=new ccs.ParticleDisplayData,c.displayName=b._plistFile):b instanceof ccs.Armature?(c=new ccs.ArmatureDisplayData,c.displayName=b.getName(),b.setParentBone(this._bone)):c=new ccs.DisplayData;a.setDisplay(b),a.setDisplayData(c)},removeDisplay:function(a){this._decoDisplayList.splice(a,1),a===this._displayIndex&&(this.setCurrentDecorativeDisplay(null),this._displayIndex=-1)},getDecorativeDisplayList:function(){return this._decoDisplayList},changeDisplayWithIndex:function(a,b){return a>=this._decoDisplayList.length?void cc.log("the index value is out of range"):(this._forceChangeDisplay=b,this._displayIndex!==a?(this._displayIndex=a,0>a?void(this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this.setCurrentDecorativeDisplay(null))):void this.setCurrentDecorativeDisplay(this._decoDisplayList[a])):void 0)},changeDisplayWithName:function(a,b){for(var c=this._decoDisplayList,d=0;d<c.length;d++)if(c[d].getDisplayData().displayName===a){this.changeDisplayWithIndex(d,b);break}},setCurrentDecorativeDisplay:function(a){var b=this._currentDecoDisplay;(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&b&&b.getColliderDetector()&&b.getColliderDetector().setActive(!1),this._currentDecoDisplay=a,b=this._currentDecoDisplay,(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&b&&b.getColliderDetector()&&b.getColliderDetector().setActive(!0);var c=b?b.getDisplay():null,d=this._displayRenderNode,e=this._bone;d&&(d instanceof ccs.Armature&&e.setChildArmature(null),d.removeFromParent(!0)),this._displayRenderNode=c,c?(c instanceof ccs.Armature?(this._bone.setChildArmature(c),c.setParentBone(this._bone)):c instanceof cc.ParticleSystem&&(c instanceof ccs.Armature?(e.setChildArmature(c),c.setParentBone(e)):c instanceof cc.ParticleSystem&&c.resetSystem()),c.setColor(e.getDisplayedColor()),c.setOpacity(e.getDisplayedOpacity()),this._displayRenderNode.setVisible(this._visible),this._displayType=this._currentDecoDisplay.getDisplayData().displayType):this._displayType=ccs.DISPLAY_TYPE_MAX,cc.renderer.childrenOrderDirty=!0},getDisplayRenderNode:function(){return this._displayRenderNode},getDisplayRenderNodeType:function(){return this._displayType},getCurrentDisplayIndex:function(){return this._displayIndex},getCurrentDecorativeDisplay:function(){return this._currentDecoDisplay},getDecorativeDisplayByIndex:function(a){return this._decoDisplayList[a]},initDisplayList:function(a){if(this._decoDisplayList.length=0,a)for(var b=a.displayDataList,c=this._decoDisplayList,d=this._bone,e=0;e<b.length;e++){var f=b[e],g=new ccs.DecorativeDisplay;g.setDisplayData(f),ccs.displayFactory.createDisplay(d,g),c.push(g)}},containPoint:function(a,b){if(!this._visible||this._displayIndex<0)return!1;if(void 0!==b&&(a=cc.p(a,b)),this._currentDecoDisplay.getDisplayData().displayType===ccs.DISPLAY_TYPE_SPRITE){var c=this._currentDecoDisplay.getDisplay();return c=c.getChildByTag(0),ccs.SPRITE_CONTAIN_POINT_WITH_RETURN(c,a)}return!1},setVisible:function(a){this._displayRenderNode&&(this._visible=a,this._displayRenderNode.setVisible(a))},isVisible:function(){return this._visible},getContentSize:function(){return this._displayRenderNode?this._displayRenderNode.getContentSize():cc.size(0,0)},getBoundingBox:function(){return this._displayRenderNode?this._displayRenderNode.getBoundingBox():cc.rect(0,0,0,0)},getAnchorPoint:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPoint():cc.p(0,0)},getAnchorPointInPoints:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPointInPoints():cc.p(0,0)},getForceChangeDisplay:function(){return this._forceChangeDisplay},release:function(){this._decoDisplayList=null,this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this._displayRenderNode=null)}}),ccs.DisplayManager.create=function(a){return new ccs.DisplayManager(a)},ccs.Skin=ccs.Sprite.extend({_skinData:null,bone:null,_skinTransform:null,_displayName:"",_armature:null,_className:"Skin",ctor:function(a,b){cc.Sprite.prototype.ctor.call(this),this._skinData=null,this.bone=null,this._displayName="",this._skinTransform=cc.affineTransformIdentity(),this._armature=null,null==a||""===a?ccs.Skin.prototype.init.call(this):"#"===a[0]?ccs.Skin.prototype.initWithSpriteFrameName.call(this,a.substr(1)):ccs.Skin.prototype.initWithFile.call(this,a,b)},initWithSpriteFrameName:function(a){if(""===a)return!1;var b=cc.spriteFrameCache.getSpriteFrame(a),c=!0;return b?this.initWithSpriteFrame(b):(cc.log("Can't find CCSpriteFrame with %s. Please check your .plist file",a),
c=!1),this._displayName=a,c},initWithFile:function(a,b){var c=b?cc.Sprite.prototype.initWithFile.call(this,a,b):cc.Sprite.prototype.initWithFile.call(this,a);return this._displayName=a,c},setSkinData:function(a){this._skinData=a,this.setScaleX(a.scaleX),this.setScaleY(a.scaleY),this.setRotationX(cc.radiansToDegrees(a.skewX)),this.setRotationY(cc.radiansToDegrees(-a.skewY)),this.setPosition(a.x,a.y),this._renderCmd.transform()},getSkinData:function(){return this._skinData},updateArmatureTransform:function(){this._renderCmd.transform()},getNodeToWorldTransform:function(){return this._renderCmd.getNodeToWorldTransform()},getNodeToWorldTransformAR:function(){return this._renderCmd.getNodeToWorldTransformAR()},setBone:function(a){this.bone=a;var b=this.bone.getArmature();b&&(this._armature=b)},getBone:function(){return this.bone},getDisplayName:function(){return this._displayName},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new ccs.Skin.CanvasRenderCmd(this):new ccs.Skin.WebGLRenderCmd(this)}});var _p=ccs.Skin.prototype;_p.skinData,cc.defineGetterSetter(_p,"skinData",_p.getSkinData,_p.setSkinData),_p.displayName,cc.defineGetterSetter(_p,"displayName",_p.getDisplayName),_p=null,ccs.Skin.create=function(a,b){return new ccs.Skin(a,b)},ccs.Skin.createWithSpriteFrameName=function(a){return new ccs.Skin("#"+a)},function(){ccs.Skin.RenderCmd={transform:function(a,b){var c=this._node,d=a?a._worldTransform:null,e=this._transform,f=this._worldTransform,g=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty;if((g||d)&&(this.originTransform(),cc.affineTransformConcatIn(e,c.bone.getNodeToArmatureTransform()),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag),d){f.a=e.a*d.a+e.b*d.c,f.b=e.a*d.b+e.b*d.d,f.c=e.c*d.a+e.d*d.c,f.d=e.c*d.b+e.d*d.d,f.tx=e.tx*d.a+e.ty*d.c+d.tx,f.ty=e.tx*d.b+e.ty*d.d+d.ty;var h=this._vertices;if(h){var i=c._offsetPosition.x,j=i+c._rect.width,k=c._offsetPosition.y,l=k+c._rect.height;h[0].x=i*f.a+l*f.c+f.tx,h[0].y=i*f.b+l*f.d+f.ty,h[1].x=i*f.a+k*f.c+f.tx,h[1].y=i*f.b+k*f.d+f.ty,h[2].x=j*f.a+l*f.c+f.tx,h[2].y=j*f.b+l*f.d+f.ty,h[3].x=j*f.a+k*f.c+f.tx,h[3].y=j*f.b+k*f.d+f.ty}}else f.a=e.a,f.b=e.b,f.c=e.c,f.d=e.d,f.tx=e.tx,f.ty=e.ty},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._transform,this._node.bone.getArmature().getNodeToWorldTransform())},getNodeToWorldTransformAR:function(){var a=this._transform,b=this._node;return this._anchorPointInPoints=cc.pointApplyAffineTransform(this._anchorPointInPoints,a),a.tx=this._anchorPointInPoints.x,a.ty=this._anchorPointInPoints.y,cc.affineTransformConcat(a,b.bone.getArmature().getNodeToWorldTransform())}},ccs.Skin.CanvasRenderCmd=function(a){cc.Sprite.CanvasRenderCmd.call(this,a)};var a=ccs.Skin.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(ccs.Skin.RenderCmd,a),a.constructor=ccs.Skin.CanvasRenderCmd,ccs.Skin.WebGLRenderCmd=function(a){cc.Sprite.WebGLRenderCmd.call(this,a)},a=ccs.Skin.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype),cc.inject(ccs.Skin.RenderCmd,a),a.constructor=ccs.Skin.WebGLRenderCmd}(),ccs.ANIMATION_TYPE_SINGLE_FRAME=-4,ccs.ANIMATION_TYPE_NO_LOOP=-3,ccs.ANIMATION_TYPE_TO_LOOP_FRONT=-2,ccs.ANIMATION_TYPE_TO_LOOP_BACK=-1,ccs.ANIMATION_TYPE_LOOP_FRONT=0,ccs.ANIMATION_TYPE_LOOP_BACK=1,ccs.ANIMATION_TYPE_MAX=2,ccs.ProcessBase=ccs.Class.extend({_processScale:1,_isComplete:!0,_isPause:!0,_isPlaying:!1,_currentPercent:0,_rawDuration:0,_loopType:0,_tweenEasing:0,animationInternal:null,_currentFrame:0,_durationTween:0,_nextFrameIndex:0,_curFrameIndex:null,_isLoopBack:!1,ctor:function(){this._processScale=1,this._isComplete=!0,this._isPause=!0,this._isPlaying=!1,this._currentFrame=0,this._currentPercent=0,this._durationTween=0,this._rawDuration=0,this._loopType=ccs.ANIMATION_TYPE_LOOP_BACK,this._tweenEasing=ccs.TweenType.LINEAR,this.animationInternal=1/60,this._curFrameIndex=0,this._durationTween=0,this._isLoopBack=!1},pause:function(){this._isPause=!0,this._isPlaying=!1},resume:function(){this._isPause=!1,this._isPlaying=!0},stop:function(){this._isComplete=!0,this._isPlaying=!1},play:function(a,b,c,d){this._isComplete=!1,this._isPause=!1,this._isPlaying=!0,this._currentFrame=0,this._nextFrameIndex=a,this._tweenEasing=d},update:function(a){if(!this._isComplete&&!this._isPause&&!(this._rawDuration<=0||a>1)){var b=void 0===this._nextFrameIndex?0:this._nextFrameIndex,c=this._currentFrame;0>=b?(this._currentPercent=1,c=0):(c+=this._processScale*(a/this.animationInternal),this._currentPercent=c/b,c=ccs.fmodf(c,b)),this._currentFrame=c,this.updateHandler()}},gotoFrame:function(a){var b=this._loopType;b===ccs.ANIMATION_TYPE_NO_LOOP?b=ccs.ANIMATION_TYPE_MAX:b===ccs.ANIMATION_TYPE_TO_LOOP_FRONT&&(b=ccs.ANIMATION_TYPE_LOOP_FRONT),this._loopType=b,this._curFrameIndex=a,this._nextFrameIndex=this._durationTween},getCurrentFrameIndex:function(){return this._curFrameIndex=(this._rawDuration-1)*this._currentPercent,this._curFrameIndex},updateHandler:function(){},isPause:function(){return this._isPause},isComplete:function(){return this._isComplete},getCurrentPercent:function(){return this._currentPercent},getRawDuration:function(){return this._rawDuration},getLoop:function(){return this._loopType},getTweenEasing:function(){return this._tweenEasing},getAnimationInternal:function(){return this.animationInternal},setAnimationInternal:function(a){this.animationInternal=a},getProcessScale:function(){return this._processScale},setProcessScale:function(a){this._processScale=a},isPlaying:function(){return this._isPlaying}});var _p=ccs.ProcessBase.prototype;_p.currentFrameIndex,cc.defineGetterSetter(_p,"currentFrameIndex",_p.getCurrentFrameIndex),_p.paused,cc.defineGetterSetter(_p,"paused",_p.isPause),_p.completed,cc.defineGetterSetter(_p,"completed",_p.isComplete),_p.currentPercent,cc.defineGetterSetter(_p,"currentPercent",_p.getCurrentPercent),_p.rawDuration,cc.defineGetterSetter(_p,"rawDuration",_p.getRawDuration),_p.loop,cc.defineGetterSetter(_p,"loop",_p.getLoop),_p.tweenEasing,cc.defineGetterSetter(_p,"tweenEasing",_p.getTweenEasing),_p.playing,cc.defineGetterSetter(_p,"playing",_p.isPlaying),_p=null,ccs.MovementEventType={start:0,complete:1,loopComplete:2},ccs.AnimationEvent=ccs.Class.extend({_arguments:null,_callFunc:null,_selectorTarget:null,ctor:function(a,b,c){this._data=c,this._callFunc=a,this._selectorTarget=b},call:function(){this._callFunc&&this._callFunc.apply(this._selectorTarget,this._arguments)},setArguments:function(a){this._arguments=a}}),ccs.MovementEvent=function(){this.armature=null,this.movementType=ccs.MovementEventType.start,this.movementID=""},ccs.FrameEvent=function(){this.bone=null,this.frameEventName="",this.originFrameIndex=0,this.currentFrameIndex=0},ccs.ArmatureAnimation=ccs.ProcessBase.extend({_animationData:null,_movementData:null,_armature:null,_movementID:"",_toIndex:0,_tweenList:null,_speedScale:1,_ignoreFrameEvent:!1,_frameEventQueue:null,_movementEventQueue:null,_movementList:null,_onMovementList:!1,_movementListLoop:!1,_movementIndex:0,_movementListDurationTo:-1,_movementEventCallFunc:null,_frameEventCallFunc:null,_movementEventTarget:null,_frameEventTarget:null,_movementEventListener:null,_frameEventListener:null,ctor:function(a){ccs.ProcessBase.prototype.ctor.call(this),this._tweenList=[],this._movementList=[],this._frameEventQueue=[],this._movementEventQueue=[],this._armature=null,a&&ccs.ArmatureAnimation.prototype.init.call(this,a)},init:function(a){return this._armature=a,this._tweenList.length=0,!0},pause:function(){for(var a=this._tweenList,b=0;b<a.length;b++)a[b].pause();ccs.ProcessBase.prototype.pause.call(this)},resume:function(){for(var a=this._tweenList,b=0;b<a.length;b++)a[b].resume();ccs.ProcessBase.prototype.resume.call(this)},stop:function(){for(var a=this._tweenList,b=0;b<a.length;b++)a[b].stop();a.length=0,ccs.ProcessBase.prototype.stop.call(this)},setAnimationScale:function(a){this.setSpeedScale(a)},getAnimationScale:function(){return this.getSpeedScale()},setSpeedScale:function(a){if(a!==this._speedScale){this._speedScale=a,this._processScale=this._movementData?this._speedScale*this._movementData.scale:this._speedScale;var b=this._armature.getBoneDic();for(var c in b){var d=b[c];d.getTween().setProcessScale(this._processScale),d.getChildArmature()&&d.getChildArmature().getAnimation().setSpeedScale(this._processScale)}}},getSpeedScale:function(){return this._speedScale},play:function(a,b,c){cc.assert(this._animationData,"this.animationData can not be null"),this._movementData=this._animationData.getMovement(a),cc.assert(this._movementData,"this._movementData can not be null"),b=void 0===b?-1:b,c=void 0===c?-1:c,this._rawDuration=this._movementData.duration,this._movementID=a,this._processScale=this._speedScale*this._movementData.scale,b=-1===b?this._movementData.durationTo:b;var d=0===this._movementData.durationTween?this._rawDuration:this._movementData.durationTween,e=this._movementData.tweenEasing;c=0>c?this._movementData.loop:c,this._onMovementList=!1,ccs.ProcessBase.prototype.play.call(this,b,d,c,e),0===this._rawDuration?this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME:(this._loopType=c?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._durationTween=d),this._tweenList.length=0;var f,g=this._armature.getBoneDic();for(var h in g){var i=g[h];f=this._movementData.movBoneDataDic[i.getName()];var j=i.getTween();f&&f.frameList.length>0?(this._tweenList.push(j),f.duration=this._movementData.duration,j.play(f,b,d,c,e),j.setProcessScale(this._processScale),i.getChildArmature()&&(i.getChildArmature().getAnimation().setSpeedScale(this._processScale),i.getChildArmature().getAnimation().isPlaying()||i.getChildArmature().getAnimation().playWithIndex(0))):i.isIgnoreMovementBoneData()||(i.getDisplayManager().changeDisplayWithIndex(-1,!1),j.stop())}this._armature.update(0)},playByIndex:function(a,b,c,d,e){cc.log("playByIndex is deprecated. Use playWithIndex instead."),this.playWithIndex(a,b,d)},playWithIndex:function(a,b,c){var d=this._animationData.movementNames;cc.assert(a>-1&&a<d.length);var e=d[a];this.play(e,b,c)},playWithNames:function(a,b,c){b=void 0===b?-1:b,c=void 0===c?!0:c,this._movementListLoop=c,this._movementListDurationTo=b,this._onMovementList=!0,this._movementIndex=0,a instanceof Array?this._movementList=a:this._movementList.length=0,this.updateMovementList()},playWithIndexes:function(a,b,c){b=void 0===b?-1:b,c=void 0===c?!0:c,this._movementList.length=0,this._movementListLoop=c,this._movementListDurationTo=b,this._onMovementList=!0,this._movementIndex=0;for(var d=this._animationData.movementNames,e=0;e<a.length;e++){var f=d[a[e]];this._movementList.push(f)}this.updateMovementList()},gotoAndPlay:function(a){if(!this._movementData||0>a||a>=this._movementData.duration)return void cc.log("Please ensure you have played a movement, and the frameIndex is in the range.");var b=this._ignoreFrameEvent;this._ignoreFrameEvent=!0,this._isPlaying=!0,this._isComplete=this._isPause=!1,ccs.ProcessBase.prototype.gotoFrame.call(this,a),this._currentPercent=this._curFrameIndex/(this._movementData.duration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent;for(var c=this._tweenList,d=0;d<c.length;d++)c[d].gotoAndPlay(a);this._armature.update(0),this._ignoreFrameEvent=b},gotoAndPause:function(a){this.gotoAndPlay(a),this.pause()},getMovementCount:function(){return this._animationData.getMovementCount()},update:function(a){ccs.ProcessBase.prototype.update.call(this,a);for(var b=this._tweenList,c=0;c<b.length;c++)b[c].update(a);for(var d,e=this._frameEventQueue;e.length>0;)d=e.shift(),this._ignoreFrameEvent=!0,this._frameEventCallFunc&&this._frameEventCallFunc.call(this._frameEventTarget,d.bone,d.frameEventName,d.originFrameIndex,d.currentFrameIndex),this._frameEventListener&&this._frameEventListener(d.bone,d.frameEventName,d.originFrameIndex,d.currentFrameIndex),this._ignoreFrameEvent=!1;for(var f=this._movementEventQueue;f.length>0;)d=f.shift(),this._movementEventCallFunc&&this._movementEventCallFunc.call(this._movementEventTarget,d.armature,d.movementType,d.movementID),this._movementEventListener&&this._movementEventListener(d.armature,d.movementType,d.movementID)},updateHandler:function(){var a=this._currentPercent;if(a>=1){switch(this._loopType){case ccs.ANIMATION_TYPE_NO_LOOP:if(this._loopType=ccs.ANIMATION_TYPE_MAX,this._currentFrame=(a-1)*this._nextFrameIndex,a=this._currentFrame/this._durationTween,1>a){this._nextFrameIndex=this._durationTween,this.movementEvent(this._armature,ccs.MovementEventType.start,this._movementID);break}break;case ccs.ANIMATION_TYPE_MAX:case ccs.ANIMATION_TYPE_SINGLE_FRAME:a=1,this._isComplete=!0,this._isPlaying=!1,this.movementEvent(this._armature,ccs.MovementEventType.complete,this._movementID),this.updateMovementList();break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:this._loopType=ccs.ANIMATION_TYPE_LOOP_FRONT,a=ccs.fmodf(a,1),this._currentFrame=0===this._nextFrameIndex?0:ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._nextFrameIndex=this._durationTween>0?this._durationTween:1,this.movementEvent(this,ccs.MovementEventType.start,this._movementID);break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._toIndex=0,this.movementEvent(this._armature,ccs.MovementEventType.loopComplete,this._movementID)}this._currentPercent=a}},getCurrentMovementID:function(){return this._isComplete?"":this._movementID},setMovementEventCallFunc:function(a,b){1===arguments.length?this._movementEventListener=a:2===arguments.length&&(this._movementEventTarget=b,this._movementEventCallFunc=a)},setFrameEventCallFunc:function(a,b){1===arguments.length?this._frameEventListener=a:2===arguments.length&&(this._frameEventTarget=b,this._frameEventCallFunc=a)},setUserObject:function(a){this._userObject=a},frameEvent:function(a,b,c,d){if(this._frameEventTarget&&this._frameEventCallFunc||this._frameEventListener){var e=new ccs.FrameEvent;e.bone=a,e.frameEventName=b,e.originFrameIndex=c,e.currentFrameIndex=d,this._frameEventQueue.push(e)}},movementEvent:function(a,b,c){if(this._movementEventTarget&&this._movementEventCallFunc||this._movementEventListener){var d=new ccs.MovementEvent;d.armature=a,d.movementType=b,d.movementID=c,this._movementEventQueue.push(d)}},updateMovementList:function(){if(this._onMovementList){var a,b=this._movementList;this._movementListLoop?(a=b[this._movementIndex],this.play(a,a.durationTo,0),this._movementIndex++,this._movementIndex>=b.length&&(this._movementIndex=0)):this._movementIndex<b.length?(a=b[this._movementIndex],this.play(a,a.durationTo,0),this._movementIndex++):this._onMovementList=!1,this._onMovementList=!0}},setAnimationData:function(a){this._animationData!==a&&(this._animationData=a)},getAnimationData:function(){return this._animationData},getUserObject:function(){return this._userObject},isIgnoreFrameEvent:function(){return this._ignoreFrameEvent}});var _p=ccs.ArmatureAnimation.prototype;_p.speedScale,cc.defineGetterSetter(_p,"speedScale",_p.getSpeedScale,_p.setSpeedScale),_p.animationScale,cc.defineGetterSetter(_p,"animationScale",_p.getAnimationScale,_p.setAnimationScale),_p=null,ccs.ArmatureAnimation.create=function(a){return new ccs.ArmatureAnimation(a)},ccs.Tween=ccs.ProcessBase.extend({_tweenData:null,_to:null,_from:null,_between:null,_movementBoneData:null,_bone:null,_frameTweenEasing:0,_betweenDuration:0,_totalDuration:0,_toIndex:0,_fromIndex:0,_animation:null,_passLastFrame:!1,ctor:function(a){ccs.ProcessBase.prototype.ctor.call(this),this._frameTweenEasing=ccs.TweenType.LINEAR,ccs.Tween.prototype.init.call(this,a)},init:function(a){return this._from=new ccs.FrameData,this._between=new ccs.FrameData,this._bone=a,this._tweenData=this._bone.getTweenData(),this._tweenData.displayIndex=-1,this._animation=null!==this._bone&&null!==this._bone.getArmature()?this._bone.getArmature().getAnimation():null,!0},play:function(a,b,c,d,e){ccs.ProcessBase.prototype.play.call(this,b,c,d,e),this._loopType=d?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;var f=a!==this._movementBoneData;this.setMovementBoneData(a),this._rawDuration=this._movementBoneData.duration;var g=this._movementBoneData.getFrameData(0);this._tweenData.displayIndex=g.displayIndex,this._bone.getArmature().getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeSub(this._tweenData,this._bone.getBoneData()),this._tweenData.scaleX+=1,this._tweenData.scaleY+=1),0===this._rawDuration?(this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME,0===b?this.setBetween(g,g):this.setBetween(this._tweenData,g),this._frameTweenEasing=ccs.TweenType.LINEAR):this._movementBoneData.frameList.length>1&&(this._durationTween=c*this._movementBoneData.scale,d&&0!==this._movementBoneData.delay?this.setBetween(this._tweenData,this.tweenNodeTo(this.updateFrameData(1-this._movementBoneData.delay),this._between)):f&&0!==b?this.setBetween(this._tweenData,g):this.setBetween(g,g)),this.tweenNodeTo(0)},gotoAndPlay:function(a){ccs.ProcessBase.prototype.gotoFrame.call(this,a),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0,this._isPlaying=!0,this._isComplete=this._isPause=!1,this._currentPercent=this._curFrameIndex/(this._rawDuration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent},gotoAndPause:function(a){this.gotoAndPlay(a),this.pause()},updateHandler:function(){var a=null==this._currentPercent?1:this._currentPercent,b=this._loopType;if(a>=1)switch(b){case ccs.ANIMATION_TYPE_SINGLE_FRAME:a=1,this._isComplete=!0,this._isPlaying=!1;break;case ccs.ANIMATION_TYPE_NO_LOOP:if(b=ccs.ANIMATION_TYPE_MAX,a=this._durationTween<=0?1:(a-1)*this._nextFrameIndex/this._durationTween,a>=1){a=1,this._isComplete=!0,this._isPlaying=!1;break}this._nextFrameIndex=this._durationTween,this._currentFrame=a*this._nextFrameIndex,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:b=ccs.ANIMATION_TYPE_LOOP_FRONT,this._nextFrameIndex=this._durationTween>0?this._durationTween:1,0!==this._movementBoneData.delay?(this._currentFrame=(1-this._movementBoneData.delay)*this._nextFrameIndex,a=this._currentFrame/this._nextFrameIndex):(a=0,this._currentFrame=0),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_MAX:a=1,this._isComplete=!0,this._isPlaying=!1;break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex)}1>a&&b<ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(a=Math.sin(a*cc.PI/2)),this._currentPercent=a,this._loopType=b,b>ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(a=this.updateFrameData(a)),this._frameTweenEasing!==ccs.TweenType.TWEEN_EASING_MAX&&this.tweenNodeTo(a)},setBetween:function(a,b,c){void 0===c&&(c=!0);do{if(a.displayIndex<0&&b.displayIndex>=0){this._from.copy(b),this._between.subtract(b,b,c);break}if(b.displayIndex<0&&a.displayIndex>=0){this._from.copy(a),this._between.subtract(b,b,c);break}this._from.copy(a),this._between.subtract(a,b,c)}while(0);a.isTween||(this._tweenData.copy(a),this._tweenData.isTween=!0),this.arriveKeyFrame(a)},arriveKeyFrame:function(a){if(a){var b=this._bone,c=b.getDisplayManager(),d=a.displayIndex;c.getForceChangeDisplay()||c.changeDisplayWithIndex(d,!1),this._tweenData.zOrder=a.zOrder,b.updateZOrder(),this._bone.setBlendFunc(a.blendFunc);var e=b.getChildArmature();e&&""!==a.movement&&e.getAnimation().play(a.movement)}},tweenNodeTo:function(a,b){b||(b=this._tweenData);var c=this._from,d=this._between;return c.isTween||(a=0),b.x=c.x+a*d.x,b.y=c.y+a*d.y,b.scaleX=c.scaleX+a*d.scaleX,b.scaleY=c.scaleY+a*d.scaleY,b.skewX=c.skewX+a*d.skewX,b.skewY=c.skewY+a*d.skewY,this._bone.setTransformDirty(!0),b&&d.isUseColorInfo&&this.tweenColorTo(a,b),b},tweenColorTo:function(a,b){var c=this._from,d=this._between;b.a=c.a+a*d.a,b.r=c.r+a*d.r,b.g=c.g+a*d.g,b.b=c.b+a*d.b,this._bone.updateColor()},updateFrameData:function(a){a>1&&0!==this._movementBoneData.delay&&(a=ccs.fmodf(a,1));var b,c,d=(this._rawDuration-1)*a,e=this._totalDuration,f=this._betweenDuration,g=this._toIndex;if(e>d||d>=e+f){var h=this._movementBoneData.frameList,i=h.length;if(d<h[0].frameID)return b=c=h[0],this.setBetween(b,c),this._currentPercent;if(d>=h[i-1].frameID){if(this._passLastFrame)return b=c=h[i-1],this.setBetween(b,c),this._currentPercent;this._passLastFrame=!0}else this._passLastFrame=!1;do if(this._fromIndex=g,b=h[this._fromIndex],e=b.frameID,g=this._fromIndex+1,g>=i&&(g=0),c=h[g],b.strEvent&&!this._animation.isIgnoreFrameEvent()&&this._animation.frameEvent(this._bone,b.strEvent,b.frameID,d),d===b.frameID||this._passLastFrame&&this._fromIndex===i-1)break;while(d<b.frameID||d>=c.frameID);f=c.frameID-b.frameID,this._frameTweenEasing=b.tweenEasing,this.setBetween(b,c,!1),this._totalDuration=e,this._betweenDuration=f,this._toIndex=g}a=0===f?0:(d-this._totalDuration)/this._betweenDuration;var j=this._frameTweenEasing!==ccs.TweenType.LINEAR?this._frameTweenEasing:this._tweenEasing;return j===ccs.TweenType.TWEEN_EASING_MAX||j===ccs.TweenType.LINEAR||this._passLastFrame||(a=ccs.TweenFunction.tweenTo(a,j,this._from.easingParams)),a},setAnimation:function(a){this._animation=a},getAnimation:function(){return this._animation},setMovementBoneData:function(a){this._movementBoneData=a}});var _p=ccs.Tween.prototype;_p.animation,cc.defineGetterSetter(_p,"animation",_p.getAnimation,_p.setAnimation),_p=null,ccs.Tween.create=function(a){return new ccs.Tween(a)},ccs.PT_RATIO=32,ccs.ColliderFilter=ccs.Class.extend({_collisionType:0,_group:0,_categoryBits:0,_groupIndex:0,_maskBits:0,ctor:function(a,b){this._collisionType=a||0,this._group=b||0},updateShape:function(a){if(a instanceof cp.Shape)a.collision_type=this._collisionType,a.group=this._group;else if(a instanceof Box2D.b2FilterData){var b=new Box2D.b2FilterData;b.categoryBits=this._categoryBits,b.groupIndex=this._groupIndex,b.maskBits=this._maskBits,a.SetFilterData(b)}}}),ccs.ColliderBody=ccs.Class.extend({shape:null,coutourData:null,colliderFilter:null,_calculatedVertexList:null,ctor:function(a){this.shape=null,this.coutourData=a,this.colliderFilter=new ccs.ColliderFilter,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX&&(this._calculatedVertexList=[])},getContourData:function(){return this.coutourData},setColliderFilter:function(a){this.colliderFilter=a},getCalculatedVertexList:function(){return this._calculatedVertexList},setB2Fixture:function(a){this._fixture=a},getB2Fixture:function(){return this._fixture},setShape:function(a){this.shape=a},getShape:function(){return this.shape},setContourData:function(a){this.coutourData=a},getColliderFilter:function(){return this.colliderFilter}}),ccs.ColliderDetector=ccs.Class.extend({_colliderBodyList:null,_bone:null,_body:null,_active:!1,_filter:null,helpPoint:cc.p(0,0),ctor:function(a){this._colliderBodyList=[],this._bone=null,this._body=null,this._active=!1,this._filter=null,ccs.ColliderDetector.prototype.init.call(this,a)},init:function(a){return this._colliderBodyList.length=0,a&&(this._bone=a),this._filter=new ccs.ColliderFilter,!0},addContourData:function(a){var b=new ccs.ColliderBody(a);if(this._colliderBodyList.push(b),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)for(var c=b.getCalculatedVertexList(),d=a.vertexList,e=0;e<d.length;e++){var f=new ccs.ContourVertex2(0,0);c.push(f)}},addContourDataList:function(a){for(var b=0;b<a.length;b++)this.addContourData(a[b])},removeContourData:function(a){var b,c=[],d=this._colliderBodyList;for(b=0;b<d.length;b++){var e=d[b];e&&e.getContourData()===a&&c.push(e)}for(b=0;b<c.length;b++)cc.arrayRemoveObject(d,c[b])},removeAll:function(){this._colliderBodyList.length=0},setActive:function(a){if(this._active!==a){this._active=a;var b,c=this._body;if(c){var d=null;if(this._active)for(var e=0;e<this._colliderBodyList.length;e++)d=this._colliderBodyList[e],b=d.getShape(),c.space.addShape(b);else for(var e=0;e<this._colliderBodyList.length;e++)d=this._colliderBodyList[e],b=d.getShape(),c.space.removeShape(b)}}},getActive:function(){return this._active},getColliderBodyList:function(){return this._colliderBodyList},setColliderFilter:function(a){this._filter=a;for(var b=this._colliderBodyList,c=0;c<b.length;c++){var d=b[c];d.setColliderFilter(a),d.getShape()&&d.getColliderFilter().updateShape(d.getShape())}},getColliderFilter:function(){return this._filter},updateTransform:function(a){if(this._active)for(var b=null,c=this._body,d=this.helpPoint,e=0;e<this._colliderBodyList.length;e++){b=this._colliderBodyList[e];var f=b.getContourData(),g=null;c&&(g=b.getShape());for(var h=f.vertexList,i=b.getCalculatedVertexList(),j=0;j<h.length;j++){if(d.x=h[j].x,d.y=h[j].y,d=cc.pointApplyAffineTransform(d,a),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX){var k=cc.p(0,0);k.x=d.x,k.y=d.y,i[j]=k}g&&(g.verts[2*j]=d.x,g.verts[2*j+1]=d.y)}if(g)for(var j=0;j<h.length;j++){var l=g.verts[(j+1)%g.verts.length],m=cp.v.normalize(cp.v.perp(cp.v.sub(l,g.verts[j])));g.planes&&(g.planes[j].n=m,g.planes[j].d=cp.v.dot(m,g.verts[j]))}}},setBody:function(a){this._body=a;for(var b,c=this._colliderBodyList,d=0;d<c.length;d++){b=c[d];for(var e=b.getContourData(),f=[],g=e.vertexList,h=0;h<g.length;h++){var i=g[h];f.push(i.x),f.push(i.y)}var j=new cp.PolyShape(this._body,f,cp.vzero);j.sensor=!0,j.data=this._bone,this._active&&this._body.space.addShape(j),b.setShape(j),b.getColliderFilter().updateShape(j)}},getBody:function(){return this._body}});var _p=ccs.ColliderDetector.prototype;_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p.active,cc.defineGetterSetter(_p,"active",_p.getActive,_p.setActive),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p=null,ccs.ColliderDetector.create=function(a){return new ccs.ColliderDetector(a)},ccs.Armature=ccs.Node.extend({animation:null,armatureData:null,batchNode:null,_textureAtlas:null,_parentBone:null,_boneDic:null,_topBoneList:null,_armatureIndexDic:null,_offsetPoint:null,version:0,_armatureTransformDirty:!0,_body:null,_blendFunc:null,_className:"Armature",ctor:function(a,b){cc.Node.prototype.ctor.call(this),this._name="",this._topBoneList=[],this._armatureIndexDic={},this._offsetPoint=cc.p(0,0),this._armatureTransformDirty=!0,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},a&&ccs.Armature.prototype.init.call(this,a,b)},init:function(a,b){cc.Node.prototype.init.call(this),b&&(this._parentBone=b),this.removeAllChildren(),this.animation=new ccs.ArmatureAnimation,this.animation.init(this),this._boneDic={},this._topBoneList.length=0;var c,d=ccs.armatureDataManager;if(""!==a){c=d.getAnimationData(a),cc.assert(c,"AnimationData not exist!"),this.animation.setAnimationData(c);var e=d.getArmatureData(a);cc.assert(e,"ArmatureData not exist!"),this.armatureData=e;var f=e.getBoneDataDic();for(var g in f){var h=this.createBone(String(g));do{var i=c.getMovement(c.movementNames[0]);if(!i)break;var j=i.getMovementBoneData(h.getName());if(!j||j.frameList.length<=0)break;var k=j.getFrameData(0);if(!k)break;h.getTweenData().copy(k),h.changeDisplayWithIndex(k.displayIndex,!1)}while(0)}this.update(0),this.updateOffsetPoint()}else a="new_armature",this.armatureData=new ccs.ArmatureData,this.armatureData.name=a,c=new ccs.AnimationData,c.name=a,d.addArmatureData(a,this.armatureData),d.addAnimationData(a,c),this.animation.setAnimationData(c);return this._renderCmd.initShaderCache(),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),!0},addChild:function(a,b,c){return a instanceof ccui.Widget?void cc.log("Armature doesn't support to add Widget as its child, it will be fix soon."):void cc.Node.prototype.addChild.call(this,a,b,c)},createBone:function(a){var b=this.getBone(a);if(b)return b;var c=this.armatureData.getBoneData(a),d=c.parentName,e=null;return d?(this.createBone(d),e=new ccs.Bone(a),this.addBone(e,d)):(e=new ccs.Bone(a),this.addBone(e,"")),e.setBoneData(c),e.getDisplayManager().changeDisplayWithIndex(-1,!1),e},addBone:function(a,b){cc.assert(a,"Argument must be non-nil");var c=this._boneDic;if(a.getName()&&cc.assert(!c[a.getName()],"bone already added. It can't be added again"),b){var d=c[b];d?d.addChildBone(a):this._topBoneList.push(a)}else this._topBoneList.push(a);a.setArmature(this),c[a.getName()]=a,this.addChild(a)},removeBone:function(a,b){cc.assert(a,"bone must be added to the bone dictionary!"),a.setArmature(null),a.removeFromParent(b),cc.arrayRemoveObject(this._topBoneList,a),delete this._boneDic[a.getName()],this.removeChild(a,!0)},getBone:function(a){return this._boneDic[a]},changeBoneParent:function(a,b){cc.assert(a,"bone must be added to the bone dictionary!");var c=a.getParentBone();if(c&&(cc.arrayRemoveObject(c.getChildren(),a),a.setParentBone(null)),b){var d=this._boneDic[b];d?(d.addChildBone(a),cc.arrayRemoveObject(this._topBoneList,a)):this._topBoneList.push(a)}},getBoneDic:function(){return this._boneDic},updateOffsetPoint:function(){var a=this.getBoundingBox();this.setContentSize(a);var b=this._offsetPoint;b.x=-a.x,b.y=-a.y,0!==a.width&&0!==a.height&&this.setAnchorPoint(b.x/a.width,b.y/a.height)},getOffsetPoints:function(){return{x:this._offsetPoint.x,y:this._offsetPoint.y}},setAnimation:function(a){this.animation=a},getAnimation:function(){return this.animation},getArmatureTransformDirty:function(){return this._armatureTransformDirty},update:function(a){this.animation.update(a);for(var b=this._topBoneList,c=0;c<b.length;c++)b[c].update(a);this._armatureTransformDirty=!1},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){cc.Node.prototype.onExit.call(this),this.unscheduleUpdate()},getBoundingBox:function(){for(var a,b,c,d=0,e=!0,f=cc.rect(0,0,0,0),g=this._children,h=g.length,i=0;h>i;i++){var j=g[i];if(j){var k=j.getDisplayManager().getBoundingBox();if(0===k.x&&0===k.y&&0===k.width&&0===k.height)continue;e?(a=k.x,b=k.y,c=k.x+k.width,d=k.y+k.height,e=!1):(a=k.x<f.x?k.x:f.x,b=k.y<f.y?k.y:f.y,c=k.x+k.width>f.x+f.width?k.x+k.width:f.x+f.width,d=k.y+k.height>f.y+f.height?k.y+k.height:f.y+f.height),f.x=a,f.y=b,f.width=c-a,f.height=d-b}}return cc.rectApplyAffineTransform(f,this.getNodeToParentTransform())},getBoneAtPoint:function(a,b){for(var c=this._children,d=c.length-1;d>=0;d--){var e=c[d];if(e instanceof ccs.Bone&&e.getDisplayManager().containPoint(a,b))return e}return null},setParentBone:function(a){this._parentBone=a;var b=this._boneDic;for(var c in b)b[c].setArmature(this)},getParentBone:function(){return this._parentBone},drawContour:function(){cc._drawingUtil.setDrawColor(255,255,255,255),cc._drawingUtil.setLineWidth(1);var a=this._boneDic;for(var b in a){var c=a[b],d=c.getColliderDetector();if(d)for(var e=d.getColliderBodyList(),f=0;f<e.length;f++){var g=e[f],h=g.getCalculatedVertexList();cc._drawingUtil.drawPoly(h,h.length,!0)}}},setBody:function(a){if(this._body!==a){this._body=a,this._body.data=this;for(var b,c,d=this._children,e=0;e<d.length;e++)if(b=d[e],b instanceof ccs.Bone)for(var f=b.getDisplayManager().getDecorativeDisplayList(),g=0;g<f.length;g++){c=f[g];var h=c.getColliderDetector();h&&h.setBody(this._body)}}},getShapeList:function(){return this._body?this._body.shapeList:null},getBody:function(){return this._body},setBlendFunc:function(a,b){void 0===b?(this._blendFunc.src=a.src,this._blendFunc.dst=a.dst):(this._blendFunc.src=a,this._blendFunc.dst=b)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setColliderFilter:function(a){var b=this._boneDic;for(var c in b)b[c].setColliderFilter(a)},getArmatureData:function(){return this.armatureData},setArmatureData:function(a){this.armatureData=a},getBatchNode:function(){return this.batchNode},setBatchNode:function(a){this.batchNode=a},getVersion:function(){return this.version},setVersion:function(a){this.version=a},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new ccs.Armature.CanvasRenderCmd(this):new ccs.Armature.WebGLRenderCmd(this);
}});var _p=ccs.Armature.prototype;_p.parentBone,cc.defineGetterSetter(_p,"parentBone",_p.getParentBone,_p.setParentBone),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",null,_p.setColliderFilter),_p=null,ccs.Armature.create=function(a,b){return new ccs.Armature(a,b)},function(){ccs.Armature.RenderCmd={_updateAnchorPointInPoint:function(){var a=this._node,b=a._contentSize,c=a._anchorPoint,d=a._offsetPoint;this._anchorPointInPoints.x=b.width*c.x-d.x,this._anchorPointInPoints.y=b.height*c.y-d.y,this._realAnchorPointInPoints.x=b.width*c.x,this._realAnchorPointInPoints.y=b.height*c.y,this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getAnchorPointInPoints:function(){return cc.p(this._realAnchorPointInPoints)}}}(),function(){ccs.Armature.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a),this._needDraw=!0,this._realAnchorPointInPoints=new cc.Point(0,0),this._startRenderCmd=new cc.CustomRenderCmd(this,this._startCmdCallback),this._RestoreRenderCmd=new cc.CustomRenderCmd(this,this._RestoreCmdCallback)};var a=ccs.Armature.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Armature.RenderCmd,a),a.constructor=ccs.Armature.CanvasRenderCmd,a._startCmdCallback=function(a,b,c){var d=this._node,e=d._parent;this.transform(e?e._renderCmd:null);var f=a||cc._renderContext;f.save(),f._switchToArmatureMode(!0,this._worldTransform,b,c)},a.transform=function(a,b){ccs.Node.CanvasRenderCmd.prototype.transform.call(this,a,b);for(var c=this._node._children,d=0,e=c.length;e>d;d++){var f=c[d];if(f&&f.getDisplayRenderNode){var g=f.getDisplayRenderNode();if(g&&g._renderCmd){var h=g._renderCmd;h.transform(null);var i=f._renderCmd._displayedColor,j=f._renderCmd._displayedOpacity,k=cc.Node._dirtyFlags,l=h._dirtyFlag,m=l&k.colorDirty,n=l&k.opacityDirty;m&&h._updateDisplayColor(i),n&&h._updateDisplayOpacity(j)}}}},a._RestoreCmdCallback=function(a){this._cacheDirty=!1,a._switchToArmatureMode(!1),a.restore()},a.initShaderCache=function(){},a.setShaderProgram=function(){},a.updateChildPosition=function(a,b){a.visit()},a.rendering=function(a,b,c){for(var d=this._node,e=d._children,f=cc.BlendFunc.ALPHA_PREMULTIPLIED,g=cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,h=0,i=e.length;i>h;h++){var j=e[h];if(j&&j.getDisplayRenderNode){var k=j.getDisplayRenderNode();if(null===k)continue;switch(j.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:k instanceof ccs.Skin&&this.updateChildPosition(k,j,f,g);break;case ccs.DISPLAY_TYPE_ARMATURE:k._renderCmd.rendering(a,b,c);break;default:k.visit(this)}}else j instanceof cc.Node&&this._visitNormalChild(j)}},a._visitNormalChild=function(a){if(null!=a){var b=a._renderCmd;if(a._visible){b._curLevel=this._curLevel+1;var c,d,e=a._children;b._syncStatus(this),b.transform(null);var f=e.length;if(f>0){for(a.sortAllChildren(),c=0;f>c&&(d=e[c],d._localZOrder<0);c++)d._renderCmd.visit(b);for(cc.renderer.pushRenderCommand(b);f>c;c++)e[c]._renderCmd.visit(b)}else cc.renderer.pushRenderCommand(b);this._dirtyFlag=0}}},a.visit=function(a){var b=this._node;b._visible&&(this.updateStatus(a),b.sortAllChildren(),cc.renderer.pushRenderCommand(this._startRenderCmd),this.rendering(),cc.renderer.pushRenderCommand(this._RestoreRenderCmd),this._cacheDirty=!1)}}(),ccs.Bone=ccs.Node.extend({_boneData:null,_armature:null,_childArmature:null,_displayManager:null,ignoreMovementBoneData:!1,_tween:null,_tweenData:null,_parentBone:null,_boneTransformDirty:!1,_worldTransform:null,_blendFunc:null,blendDirty:!1,_worldInfo:null,_armatureParentBone:null,_dataVersion:0,_className:"Bone",ctor:function(a){cc.Node.prototype.ctor.call(this),this._tweenData=null,this._parentBone=null,this._armature=null,this._childArmature=null,this._boneData=null,this._tween=null,this._displayManager=null,this.ignoreMovementBoneData=!1,this._worldTransform=cc.affineTransformMake(1,0,0,1,0,0),this._boneTransformDirty=!0,this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.blendDirty=!1,this._worldInfo=null,this._armatureParentBone=null,this._dataVersion=0,ccs.Bone.prototype.init.call(this,a)},init:function(a){return a&&(this._name=a),this._tweenData=new ccs.FrameData,this._tween=new ccs.Tween(this),this._displayManager=new ccs.DisplayManager(this),this._worldInfo=new ccs.BaseData,this._boneData=new ccs.BaseData,!0},setBoneData:function(a){cc.assert(a,"_boneData must not be null"),this._boneData!==a&&(this._boneData=a),this.setName(this._boneData.name),this._localZOrder=this._boneData.zOrder,this._displayManager.initDisplayList(a)},getBoneData:function(){return this._boneData},setArmature:function(a){this._armature=a,a?(this._tween.setAnimation(this._armature.getAnimation()),this._dataVersion=this._armature.getArmatureData().dataVersion,this._armatureParentBone=this._armature.getParentBone()):this._armatureParentBone=null},getArmature:function(){return this._armature},update:function(a){if(this._parentBone&&(this._boneTransformDirty=this._boneTransformDirty||this._parentBone.isTransformDirty()),this._armatureParentBone&&!this._boneTransformDirty&&(this._boneTransformDirty=this._armatureParentBone.isTransformDirty()),this._boneTransformDirty){var b=this._tweenData;this._dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeConcat(b,this._boneData),b.scaleX-=1,b.scaleY-=1);var c=this._worldInfo;c.copy(b),c.x=b.x+this._position.x,c.y=b.y+this._position.y,c.scaleX=b.scaleX*this._scaleX,c.scaleY=b.scaleY*this._scaleY,c.skewX=b.skewX+this._skewX+cc.degreesToRadians(this._rotationX),c.skewY=b.skewY+this._skewY-cc.degreesToRadians(this._rotationY),this._parentBone?this._applyParentTransform(this._parentBone):this._armatureParentBone&&this._applyParentTransform(this._armatureParentBone),ccs.TransformHelp.nodeToMatrix(c,this._worldTransform),this._armatureParentBone&&(this._worldTransform=cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToParentTransform()))}ccs.displayFactory.updateDisplay(this,a,this._boneTransformDirty||this._armature.getArmatureTransformDirty());for(var d=0;d<this._children.length;d++){var e=this._children[d];e.update(a)}this._boneTransformDirty=!1},_applyParentTransform:function(a){var b=this._worldInfo,c=a._worldTransform,d=a._worldInfo,e=b.x,f=b.y;b.x=e*c.a+f*c.c+d.x,b.y=e*c.b+f*c.d+d.y,b.scaleX=b.scaleX*d.scaleX,b.scaleY=b.scaleY*d.scaleY,b.skewX=b.skewX+d.skewX,b.skewY=b.skewY+d.skewY},setBlendFunc:function(a,b){var c,d,e=this._blendFunc;void 0===b?(c=a.src,d=a.dst):(c=a,d=b),e.src===c&&e.dst===d||(e.src=c,e.dst=d,this.blendDirty=!0)},updateColor:function(){var a=this._displayManager.getDisplayRenderNode();if(null!==a){var b=this._renderCmd;a.setColor(cc.color(b._displayedColor.r*this._tweenData.r/255,b._displayedColor.g*this._tweenData.g/255,b._displayedColor.b*this._tweenData.b/255)),a.setOpacity(b._displayedOpacity*this._tweenData.a/255)}},updateZOrder:function(){this._armature.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?this.setLocalZOrder(this._tweenData.zOrder+this._boneData.zOrder):this.setLocalZOrder(this._tweenData.zOrder)},addChildBone:function(a){cc.assert(a,"Argument must be non-nil"),cc.assert(!a.parentBone,"child already added. It can't be added again"),this._children.indexOf(a)<0&&(this._children.push(a),a.setParentBone(this))},removeChildBone:function(a,b){if(this._children.length>0&&-1!==this._children.getIndex(a)){if(b)for(var c=a._children,d=0;d<c.length;d++){var e=c[d];a.removeChildBone(e,b)}a.setParentBone(null),a.getDisplayManager().setCurrentDecorativeDisplay(null),cc.arrayRemoveObject(this._children,a)}},removeFromParent:function(a){this._parentBone&&this._parentBone.removeChildBone(this,a)},setParentBone:function(a){this._parentBone=a},getParentBone:function(){return this._parentBone},setChildArmature:function(a){this._childArmature!==a&&(null==a&&this._childArmature&&this._childArmature.setParentBone(null),this._childArmature=a)},getChildArmature:function(){return this._childArmature},getTween:function(){return this._tween},setLocalZOrder:function(a){this._localZOrder!==a&&cc.Node.prototype.setLocalZOrder.call(this,a)},getNodeToArmatureTransform:function(){return this._worldTransform},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToWorldTransform())},getDisplayRenderNode:function(){return this._displayManager.getDisplayRenderNode()},getDisplayRenderNodeType:function(){return this._displayManager.getDisplayRenderNodeType()},addDisplay:function(a,b){return b=b||0,this._displayManager.addDisplay(a,b)},removeDisplay:function(a){this._displayManager.removeDisplay(a)},changeDisplayByIndex:function(a,b){cc.log("changeDisplayByIndex is deprecated. Use changeDisplayWithIndex instead."),this.changeDisplayWithIndex(a,b)},changeDisplayByName:function(a,b){cc.log("changeDisplayByName is deprecated. Use changeDisplayWithName instead."),this.changeDisplayWithName(a,b)},changeDisplayWithIndex:function(a,b){this._displayManager.changeDisplayWithIndex(a,b)},changeDisplayWithName:function(a,b){this._displayManager.changeDisplayWithName(a,b)},getColliderDetector:function(){var a=this._displayManager.getCurrentDecorativeDisplay();if(a){var b=a.getColliderDetector();if(b)return b}return null},setColliderFilter:function(a){for(var b=this._displayManager.getDecorativeDisplayList(),c=0;c<b.length;c++){var d=b[c],e=d.getColliderDetector();e&&e.setColliderFilter(a)}},getColliderFilter:function(){var a=this.displayManager.getCurrentDecorativeDisplay();if(a){var b=a.getColliderDetector();if(b)return b.getColliderFilter()}return null},setTransformDirty:function(a){this._boneTransformDirty=a},isTransformDirty:function(){return this._boneTransformDirty},getDisplayManager:function(){return this._displayManager},setIgnoreMovementBoneData:function(a){this._ignoreMovementBoneData=a},isIgnoreMovementBoneData:function(){return this._ignoreMovementBoneData},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setBlendDirty:function(a){this._blendDirty=a},isBlendDirty:function(){return this._blendDirty},getTweenData:function(){return this._tweenData},getWorldInfo:function(){return this._worldInfo},getChildrenBone:function(){return this._children},nodeToArmatureTransform:function(){return this.getNodeToArmatureTransform()},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getColliderBodyList:function(){var a=this.getColliderDetector();return a?a.getColliderBodyList():null},getIgnoreMovementBoneData:function(){return this.isIgnoreMovementBoneData()},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new ccs.Bone.CanvasRenderCmd(this):new ccs.Bone.WebGLRenderCmd(this)}});var _p=ccs.Bone.prototype;_p.boneData,cc.defineGetterSetter(_p,"boneData",_p.getBoneData,_p.setBoneData),_p.armature,cc.defineGetterSetter(_p,"armature",_p.getArmature,_p.setArmature),_p.childArmature,cc.defineGetterSetter(_p,"childArmature",_p.getChildArmature,_p.setChildArmature),_p.childrenBone,cc.defineGetterSetter(_p,"childrenBone",_p.getChildrenBone),_p.tween,cc.defineGetterSetter(_p,"tween",_p.getTween),_p.tweenData,cc.defineGetterSetter(_p,"tweenData",_p.getTweenData),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p=null,ccs.Bone.create=function(a){return new ccs.Bone(a)},ccs.Bone.RenderCmd={_updateColor:function(){var a=this._node,b=a._displayManager.getDisplayRenderNode();if(null!==b){var c=b._renderCmd;b.setColor(cc.color(a._tweenData.r,a._tweenData.g,a._tweenData.g)),b.setOpacity(a._tweenData.a),c._syncDisplayColor(this._displayedColor),c._syncDisplayOpacity(this._displayedOpacity),c._updateColor()}}},function(){ccs.Bone.CanvasRenderCmd=function(a){cc.Node.CanvasRenderCmd.call(this,a),this._needDraw=!1};var a=ccs.Bone.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Bone.RenderCmd,a),a.constructor=ccs.Bone.CanvasRenderCmd}(),function(){if(cc.Node.WebGLRenderCmd){ccs.Bone.WebGLRenderCmd=function(a){cc.Node.WebGLRenderCmd.call(this,a),this._needDraw=!1};var a=ccs.Bone.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(ccs.Bone.RenderCmd,a),a.constructor=ccs.Bone.WebGLRenderCmd}}(),ccs.FRAME_TYPE_MOVE=0,ccs.FRAME_TYPE_SCALE=1,ccs.FRAME_TYPE_ROTATE=2,ccs.FRAME_TYPE_TINT=3,ccs.FRAME_TYPE_FADE=4,ccs.FRAME_TYPE_MAX=5,ccs.FrameEaseType={CUSTOM:-1,LINEAR:0,SINE_EASEIN:1,SINE_EASEOUT:2,SINE_EASEINOUT:3,QUAD_EASEIN:4,QUAD_EASEOUT:5,QUAD_EASEINOUT:6,CUBIC_EASEIN:7,CUBIC_EASEOUT:8,CUBIC_EASEINOUT:9,QUART_EASEIN:10,QUART_EASEOUT:11,QUART_EASEINOUT:12,QUINT_EASEIN:13,QUINT_EASEOUT:14,QUINT_EASEINOUT:15,EXPO_EASEIN:16,EXPO_EASEOUT:17,EXPO_EASEINOUT:18,CIRC_EASEIN:19,CIRC_EASEOUT:20,CIRC_EASEINOUT:21,ELASTIC_EASEIN:22,ELASTIC_EASEOUT:23,ELASTIC_EASEINOUT:24,BACK_EASEIN:25,BACK_EASEOUT:26,BACK_EASEINOUT:27,BOUNCE_EASEIN:28,BOUNCE_EASEOUT:29,BOUNCE_EASEINOUT:30,TWEEN_EASING_MAX:1e3},ccs.ActionFrame=ccs.Class.extend({frameType:0,easingType:0,frameIndex:0,_Parameter:null,time:0,ctor:function(){this.frameType=0,this.easingType=ccs.FrameEaseType.LINEAR,this.frameIndex=0,this.time=0},getAction:function(a,b){return cc.log("Need a definition of <getAction> for ActionFrame"),null},_getEasingAction:function(a){if(null===a)return console.error("Action cannot be null!"),null;var b;switch(this.easingType){case ccs.FrameEaseType.CUSTOM:break;case ccs.FrameEaseType.LINEAR:b=a;break;case ccs.FrameEaseType.SINE_EASEIN:b=a.easing(cc.easeSineIn());break;case ccs.FrameEaseType.SINE_EASEOUT:b=a.easing(cc.easeSineOut());break;case ccs.FrameEaseType.SINE_EASEINOUT:b=a.easing(cc.easeSineInOut());break;case ccs.FrameEaseType.QUAD_EASEIN:b=a.easing(cc.easeQuadraticActionIn());break;case ccs.FrameEaseType.QUAD_EASEOUT:b=a.easing(cc.easeQuadraticActionOut());break;case ccs.FrameEaseType.QUAD_EASEINOUT:b=a.easing(cc.easeQuadraticActionInOut());break;case ccs.FrameEaseType.CUBIC_EASEIN:b=a.easing(cc.easeCubicActionIn());break;case ccs.FrameEaseType.CUBIC_EASEOUT:b=a.easing(cc.easeCubicActionOut());break;case ccs.FrameEaseType.CUBIC_EASEINOUT:b=a.easing(cc.easeCubicActionInOut());break;case ccs.FrameEaseType.QUART_EASEIN:b=a.easing(cc.easeQuarticActionIn());break;case ccs.FrameEaseType.QUART_EASEOUT:b=a.easing(cc.easeQuarticActionOut());break;case ccs.FrameEaseType.QUART_EASEINOUT:b=a.easing(cc.easeQuarticActionInOut());break;case ccs.FrameEaseType.QUINT_EASEIN:b=a.easing(cc.easeQuinticActionIn());break;case ccs.FrameEaseType.QUINT_EASEOUT:b=a.easing(cc.easeQuinticActionOut());break;case ccs.FrameEaseType.QUINT_EASEINOUT:b=a.easing(cc.easeQuinticActionInOut());break;case ccs.FrameEaseType.EXPO_EASEIN:b=a.easing(cc.easeExponentialIn());break;case ccs.FrameEaseType.EXPO_EASEOUT:b=a.easing(cc.easeExponentialOut());break;case ccs.FrameEaseType.EXPO_EASEINOUT:b=a.easing(cc.easeExponentialInOut());break;case ccs.FrameEaseType.CIRC_EASEIN:b=a.easing(cc.easeCircleActionIn());break;case ccs.FrameEaseType.CIRC_EASEOUT:b=a.easing(cc.easeCircleActionOut());break;case ccs.FrameEaseType.CIRC_EASEINOUT:b=a.easing(cc.easeCircleActionInOut());break;case ccs.FrameEaseType.ELASTIC_EASEIN:b=a.easing(cc.easeElasticIn());break;case ccs.FrameEaseType.ELASTIC_EASEOUT:b=a.easing(cc.easeElasticOut());break;case ccs.FrameEaseType.ELASTIC_EASEINOUT:b=a.easing(cc.easeElasticInOut());break;case ccs.FrameEaseType.BACK_EASEIN:b=a.easing(cc.easeBackIn());break;case ccs.FrameEaseType.BACK_EASEOUT:b=a.easing(cc.easeBackOut());break;case ccs.FrameEaseType.BACK_EASEINOUT:b=a.easing(cc.easeBackInOut());break;case ccs.FrameEaseType.BOUNCE_EASEIN:b=a.easing(cc.easeBounceIn());break;case ccs.FrameEaseType.BOUNCE_EASEOUT:b=a.easing(cc.easeBounceOut());break;case ccs.FrameEaseType.BOUNCE_EASEINOUT:b=a.easing(cc.easeBounceInOut())}return b},setEasingParameter:function(a){this._Parameter=[];for(var b=0;b<a.length;b++)this._Parameter.push(a[b])},setEasingType:function(a){this.easingType=a}}),ccs.ActionMoveFrame=ccs.ActionFrame.extend({_position:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._position=cc.p(0,0),this.frameType=ccs.FRAME_TYPE_MOVE},setPosition:function(a,b){void 0===b?(this._position.x=a.x,this._position.y=a.y):(this._position.x=a,this._position.y=b)},getPosition:function(){return this._position},getAction:function(a){return this._getEasingAction(cc.moveTo(a,this._position))}}),ccs.ActionScaleFrame=ccs.ActionFrame.extend({_scaleX:1,_scaleY:1,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1,this.frameType=ccs.FRAME_TYPE_SCALE},setScaleX:function(a){this._scaleX=a},getScaleX:function(){return this._scaleX},setScaleY:function(a){this._scaleY=a},getScaleY:function(){return this._scaleY},getAction:function(a){return this._getEasingAction(cc.scaleTo(a,this._scaleX,this._scaleY))}}),ccs.ActionRotationFrame=ccs.ActionFrame.extend({_rotation:0,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._rotation=0,this.frameType=ccs.FRAME_TYPE_ROTATE},setRotation:function(a){this._rotation=a},getRotation:function(){return this._rotation},getAction:function(a,b){if(void 0===b)return this._getEasingAction(cc.rotateTo(a,this._rotation));if(b instanceof cc.ActionRotationFrame){var c=this._rotation-b._rotation;return this._getEasingAction(cc.rotateBy(a,c))}return this.getAction(a)}}),ccs.ActionFadeFrame=ccs.ActionFrame.extend({_opacity:255,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._opacity=255,this.frameType=ccs.FRAME_TYPE_FADE},setOpacity:function(a){this._opacity=a},getOpacity:function(){return this._opacity},getAction:function(a){return this._getEasingAction(cc.fadeTo(a,this._opacity))}}),ccs.ActionTintFrame=ccs.ActionFrame.extend({_color:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._color=cc.color(255,255,255,255),this.frameType=ccs.FRAME_TYPE_TINT},setColor:function(a){var b=this._color;b.r=a.r,b.g=a.g,b.b=a.b},getColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,a.a)},getAction:function(a){return this._getEasingAction(cc.tintTo(a,this._color.r,this._color.g,this._color.b))}}),ccs.actionManager={_actionDic:{},initWithDictionary:function(a,b,c){for(var d=a,e=d.lastIndexOf("/"),f=d.substr(e+1,d.length),g=b.actionlist,h=[],i=0;i<g.length;i++){var j=new ccs.ActionObject,k=g[i];j.initWithDictionary(k,c),h.push(j)}this._actionDic[f]=h},getActionByName:function(a,b){var c=a,d=c.lastIndexOf("/"),e=c.substr(d+1,c.length),f=this._actionDic[e];if(!f)return null;for(var g=0;g<f.length;g++){var h=f[g];if(b===h.getName())return h}return null},playActionByName:function(a,b,c){var d=this.getActionByName(a,b);d&&d.play(c)},stopActionByName:function(a,b){var c=this.getActionByName(a,b);c&&c.stop()},releaseActions:function(){this._actionDic={}},clear:function(){this._actionDic={}}},ccs.ActionNode=ccs.Class.extend({_currentFrameIndex:0,_destFrameIndex:0,_unitTime:0,_actionTag:0,_object:null,_actionSpawn:null,_action:null,_frameArray:null,_frameArrayNum:0,ctor:function(){this._currentFrameIndex=0,this._destFrameIndex=0,this._unitTime=.1,this._actionTag=0,this._object=null,this._actionSpawn=null,this._action=null,this._frameArray=[],this._frameArrayNum=ccs.FRAME_TYPE_MAX;for(var a=0;a<this._frameArrayNum;a++)this._frameArray.push([])},initWithDictionary:function(a,b){this.setActionTag(a.ActionTag);for(var c=a.actionframelist,d=ccui.helper.seekActionWidgetByActionTag(b,a.ActionTag),e=d instanceof ccui.Widget&&!(d instanceof ccui.Layout),f=0;f<c.length;f++){var g=c[f],h=g.frameid,i=g.tweenType;null==i&&(i=0);for(var j=g.tweenParameter,k=[],l=0;j>l;l++){var m=g.tweenParameter[l];k.push(m)}var n,o;if(void 0!==g.positionx){var p=g.positionx,q=g.positiony;if(e&&d.parent){var r=d.parent.getAnchorPointInPoints();p+=r.x,q+=r.y}n=new ccs.ActionMoveFrame,n.frameIndex=h,n.setEasingType(i),n.setEasingParameter(k),n.setPosition(p,q),o=this._frameArray[ccs.FRAME_TYPE_MOVE],o.push(n)}if(void 0!==g.scalex){var s=g.scalex,t=g.scaley;n=new ccs.ActionScaleFrame,n.frameIndex=h,n.setEasingType(i),n.setEasingParameter(k),n.setScaleX(s),n.setScaleY(t),o=this._frameArray[ccs.FRAME_TYPE_SCALE],o.push(n)}if(void 0!==g.rotation){var u=g.rotation;n=new ccs.ActionRotationFrame,n.frameIndex=h,n.setEasingType(i),n.setEasingParameter(k),n.setRotation(u),o=this._frameArray[ccs.FRAME_TYPE_ROTATE],o.push(n)}if(void 0!==g.opacity){var v=g.opacity;n=new ccs.ActionFadeFrame,n.frameIndex=h,n.setEasingType(i),n.setEasingParameter(k),n.setOpacity(v),o=this._frameArray[ccs.FRAME_TYPE_FADE],o.push(n)}if(void 0!==g.colorr){var w=g.colorr,x=g.colorg,y=g.colorb;n=new ccs.ActionTintFrame,n.frameIndex=h,n.setEasingType(i),n.setEasingParameter(k),n.setColor(cc.color(w,x,y)),o=this._frameArray[ccs.FRAME_TYPE_TINT],o.push(n)}g=null}this._initActionNodeFromRoot(b)},_initActionNodeFromRoot:function(a){if(a instanceof ccui.Widget){var b=ccui.helper.seekActionWidgetByActionTag(a,this.getActionTag());b&&this.setObject(b)}},setUnitTime:function(a){this._unitTime=a,this._refreshActionProperty()},getUnitTime:function(){return this._unitTime},setActionTag:function(a){this._actionTag=a},getActionTag:function(){return this._actionTag},setObject:function(a){this._object=a},getObject:function(){return this._object},getActionNode:function(){return this._object instanceof cc.Node?this._object:null},insertFrame:function(a,b){if(null!=b){var c=b.frameType,d=this._frameArray[c];d.splice(a,0,b)}},addFrame:function(a){if(a){var b=a.frameType,c=this._frameArray[b];c.push(a)}},deleteFrame:function(a){if(null!=a){var b=a.frameType,c=this._frameArray[b];cc.arrayRemoveObject(c,a)}},clearAllFrame:function(){for(var a=0;a<this._frameArrayNum;a++)this._frameArray[a].length=0},_refreshActionProperty:function(){if(null===this._object)return null;for(var a=[],b=0;b<this._frameArrayNum;b++){var c=this._frameArray[b];if(!(c.length<=0)){for(var d=[],e=0;e<c.length;e++){var f=c[e],g=null;if(0!==e){var h=c[e-1],i=(f.frameIndex-h.frameIndex)*this.getUnitTime();g=f.getAction(i)}else g=f.getAction(0);g&&d.push(g)}if(d){var j=cc.sequence(d);null!==j&&a.push(j)}}}return this._action=null,this._actionSpawn=cc.spawn(a),this._actionSpawn},playAction:function(a){null!==this._object&&null!==this._actionSpawn&&(a?this._action=cc.sequence(this._actionSpawn,a):this._action=cc.sequence(this._actionSpawn),this._runAction())},_runAction:function(){var a=this.getActionNode();null!==a&&null!==this._action&&a.runAction(this._action)},stopAction:function(){var a=this.getActionNode();null!==a&&null!==this._action&&(this._action.isDone()||a.stopAction(this._action))},getFirstFrameIndex:function(){for(var a=99999,b=!1,c=this._frameArray,d=0,e=this._frameArrayNum;e>d;d++){var f=c[d];if(!(f.length<=0)){b=!0;var g=f[0].frameIndex;a=a>g?g:a}}return b||(a=0),a},getLastFrameIndex:function(){for(var a=-1,b=!1,c=this._frameArray,d=0,e=this._frameArrayNum;e>d;d++){var f=c[d];if(!(f.length<=0)){b=!0;var g=f[f.length-1],h=g.frameIndex;a=h>a?h:a}}return b||(a=0),a},updateActionToTimeLine:function(a){for(var b=!1,c=this.getUnitTime(),d=0;d<this._frameArrayNum;d++){var e=this._frameArray[d];if(null!==e)for(var f=0;f<e.length;f++){var g=e[f];if(g.frameIndex*c===a){this._easingToFrame(1,1,g),b=!0;break}if(g.frameIndex*c>a){if(0===f)this._easingToFrame(1,1,g),b=!1;else{var h=e[f-1],i=(g.frameIndex-h.frameIndex)*c,j=a-h.frameIndex*c;this._easingToFrame(i,1,h),this._easingToFrame(i,j/i,g),b=!0}break}}}return b},_easingToFrame:function(a,b,c){var d=c.getAction(a),e=this.getActionNode();null!=d&&null!=e&&(d.startWithTarget(e),d.update(b))},isActionDoneOnce:function(){return null===this._action?!0:this._action.isDone()}}),ccs.ActionObject=ccs.Class.extend({_actionNodeList:null,_name:"",_loop:!1,_pause:!1,_playing:!1,_unitTime:0,_currentTime:0,_scheduler:null,_callback:null,_fTotalTime:0,ctor:function(){this._actionNodeList=[],this._name="",this._loop=!1,this._pause=!1,this._playing=!1,this._unitTime=.1,this._currentTime=0,this._fTotalTime=0,this._scheduler=cc.director.getScheduler()},setName:function(a){this._name=a},getName:function(){return this._name},setLoop:function(a){this._loop=a},getLoop:function(){return this._loop},setUnitTime:function(a){this._unitTime=a;for(var b=this._actionNodeList.length,c=0;b>c;c++){var d=this._actionNodeList[c];d.setUnitTime(this._unitTime)}},getUnitTime:function(){return this._unitTime},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(a){this._currentTime=a},getTotalTime:function(){return this._fTotalTime},isPlaying:function(){return this._playing},initWithDictionary:function(a,b){this.setName(a.name),this.setLoop(a.loop),this.setUnitTime(a.unittime);for(var c=a.actionnodelist,d=0,e=0;e<c.length;e++){var f=new ccs.ActionNode,g=c[e];f.initWithDictionary(g,b),f.setUnitTime(this.getUnitTime()),this._actionNodeList.push(f);var h=f.getLastFrameIndex()-f.getFirstFrameIndex();h>d&&(d=h)}this._fTotalTime=d*this._unitTime},addActionNode:function(a){a&&(this._actionNodeList.push(a),a.setUnitTime(this._unitTime))},removeActionNode:function(a){null!=a&&cc.arrayRemoveObject(this._actionNodeList,a)},play:function(a){this.stop(),this.updateToFrameByTime(0);for(var b=this._actionNodeList,c=b.length,d=0;c>d;d++)b[d].playAction(a);this._loop&&this._scheduler.schedule(this.simulationActionUpdate,this,0,cc.REPEAT_FOREVER,0,!1,this.__instanceId+""),void 0!==a&&(this._callback=a)},pause:function(){this._pause=!0,this._playing=!1},stop:function(){for(var a=this._actionNodeList,b=0;b<a.length;b++)a[b].stopAction();this._scheduler.unschedule(this.simulationActionUpdate,this),this._pause=!1,this._playing=!1},updateToFrameByTime:function(a){this._currentTime=a;for(var b=0;b<this._actionNodeList.length;b++){var c=this._actionNodeList[b];c.updateActionToTimeLine(a)}},simulationActionUpdate:function(a){for(var b=!0,c=this._actionNodeList,d=0,e=c.length;e>d;d++)if(!c[d].isActionDoneOnce()){b=!1;break}b&&(null!==this._callback&&this._callback.execute(),this._loop?this.play():(this._playing=!1,this._scheduler.unschedule(this.simulationActionUpdate,this)))}}),ccs.ComAttribute=ccs.Component.extend({_jsonDict:null,_filePath:"",ctor:function(){cc.Component.prototype.ctor.call(this),this._jsonDict={},this._filePath="",this._name="CCComAttribute",ccs.ComAttribute.prototype.init.call(this)},init:function(){return this._jsonDict={},!0},setInt:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setDouble:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setFloat:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setBool:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setString:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},setObject:function(a,b){return a?void(this._jsonDict[a]=b):void cc.log("Argument must be non-nil")},getInt:function(a){var b=this._jsonDict[a];return parseInt(b||0)},getDouble:function(a){var b=this._jsonDict[a];return parseFloat(b||0)},getFloat:function(a){var b=this._jsonDict[a];return parseFloat(b||0)},getBool:function(a){var b=this._jsonDict[a];return Boolean(b||!1)},getString:function(a){var b=this._jsonDict[a];return b||""},getObject:function(a){return this._jsonDict[a]},parse:function(a){this._jsonDict=cc.loader.getRes(a)}}),ccs.ComAttribute.create=function(){return new ccs.ComAttribute},ccs.ComAudio=ccs.Component.extend({_filePath:"",_loop:!1,ctor:function(){cc.Component.prototype.ctor.call(this),this._name="Audio",ccs.ComAudio.prototype.init.call(this)},init:function(){return!0},onExit:function(){this.stopBackgroundMusic(!0),this.stopAllEffects()},end:function(){cc.audioEngine.end()},preloadBackgroundMusic:function(a){cc.loader.load(a)},playBackgroundMusic:function(a,b){a?cc.audioEngine.playMusic(a,b):cc.audioEngine.playMusic(this._filePath,this._loop)},stopBackgroundMusic:function(a){cc.audioEngine.stopMusic(a)},pauseBackgroundMusic:function(){cc.audioEngine.pauseMusic()},resumeBackgroundMusic:function(){cc.audioEngine.resumeMusic()},rewindBackgroundMusic:function(){cc.audioEngine.rewindMusic()},willPlayBackgroundMusic:function(){return cc.audioEngine.willPlayMusic()},isBackgroundMusicPlaying:function(){return cc.audioEngine.isMusicPlaying()},getBackgroundMusicVolume:function(){return cc.audioEngine.getMusicVolume()},setBackgroundMusicVolume:function(a){cc.audioEngine.setMusicVolume(a)},getEffectsVolume:function(){return cc.audioEngine.getEffectsVolume()},setEffectsVolume:function(a){cc.audioEngine.setEffectsVolume(a)},playEffect:function(a,b){return a?cc.audioEngine.playEffect(a,b):cc.audioEngine.playEffect(this._filePath,this._loop)},pauseEffect:function(a){cc.audioEngine.pauseEffect(a)},pauseAllEffects:function(){cc.audioEngine.pauseAllEffects()},resumeEffect:function(a){cc.audioEngine.resumeEffect(a)},resumeAllEffects:function(){cc.audioEngine.resumeAllEffects()},stopEffect:function(a){cc.audioEngine.stopEffect(a)},stopAllEffects:function(){cc.audioEngine.stopAllEffects()},preloadEffect:function(a){cc.loader.getRes(a),this.setFile(a),this.setLoop(!1)},unloadEffect:function(a){cc.audioEngine.unloadEffect(a)},setFile:function(a){this._filePath=a},setLoop:function(a){this._loop=a},getFile:function(){return this._filePath},isLoop:function(){return this._loop}}),ccs.ComAudio.create=function(){return new ccs.ComAudio},ccs.ComController=ccs.Component.extend({ctor:function(){cc.Component.prototype.ctor.call(this),this._name="ComController",ccs.ComController.prototype.init.call(this)},onEnter:function(){null!==this._owner&&this._owner.scheduleUpdate()},isEnabled:function(){return this._enabled},setEnabled:function(a){this._enabled=a}}),ccs.ComController.create=function(){return new ccs.ComController},ccs.ComRender=ccs.Component.extend({_render:null,ctor:function(a,b){cc.Component.prototype.ctor.call(this),this._render=a,this._name=b,this.isRenderer=!0,ccs.ComRender.prototype.init.call(this)},onEnter:function(){this._owner&&this._owner.addChild(this._render)},onExit:function(){this._owner&&(this._owner.removeChild(this._render,!0),this._render=null)},getNode:function(){return this._render},setNode:function(a){this._render=a}}),ccs.ComRender.create=function(a,b){return new ccs.ComRender(a,b)},ccs.objectFactory={_typeMap:{},createObject:function(a){var b=null,c=this._typeMap[a];return c&&(b=cc.isFunction(c._fun)?new c._fun:c._fun),b},registerType:function(a){this._typeMap[a._className]=a},createGUI:function(a){var b=null;"Panel"===a?a="Layout":"TextArea"===a?a="Label":"TextButton"===a&&(a="Button");var c=this._typeMap[a];return c&&c._fun&&(b=c._fun),b},removeAll:function(){this._typeMap={}}},ccs.TInfo=ccs.Class.extend({_className:"",_fun:null,ctor:function(a,b){b?(this._className=a,this._fun=b):(this._className=a._className,this._fun=a._fun),ccs.objectFactory.registerType(this)}}),ccs.sendEvent=function(a){var b=ccs.triggerManager.get(a);if(null!=b)for(var c=0;c<b.length;c++){var d=b[c];null!=d&&d.detect()&&d.done()}},ccs.registerTriggerClass=function(a,b){new ccs.TInfo(a,b)},ccs.triggerManager={_eventTriggers:{},_triggerObjs:{},_movementDispatches:[],parse:function(a){for(var b=0;b<a.length;++b){var c=a[b],d=new ccs.TriggerObj;d.serialize(c);for(var e=d.getEvents(),f=0;f<e.length;f++){var g=e[f];this.add(g,d)}this._triggerObjs[d.getId()]=d}},get:function(a){return this._eventTriggers[a]},getTriggerObj:function(a){return this._triggerObjs[a]},add:function(a,b){var c=this._eventTriggers[a];c||(c=[]),-1===c.indexOf(b)&&(c.push(b),this._eventTriggers[a]=c)},removeAll:function(){for(var a in this._eventTriggers)for(var b=this._eventTriggers[a],c=0;c<b.length;c++){var d=b[c];d.removeAll()}this._eventTriggers={}},remove:function(a,b){if(b)return this._removeObj(a,b);var c=!1;do{var d=this._eventTriggers[a];if(!d)break;for(var e=0;e<d.length;e++){var f=d[e];f&&f.removeAll()}delete this._eventTriggers[a],c=!0}while(0);return c},_removeObj:function(a,b){var c=!1;do{var d=this._eventTriggers[a];if(!d)break;for(var e=0;e<d.length;e++){
var f=d[e];if(f&&f==b){f.removeAll(),d.splice(e,1);break}}c=!0}while(0);return c},removeTriggerObj:function(a){var b=this.getTriggerObj(a);if(!b)return!1;for(var c=b.getEvents(),d=0;d<c.length;d++){var e=c[d];this.remove(e,b)}return!0},isEmpty:function(){return!this._eventTriggers||this._eventTriggers.length<=0},addArmatureMovementCallBack:function(a,b,c){if(null!=a&&null!=c&&null!=b){for(var d,e=!1,f=0;f<this._movementDispatches.length;f++)d=this._movementDispatches[f],d&&d[0]===a&&(d.addAnimationEventCallBack(b,c),e=!0);if(!e){var g=new ccs.ArmatureMovementDispatcher;a.getAnimation().setMovementEventCallFunc(g.animationEvent,g),g.addAnimationEventCallBack(b,c),this._movementDispatches.push([a,g])}}},removeArmatureMovementCallBack:function(a,b,c){if(null!=a&&null!=b&&null!=c)for(var d,e=0;e<this._movementDispatches.length;e++)d=this._movementDispatches[e],d&&d[0]===a&&d.removeAnimationEventCallBack(c,b)},removeArmatureAllMovementCallBack:function(a){if(null!=a)for(var b,c=0;c<this._movementDispatches.length;c++)if(b=this._movementDispatches[c],b&&b[0]===a){this._movementDispatches.splice(c,1);break}},removeAllArmatureMovementCallBack:function(){this._movementDispatches.length=0},version:function(){return"1.2.0.0"}},ccs.ArmatureMovementDispatcher=ccs.Class.extend({_mapEventAnimation:null,ctor:function(){this._mapEventAnimation=[]},animationEvent:function(a,b,c){for(var d,e,f,g=0;g<this._mapEventAnimation.length;g++)d=this._mapEventAnimation[g],e=d[0],f=d[1],f&&f.call(e,a,b,c)},addAnimationEventCallBack:function(a,b){this._mapEventAnimation.push([b,a])},removeAnimationEventCallBack:function(a,b){for(var c,d=0;d<this._mapEventAnimation.length;d++)c=this._mapEventAnimation[d],c[0]===b&&this._mapEventAnimation.splice(d,1)}}),ccs.BaseTriggerCondition=ccs.Class.extend({ctor:function(){},init:function(){return!0},detect:function(){return!0},serialize:function(a){},removeAll:function(){}}),ccs.BaseTriggerAction=ccs.Class.extend({ctor:function(){},init:function(){return!0},done:function(){},serialize:function(a){},removeAll:function(){}}),ccs.TriggerObj=ccs.Class.extend({_cons:null,_acts:null,_id:0,_enable:!0,_vInt:null,ctor:function(){this._id=0,this._enable=!0,ccs.TriggerObj.prototype.init.call(this)},init:function(){return this._cons=[],this._acts=[],this._vInt=[],!0},detect:function(){if(!this._enable||0===this._cons.length)return!0;for(var a=!0,b=null,c=0;c<this._cons.length;c++)b=this._cons[c],b&&b.detect&&(a=a&&b.detect());return a},done:function(){if(this._enable&&0!==this._acts.length)for(var a,b=0;b<this._acts.length;b++)a=this._acts[b],a&&a.done&&a.done()},removeAll:function(){for(var a=null,b=0;b<this._cons.length;b++)a=this._cons[b],a&&a.removeAll();this._cons=[];for(var b=0;b<this._acts.length;b++)a=this._acts[b],a&&a.removeAll();this._acts=[]},serialize:function(a){this._id=a.id||0;for(var b=a.conditions||[],c=0;c<b.length;c++){var d=b[c],e=d.classname,f=ccs.objectFactory.createObject(e);f?(f.serialize(d),f.init(),this._cons.push(f)):cc.log("class named classname("+e+") can not implement!")}for(var g=a.actions||[],c=0;c<g.length;c++){var d=g[c],e=d.classname,h=ccs.objectFactory.createObject(e);h?(h.serialize(d),h.init(),this._acts.push(h)):cc.log("class named classname("+e+") can not implement!")}for(var i=a.events||[],c=0;c<i.length;c++){var d=i[c],j=d.id;0>j||this._vInt.push(j)}},getId:function(){return this._id},setEnable:function(a){this._enable=a},getEvents:function(){return this._vInt}}),ccs.TriggerObj.create=function(){return new ccs.TriggerObj},ccs.ActionTimelineData=ccs.Class.extend({_actionTag:0,ctor:function(a){this._init(a)},_init:function(a){return this._actionTag=a,!0},setActionTag:function(a){this._actionTag=a},getActionTag:function(){return this._actionTag}}),ccs.AnimationInfo=function(a,b,c){this.name=a,this.startIndex=b,this.endIndex=c},ccs.ComExtensionData=ccs.Component.extend({_customProperty:null,_timelineData:null,_name:"ComExtensionData",ctor:function(){return this._customProperty="",this._timelineData=new ccs.ActionTimelineData(0),!0},setActionTag:function(a){this._timelineData.setActionTag(a)},getActionTag:function(){return this._timelineData.getActionTag()},setCustomProperty:function(a){this._customProperty=a},getCustomProperty:function(){return this._customProperty}}),ccs.ComExtensionData.create=function(){return new ccs.ComExtensionData},ccs.ActionTimelineData.create=function(a){return new ccs.ActionTimelineData(a)},ccs.ActionTimeline=cc.Action.extend({_timelineMap:null,_timelineList:null,_duration:0,_time:null,_timeSpeed:1,_frameInternal:1/60,_playing:!1,_currentFrame:0,_startFrame:0,_endFrame:0,_loop:null,_frameEventListener:null,_animationInfos:null,_lastFrameListener:null,ctor:function(){cc.Action.prototype.ctor.call(this),this._timelineMap={},this._timelineList=[],this._animationInfos={},this.init()},_gotoFrame:function(a){for(var b=this._timelineList.length,c=0;b>c;c++)this._timelineList[c]._gotoFrame(a)},_stepToFrame:function(a){for(var b=this._timelineList.length,c=0;b>c;c++)this._timelineList[c]._stepToFrame(a)},_emitFrameEvent:function(a){this._frameEventListener&&this._frameEventListener(a)},init:function(){return!0},gotoFrameAndPlay:function(a,b,c,d){var e,f=0,g=arguments.length,h=[];for(f;g>f;f++)"boolean"==typeof arguments[f]?e=arguments[f]:h.push(arguments[f]);a=h[0],b=void 0!==h[1]?h[1]:this._duration,c=h[2]||a,d=null!=e?e:!0,this._startFrame=a,this._endFrame=b,this._currentFrame=c,this._loop=d,this._time=this._currentFrame*this._frameInternal,this.resume(),this._gotoFrame(this._currentFrame)},gotoFrameAndPause:function(a){this._startFrame=this._currentFrame=a,this._time=this._currentFrame*this._frameInternal,this.pause(),this._gotoFrame(this._currentFrame)},pause:function(){this._playing=!1},resume:function(){this._playing=!0},isPlaying:function(){return this._playing},setTimeSpeed:function(a){this._timeSpeed=a},getTimeSpeed:function(){return this._timeSpeed},setDuration:function(a){this._duration=a},getDuration:function(){return this._duration},getStartFrame:function(){return this._startFrame},getEndFrame:function(){return this._endFrame},setCurrentFrame:function(a){a>=this._startFrame&&a<=this._endFrame?(this._currentFrame=a,this._time=this._currentFrame*this._frameInternal):cc.log("frame index is not between start frame and end frame")},getCurrentFrame:function(){return this._currentFrame},addTimeline:function(a){var b=a.getActionTag();this._timelineMap[b]||(this._timelineMap[b]=[]),-1===this._timelineMap[b].indexOf(a)&&(this._timelineList.push(a),this._timelineMap[b].push(a),a.setActionTimeline(this))},removeTimeline:function(a){var b=a.getActionTag();this._timelineMap[b]&&this._timelineMap[b].some(function(b){return b===a?!0:void 0})&&(cc.arrayRemoveObject(this._timelineMap[b],a),cc.arrayRemoveObject(this._timelineList,a),a.setActionTimeline(null))},getTimelines:function(){return this._timelineList},setFrameEventCallFunc:function(a){this._frameEventListener=a},clearFrameEventCallFunc:function(){this._frameEventListener=null},clone:function(){var a=new ccs.ActionTimeline;a.setDuration(this._duration),a.setTimeSpeed(this._timeSpeed);for(var b in this._timelineMap){var c=this._timelineMap[b];for(var d in c){var e=c[d],f=e.clone();a.addTimeline(f)}}return a},reverse:function(){return null},step:function(a){if(this._playing&&0!==this._timelineMap.length&&0!==this._duration){this._time+=a*this._timeSpeed;var b=this._time-this._endFrame*this._frameInternal;b<this._frameInternal?(this._currentFrame=Math.floor(this._time/this._frameInternal),this._stepToFrame(this._currentFrame),b>=0&&this._lastFrameListener&&this._lastFrameListener()):(this._playing=this._loop,this._playing?this.gotoFrameAndPlay(this._startFrame,this._endFrame,this._loop):(this._time=this._endFrame*this._frameInternal,this._currentFrame!=this._endFrame&&(this._currentFrame=this._endFrame,this._stepToFrame(this._currentFrame),this._lastFrameListener&&this._lastFrameListener())))}},_foreachNodeDescendant:function(a,b){b(a);for(var c=a.getChildren(),d=0;d<c.length;d++){var e=c[d];this._foreachNodeDescendant(e,b)}},startWithTarget:function(a){cc.Action.prototype.startWithTarget.call(this,a);var b=this,c=function(a){var c=a.getComponent("ComExtensionData");if(c){var d=c.getActionTag();if(b._timelineMap[d])for(var e=b._timelineMap[d],f=0;f<e.length;f++){var g=e[f];g.setNode(a)}}};this._foreachNodeDescendant(a,c)},isDone:function(){return!1},play:function(a,b){var c=this._animationInfos[a];return c?void this.gotoFrameAndPlay(c.startIndex,c.endIndex,b):cc.log("Can't find animation info for %s",a)},addAnimationInfo:function(a){this._animationInfos[a.name]=a},removeAnimationInfo:function(a){delete this._animationInfos[a]},isAnimationInfoExists:function(a){return this._animationInfos[a]},getAnimationInfo:function(a){return this._animationInfos[a]},setLastFrameCallFunc:function(a){this._lastFrameListener=a},clearLastFrameCallFunc:function(){this._lastFrameListener=null}}),ccs.ActionTimeline.create=function(){return new ccs.ActionTimeline},ccs.Frame=ccs.Class.extend({_frameIndex:null,_tween:null,_timeline:null,_node:null,_tweenType:null,_easingParam:null,_enterWhenPassed:null,ctor:function(){this._frameIndex=0,this._tween=!0,this._timeline=null,this._node=null,this._enterWhenPassed=!1,this._easingParam=[]},_emitEvent:function(){this._timeline&&this._timeline.getActionTimeline()._emitFrameEvent(this)},_cloneProperty:function(a){this._frameIndex=a.getFrameIndex(),this._tween=a.isTween(),this._tweenType=a.getTweenType(),this.setEasingParams(a.getEasingParams())},setFrameIndex:function(a){this._frameIndex=a},getFrameIndex:function(){return this._frameIndex},setTimeline:function(a){this._timeline=a},getTimeline:function(a){return this._timeline},setNode:function(a){this._node=a},getNode:function(){return this._node},setTween:function(a){this._tween=a},isTween:function(){return this._tween},onEnter:function(a){},apply:function(a){this._tween&&(this._tweenType!==ccs.FrameEaseType.TWEEN_EASING_MAX&&this._tweenType!==ccs.FrameEaseType.LINEAR&&(a=this.tweenPercent(a)),this._onApply(a))},_onApply:function(a){},clone:function(){},tweenPercent:function(a){var b=ccs.Frame.tweenToMap[this._tweenType];return b?b(a,this._easingParam):a},setEasingParams:function(a){if(a){this._easingParam.length=0;for(var b=0;b<a.length;b++)this._easingParam[b]=a[b]}},getEasingParams:function(){return this._easingParam},setTweenType:function(a){this._tweenType=a},getTweenType:function(){return this._tweenType},isEnterWhenPassed:function(){return this._enterWhenPassed}}),ccs.Frame.tweenToMap={"-1":function(a,b){if(b){var c=1-a;return b[1]*c*c*c+3*b[3]*a*c*c+3*b[5]*a*a*c+b[7]*a*a*a}return a},1:cc._easeSineInObj.easing,2:cc._easeSineOutObj.easing,3:cc._easeSineInOutObj.easing,4:cc._easeQuadraticActionIn.easing,5:cc._easeQuadraticActionOut.easing,6:cc._easeQuadraticActionInOut.easing,7:cc._easeCubicActionIn.easing,8:cc._easeCubicActionOut.easing,9:cc._easeCubicActionInOut.easing,10:cc._easeCubicActionIn.easing,11:cc._easeCubicActionOut.easing,12:cc._easeCubicActionInOut.easing,13:cc._easeQuinticActionIn.easing,14:cc._easeQuinticActionOut.easing,15:cc._easeQuinticActionInOut.easing,16:cc._easeExponentialInObj.easing,17:cc._easeExponentialOutObj.easing,18:cc._easeExponentialInOutObj.easing,19:cc._easeCircleActionIn.easing,20:cc._easeCircleActionOut.easing,21:cc._easeCircleActionInOut.easing,22:function(a,b){var c=.3;return null!=b&&(c=b[0]),cc.easeElasticIn(c).easing(a)},23:function(a,b){var c=.3;return null!=b&&(c=b[0]),cc.easeElasticOut(c).easing(a)},24:function(a,b){var c=.3;return null!=b&&(c=b[0]),cc.easeElasticInOut(c).easing(a)},25:cc._easeBackInObj.easing,26:cc._easeBackOutObj.easing,27:cc._easeBackInOutObj.easing,28:cc._easeBounceInObj.easing,29:cc._easeBounceOutObj.easing,30:cc._easeBounceInOutObj.easing},ccs.VisibleFrame=ccs.Frame.extend({_visible:!0,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._visible=!0},onEnter:function(a){this._node&&this._node.setVisible(this._visible)},clone:function(){var a=new ccs.VisibleFrame;return a.setVisible(this._visible),a._cloneProperty(this),a},setVisible:function(a){this._visible=a},isVisible:function(){return this._visible}}),ccs.VisibleFrame.create=function(){return new ccs.VisibleFrame},ccs.TextureFrame=ccs.Frame.extend({_sprite:null,_textureName:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._textureName=""},setNode:function(a){ccs.Frame.prototype.setNode.call(this,a),this._sprite=a},onEnter:function(a){if(this._sprite){var b=this._sprite.getBlendFunc(),c=cc.spriteFrameCache._spriteFrames[this._textureName];null!=c?this._sprite.setSpriteFrame(c):this._sprite.setTexture(this._textureName),this._sprite.getBlendFunc()!==b&&this._sprite.setBlendFunc(b)}},clone:function(){var a=new ccs.TextureFrame;return a.setTextureName(this._textureName),a._cloneProperty(this),a},setTextureName:function(a){this._textureName=a},getTextureName:function(){return this._textureName}}),ccs.TextureFrame.create=function(){return new ccs.TextureFrame},ccs.RotationFrame=ccs.Frame.extend({_rotation:null,_betwennRotation:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._rotation=0},onEnter:function(a){this._node&&(this._node.setRotation(this._rotation),this._tween&&(this._betwennRotation=a._rotation-this._rotation))},_onApply:function(a){if(0!==this._betwennRotation){var b=this._rotation+a*this._betwennRotation;this._node.setRotation(b)}},clone:function(){var a=new ccs.RotationFrame;return a.setRotation(this._rotation),a._cloneProperty(this),a},setRotation:function(a){this._rotation=a},getRotation:function(){return this._rotation}}),ccs.RotationFrame.create=function(){return new ccs.RotationFrame},ccs.SkewFrame=ccs.Frame.extend({_skewX:null,_skewY:null,_betweenSkewX:null,_betweenSkewY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._skewX=0,this._skewY=0},onEnter:function(a){this._node&&(this._node.setSkewX(this._skewX),this._node.setSkewY(this._skewY),this._tween&&(this._betweenSkewX=a._skewX-this._skewX,this._betweenSkewY=a._skewY-this._skewY))},_onApply:function(a){if(0!==this._betweenSkewX||0!==this._betweenSkewY){var b=this._skewX+a*this._betweenSkewX,c=this._skewY+a*this._betweenSkewY;this._node.setSkewX(b),this._node.setSkewY(c)}},clone:function(){var a=new ccs.SkewFrame;return a.setSkewX(this._skewX),a.setSkewY(this._skewY),a._cloneProperty(this),a},setSkewX:function(a){this._skewX=a},getSkewX:function(){return this._skewX},setSkewY:function(a){this._skewY=a},getSkewY:function(){return this._skewY}}),ccs.SkewFrame.create=function(){return new ccs.SkewFrame},ccs.RotationSkewFrame=ccs.SkewFrame.extend({onEnter:function(a){this._node&&(this._node.setRotationX(this._skewX),this._node.setRotationY(this._skewY),this._tween&&(this._betweenSkewX=a._skewX-this._skewX,this._betweenSkewY=a._skewY-this._skewY))},_onApply:function(a){if(this._node&&(0!==this._betweenSkewX||0!==this._betweenSkewY)){var b=this._skewX+a*this._betweenSkewX,c=this._skewY+a*this._betweenSkewY;this._node.setRotationX(b),this._node.setRotationY(c)}},clone:function(){var a=new ccs.RotationSkewFrame;return a.setSkewX(this._skewX),a.setSkewY(this._skewY),a._cloneProperty(this),a}}),ccs.RotationSkewFrame.create=function(){return new ccs.RotationSkewFrame},ccs.PositionFrame=ccs.Frame.extend({_position:null,_betweenX:null,_betweenY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._position=cc.p(0,0)},onEnter:function(a){this._node&&(this._node.setPosition(this._position),this._tween&&(this._betweenX=a._position.x-this._position.x,this._betweenY=a._position.y-this._position.y))},_onApply:function(a){if(this._node&&(0!==this._betweenX||0!==this._betweenY)){var b=cc.p(0,0);b.x=this._position.x+this._betweenX*a,b.y=this._position.y+this._betweenY*a,this._node.setPosition(b)}},clone:function(){var a=new ccs.PositionFrame;return a.setPosition(this._position),a._cloneProperty(this),a},setPosition:function(a){this._position=a},getPosition:function(){return this._position},setX:function(a){this._position.x=a},getX:function(){return this._position.x},setY:function(a){this._position.y=a},getY:function(){return this._position.y}}),ccs.PositionFrame.create=function(){return new ccs.PositionFrame},ccs.ScaleFrame=ccs.Frame.extend({_scaleX:null,_scaleY:null,_betweenScaleX:null,_betweenScaleY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1},onEnter:function(a){this._node&&(this._node.setScaleX(this._scaleX),this._node.setScaleY(this._scaleY),this._tween&&(this._betweenScaleX=a._scaleX-this._scaleX,this._betweenScaleY=a._scaleY-this._scaleY))},_onApply:function(a){if(this._node&&(0!==this._betweenScaleX||0!==this._betweenScaleY)){var b=this._scaleX+this._betweenScaleX*a,c=this._scaleY+this._betweenScaleY*a;this._node.setScaleX(b),this._node.setScaleY(c)}},clone:function(){var a=new ccs.ScaleFrame;return a.setScaleX(this._scaleX),a.setScaleY(this._scaleY),a._cloneProperty(this),a},setScale:function(a){this._scaleX=a,this._scaleY=a},setScaleX:function(a){this._scaleX=a},getScaleX:function(){return this._scaleX},setScaleY:function(a){this._scaleY=a},getScaleY:function(){return this._scaleY}}),ccs.ScaleFrame.create=function(){return new ccs.ScaleFrame},ccs.AnchorPointFrame=ccs.Frame.extend({_anchorPoint:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._anchorPoint=cc.p(0,0)},onEnter:function(a){this._node&&this._node.setAnchorPoint(this._anchorPoint)},clone:function(){var a=new ccs.AnchorPointFrame;return a.setAnchorPoint(this._anchorPoint),a._cloneProperty(this),a},setAnchorPoint:function(a){this._anchorPoint=a},getAnchorPoint:function(){return this._anchorPoint}}),ccs.AnchorPointFrame.create=function(){return new ccs.AnchorPointFrame},ccs.InnerActionType={LoopAction:0,NoLoopAction:1,SingleFrame:2},ccs.InnerActionFrame=ccs.Frame.extend({_innerActionType:null,_startFrameIndex:null,_endFrameIndex:0,_singleFrameIndex:0,_enterWithName:null,_animationName:"",ctor:function(){ccs.Frame.prototype.ctor.call(this),this._enterWithName=!1,this._innerActionType=ccs.InnerActionType.LoopAction,this._startFrameIndex=0},onEnter:function(a){if(this._node){var b=this._node.getActionByTag(this._node.getTag());if(b){if(ccs.InnerActionType.SingleFrame===this._innerActionType)return void b.gotoFrameAndPause(this._singleFrameIndex);var c=this._startFrameIndex,d=this._endFrameIndex;if(this._enterWithName)if("-- ALL --"===this._animationName)c=0,d=b.getDuration();else if(b.isAnimationInfoExists(this._animationName)){var e=b.getAnimationInfo(this._animationName);c=e.startIndex,d=e.endIndex}else cc.log("Animation %s not exists!",this._animationName);var f=this._timeline.getActionTimeline().getDuration(),g=f-this._frameIndex-d+c;0>g&&(d+=g),ccs.InnerActionType.NoLoopAction===this._innerActionType?b.gotoFrameAndPlay(c,d,!1):ccs.InnerActionType.LoopAction===this._innerActionType&&b.gotoFrameAndPlay(c,d,!0)}}},setAnimationName:function(a){this._animationName=a},setSingleFrameIndex:function(a){this._singleFrameIndex=a},getSingleFrameIndex:function(){return this._startFrameIndex},setEnterWithName:function(a){this._enterWithName=a},getEnterWithName:function(){return this._enterWithName},clone:function(){var a=new ccs.InnerActionFrame;return a.setInnerActionType(this._innerActionType),a.setStartFrameIndex(this._startFrameIndex),a.setEnterWithName(this._enterWithName),a.setAnimationName(this._animationName),a.setSingleFrameIndex(this._singleFrameIndex),a._cloneProperty(this),a},setInnerActionType:function(a){this._innerActionType=a},getInnerActionType:function(){return this._innerActionType},setStartFrameIndex:function(a){this._startFrameIndex=a},getStartFrameIndex:function(){return this._startFrameIndex}}),ccs.InnerActionFrame.create=function(){return new ccs.InnerActionFrame},ccs.ColorFrame=ccs.Frame.extend({_alpha:null,_color:null,_betweenAlpha:null,_betweenRed:null,_betweenGreen:null,_betweenBlue:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._color=cc.color(255,255,255)},onEnter:function(a){if(this._node&&(this._node.setColor(this._color),this._tween)){var b=a._color;this._betweenRed=b.r-this._color.r,this._betweenGreen=b.g-this._color.g,this._betweenBlue=b.b-this._color.b}},_onApply:function(a){if(this._node&&this._tween&&(0!==this._betweenAlpha||0!==this._betweenRed||0!==this._betweenGreen||0!==this._betweenBlue)){var b=cc.color(255,255,255);if(b.r=this._color.r+this._betweenRed*a,b.g=this._color.g+this._betweenGreen*a,b.b=this._color.b+this._betweenBlue*a,this._node.setColor(b),null!==this._alpha){var c=this._alpha+this._betweenAlpha*a;this._node.setOpacity(c)}}},clone:function(){var a=new ccs.ColorFrame;return a.setColor(this._color),a._cloneProperty(this),a},setColor:function(a){this._color=a},getColor:function(){return this._color}}),ccs.ColorFrame.create=function(){return new ccs.ColorFrame},ccs.AlphaFrame=ccs.Frame.extend({_alpha:null,_betweenAlpha:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._alpha=255},onEnter:function(a){this._node&&(this._node.setOpacity(this._alpha),this._tween&&(this._betweenAlpha=a._alpha-this._alpha))},_onApply:function(a){if(this._node){var b=this._alpha+this._betweenAlpha*a;this._node.setOpacity(b)}},setAlpha:function(a){this._alpha=a},getAlpha:function(){return this._alpha},clone:function(){var a=new ccs.AlphaFrame;return a.setAlpha(this._alpha),a._cloneProperty(this),a}}),ccs.EventFrame=ccs.Frame.extend({_event:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._event="",this._enterWhenPassed=!0},onEnter:function(a){this._emitEvent()},clone:function(){var a=new ccs.EventFrame;return a.setEvent(this._event),a._cloneProperty(this),a},setEvent:function(a){this._event=a},getEvent:function(){return this._event}}),ccs.EventFrame.create=function(){return new ccs.EventFrame},ccs.ZOrderFrame=ccs.Frame.extend({_zorder:0,onEnter:function(a){this._node&&this._node.setLocalZOrder(this._zorder)},clone:function(){var a=new ccs.ZOrderFrame;return a.setZOrder(this._zorder),a._cloneProperty(this),a},setZOrder:function(a){this._zorder=a},getZOrder:function(){return this._zorder}}),ccs.ZOrderFrame.create=function(){return new ccs.ZOrderFrame},ccs.BlendFuncFrame=ccs.Frame.extend({ctor:function(){this._super(),this._blendFunc=null},onEnter:function(a,b){this._node&&this._blendFunc&&this._node.setBlendFunc(this._blendFunc)},clone:function(){var a=new ccs.BlendFuncFrame;return a.setBlendFunc(this._blendFunc),a._cloneProperty(this),a},setBlendFunc:function(a){a&&a.src&&a.dst&&(this._blendFunc=a)},getBlendFunc:function(){return this._blendFunc}}),ccs.BlendFuncFrame.create=function(){return new ccs.BlendFuncFrame},ccs.Timeline=ccs.Class.extend({_frames:null,_currentKeyFrame:null,_currentKeyFrameIndex:null,_fromIndex:null,_toIndex:null,_betweenDuration:null,_actionTag:null,_ActionTimeline:null,_node:null,ctor:function(){this._frames=[],this._currentKeyFrame=null,this._currentKeyFrameIndex=0,this._fromIndex=0,this._toIndex=0,this._betweenDuration=0,this._actionTag=0,this._ActionTimeline=null,this._node=null},_gotoFrame:function(a){0!==this._frames.length&&(this._binarySearchKeyFrame(a),this._apply(a))},_stepToFrame:function(a){0!==this._frames.length&&(this._updateCurrentKeyFrame(a),this._apply(a))},getFrames:function(){return this._frames},addFrame:function(a){this._frames.push(a),a.setTimeline(this)},insertFrame:function(a,b){this._frames.splice(b,0,a),a.setTimeline(this)},removeFrame:function(a){cc.arrayRemoveObject(this._frames,a),a.setTimeline(null)},setActionTag:function(a){this._actionTag=a},getActionTag:function(){return this._actionTag},setNode:function(a){for(var b=0;b<this._frames.length;b++){var c=this._frames[b];c.setNode(a)}},getNode:function(){return this._node},setActionTimeline:function(a){this._ActionTimeline=a},getActionTimeline:function(){return this._ActionTimeline},clone:function(){var a=new ccs.Timeline;a._actionTag=this._actionTag;for(var b=0;b<this._frames.length;b++){var c=this._frames[b],d=c.clone();a.addFrame(d)}return a},_apply:function(a){if(this._currentKeyFrame){var b=this._betweenDuration<=0?0:(a-this._currentKeyFrameIndex)/this._betweenDuration;this._currentKeyFrame.apply(b)}},_binarySearchKeyFrame:function(a){var b=null,c=null,d=this._frames.length,e=!1;do{if(a<this._frames[0].getFrameIndex()){this._currentKeyFrameIndex>=this._frames[0].getFrameIndex()&&(e=!0),this._fromIndex=0,this._toIndex=0,b=c=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(a>=this._frames[d-1].getFrameIndex()){this._fromIndex=d-1,this._toIndex=0,b=c=this._frames[d-1],this._currentKeyFrameIndex=this._frames[d-1].getFrameIndex(),this._betweenDuration=0;break}for(var f=-1,g=0,h=d-1,i=0;h>=g;){if(i=Math.ceil((g+h)/2),a>=this._frames[i].getFrameIndex()&&a<this._frames[i+1].getFrameIndex()){f=i;break}this._frames[i].getFrameIndex()>a?h=i-1:g=i+1}this._fromIndex=f,d>1?this._toIndex=f+1|0:this._toIndex=0|f,b=this._frames[this._fromIndex],c=this._frames[this._toIndex],b=this._frames[f],c=this._frames[f+1],0===f&&this._currentKeyFrameIndex<b.getFrameIndex()&&(e=!0),this._currentKeyFrameIndex=b.getFrameIndex(),this._betweenDuration=c.getFrameIndex()-b.getFrameIndex()}while(0);(e||this._currentKeyFrame!=b)&&(this._currentKeyFrame=b,this._currentKeyFrame.onEnter(c))},_updateCurrentKeyFrame:function(a){if(a>60);if(a<this._currentKeyFrameIndex||a>=this._currentKeyFrameIndex+this._betweenDuration){var b=null,c=null;do{var d=this._frames.length;if(a<this._frames[0].getFrameIndex()){b=c=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(a>=this._frames[d-1].getFrameIndex()){var e=this._frames[d-1].getFrameIndex();if(this._currentKeyFrameIndex>=e)return;a=e}for(;;){if(this._fromIndex=this._toIndex,b=this._frames[this._fromIndex],this._currentKeyFrameIndex=b.getFrameIndex(),this._toIndex=this._fromIndex+1,this._toIndex>=d&&(this._toIndex=0),c=this._frames[this._toIndex],a===b.getFrameIndex())break;if(a>b.getFrameIndex()&&a<c.getFrameIndex())break;b.isEnterWhenPassed()&&b.onEnter(c)}this._betweenDuration=c.getFrameIndex()-b.getFrameIndex()}while(0);this._currentKeyFrame=b,this._currentKeyFrame.onEnter(c)}}}),ccs.Timeline.create=function(){return new ccs.Timeline},ccs.SkinNode=function(){var a=cc.Node,b={},c=a.extend(b);return c.create=function(){},c}(),ccs.BoneNode=function(){var a=cc.Node,b=ccs.SkinNode,c=cc.BlendFunc,d={p:cc.p,size:cc.size,rect:cc.rect},e={log:cc.log,assert:cc.assert},f=a.extend({_customCommand:null,_blendFunc:null,_rackColor:null,_rackLength:null,_rackWidth:null,_childBones:null,_boneSkins:null,_rootSkeleton:null,_squareVertices:null,_squareColors:null,_noMVPVertices:null,ctor:function(b){a.prototype.ctor.call(this),null===this._squareVertices&&(this._squareVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]),this._rackColor=cc.color.WHITE,this._blendFunc=c.ALPHA_NON_PREMULTIPLIED,this._childBones=[],this._boneSkins=[],this._rackLength=void 0===b?50:b,this._rackWidth=20,this._updateVertices()},addSkin:function(b,c,d){var f=this._boneSkins;if(e.assert(null!=b,"Argument must be non-nil"),d)for(var g=0;g<f.length;g++)f[g].setVisible(!1);a.prototype.addChild.call(this,b),this._boneSkins.push(b),b.setVisible(c)},getChildBones:function(){return this._childBones},getSkins:function(){return this._boneSkins},displaySkin:function(a,b){var c,d,e=this._boneSkins;if("string"==typeof a)for(d=0;d<e.length;d++)c=e[d],a==c.getName()?c.setVisible(!0):b&&c.setVisible(!1);else for(d=0;d<e.length;d++)c=e[d],c==a?c.setVisible(!0):b&&c.setVisible(!1)},getVisibleSkins:function(){for(var a,b=[],c=this._boneSkins,d=0;d<c.length;d++)a=c[d],a.isVisible()&&b.push(a);return b},getRootSkeletonNode:function(){return this._rootSkeleton},getAllSubBones:function(){for(var a=[],b=[],c=this._childBones,d=0;d<c.length;d++)b.push(c[d]);for(;b.length>0;){var e=b.pop();a.push(e);for(var f=e.getChildBones(),g=0;f>g;g++)b.push(f[g])}return a},getAllSubSkins:function(){for(var a=this.getAllSubBones(),b=[],c=0;c<a.length;c++)for(var d=a[c].getSkins(),e=0;e<d.length;e++)b.push(d[c]);return b},addChild:function(b,c,d){a.prototype.addChild.call(this,b,c,d),this._addToChildrenListHelper(b)},removeChild:function(b,c){-1!==this._children.indexOf(b)&&(a.prototype.removeChild.call(this,b,c),this._removeFromChildrenListHelper(b))},setBlendFunc:function(a){var b=this._blendFunc;if(a&&b.src!==a.src&&b.dst!==a.dst){this._blendFunc=a;for(var c,d=this._boneSkins,e=0;e<d.length;e++)c=d[e],c.setBlendFunc(a)}},getBlendFunc:function(){return this._blendFunc},setDebugDrawLength:function(a){this._rackLength=a,this._updateVertices()},getDebugDrawLength:function(){return this._rackLength},setDebugDrawWidth:function(a){this._rackWidth=a,this._updateVertices()},getDebugDrawWidth:function(){return this._rackWidth},setDebugDrawEnabled:function(a){var b=this._renderCmd;b._debug!==a&&(b._debug=a,cc.renderer.childrenOrderDirty=!0,this._visible&&null!=this._rootSkeleton&&(this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0))},isDebugDrawEnabled:function(){return this._renderCmd._debug},setDebugDrawColor:function(a){this._rackColor=a},getDebugDrawColor:function(){return this._rackColor},getVisibleSkinsRect:function(){var a,b,c,e=0;a=b=c=e;var f=!0,g=d.rect(0,0,0,0);this._renderCmd._debug&&null!=this._rootSkeleton&&this._rootSkeleton._renderCmd._debug&&(c=this._rackWidth,e=this._rackLength,f=!1);for(var h,i=this._boneSkins,j=0;j<i.length;j++){h=i[j];var k=h.getBoundingBox();!h.isVisible()||0===k.x&&0===k.y&&0===k.width&&0===k.height||(f?(a=cc.rectGetMinX(k),b=cc.rectGetMinY(k),c=cc.rectGetMaxX(k),e=cc.rectGetMaxY(k),f=!1):(a=Math.min(cc.rectGetMinX(k),a),b=Math.min(cc.rectGetMinY(k),b),c=Math.max(cc.rectGetMaxX(k),c),e=Math.max(cc.rectGetMaxY(k),e)),g.setRect(a,b,c-a,e-b))}return g},getBoundingBox:function(){var a=this.getVisibleSkinsRect();return cc.rectApplyAffineTransform(a,this.getNodeToParentAffineTransform())},batchBoneDrawToSkeleton:function(a){},setLocalZOrder:function(b){a.prototype.setLocalZOrder.call(this,b),null!=this._rootSkeleton&&(this._rootSkeleton._subBonesOrderDirty=!0)},setName:function(b){var c=this._rootSkeleton,d=this.getName();if(a.prototype.setName.call(this,b),null!=c){var e=c._subBonesMap[d],f=c._subBonesMap[b];e&&!f&&(delete c._subBonesMap[e],c._subBonesMap[b]=e)}},setContentSize:function(b){a.prototype.setContentSize.call(this,b),this._updateVertices()},setAnchorPoint:function(b){a.prototype.setAnchorPoint.call(this,b),this._updateVertices()},setVisible:function(b){this._visible!=b&&(a.prototype.setVisible.call(this,b),null!=this._rootSkeleton&&(this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0))},_addToChildrenListHelper:function(a){a instanceof f?this._addToBoneList(a):this._addToSkinList(a)},_removeFromChildrenListHelper:function(a){a instanceof f?this._removeFromBoneList(a):a instanceof b&&this._removeFromSkinList(skin)},_removeFromBoneList:function(a){if(null!=this._rootSkeleton&&a instanceof ccs.SkeletonNode&&a._rootSkeleton===this._rootSkeleton){a._rootSkeleton=null;var b=a.getAllSubBones();b.push(a);for(var c,d=0;d<b.length;d++)c=b[d],c._rootSkeleton=null,delete this._rootSkeleton._subBonesMap[c.getName()],this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0}else this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0;cc.arrayRemoveObject(this._childBones,a)},_setRootSkeleton:function(a){this._rootSkeleton=a;for(var b=this.getAllSubBones(),c=0;c<b.length;c++)this._addToBoneList(b[c])},_addToBoneList:function(a){if(-1===this._childBones.indexOf(a)&&this._childBones.push(a),null!=this._rootSkeleton){var c=a;if(!(c instanceof b||a._rootSkeleton)){var d=a.getAllSubBones();d.push(a);for(var e,f=0;f<d.length;f++){e=d[f],e._setRootSkeleton(this._rootSkeleton);var g=e.getName();this._rootSkeleton._subBonesMap[g]?(cc.log("already has a bone named %s in skeleton %s",g,this._rootSkeleton.getName()),this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0):(this._rootSkeleton._subBonesMap[e.getName()]=e,
this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0)}}}},_visitSkins:function(){var a=this._renderCmd;if(this._visible){var b=a.getParentRenderCmd();b&&(a._curLevel=b._curLevel+1);var c,d,e=this._boneSkins;a._syncStatus(b);var f=e.length;if(f>0){for(this.sortAllChildren(),c=0;f>c&&(d=e[c],d._localZOrder<0);c++)d._renderCmd.visit(a);for(;f>c;c++)e[c]._renderCmd.visit(a)}a._dirtyFlag=0}},_addToSkinList:function(a){if(this._boneSkins.push(a),a.getBlendFunc){var b=a.getBlendFunc();this._blendFunc.src!==b.src&&this._blendFunc.dst!==b.dst&&a.setBlendFunc(this._blendFunc)}},_removeFromSkinList:function(a){cc.arrayRemoveObject(this._boneSkins,a)},sortAllChildren:function(){this._sortArray(this._childBones),this._sortArray(this._boneSkins),a.prototype.sortAllChildren.call(this)},_sortArray:function(a){if(a){var b,c,d,e=a.length;for(b=1;e>b;b++){for(d=a[b],c=b-1;c>=0;){if(d._localZOrder<a[c]._localZOrder)a[c+1]=a[c];else{if(!(d._localZOrder===a[c]._localZOrder&&d.arrivalOrder<a[c].arrivalOrder))break;a[c+1]=a[c]}c--}a[c+1]=d}}},_updateVertices:function(){var a=this._squareVertices,b=this._renderCmd._anchorPointInPoints;if(this._rackLength!=a[2].x-b.x||a[3].y!=this._rackWidth/2-b.y){a[1].x=a[1].y=a[3].y=0,a[0].x=a[2].x=.1*this._rackLength,a[2].y=.5*this._rackWidth,a[0].y=-a[2].y,a[3].x=this._rackLength;for(var c=0;c<a.length;c++)a[c].x+=b.x,a[c].y+=b.y;this._renderCmd.updateDebugPoint(a)}},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new g(this):new h(this)}});f.create=function(a,b){return new ccui.BoneNode(a,b)};var g=function(){var b=function(b){a.CanvasRenderCmd.call(this,b),this._debug=!1,this._color=cc.color.WHITE,this._drawNode=new cc.DrawNode},c=b.prototype=Object.create(a.CanvasRenderCmd.prototype);return c.constructor=b,c.visit=function(a){var b=this._node;b._visit&&b._visit(a)},c.updateDebugPoint=function(a){this._drawNode.clear(),this._drawNode.drawPoly(a,this._color,0,this._color)},c.transform=function(b,c){var d=this._node._rootSkeleton;a.CanvasRenderCmd.prototype.transform.call(this,b,c),d&&d._renderCmd._debug&&this._drawNode._renderCmd.transform(this)},b}(),h=function(){var b=function(b){a.WebGLRenderCmd.call(this,b),this._debug=!1,this._color=cc.color.WHITE,this._drawNode=new cc.DrawNode},c=b.prototype=Object.create(a.WebGLRenderCmd.prototype);return c.constructor=b,c.visit=function(a){var b=this._node;b._visit&&b._visit(a)},c.updateDebugPoint=function(a){this._drawNode.clear(),this._drawNode.drawPoly(a,this._color,0,this._color)},c.transform=function(b,c){var d=this._node._rootSkeleton;a.WebGLRenderCmd.prototype.transform.call(this,b,c),d&&d._renderCmd._debug&&this._drawNode._renderCmd.transform(this)},b}();return f}(),ccs.SkeletonNode=function(){var a=ccs.BoneNode,b=({p:cc.p,size:cc.size,rect:cc.rect},a.extend({_subBonesMap:null,_squareVertices:null,_squareColors:null,_noMVPVertices:null,_skinGroupMap:null,_sortedAllBonesDirty:!1,_sortedAllBones:null,_batchedBoneVetices:null,_batchedBoneColors:null,_batchedVeticesCount:null,_batchBoneCommand:null,_subOrderedAllBones:null,ctor:function(){this._squareVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._rootSkeleton=this,a.prototype.ctor.call(this),this._subBonesMap={},this._subOrderedAllBones=[],this._skinGroupMap={},this._rackLength=this._rackWidth=20,this._updateVertices()},getBoneNode:function(a){var b=this._subBonesMap[a];return b?b:null},getAllSubBonesMap:function(){return this._subBonesMap},changeSkins:function(a){if("object"==typeof a){var b;for(var c in a){b=a[c];var d=this.getBoneNode(c);null!==d&&d.displaySkin(b,!0)}}else{var e=this._suitMap[a];e&&this.changeSkins(e,!0)}},addSkinGroup:function(a,b){this._skinGroupMap[a]=b},getBoundingBox:function(){var a,b,c,d=0;a=b=c=d;var e=this.getVisibleSkinsRect(),f=!0;0===e.x&&0===e.y&&0===e.width&&0===e.height||(a=cc.rectGetMinX(e),b=cc.rectGetMinY(e),c=cc.rectGetMaxX(e),d=cc.rectGetMaxY(e),f=!1);for(var g,h=this.getAllSubBones(),i=0;i<h.length;i++){g=h[i];var j=cc.rectApplyAffineTransform(g.getVisibleSkinsRect(),g.getNodeToParentTransform(g.getRootSkeletonNode()));0===j.x&&0===j.y&&0===j.width&&0===j.height||(f?(a=cc.rectGetMinX(j),b=cc.rectGetMinY(j),c=cc.rectGetMaxX(j),d=cc.rectGetMaxY(j),f=!1):(a=Math.min(cc.rectGetMinX(j),a),b=Math.min(cc.rectGetMinY(j),b),c=Math.max(cc.rectGetMaxX(j),c),d=Math.max(cc.rectGetMaxY(j),d)))}return e.x=a,e.y=b,e.width=c-a,e.height=d-b,cc.rectApplyAffineTransform(e,this.getNodeToParentTransform())},_visit:function(a){if(this._visible){var b=this._renderCmd;a=a||b.getParentRenderCmd(),b._syncStatus(a);var c,d;if(0!==this._children.length)for(c=0;c<this._children.length;c++)d=this._children[c],d._renderCmd.visit(b);this._checkSubBonesDirty();var e,f,g=this._subOrderedAllBones;for(c=0;c<g.length;c++)e=g[c],e._visitSkins();if(b._debug)for(c=0;c<g.length;c++)f=g[c]._renderCmd,cc.renderer.pushRenderCommand(f._drawNode._renderCmd);this._dirtyFlag=0}},_checkSubBonesDirty:function(){this._subBonesDirty&&(this._updateOrderedAllbones(),this._subBonesDirty=!1),this._subBonesOrderDirty&&(this._sortOrderedAllBones(),this._subBonesOrderDirty=!1)},_updateOrderedAllbones:function(){this._subOrderedAllBones.length=0;for(var a,b=[],c=this._childBones,d=0;d<c.length;d++)a=c[d],a.isVisible()&&b.push(a);for(;b.length>0;){var e=b.pop(),f=e._renderCmd;f._syncStatus(f.getParentRenderCmd()),this._subOrderedAllBones.push(e);for(var g,h=e.getChildBones(),d=0;d<h.length;d++)g=h[d],g.isVisible()&&b.push(g)}},_sortOrderedAllBones:function(){this._sortArray(this._subOrderedAllBones)},_updateVertices:function(){var a=this._squareVertices,b=this._renderCmd._anchorPointInPoints;if(this._rackLength!=a[6].x-b.x||this._rackWidth!=a[3].y-b.y){var c=.5*this._rackLength,d=.5*this._rackWidth,e=.25*c,f=.25*d;a[5].y=a[2].y=a[1].y=a[6].y=a[0].x=a[4].x=a[7].x=a[3].x=0,a[5].x=-c,a[0].y=-d,a[6].x=c,a[3].y=d,a[1].x=e,a[7].y=f,a[2].x=-e,a[4].y=-f;for(var g=0;g<a.length;g++)a[g].x+=b.x,a[g].y+=b.y}},_updateAllDrawBones:function(){this._subDrawBones={};for(var a in this._subBonesMap){var b=this._subBonesMap[a];b.isVisible()&&b.isDebugDrawEnabled()&&this._subDrawBones.push(b)}this._sortArray(this._sortedAllBones),this._subDrawBones=!1}}));return b.create=function(){return new b},b}(),ccs._load=function(){var a=function(a,d,e){var g=cc.loader.getRes(a);if(!g)return cc.log("%s does not exist",a);var h=c(a).toLocaleLowerCase();if("json"!==h&&"exportjson"!==h)return cc.log("%s load error, must be json file",a);var i;if(d?i=b[d]:g.widgetTree?i=b.ccui:g.nodeTree?i=b.timeline:g.Content&&g.Content.Content?i=b.timeline:g.gameobjects&&(i=b.scene),!i)return cc.log("Can't find the parser : %s",a),new cc.Node;var j=g.version||g.Version;if(!j&&g.armature_data)return cc.warn("%s is armature. please use:",a),cc.warn("    ccs.armatureDataManager.addArmatureFileInfoAsync(%s);",a),cc.warn("    var armature = new ccs.Armature('name');"),new cc.Node;var k=f(i,j);return k?k.parse(a,g,e)||null:(cc.log("Can't find the parser : %s",a),new cc.Node)},b={ccui:{},timeline:{},action:{},scene:{}};a.registerParser=function(a,c,d){return a&&c&&d?(b[a]||(b[a]={}),void(b[a][c]=d)):cc.log("register parser error")},a.getParser=function(a,c){return a&&c?b[a]?b[a][c]:void 0:a?b[a]:b};var c=function(a){var b=a.match(d);return b&&b[1]?b[1]:null},d=/\.([^\.]+)$/,e=/([^\.](\.\*)?)*$/,f=function(a,b){return a[b]?a[b]:"*"===b?null:f(a,b.replace(e,"*"))};return a}(),ccs._parser=cc.Class.extend({ctor:function(){this.parsers={}},_dirnameReg:/\S*\//,_dirname:function(a){var b=a.match(this._dirnameReg);return b&&b[0]?b[0]:""},getClass:function(a){return a.classname},getNodeJson:function(a){return a.widgetTree},parse:function(a,b,c){c=c||this._dirname(a),this.pretreatment(b,c);var d=this.parseNode(this.getNodeJson(b),c,a);return d&&this.deferred(b,c,d,a),d},pretreatment:function(a,b,c){},deferred:function(a,b,c,d){},parseNode:function(a,b){var c=this.parsers[this.getClass(a)],d=null;return c?d=c.call(this,a,b):cc.log("Can't find the parser : %s",this.getClass(a)),d},registerParser:function(a,b){this.parsers[a]=b}}),ccs.load=function(a,b){var c={node:null,action:null};return c.node=ccs._load(a,null,b),c.action=ccs._load(a,"action",b),c.action&&-1===c.action.tag&&c.node&&(c.action.tag=c.node.tag),c},ccs.load.validate={},ccs.loadWithVisibleSize=function(a,b){var c=ccs.load(a,b),d=cc.director.getVisibleSize();return c.node&&d&&(c.node.setContentSize(d.width,d.height),ccui.helper.doLayout(c.node)),c},ccs.actionTimelineCache={createAction:function(a){return ccs._load(a,"action")}},ccs.csLoader={createNode:function(a){return ccs._load(a)}},cc.loader.register(["json"],{load:function(a,b,c,d){cc.loader.loadJson(a,function(a,c){var e=cc.path;if(c&&c.Content&&c.Content.Content.UsedResources){for(var f,g,h=c.Content.Content.UsedResources,i=e.dirname(b),j=[],k=0;k<h.length;k++)f=e.join(i,h[k]),g=e._normalize(f),ccs.load.validate[g]||(ccs.load.validate[g]=!0,j.push(g));cc.loader.load(j,function(){d(a,c)})}else d(a,c)})}}),function(a,b){var c=b.extend({getNodeJson:function(a){return a.action},parseNode:function(a,b,c){if(!a)return null;var d=this,e=new ccs.ActionTimeline;e.setDuration(a.duration),e.setTimeSpeed(a.speed||1);var f=a.timelines;return f.forEach(function(a){var c,f=d.parsers[a.frameType];f?c=f.call(d,a,b):cc.log("parser does not exist : %s",a.frameType),c&&e.addTimeline(c),"ColorFrame"===a.frameType&&e.addTimeline(d.parsers.AlphaFrame.call(d,a,b))}),e}}),d=new c,e=[{name:"PositionFrame",handle:function(a){var b=new ccs.PositionFrame,c=a.x,d=a.y;return b.setPosition(cc.p(c,d)),b}},{name:"VisibleFrame",handle:function(a){var b=new ccs.VisibleFrame,c=a.value;return b.setVisible(c),b}},{name:"ScaleFrame",handle:function(a){var b=new ccs.ScaleFrame,c=a.x,d=a.y;return b.setScaleX(c),b.setScaleY(d),b}},{name:"RotationFrame",handle:function(a){var b=new ccs.RotationFrame,c=a.rotation;return b.setRotation(c),b}},{name:"SkewFrame",handle:function(a){var b=new ccs.SkewFrame,c=a.x,d=a.y;return b.setSkewX(c),b.setSkewY(d),b}},{name:"RotationSkewFrame",handle:function(a){var b=new ccs.RotationSkewFrame,c=a.x,d=a.y;return b.setSkewX(c),b.setSkewY(d),b}},{name:"AnchorFrame",handle:function(a){var b=new ccs.AnchorPointFrame,c=a.x,d=a.y;return b.setAnchorPoint(cc.p(c,d)),b}},{name:"InnerActionFrame",handle:function(a){var b=new ccs.InnerActionFrame,c=a.innerActionType,d=a.startFrame;return b.setInnerActionType(c),b.setStartFrameIndex(d),b}},{name:"ColorFrame",handle:function(a){var b=new ccs.ColorFrame,c=a.red,d=a.green,e=a.blue;b.setColor(cc.color(c,d,e));var f=new ccs.AlphaFrame,g=a.alpha;return f.setAlpha(g),b}},{name:"AlphaFrame",handle:function(a){var b=new ccs.AlphaFrame,c=a.alpha;return b.setAlpha(c),b}},{name:"TextureFrame",handle:function(a){var b=new ccs.TextureFrame,c=a.value;if(null!=c){var d=c,e=cc.spriteFrameCache.getSpriteFrame(d);if(null==e){var f=ccs.csLoader.getJsonPath();d=f+c}b.setTextureName(d)}return b}},{name:"EventFrame",handle:function(a){var b=new ccs.EventFrame,c=a.value;return null!=c&&b.setEvent(c),b}},{name:"ZOrderFrame",handle:function(a){var b=new ccs.ZOrderFrame,c=a.value;return b.setZOrder(c),b}}];e.forEach(function(a){d.registerParser(a.name,function(b,c){var d=new ccs.Timeline;d.setActionTag(b.actionTag);var e=b.frames;return e&&e.length&&e.forEach(function(b){var c=a.handle(b);c.setFrameIndex(b.frameIndex),c.setTween(b.tween),d.addFrame(c)}),d})}),a.registerParser("action","0.*",d),a.registerParser("action","1.*",d)}(ccs._load,ccs._parser),function(a,b){var c=b.extend({getNodeJson:function(a){return a.Content.Content.Animation},parseNode:function(a,b,c){if(!a)return null;var d=this,e=new ccs.ActionTimeline;e.setDuration(a.Duration),e.setTimeSpeed(a.Speed||1);var f=a.Timelines;return f.forEach(function(a){var c,f=d.parsers[a.Property];f?c=f.call(d,a,b):cc.log("parser does not exist : %s",a.Property),c&&e.addTimeline(c)}),e},deferred:function(a,b,c,d){for(var e=a.Content.Content.AnimationList,f=e?e.length:0,g=0;f>g;g++){var h=e[g],i={name:null,startIndex:null,endIndex:null};i.name=h.Name,i.startIndex=h.StartIndex,i.endIndex=h.EndIndex,c.addAnimationInfo(i)}}}),d=new c,e=[{name:"Position",handle:function(a){var b=new ccs.PositionFrame,c=a.X,d=a.Y;return b.setPosition(cc.p(c,d)),b}},{name:"VisibleForFrame",handle:function(a){var b=new ccs.VisibleFrame,c=a.Value;return b.setVisible(c),b}},{name:"Scale",handle:function(a){var b=new ccs.ScaleFrame,c=a.X,d=a.Y;return b.setScaleX(c),b.setScaleY(d),b}},{name:"Rotation",handle:function(a){var b=new ccs.RotationFrame,c=a.Rotation||a.Value||0;return b.setRotation(c),b}},{name:"Skew",handle:function(a){var b=new ccs.SkewFrame,c=a.X,d=a.Y;return b.setSkewX(c),b.setSkewY(d),b}},{name:"RotationSkew",handle:function(a){var b=new ccs.RotationSkewFrame,c=a.X,d=a.Y;return b.setSkewX(c),b.setSkewY(d),b}},{name:"Anchor",handle:function(a){var b=new ccs.AnchorPointFrame,c=a.X,d=a.Y;return b.setAnchorPoint(cc.p(c,d)),b}},{name:"AnchorPoint",handle:function(a){var b=new ccs.AnchorPointFrame,c=a.X,d=a.Y;return b.setAnchorPoint(cc.p(c,d)),b}},{name:"InnerAction",handle:function(a){var b=new ccs.InnerActionFrame,c=a.InnerActionType,d=a.StartFrame;return b.setInnerActionType(c),b.setStartFrameIndex(d),b}},{name:"CColor",handle:function(a){var b=new ccs.ColorFrame,c=a.Color;return c||(c={}),c.R=void 0===c.R?255:c.R,c.G=void 0===c.G?255:c.G,c.B=void 0===c.B?255:c.B,b.setColor(cc.color(c.R,c.G,c.B)),b}},{name:"Alpha",handle:function(a){var b=new ccs.AlphaFrame,c=a.Value;return b.setAlpha(c),b}},{name:"FileData",handle:function(a,b){var c,d,e,f,g;return c=new ccs.TextureFrame,d=a.TextureFile,null!=d&&(e=d.Plist,f=d.Path,g=cc.spriteFrameCache.getSpriteFrame(f),!g&&e&&(cc.loader.getRes(b+e)?(cc.spriteFrameCache.addSpriteFrames(b+e),g=cc.spriteFrameCache.getSpriteFrame(f)):cc.log("%s need to be preloaded",b+e)),null==g&&(f=b+f),c.setTextureName(f)),c}},{name:"FrameEvent",handle:function(a){var b=new ccs.EventFrame,c=a.Value;return null!=c&&b.setEvent(c),b}},{name:"ZOrder",handle:function(a){var b=new ccs.ZOrderFrame,c=a.Value;return b.setZOrder(c),b}},{name:"ActionValue",handle:function(a){var b=new ccs.InnerActionFrame,c=a.InnerActionType,d=a.CurrentAniamtionName,e=a.SingleFrameIndex,f=a.FrameIndex;return void 0!==f&&b.setFrameIndex(f),b.setInnerActionType(ccs.InnerActionType[c]),b.setSingleFrameIndex(e),b.setEnterWithName(!0),d&&b.setAnimationName(d),b}},{name:"BlendFunc",handle:function(a){var b=new ccs.BlendFuncFrame,c=a.BlendFunc;return c&&void 0!==c.Src&&void 0!==c.Dst&&b.setBlendFunc(new cc.BlendFunc(c.Src,c.Dst)),b}}],f=function(a,b){var c=b.Type;a.setTweenType(c);var d=b.Points,e=[];d&&(d.forEach(function(a){e.push(a.X),e.push(a.Y)}),a.setEasingParams(e))};e.forEach(function(a){d.registerParser(a.name,function(b,c){var d=new ccs.Timeline;d.setActionTag(b.ActionTag);var e=b.Frames;return e&&e.length&&e.forEach(function(b){var e=a.handle(b,c);e.setFrameIndex(b.FrameIndex);var g=null!=b.Tween?b.Tween:!0;e.setTween(g);var h=b.EasingData;h&&f(e,h),d.addFrame(e)}),d})}),a.registerParser("action","2.*",d),a.registerParser("action","*",d)}(ccs._load,ccs._parser),function(a,b){var c=b.extend({getNodeJson:function(a){return a},parseNode:function(a,b){var c=this.parsers[this.getClass(a)],d=null;return c?d=c.call(this,a,b):cc.log("Can't find the parser : %s",this.getClass(a)),d},deferred:function(a,b,c,d){ccs.triggerManager.parse(a.Triggers||[]),ccs.sceneReader&&(ccs.sceneReader._node=c)},setPropertyFromJsonDict:function(a,b){var c=cc.isUndefined(b.x)?0:b.x,d=cc.isUndefined(b.y)?0:b.y;a.setPosition(c,d);var e=Boolean(cc.isUndefined(b.visible)?1:b.visible);a.setVisible(e);var f=cc.isUndefined(b.objecttag)?-1:b.objecttag;a.setTag(f);var g=cc.isUndefined(b.zorder)?0:b.zorder;a.setLocalZOrder(g);var h=cc.isUndefined(b.scalex)?1:b.scalex,i=cc.isUndefined(b.scaley)?1:b.scaley;a.setScaleX(h),a.setScaleY(i);var j=cc.isUndefined(b.rotation)?0:b.rotation;a.setRotation(j);var k=b.name||"";a.setName(k)}}),d=new c;d.parseChild=function(a,b,c){for(var d=0;d<b.length;d++){var e,f=b[d];f&&(e=this.parseNode(f,c)),e&&a.addChild(e)}};var e={CCSprite:function(a,b,c){var d=new cc.Sprite;g(b.fileData,c,function(a,b){if(0===b)d.setTexture(a);else if(1===b){var c=cc.spriteFrameCache.getSpriteFrame(a);d.setSpriteFrame(c)}});var e=new ccs.ComRender(d,"CCSprite");return a.addComponent(e),e},CCTMXTiledMap:function(a,b,c){var d=null;g(b.fileData,c,function(a,b){0===b&&(d=new cc.TMXTiledMap(a))});var e=new ccs.ComRender(d,"CCTMXTiledMap");return a.addComponent(e),e},CCParticleSystemQuad:function(a,b,c){var d=null;g(b.fileData,c,function(a,b){0===b?d=new cc.ParticleSystem(a):cc.log("unknown resourcetype on CCParticleSystemQuad!"),d.setPosition(0,0)});var e=new ccs.ComRender(d,"CCParticleSystemQuad");return a.addComponent(e),e},CCArmature:function(a,b,c){var d=null;if(g(b.fileData,c,function(a,b){if(0===b){var c=cc.loader.getRes(a);c||cc.log("Please load the resource [%s] first!",a);var e=c.armature_data,f=e[0],g=f.name;ccs.armatureDataManager.addArmatureFileInfo(a),d=new ccs.Armature(g)}}),d){var e=new ccs.ComRender(d,"CCArmature");a.addComponent(e);var f=b.selectedactionname;return f&&d.getAnimation()&&d.getAnimation().play(f),e}},CCComAudio:function(a,b,c){var d=null;g(b.fileData,c,function(c,e){if(0===e){d=new ccs.ComAudio,d.preloadEffect(c);var f=b.name;f&&d.setName(f),a.addComponent(d)}})},CCComAttribute:function(a,b,c){var d=null;return g(b.fileData,c,function(b,c){0===c?(d=new ccs.ComAttribute,""!==b&&d.parse(b),a.addComponent(d)):cc.log("unknown resourcetype on CCComAttribute!")}),d},CCBackgroundAudio:function(a,b,c){var d=null;g(b.fileData,c,function(c,e){if(0===e){d=new ccs.ComAudio,d.preloadBackgroundMusic(c),d.setFile(c);var f=Boolean(b.loop||0);d.setLoop(f);var g=b.name;g&&d.setName(g),a.addComponent(d),d.playBackgroundMusic(c,f)}})},GUIComponent:function(a,b,c){var d=null;g(b.fileData,c,function(a,b){d=ccs._load(a,"ccui")});var e=new ccs.ComRender(d,"GUIComponent");return a.addComponent(e),e},CCScene:function(){}},f={},g=function(a,b,c){if(null!=a){var d=a.path,e=a.resourceType,g=a.plist;if(!d)return;g&&(cc.loader.getRes(b+g)?(f[b+g]=!0,cc.spriteFrameCache.addSpriteFrames(b+g)):f[b+g]||cc.log("%s need to be preloaded",b+g)),0!==e?c(d,e):c(b+d,e)}};d.parseComponents=function(a,b,c){a&&b&&b.forEach(function(b){var d=e[b.classname],f=null;d?f=d(a,b,c):cc.log("Can't find the component parser : %s",b.classname);var g=b.name;f&&g&&f.setName(g)})},d.registerParser("CCNode",function(a,b){var c=new cc.Node;this.setPropertyFromJsonDict(c,a),this.parseChild.call(this,c,a.gameobjects,b),this.parseComponents(c,a.components,b);var d=a.CanvasSize;return d&&c.setContentSize(cc.size(d._width,d._height)),c}),a.registerParser("scene","*",d)}(ccs._load,ccs._parser),function(a,b){var c={},d=b.extend({getNodeJson:function(a){return a.nodeTree},addSpriteFrame:function(a,b,d){if(a&&b&&a.length===b.length)for(var e=0;e<a.length;e++){var f=d+a[e];cc.loader.getRes(f)||c[f]?c[f]=!0:cc.log("%s need to be preloaded",f),cc.spriteFrameCache.addSpriteFrames(f,d+b[e])}},pretreatment:function(a,b,c){this.addSpriteFrame(a.textures,a.texturesPng,b)}}),e=new d;e.generalAttributes=function(a,b){var c=null!=b.width?b.width:0,d=null!=b.height?b.height:0,e=null!=b.x?b.x:0,f=null!=b.y?b.y:0,g=null!=b.scaleX?b.scaleX:1,h=null!=b.scaleY?b.scaleY:1,i=null!=b.rotation?b.rotation:0,j=null!=b.rotationSkewX?b.rotationSkewX:0,k=null!=b.rotationSkewY?b.rotationSkewY:0,l=null!=b.skewX?b.skewX:0,m=null!=b.skewY?b.skewY:0,n=null!=b.anchorPointX?b.anchorPointX:.5,o=null!=b.anchorPointY?b.anchorPointY:.5,p=null!=b.opacity?b.opacity:255,q=null!=b.colorR?b.colorR:255,r=null!=b.colorG?b.colorG:255,s=null!=b.colorB?b.colorB:255,t=null!=b.colorR?b.colorR:0,u=null!=b.tag?b.tag:0,v=null!=b.actionTag?b.actionTag:0,w=null!=b.visible?b.visible:!0;0==e&&0==f||a.setPosition(cc.p(e,f)),1!=g&&a.setScaleX(g),1!=h&&a.setScaleY(h),0!=i&&a.setRotation(i),0!=j&&a.setRotationX(j),0!=k&&a.setRotationY(k),0!=l&&a.setSkewX(l),0!=m&&a.setSkewY(m),.5==n&&.5==o||a.setAnchorPoint(cc.p(n,o)),0==c&&0==d||a.setContentSize(cc.size(c,d)),0!=t&&a.setLocalZOrder(t),1!=w&&a.setVisible(w),255!=p&&a.setOpacity(p),255==q&&255==r&&255==s||a.setColor(cc.color(q,r,s)),a.setTag(u),a.setUserObject(new ccs.ActionTimelineData(v))},e.parseComponent=function(a,b){if(b)for(var c=0;c<b.length;++c){var d=b[c],e=this.loadComponent(d);e&&a.addComponent(e)}},e.parseChild=function(a,b,c,d){for(var e=c.children,f=0;f<e.length;f++){var g=this.parseNode(e[f],d);if(g)if(b instanceof ccui.PageView)g instanceof ccui.Layout&&b.addPage(g);else if(b instanceof ccui.ListView)g instanceof ccui.Widget&&b.pushBackCustomItem(g);else{if(!(b instanceof ccui.Layout)&&g instanceof ccui.Widget){if(g.getPositionType()===ccui.Widget.POSITION_PERCENT){var h=g.getPositionPercent(),i=b.getAnchorPoint();g.setPositionPercent(cc.p(h.x+i.x,h.y+i.y))}var j=b.getAnchorPointInPoints();g.setPosition(cc.p(g.getPositionX()+j.x,g.getPositionY()+j.y))}b.addChild(g)}}},e.initNode=function(a){var b=new cc.Node;return this.generalAttributes(b,a),b},e.initSubGraph=function(a){var b,c=a.fileName;return b=c&&""!==c?this.createNode(c):new ccs.Node,this.generalAttributes(b,a),b},e.initSprite=function(a,b){var c,d=a.fileName;if(null!=d){var e=cc.spriteFrameCache.getSpriteFrame(d);e?c=ccs.Sprite.createWithSpriteFrame(e):(d=b+d,c=new ccs.Sprite(d)),c||(c=new cc.Sprite,cc.log("filePath is empty. Create a sprite with no texture"))}else c=new ccs.Sprite;this.generalAttributes(c,a);var f=a.flipX,g=a.flipY;return 0!=f&&c.setFlippedX(f),0!=g&&c.setFlippedY(g),c},e.initParticle=function(a,b){var c=a.plistFile,d=a.tmxFile,e=new cc.ParticleSystemQuad(c);return e.setTotalParticles(d),this.generalAttributes(e,a),e},e.initTMXTiledMap=function(a,b){var c=a.tmxFile,d=a.tmxString,e=a.resourcePath,f=null;return c&&""!==c?f=new cc.TMXTiledMap(c):d&&""!==d&&e&&""!==e&&(f=new cc.TMXTiledMap(d,e)),f};var f=a.getParser("ccui")["*"];e.initWidget=function(a,b){var c=a.classname,d=f.parsers[c];if(!d)return cc.log("%s parser is not found",c);var e=d.call(f,a,b);if(e){var g=a.rotationSkewX,h=a.rotationSkewY,i=a.skewX,j=a.skewY;0!=g&&e.setRotationX(g),0!=h&&e.setRotationY(h),0!=i&&e.setSkewX(i),0!=j&&e.setSkewY(j);var k=a.actionTag;e.setUserObject(new ccs.ActionTimelineData(k))}return e};var g=[{name:"Node",handle:e.initNode},{name:"SubGraph",handle:e.initSubGraph},{name:"Sprite",handle:e.initSprite},{name:"Particle",handle:e.initParticle},{name:"TMXTiledMap",handle:e.initTMXTiledMap},{name:"Widget",handle:e.initWidget},{name:"Panel",handle:e.initWidget},{name:"Button",handle:e.initWidget},{name:"CheckBox",handle:e.initWidget},{name:"ImageView",handle:e.initWidget},{name:"LabelAtlas",handle:e.initWidget},{name:"LabelBMFont",handle:e.initWidget},{name:"Label",handle:e.initWidget},{name:"ListView",handle:e.initWidget},{name:"LoadingBar",handle:e.initWidget},{name:"PageView",handle:e.initWidget},{name:"ScrollView",handle:e.initWidget},{name:"Slider",handle:e.initWidget},{name:"TextField",handle:e.initWidget}];g.forEach(function(a){e.registerParser(a.name,function(b,c,d){var e=a.handle.call(this,b.options);return this.parseComponent(e,b.components),this.parseChild(c,e,b,d),e})}),a.registerParser("timeline","0.*",e),a.registerParser("timeline","1.*",e)}(ccs._load,ccs._parser),function(a,b){var c=!1,d=b.extend({parse:function(a,b,c){var d;d=void 0!==c?c:this._dirname(a),this.pretreatment(b,d,a);var e=this.parseNode(this.getNodeJson(b),d);return this.deferred(b,d,e,a),e},getNodeJson:function(a){var b=a.Content;return b.ObjectData?b.ObjectData:b.Content.ObjectData},getClass:function(a){return a.ctype}}),e=new d,f=function(a,b){return void 0===a?b:a};e.generalAttributes=function(a,b){null!=b.Name&&a.setName(b.Name);var c=b.Position;null==c||null==c.X&&null==c.Y||a.setPosition(cc.p(c.X||0,c.Y||0));var d=b.Scale;null!=d&&(null!=d.ScaleX&&a.setScaleX(d.ScaleX),null!=d.ScaleY&&a.setScaleY(d.ScaleY));var e=b.RotationSkewX;null!=e&&a.setRotationX(e);var g=b.RotationSkewY;null!=b.RotationSkewY&&a.setRotationY(g);var i=b.AnchorPoint;null!=i&&(null==i.ScaleX&&(i.ScaleX=0),null==i.ScaleY&&(i.ScaleY=0),.5==i.ScaleX&&.5==i.ScaleY||a.setAnchorPoint(cc.p(i.ScaleX,i.ScaleY))),null!=b.ZOrder&&a.setLocalZOrder(b.ZOrder);var j=f(b.VisibleForFrame,!0);a.setVisible(j);var k=b.Size;k&&o(a,k),null!=b.Alpha&&a.setOpacity(b.Alpha),a.setTag(b.Tag||0);var l=b.ActionTag||0,m=new ccs.ComExtensionData,n=b.UserData;void 0!==n&&m.setCustomProperty(n),m.setActionTag(l),a.getComponent("ComExtensionData")&&a.removeComponent("ComExtensionData"),a.addComponent(m),a.setCascadeColorEnabled(!0),a.setCascadeOpacityEnabled(!0),h(a,b)},e.parseChild=function(a,b,c){if(a&&b)for(var d=0;d<b.length;d++){var e=this.parseNode(b[d],c);if(e)if(a instanceof ccui.PageView)e instanceof ccui.Layout&&a.addPage(e);else if(a instanceof ccui.ListView)e instanceof ccui.Widget&&a.pushBackCustomItem(e);else{if(!(a instanceof ccui.Layout)&&e instanceof ccui.Widget&&e.getPositionType()===ccui.Widget.POSITION_PERCENT){var f=e.getPositionPercent(),g=a.getAnchorPoint();e.setPositionPercent(cc.p(f.x+g.x,f.y+g.y))}a.addChild(e)}}},e.initSingleNode=function(a){var b=new cc.Node;this.generalAttributes(b,a);var c=a.CColor;return null!=c&&b.setColor(n(c)),b},e.initSprite=function(a,b){var c=new cc.Sprite;m(a.FileData,b,function(a,b){if(0===b)c.setTexture(a);else if(1===b){var d=cc.spriteFrameCache.getSpriteFrame(a);d&&c.setSpriteFrame(d)}});var d=a.BlendFunc;if(a.BlendFunc){var e=cc.BlendFunc.ALPHA_PREMULTIPLIED;void 0!==d.Src&&(e.src=d.Src),void 0!==d.Dst&&(e.dst=d.Dst),c.setBlendFunc(e)}a.FlipX&&c.setFlippedX(!0),a.FlipY&&c.setFlippedY(!0),this.generalAttributes(c,a);var f=a.CColor;return null!=f&&c.setColor(n(f)),c},e.initParticle=function(a,b){var c,d=this;return m(a.FileData,b,function(b,e){cc.loader.getRes(b)||cc.log("%s need to be preloaded",b),c=new cc.ParticleSystem(b),d.generalAttributes(c,a),c.setPositionType(cc.ParticleSystem.TYPE_GROUPED),!cc.sys.isNative&&c.setDrawMode(cc.ParticleSystem.TEXTURE_MODE);var f=a.BlendFunc;if(a.BlendFunc){var g=cc.BlendFunc.ALPHA_PREMULTIPLIED;void 0!==f.Src&&(g.src=f.Src),void 0!==f.Dst&&(g.dst=f.Dst),c.setBlendFunc(g)}}),c},e.widgetAttributes=function(a,b,c){a.setCascadeColorEnabled(!0),a.setCascadeOpacityEnabled(!0),a.setUnifySizeEnabled(!1),a.ignoreContentAdaptWithSize(!1),!c&&o(a,b.Size);var d=b.Name;d&&a.setName(d);var e=b.ActionTag||0;a.setActionTag(e);var i=new ccs.ComExtensionData,j=b.UserData;void 0!==j&&i.setCustomProperty(j),i.setActionTag(e),a.getComponent("ComExtensionData")&&a.removeComponent("ComExtensionData"),a.addComponent(i);var k=b.RotationSkewX;k&&a.setRotationX(k);var l=b.RotationSkewY;l&&a.setRotationY(l);var m=b.FlipX;m&&a.setFlippedX(!0);var p=b.FlipY;p&&a.setFlippedY(!0);var q=b.zOrder;null!=q&&a.setLocalZOrder(q);var r=f(b.VisibleForFrame,!0);a.setVisible(r);var s=b.Alpha;null!=s&&a.setOpacity(s),a.setTag(b.Tag||0);var t=b.TouchEnable||!1;a.setTouchEnabled(t);var u=b.CallBackType;null!=u&&a.setCallbackType(u);var v=b.CallBackName;v&&a.setCallbackName(v);var w=b.Position;null!=w&&a.setPosition(w.X||0,w.Y||0);var x=b.Scale;if(null!=x){var y=f(x.ScaleX,1),z=f(x.ScaleY,1);a.setScaleX(y),a.setScaleY(z)}var A=b.AnchorPoint;null!=A&&a.setAnchorPoint(A.ScaleX||0,A.ScaleY||0);var B=b.CColor;null!=B&&a.setColor(n(B)),h(a,b),g(a,b)};var g=function(a,b){var c=b.CallBackType,d=b.CallBackName,e=function(b){"function"==typeof a[d]&&a[d](b)};"Click"===c?a.addClickEventListener(e):"Touch"===c?a.addTouchEventListener(e):"Event"===c&&a.addCCSEventListener(e)},h=function(a,b){var c=ccui.LayoutComponent.bindLayoutComponent(a);if(c){var d=b.PositionPercentXEnable||b.PositionPercentXEnabled||!1,e=b.PositionPercentYEnable||b.PositionPercentYEnabled||!1,f=0,g=0,h=b.PrePosition;null!=h&&(f=h.X||0,g=h.Y||0);var i=b.PercentWidthEnable||b.PercentWidthEnabled||!1,j=b.PercentHeightEnable||b.PercentHeightEnabled||!1,k=0,l=0,m=b.PreSize;null!=h&&(k=m.X||0,l=m.Y||0);var n=b.StretchWidthEnable||!1,o=b.StretchHeightEnable||!1,p=b.HorizontalEdge,q=b.VerticalEdge,r=b.LeftMargin||0,s=b.RightMargin||0,t=b.TopMargin||0,u=b.BottomMargin||0;c.setPositionPercentXEnabled(d),c.setPositionPercentYEnabled(e),c.setPositionPercentX(f),c.setPositionPercentY(g),c.setPercentWidthEnabled(i),c.setPercentHeightEnabled(j),c.setPercentWidth(k),c.setPercentHeight(l),c.setPercentWidthEnabled(i||j),c.setStretchWidthEnabled(n),c.setStretchHeightEnabled(o);var v=ccui.LayoutComponent.horizontalEdge.NONE;"LeftEdge"===p?v=ccui.LayoutComponent.horizontalEdge.LEFT:"RightEdge"===p?v=ccui.LayoutComponent.horizontalEdge.RIGHT:"BothEdge"===p&&(v=ccui.LayoutComponent.horizontalEdge.CENTER),c.setHorizontalEdge(v);var w=ccui.LayoutComponent.verticalEdge.NONE;"TopEdge"===q?w=ccui.LayoutComponent.verticalEdge.TOP:"BottomEdge"===q?w=ccui.LayoutComponent.verticalEdge.BOTTOM:"BothEdge"===q&&(w=ccui.LayoutComponent.verticalEdge.CENTER),c.setVerticalEdge(w),c.setTopMargin(t),c.setBottomMargin(u),c.setLeftMargin(r),c.setRightMargin(s),c.setVerticalEdge(w),c.setTopMargin(t),c.setBottomMargin(u),c.setLeftMargin(r),c.setRightMargin(s)}},i=function(a,b,c,d){2===a.getBackGroundColorType()?(c=c||{},d=d||{},a.setBackGroundColor(n(c),n(d))):(b=b||{},a.setBackGroundColor(n(b)))},j=function(a,b){var c=b.ScaleX||0,d=b.ScaleY||0;a.setBackGroundColorVector(cc.p(c,d))};e.initPanel=function(a,b){var c=new ccui.Layout;this.widgetAttributes(c,a);var d=a.ClipAble||!1;null!=d&&c.setClippingEnabled(d);var e=f(a.ComboBoxIndex,0);c.setBackGroundColorType(e);var g=f(a.BackColorAlpha,255);null!=g&&c.setBackGroundColorOpacity(g);var h=a.Scale9Enable;null!=h&&c.setBackGroundImageScale9Enabled(h);var k=f(a.Alpha,255);if(c.setOpacity(k),m(a.FileData,b,function(a,b){c.setBackGroundImage(a,b)}),h){var l=a.Scale9OriginX||0,n=a.Scale9OriginY||0,p=a.Scale9Width||0,q=a.Scale9Height||0;c.setBackGroundImageCapInsets(cc.rect(l,n,p,q)),o(c,a.Size)}else c.isIgnoreContentAdaptWithSize()||o(c,a.Size);return i(c,a.SingleColor,a.FirstColor,a.EndColor),j(c,a.ColorVector),c},e.initText=function(a,b){var c=new ccui.Text,d=a.TouchScaleChangeAble;null!=d&&c.setTouchScaleChangeEnabled(d);var e=a.LabelText;null!=e&&c.setString(e);var g=a.FontSize;null!=g&&c.setFontSize(g);var h=a.FontName;null!=h&&c.setFontName(h);var i=a.AreaWidth,j=a.areaHeight;i&&j&&c.setTextAreaSize(cc.size(i,j));var k=a.HorizontalAlignmentType||"HT_Left";switch(k){case"HT_Right":k=2;break;case"HT_Center":k=1;break;case"HT_Left":default:k=0}c.setTextHorizontalAlignment(k);var l=a.VerticalAlignmentType||"VT_Top";switch(l){case"VT_Bottom":l=2;break;case"VT_Center":l=1;break;case"VT_Top":default:l=0}c.setTextVerticalAlignment(l);var m=a.FontResource;if(null!=m){var o=m.Path;null!=o&&(cc.sys.isNative?h=cc.path.join(cc.loader.resPath,b,o):(h=o.match(/([^\/]+)\.(\S+)/),h=h?h[1]:""),c.setFontName(h))}a.OutlineEnabled&&a.OutlineColor&&c.enableOutline&&c.enableOutline(n(a.OutlineColor),f(a.OutlineSize,1)),a.ShadowEnabled&&a.ShadowColor&&c.enableShadow&&c.enableShadow(n(a.ShadowColor),cc.size(f(a.ShadowOffsetX,2),f(a.ShadowOffsetY,-2)),a.ShadowBlurRadius||0);var p=a.IsCustomSize;null!=p&&c.ignoreContentAdaptWithSize(!p),c.setUnifySizeEnabled(!1);var q=a.CColor;return a.CColor=null,c.setTextColor(n(q)),this.widgetAttributes(c,a,c.isIgnoreContentAdaptWithSize()),a.CColor=q,c},e.initButton=function(a,b){var c=new ccui.Button;m(a.NormalFileData,b,function(a,b){c.loadTextureNormal(a,b)}),m(a.PressedFileData,b,function(a,b){c.loadTexturePressed(a,b)}),m(a.DisabledFileData,b,function(a,b){c.loadTextureDisabled(a,b)});var d=f(a.Scale9Enable,!1);d&&c.setScale9Enabled(d);var e=a.ButtonText;null!=e&&c.setTitleText(e);var g=a.FontSize;null!=g&&c.setTitleFontSize(g);var h=a.FontName;null!=h&&c.setTitleFontName(h);var i=a.TextColor;null!=i&&c.setTitleColor(n(i));var j=f(a.DisplayState,!0);c.setBright(j),c.setEnabled(j);var k=a.FontResource;if(null!=k){var l=k.Path;null!=l&&(cc.sys.isNative?h=cc.path.join(cc.loader.resPath,b,l):(h=l.match(/([^\/]+)\.(\S+)/),h=h?h[1]:""),c.setTitleFontName(h))}var p=c.getTitleRenderer();
if(p&&a.ShadowEnabled&&a.ShadowColor&&p.enableShadow&&p.enableShadow(n(a.ShadowColor),cc.size(f(a.ShadowOffsetX,2),f(a.ShadowOffsetY,-2)),a.ShadowBlurRadius||0),p&&a.OutlineEnabled&&a.OutlineColor&&p.enableStroke&&p.enableStroke(n(a.OutlineColor),f(a.OutlineSize,1)),this.widgetAttributes(c,a),d){c.setUnifySizeEnabled(!1),c.ignoreContentAdaptWithSize(!1);var q=cc.rect(a.Scale9OriginX||0,a.Scale9OriginY||0,a.Scale9Width||0,a.Scale9Height||0);c.setCapInsets(q)}return o(c,a.Size),c},e.initCheckBox=function(a,b){var c=new ccui.CheckBox;this.widgetAttributes(c,a);var d=[{name:"NormalBackFileData",handle:c.loadTextureBackGround},{name:"PressedBackFileData",handle:c.loadTextureBackGroundSelected},{name:"NodeNormalFileData",handle:c.loadTextureFrontCross},{name:"DisableBackFileData",handle:c.loadTextureBackGroundDisabled},{name:"NodeDisableFileData",handle:c.loadTextureFrontCrossDisabled}];d.forEach(function(d){m(a[d.name],b,function(a,b){d.handle.call(c,a,b)})});var e=f(a.CheckedState,!1);c.setSelected(e);var g=f(a.DisplayState,!0);return c.setBright(g),c.setEnabled(g),c},e.initScrollView=function(a,b){var c=new ccui.ScrollView;this.widgetAttributes(c,a),m(a.FileData,b,function(a,b){c.setBackGroundImage(a,b)});var d=a.ClipAble||!1;c.setClippingEnabled(d);var e=f(a.ComboBoxIndex,0);c.setBackGroundColorType(e);var g=a.BackColorAlpha;null!=g&&c.setBackGroundColorOpacity(g);var h=a.Scale9Enable;if(h){c.setBackGroundImageScale9Enabled(!0);var k=a.Scale9OriginX||0,l=a.Scale9OriginY||0,n=a.Scale9Width||0,p=a.Scale9Height||0;c.setBackGroundImageCapInsets(cc.rect(k,l,n,p)),o(c,a.Size)}else c.isIgnoreContentAdaptWithSize()||o(c,a.Size);i(c,a.SingleColor,a.FirstColor,a.EndColor),j(c,a.ColorVector);var q=a.InnerNodeSize,r=cc.size(q.Width||0,q.Height||0);c.setInnerContainerSize(r);var s=0;"Vertical"===a.ScrollDirectionType&&(s=1),"Horizontal"===a.ScrollDirectionType&&(s=2),"Vertical_Horizontal"===a.ScrollDirectionType&&(s=3),c.setDirection(s);var t=f(a.IsBounceEnabled,!1);return c.setBounceEnabled(t),c},e.initImageView=function(a,b){var c=new ccui.ImageView;m(a.FileData,b,function(a,b){c.loadTexture(a,b)}),m(a.ImageFileData,b,function(a,b){c.loadTexture(a,b)});var d=a.Scale9Enable;if(d){c.setScale9Enabled(!0),c.setUnifySizeEnabled(!1),c.ignoreContentAdaptWithSize(!1);var e=a.Scale9OriginX||0,f=a.Scale9OriginY||0,g=a.Scale9Width||0,h=a.Scale9Height||0;c.setCapInsets(cc.rect(e,f,g,h))}else o(c,a.Size);return this.widgetAttributes(c,a),c},e.initLoadingBar=function(a,b){var c=new ccui.LoadingBar;this.widgetAttributes(c,a),m(a.ImageFileData,b,function(a,b){c.loadTexture(a,b)});var d="Right_To_Left"===a.ProgressType?1:0;c.setDirection(d);var e=f(a.ProgressInfo,80);return null!=e&&c.setPercent(e),c},e.initSlider=function(a,b){var c=new ccui.Slider,d=cc.loader;this.widgetAttributes(c,a);var e=[{name:"BackGroundData",handle:c.loadBarTexture},{name:"BallNormalData",handle:c.loadSlidBallTextureNormal},{name:"BallPressedData",handle:c.loadSlidBallTexturePressed},{name:"BallDisabledData",handle:c.loadSlidBallTextureDisabled},{name:"ProgressBarData",handle:c.loadProgressBarTexture}];e.forEach(function(e){m(a[e.name],b,function(a,b){0!==b||d.getRes(a)||cc.log("%s need to be preloaded",a),e.handle.call(c,a,b)})});var g=a.PercentInfo||0;c.setPercent(g);var h=f(a.DisplayState,!0);return c.setBright(h),c.setEnabled(h),c},e.initPageView=function(a,b){var c=new ccui.PageView;this.widgetAttributes(c,a),m(a.FileData,b,function(a,b){c.setBackGroundImage(a,b)});var d=a.ClipAble||!1;c.setClippingEnabled(d);var e=a.Scale9Enable;if(e){c.setBackGroundImageScale9Enabled(!0);var g=a.Scale9OriginX||0,h=a.Scale9OriginY||0,k=a.Scale9Width||0,l=a.Scale9Height||0;c.setBackGroundImageCapInsets(cc.rect(g,h,k,l))}var n=f(a.ComboBoxIndex,0);c.setBackGroundColorType(n),i(c,a.SingleColor,a.FirstColor,a.EndColor),j(c,a.ColorVector);var p=a.BackColorAlpha;return null!=p&&c.setBackGroundColorOpacity(p),o(c,a.Size),c},e.initListView=function(a,b){var c=new ccui.ListView;this.widgetAttributes(c,a),m(a.FileData,b,function(a,b){c.setBackGroundImage(a,b)});var d=a.ClipAble||!1;c.setClippingEnabled(d);var e=f(a.ComboBoxIndex,0);c.setBackGroundColorType(e);var g=f(a.BackColorAlpha,255),h=a.Scale9Enable;if(h){c.setBackGroundImageScale9Enabled(!0);var k=a.Scale9OriginX||0,l=a.Scale9OriginY||0,n=a.Scale9Width||0,p=a.Scale9Height||0;c.setBackGroundImageCapInsets(cc.rect(k,l,n,p))}var q=f(a.DirectionType,ccui.ListView.DIR_HORIZONTAL),r=f(a.VerticalType,"Align_Left"),s=f(a.HorizontalType,"Align_Top");q?"Vertical"===q&&(c.setDirection(ccui.ScrollView.DIR_VERTICAL),""===s?c.setGravity(ccui.ListView.GRAVITY_LEFT):"Align_Right"===s?c.setGravity(ccui.ListView.GRAVITY_RIGHT):"Align_HorizontalCenter"===s&&c.setGravity(ccui.ListView.GRAVITY_CENTER_HORIZONTAL)):(c.setDirection(ccui.ScrollView.DIR_HORIZONTAL),"Align_Bottom"===r?c.setGravity(ccui.ListView.GRAVITY_BOTTOM):"Align_VerticalCenter"===r?c.setGravity(ccui.ListView.GRAVITY_CENTER_VERTICAL):c.setGravity(ccui.ListView.GRAVITY_TOP));var t=f(a.IsBounceEnabled,!1);c.setBounceEnabled(t);var u=a.ItemMargin||0;c.setItemsMargin(u);var v=a.InnerNodeSize;return null!=v&&c.setInnerContainerSize(cc.size(v.Widget||0,v.Height||0)),i(c,a.SingleColor,a.FirstColor,a.EndColor),j(c,a.ColorVector),null!=g&&c.setBackGroundColorOpacity(g),o(c,a.Size),c},e.initTextAtlas=function(a,b){var c=new ccui.TextAtlas,d=a.LabelText,e=a.CharWidth,f=a.CharHeight,g=a.StartChar;return m(a.LabelAtlasFileImage_CNB,b,function(a,b){cc.loader.getRes(a)||cc.log("%s need to be preloaded",a),0===b&&c.setProperty(d,a,e,f,g)}),this.widgetAttributes(c,a),c.ignoreContentAdaptWithSize(!0),c},e.initTextBMFont=function(a,b){var c=new ccui.TextBMFont;this.widgetAttributes(c,a);var d=a.LabelText;return c.setString(d),m(a.LabelBMFontFile_CNB,b,function(a,b){cc.loader.getRes(a)||cc.log("%s need to be pre loaded",a),c.setFntFile(a)}),c.ignoreContentAdaptWithSize(!0),c},e.initTextField=function(a,b){var c=new ccui.TextField,d=a.PasswordEnable;if(d){c.setPasswordEnabled(!0);var e=a.PasswordStyleText||"*";c.setPasswordStyleText(e)}var f=a.PlaceHolderText;null!=f&&c.setPlaceHolder(f);var g=a.FontSize;null!=g&&c.setFontSize(g);var h=a.FontName;null!=h&&c.setFontName(h);var i=a.MaxLengthEnable;if(i){c.setMaxLengthEnabled(!0);var j=a.MaxLengthText||0;c.setMaxLength(j)}this.widgetAttributes(c,a);var k=a.LabelText;null!=k&&c.setString(k);var l=a.FontResource;if(null!=l){var m=l.Path;null!=m&&(cc.sys.isNative?h=cc.path.join(cc.loader.resPath,b,m):(h=m.match(/([^\/]+)\.(\S+)/),h=h?h[1]:""),c.setFontName(h))}c.setUnifySizeEnabled(!1),c.ignoreContentAdaptWithSize(!1);var p=a.CColor;return null!=p&&c.setTextColor(n(p)),c.isIgnoreContentAdaptWithSize()||(o(c,a.Size),cc.sys.isNative&&c.getVirtualRenderer().setLineBreakWithoutSpace(!0)),c},e.initSimpleAudio=function(a,b){var c=new ccs.ComAudio,d=a.Loop||!1;c.setLoop(d),m(a.FileData,b,function(a,b){c.setFile(a)})},e.initGameMap=function(a,b){var c=null;return m(a.FileData,b,function(b,d){0===d&&(c=new cc.TMXTiledMap(b)),e.generalAttributes(c,a)}),c},e.initProjectNode=function(a,b){var c=a.FileData;if(null!=c&&c.Path){var d=b+c.Path;if(cc.loader.getRes(d)){var f=ccs.load(d,b);if(e.generalAttributes(f.node,a),f.action&&f.node){f.action.tag=f.node.tag;var g=a.InnerActionSpeed;void 0!==g&&f.action.setTimeSpeed(g),f.node.runAction(f.action),f.action.gotoFrameAndPause(0)}return f.node}cc.log("%s need to be preloaded",d)}};var k=function(a){if(!a)return"";var b=a.match(/([^\/]+)\.[^\/]+$/);return b&&b[1]?b[1]:""};e.initArmature=function(a,b){var c=new ccs.Armature,d=a.IsLoop,f=a.IsAutoPlay,g=a.CurrentAnimationName;return m(a.FileData,b,function(a,b){var e,h,i=cc.loader.getRes(a);i?(e=i.config_file_path,h=i.config_png_path,e.forEach(function(a,b){h[b]&&cc.spriteFrameCache.addSpriteFrames(a,h[b])})):cc.log("%s need to be preloaded",a),ccs.armatureDataManager.addArmatureFileInfo(a),c.init(k(a)),f?c.getAnimation().play(g,-1,d):(c.getAnimation().play(g),c.getAnimation().gotoAndPause(0))}),delete a.AnchorPoint,delete a.Size,e.generalAttributes(c,a),c.setColor(n(a.CColor)),c},e.initBoneNode=function(a,b){var c=new ccs.BoneNode,d=a.Length;void 0!==d&&c.setDebugDrawLength(d);var f=a.BlendFunc;f&&void 0!==f.Src&&void 0!==f.Dst&&c.setBlendFunc(new cc.BlendFunc(f.Src,f.Dst)),e.generalAttributes(c,a);var g=a.CColor;return!g||void 0===g.R&&void 0===g.G&&void 0===g.B||c.setColor(n(g)),c},e.initSkeletonNode=function(a){var b=new ccs.SkeletonNode;e.generalAttributes(b,a);var c=a.CColor;return!c||void 0===c.R&&void 0===c.G&&void 0===c.B||b.setColor(n(c)),b};var l={},m=function(a,b,c){if(null!=a){var d,e=a.Path;d="Default"===a.Type||"Normal"===a.Type?0:1;var f=a.Plist;f&&(cc.loader.getRes(b+f)?(l[b+f]=!0,cc.spriteFrameCache.addSpriteFrames(b+f)):l[b+f]||cc.spriteFrameCache.getSpriteFrame(e)||cc.log("%s need to be preloaded",b+f)),0!==d?cc.spriteFrameCache.getSpriteFrame(e)?c(e,d):cc.log("failed to get spriteFrame: %s",e):c(b+e,d)}},n=function(a){if(a){var b=null!=a.R?a.R:255,c=null!=a.G?a.G:255,d=null!=a.B?a.B:255,e=null!=a.A?a.A:255;return cc.color(b,c,d,e)}},o=function(a,b){var c=b.X||0,d=b.Y||0;b&&a.setContentSize(cc.size(c,d))},p=[{name:"SingleNodeObjectData",handle:e.initSingleNode},{name:"NodeObjectData",handle:e.initSingleNode},{name:"LayerObjectData",handle:e.initSingleNode},{name:"GameNodeObjectData",handle:e.initSingleNode},{name:"GameLayerObjectData",handle:e.initSingleNode},{name:"SpriteObjectData",handle:e.initSprite},{name:"ParticleObjectData",handle:e.initParticle},{name:"PanelObjectData",handle:e.initPanel},{name:"TextObjectData",handle:e.initText},{name:"ButtonObjectData",handle:e.initButton},{name:"CheckBoxObjectData",handle:e.initCheckBox},{name:"ScrollViewObjectData",handle:e.initScrollView},{name:"ImageViewObjectData",handle:e.initImageView},{name:"LoadingBarObjectData",handle:e.initLoadingBar},{name:"SliderObjectData",handle:e.initSlider},{name:"PageViewObjectData",handle:e.initPageView},{name:"ListViewObjectData",handle:e.initListView},{name:"TextAtlasObjectData",handle:e.initTextAtlas},{name:"TextBMFontObjectData",handle:e.initTextBMFont},{name:"TextFieldObjectData",handle:e.initTextField},{name:"SimpleAudioObjectData",handle:e.initSimpleAudio},{name:"GameMapObjectData",handle:e.initGameMap},{name:"ProjectNodeObjectData",handle:e.initProjectNode},{name:"ArmatureNodeObjectData",handle:e.initArmature},{name:"BoneNodeObjectData",handle:e.initBoneNode},{name:"SkeletonNodeObjectData",handle:e.initSkeletonNode}];p.forEach(function(a){e.registerParser(a.name,function(b,d){var e=a.handle.call(this,b,d);return this.parseChild(e,b.Children,d),c&&e&&(e.__parserName=a.name),e})}),a.registerParser("timeline","2.*",e),a.registerParser("timeline","*",e)}(ccs._load,ccs._parser),function(a,b){var c=b.extend({addSpriteFrame:function(a,b){if(a)for(var c=0;c<a.length;c++)cc.spriteFrameCache.addSpriteFrames(b+a[c])},pretreatment:function(a,b){this.addSpriteFrame(a.textures,b)},deferred:function(a,b,c,d){c&&(ccs.actionManager.initWithDictionary(d,a.animation,c),c.setContentSize(cc.size(a.designWidth,a.designHeight)))}}),d=new c;d.generalAttributes=function(a,b){var c=b.ignoreSize;null!=c&&a.ignoreContentAdaptWithSize(c),b.sizeType&&a.setSizeType(b.sizeType),b.positionType&&a.setPositionType(b.positionType),a.setSizePercent(cc.p(b.sizePercentX,b.sizePercentY)),a.setPositionPercent(cc.p(b.positionPercentX,b.positionPercentY));var d=0,e=0,f=b.adaptScreen;if(f){var g=cc.director.getWinSize();d=g.width,e=g.height}else d=b.width,e=b.height;a.setContentSize(d,e),a.setTag(b.tag),a.setActionTag(b.actiontag),a.setTouchEnabled(b.touchAble);var h=b.name,i=h?h:"default";a.setName(i);var j=b.x,k=b.y;a.setPosition(j,k);var l=null!=b.scaleX?b.scaleX:1;a.setScaleX(l);var m=null!=b.scaleY?b.scaleY:1;a.setScaleY(m);var n=b.rotation||0;a.setRotation(n);var o=b.visible||!1;null!=o&&a.setVisible(o),a.setLocalZOrder(b.ZOrder);var p=b.layoutParameter;if(null!=p){var q=b.layoutParameter,r=q.type,s=null;switch(r){case 0:break;case 1:s=new ccui.LinearLayoutParameter;var t=q.gravity;s.setGravity(t);break;case 2:s=new ccui.RelativeLayoutParameter;var u=s,v=q.relativeName;u.setRelativeName(v);var w=q.relativeToName;u.setRelativeToWidgetName(w);var x=q.align;u.setAlign(x)}if(null!=s){var y=q.marginLeft||0,z=q.marginTop||0,A=q.marginRight||0,B=q.marginDown||0;s.setMargin(y,z,A,B),a.setLayoutParameter(s)}}},d.colorAttributes=function(a,b){var c=b.opacity;null!=c&&a.setOpacity(c);var d=b.colorR,e=b.colorG,f=b.colorB;a.setColor(cc.color(null==d?255:d,null==e?255:e,null==f?255:f)),a.setFlippedX(b.flipX),a.setFlippedY(b.flipY)},d.anchorPointAttributes=function(a,b){var c,d=b.anchorPointX;c=null!=d?b.anchorPointX:a.getAnchorPoint().x;var e,f=b.anchorPointY;e=null!=f?b.anchorPointY:a.getAnchorPoint().y,null==d&&null==f||a.setAnchorPoint(cc.p(c,e))},d.parseChild=function(a,b,c){for(var d=b.children,e=0;e<d.length;e++){var f=this.parseNode(d[e],c);if(f)if(a instanceof ccui.PageView)a.addPage(f);else if(a instanceof ccui.ListView)a.pushBackCustomItem(f);else{if(!(a instanceof ccui.Layout)){if(f.getPositionType()===ccui.Widget.POSITION_PERCENT){var g=f.getPositionPercent(),h=a.getAnchorPoint();f.setPositionPercent(cc.p(g.x+h.x,g.y+h.y))}var i=a.getAnchorPointInPoints();f.setPosition(cc.p(f.getPositionX()+i.x,f.getPositionY()+i.y))}a.addChild(f)}}};var e=function(a,b,c,d){c&&(0===b?d(a+c,b):d(c,b))};d.LayoutAttributes=function(a,b,c){var d=0,f=0,g=b.adaptScreen;if(g){var h=cc.director.getWinSize();d=h.width,f=h.height}else d=b.width,f=b.height;a.setSize(cc.size(d,f)),a.setClippingEnabled(b.clipAble);var i=b.backGroundScale9Enable;a.setBackGroundImageScale9Enabled(i);var j=b.bgColorR,k=b.bgColorG,l=b.bgColorB,m=b.bgStartColorR,n=b.bgStartColorG,o=b.bgStartColorB,p=b.bgEndColorR,q=b.bgEndColorG,r=b.bgEndColorB,s=b.vectorX,t=b.vectorY;a.setBackGroundColorVector(cc.p(s,t));var u=b.bgColorOpacity,v=b.colorType;a.setBackGroundColorType(v),a.setBackGroundColor(cc.color(m,n,o),cc.color(p,q,r)),a.setBackGroundColor(cc.color(j,k,l)),a.setBackGroundColorOpacity(u);var w=b.backGroundImageData;if(w&&e(c,w.resourceType,w.path,function(b,c){a.setBackGroundImage(b,c)}),i){var x=b.capInsetsX,y=b.capInsetsY,z=b.capInsetsWidth,A=b.capInsetsHeight;a.setBackGroundImageCapInsets(cc.rect(x,y,z,A))}b.layoutType&&a.setLayoutType(b.layoutType)},d.ButtonAttributes=function(a,b,c){var d=a,f=b.scale9Enable;d.setScale9Enabled(f);var g=b.normalData;e(c,g.resourceType,g.path,function(a,b){d.loadTextureNormal(a,b)});var h=b.pressedData;e(c,h.resourceType,h.path,function(a,b){d.loadTexturePressed(a,b)});var i=b.disabledData;if(e(c,i.resourceType,i.path,function(a,b){d.loadTextureDisabled(a,b)}),f){var j=b.capInsetsX,k=b.capInsetsY,l=b.capInsetsWidth,m=b.capInsetsHeight;d.setCapInsets(cc.rect(j,k,l,m));var n=b.scale9Width,o=b.scale9Height;null!=n&&null!=o&&d.setSize(cc.size(n,o))}var p=b.text;null!=p&&d.setTitleText(p);var q=b.textColorR,r=b.textColorG,s=b.textColorB,t=null!==q?b.textColorR:255,u=null!==r?b.textColorG:255,v=null!==s?b.textColorB:255;d.setTitleColor(cc.color(t,u,v));var w=b.fontSize;null!=w&&d.setTitleFontSize(b.fontSize);var x=b.fontName;x&&d.setTitleFontName(b.fontName)},d.CheckBoxAttributes=function(a,b,c){var d=b.backGroundBoxData;e(c,d.resourceType,d.path,function(b,c){a.loadTextureBackGround(b,c)});var f=b.backGroundBoxSelectedData;e(c,f.resourceType||d.resourceType,f.path||d.path,function(b,c){a.loadTextureBackGroundSelected(b,c)});var g=b.frontCrossData;e(c,g.resourceType,g.path,function(b,c){a.loadTextureFrontCross(b,c)});var h=b.backGroundBoxDisabledData;e(c,h.resourceType||g.resourceType,h.path||g.path,function(b,c){a.loadTextureBackGroundDisabled(b,c)});var i=b.frontCrossDisabledData;e(c,i.resourceType,i.path,function(b,c){a.loadTextureFrontCrossDisabled(b,c)}),b.selectedState&&a.setSelected(b.selectedState)},d.ImageViewAttributes=function(a,b,c){var d=b.fileNameData;e(c,d.resourceType,d.path,function(b,c){a.loadTexture(b,c)});var f=b.scale9Enable,g=!1;if(f&&(g=b.scale9Enable),a.setScale9Enabled(g),g){var h=b.scale9Width,i=b.scale9Height;if(h&&i){var j=b.scale9Width,k=b.scale9Height;a.setSize(cc.size(j,k))}var l=b.capInsetsX,m=b.capInsetsY,n=b.capInsetsWidth,o=b.capInsetsHeight;a.setCapInsets(cc.rect(l,m,n,o))}},d.TextAtlasAttributes=function(a,b,c){var d=b.stringValue,e=b.charMapFileData,f=b.itemWidth,g=b.itemHeight,h=b.startCharMap;if(null!=d&&e&&null!=f&&null!=g&&null!=h){var i=b.charMapFileData,j=i.resourceType;switch(j){case 0:var k=c,l=i.path,m=k+l;a.setProperty(d,m,f,g,h);break;case 1:cc.log("Wrong res type of LabelAtlas!")}}},d.TextBMFontAttributes=function(a,b,c){var d=b.fileNameData,e=d.resourceType;switch(e){case 0:var f=c,g=d.path,h=f+g;a.setFntFile(h);break;case 1:cc.log("Wrong res type of LabelAtlas!")}var i=b.text;a.setString(i)};var f=/\.ttf$/;d.TextAttributes=function(a,b,c){var d=b.touchScaleEnable;a.setTouchScaleChangeEnabled(d);var e=b.text;a.setString(e);var g=b.fontSize;null!=g&&a.setFontSize(b.fontSize);var h=b.fontName;null!=h&&(cc.sys.isNative?f.test(h)?a.setFontName(cc.path.join(cc.loader.resPath,c,h)):a.setFontName(h):a.setFontName(h.replace(f,"")));var i=b.areaWidth,j=b.areaHeight;if(null!=i&&null!=j){var k=cc.size(b.areaWidth,b.areaHeight);a.setTextAreaSize(k)}var l=b.hAlignment;null!=l&&a.setTextHorizontalAlignment(b.hAlignment);var m=b.vAlignment;null!=m&&a.setTextVerticalAlignment(b.vAlignment)},d.ListViewAttributes=function(a,b,c){d.ScrollViewAttributes(a,b,c);var e=b.direction;a.setDirection(e);var f=b.gravity;a.setGravity(f);var g=b.itemMargin;a.setItemsMargin(g)},d.LoadingBarAttributes=function(a,b,c){var d=b.textureData;e(c,d.resourceType,d.path,function(b,c){a.loadTexture(b,c)});var f=b.scale9Enable;if(a.setScale9Enabled(f),f){var g=b.capInsetsX,h=b.capInsetsY,i=b.capInsetsWidth,j=b.capInsetsHeight;a.setCapInsets(cc.rect(g,h,i,j));var k=b.width,l=b.height;a.setSize(cc.size(k,l))}a.setDirection(b.direction),a.setPercent(b.percent)},d.PageViewAttributes=d.LayoutAttributes,d.ScrollViewAttributes=function(a,b,c){d.LayoutAttributes(a,b,c);var e=null!=b.innerWidth?b.innerWidth:200,f=null!=b.innerHeight?b.innerHeight:200;a.setInnerContainerSize(cc.size(e,f));var g=null!=b.direction?b.direction:1;a.setDirection(g),a.setBounceEnabled(b.bounceEnable)},d.SliderAttributes=function(a,b,c){var d=a,f=b.scale9Enable;d.setScale9Enabled(f);var g=b.barFileName,h=b.length,i=b.barFileNameData,j=i.resourceType,k=i.path;null!=g?f&&(e(c,j,k,function(a,b){d.loadBarTexture(a,b)}),d.setSize(cc.size(h,d.getContentSize().height))):e(c,j,k,function(a,b){d.loadBarTexture(a,b)});var l=b.ballNormalData;e(c,l.resourceType,l.path,function(a,b){d.loadSlidBallTextureNormal(a,b)});var m=b.ballPressedData;e(c,m.resourceType||l.resourceType,m.path||l.path,function(a,b){d.loadSlidBallTexturePressed(a,b)});var n=b.ballDisabledData;e(c,n.resourceType,n.path,function(a,b){d.loadSlidBallTextureDisabled(a,b)});var o=b.progressBarData;e(c,o.resourceType,o.path,function(a,b){d.loadProgressBarTexture(a,b)})},d.TextFieldAttributes=function(a,b,c){var d=b.placeHolder;d&&a.setPlaceHolder(d),a.setString(b.text||"");var e=b.fontSize;e&&a.setFontSize(e);var g=b.fontName;null!=g&&(cc.sys.isNative?f.test(g)?a.setFontName(cc.path.join(cc.loader.resPath,c,g)):a.setFontName(g):a.setFontName(g.replace(f,"")));var h=b.touchSizeWidth,i=b.touchSizeHeight;null!=h&&null!=i&&a.setTouchSize(h,i);var j=(b.width,b.height,b.maxLengthEnable);if(a.setMaxLengthEnabled(j),j){var k=b.maxLength;a.setMaxLength(k)}var l=b.passwordEnable;a.setPasswordEnabled(l),l&&a.setPasswordStyleText(b.passwordStyleText);var m=b.areaWidth,n=b.areaHeight;if(m&&n){var o=cc.size(m,n);a.setTextAreaSize(o)}var p=b.hAlignment;p&&a.setTextHorizontalAlignment(p);var q=b.vAlignment;q&&a.setTextVerticalAlignment(q);var r=b.colorR,s=b.colorG,t=b.colorB;void 0!==r&&void 0!==s&&void 0!==t&&a.setTextColor(cc.color(r,s,t))};var g=[{name:"Panel",object:ccui.Layout,handle:d.LayoutAttributes},{name:"Button",object:ccui.Button,handle:d.ButtonAttributes},{name:"CheckBox",object:ccui.CheckBox,handle:d.CheckBoxAttributes},{name:"ImageView",object:ccui.ImageView,handle:d.ImageViewAttributes},{name:"LabelAtlas",object:ccui.TextAtlas,handle:d.TextAtlasAttributes},{name:"LabelBMFont",object:ccui.TextBMFont,handle:d.TextBMFontAttributes},{name:"Label",object:ccui.Text,handle:d.TextAttributes},{name:"ListView",object:ccui.ListView,handle:d.ListViewAttributes},{name:"LoadingBar",object:ccui.LoadingBar,handle:d.LoadingBarAttributes},{name:"PageView",object:ccui.PageView,handle:d.PageViewAttributes},{name:"ScrollView",object:ccui.ScrollView,handle:d.ScrollViewAttributes},{name:"Slider",object:ccui.Slider,handle:d.SliderAttributes},{name:"TextField",object:ccui.TextField,handle:d.TextFieldAttributes}];g.forEach(function(a){d.registerParser(a.name,function(b,c){var e=new a.object,f=b.options;return d.generalAttributes(e,f),a.handle(e,f,c),d.colorAttributes(e,f),d.anchorPointAttributes(e,f),d.parseChild.call(this,e,b,c),e})}),a.registerParser("ccui","*",d)}(ccs._load,ccs._parser),function(){ccs.uiReader={_fileDesignSizes:{},widgetFromJsonFile:function(a){var b=cc.loader.getRes(a);b&&(this._fileDesignSizes[a]=cc.size(b.designWidth||0,b.designHeight||0));var c=b.Version||b.version,d=ccs.uiReader.getVersionInteger(c);return!c||d>=1700?(cc.warn("Not supported file types, Please try use the ccs.load"),null):ccs._load(a,"ccui")},registerTypeAndCallBack:function(a,b,c,d){var e=ccs._load.getParser("ccui")["*"],f=d.bind(c);e.registerParser(a,function(d,e){var g=new b,h=d.options;c.setPropsFromJsonDictionary&&c.setPropsFromJsonDictionary(g,h),this.generalAttributes(g,h);var i=h.customProperty;return i=i?JSON.parse(i):{},f(a,g,i),this.colorAttributes(g,h),this.anchorPointAttributes(g,h),this.parseChild.call(this,g,d,e),g})},getVersionInteger:function(a){if(!a||"string"!=typeof a)return 0;var b=a.split(".");if(4!==b.length)return 0;var c=0;return b.forEach(function(a,b){c+=a*Math.pow(10,3-b)}),c},storeFileDesignSize:function(a,b){this._fileDesignSizes[a]=b},getFileDesignSize:function(a){return this._fileDesignSizes[a]},getFilePath:function(){return this._filePath},setFilePath:function(a){this._filePath=a},getParseObjectMap:function(){return ccs._load.getParser("ccui")["*"].parsers},getParseCallBackMap:function(){return ccs._load.getParser("ccui")["*"].parsers},clear:function(){}};var a=ccs._load.getParser("ccui")["*"];ccs.imageViewReader={setPropsFromJsonDictionary:a.ImageViewAttributes},ccs.buttonReader={setPropsFromJsonDictionary:a.ButtonAttributes},ccs.checkBoxReader={setPropsFromJsonDictionary:a.CheckBoxAttributes},ccs.labelAtlasReader={setPropsFromJsonDictionary:a.TextAtlasAttributes},ccs.labelBMFontReader={setPropsFromJsonDictionary:a.TextBMFontAttributes},ccs.labelReader={setPropsFromJsonDictionary:a.TextAttributes},ccs.layoutReader={setPropsFromJsonDictionary:a.LayoutAttributes},ccs.listViewReader={setPropsFromJsonDictionary:a.ListViewAttributes},ccs.loadingBarReader={setPropsFromJsonDictionary:a.LoadingBarAttributes},ccs.pageViewReader={setPropsFromJsonDictionary:a.PageViewAttributes},ccs.scrollViewReader={setPropsFromJsonDictionary:a.ScrollViewAttributes},ccs.sliderReader={setPropsFromJsonDictionary:a.SliderAttributes},ccs.textFieldReader={setPropsFromJsonDictionary:a.TextFieldAttributes}}(),function(){ccs.sceneReader={_node:null,createNodeWithSceneFile:function(a){var b=ccs._load(a,"scene");return this._node=b,b},getNodeByTag:function(a){return null==this._node?null:this._node.getTag()===a?this._node:this._nodeByTag(this._node,a)},_nodeByTag:function(a,b){if(null==a)return null;for(var c=null,d=a.getChildren(),e=0;e<d.length;e++){var f=d[e];if(f&&f.getTag()===b){c=f;break}if(c=this._nodeByTag(f,b))break}return c},version:function(){return"*"},setTarget:function(){},clear:function(){ccs.triggerManager.removeAll(),cc.audioEngine.end()}}}();