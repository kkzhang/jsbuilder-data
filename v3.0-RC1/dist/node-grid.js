cc.NodeGrid=cc.Node.extend({grid:null,_target:null,getGrid:function(){return this.grid},setGrid:function(a){this.grid=a},setTarget:function(a){this._target=a},addChild:function(a,b,c){cc.Node.prototype.addChild.call(this,a,b,c);a&&!this._target&&(this._target=a)},visit:function(){if(this._visible){var a=cc._renderType==cc._RENDER_TYPE_WEBGL,b=this.grid;a&&(b&&b._active)&&b.beforeDraw();this.transform();var c=this._children;if(c&&0<c.length){var d=c.length;this.sortAllChildren();for(i=0;i<d;i++){var e=
c[i];e&&e.visit()}}a&&(b&&b._active)&&b.afterDraw(this._target)}},_transformForWebGL:function(){var a=this._transform4x4,b=cc.current_stack.top,c=this.nodeToParentTransform(),d=a.mat;d[0]=c.a;d[4]=c.c;d[12]=c.tx;d[1]=c.b;d[5]=c.d;d[13]=c.ty;d[14]=this._vertexZ;cc.kmMat4Multiply(b,b,a);if(null!=this._camera&&(!this.grid||!this.grid.isActive()))a=this._anchorPointInPoints.x,b=this._anchorPointInPoints.y,0!==a||0!==b?(cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(a|=0,b|=0),cc.kmGLTranslatef(a,b,0),this._camera.locate(),
cc.kmGLTranslatef(-a,-b,0)):this._camera.locate()}});var _p=cc.NodeGrid.prototype;cc._renderType===cc._RENDER_TYPE_WEBGL&&(_p.transform=_p._transformForWebGL);cc.defineGetterSetter(_p,"target",null,_p.setTarget);cc.NodeGrid.create=function(){return new cc.NodeGrid};